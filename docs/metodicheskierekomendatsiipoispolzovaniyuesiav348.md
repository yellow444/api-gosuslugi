ЕДИНАЯ СИСТЕМА ИДЕНТИФИКАЦИИ И АУТЕНТИФИКАЦИИ

(ЕСИА)

МЕТОДИЧЕСКИЕ РЕКОМЕНДАЦИИ ПО ИСПОЛЬЗОВАНИЮ ЕСИА

Версия 3.48

Москва 2024

Аннотация

Настоящий документ представляет собой методические рекомендации\
по использованию федеральной государственной информационной системы
«Единая система идентификации и аутентификации в инфраструктуре,
обеспечивающей информационно-технологическое взаимодействие
информационных систем, используемых для предоставления государственных и
муниципальных услуг в электронной форме»\
(далее -- ЕСИА) конечными пользователями данной информационной системы.

Методические рекомендации описывают интеграции внешних ИС с ЕСИА\
и для обеспечения соответствия положений нормативно-правовых актов в
части использования ЕСИА.

Описание сопровождается иллюстрациями и примерами с фрагментами кода
запросов от систем-клиентов и ответов сервисов ЕСИА на эти запросы.

**Содержание**

Обозначения и сокращения [31](#обозначения-и-сокращения)

Термины и определения [35](#термины-и-определения)

1 Введение [37](#введение)

1.1 Назначение документа [38](#назначение-документа)

1.2 Нормативные ссылки [38](#нормативные-ссылки)

2 Общее описание ЕСИА [40](#общее-описание-есиа)

3 Аутентификация пользователей через ЕСИА
[42](#аутентификация-пользователей-через-есиа)

3.1 Как обеспечить вход пользователей через ЕСИА
[43](#как-обеспечить-вход-пользователей-через-есиа)

3.1.1 Аутентификация с использованием OpenID Connect 1.0
[44](#аутентификация-с-использованием-openid-connect-1.0)

3.2 Рекомендуемый сценарий аутентификации при интеграции по OpenID
Connect 1.0
[45](#рекомендуемый-сценарий-аутентификации-при-интеграции-по-openid-connect-1.0)

3.3 Требования к визуальному оформлению входа посредством ЕСИА
[48](#требования-к-визуальному-оформлению-входа-посредством-есиа)

3.3.1 Аутентификация исключительно посредством ЕСИА
[49](#аутентификация-исключительно-посредством-есиа)

3.3.2 Аутентификация посредством ЕСИА в качестве одного из возможных
вариантов аутентификации
[49](#аутентификация-посредством-есиа-в-качестве-одного-из-возможных-вариантов-аутентификации)

3.4 Аутентификация посредством ЕСИА с обязательным использованием
второго фактора
[49](#аутентификация-посредством-есиа-с-обязательным-использованием-второго-фактора)

3.5 Возврат пользователя в систему, вызвавшую профиль пользователя в
ЕСИА или регистрацию пользователя в ЕСИА
[50](#возврат-пользователя-в-систему-вызвавшую-профиль-пользователя-в-есиа-или-регистрацию-пользователя-в-есиа)

4 Ведение регистров ЕСИА [52](#ведение-регистров-есиа)

4.1 Регистрация [52](#регистрация)

4.1.1 Регистрация физических лиц и получение ролей
[52](#регистрация-физических-лиц-и-получение-ролей)

4.1.2 Регистрация ЮЛ [57](#регистрация-юл)

4.1.3 Регистрация ОГВ [58](#регистрация-огв)

4.1.4 Регистрация ИС [58](#регистрация-ис)

4.1.5 Регистрация системных групп [59](#регистрация-системных-групп)

4.2 Управление данными [60](#управление-данными)

4.2.1 Управление данными ФЛ [60](#управление-данными-фл)

4.2.2 Управление данными ЮЛ [61](#управление-данными-юл)

4.2.3 Управление данными ОГВ [63](#управление-данными-огв)

4.2.4 Управление данными ИС [63](#управление-данными-ис)

4.3 Получение данных [64](#получение-данных)

4.3.1 Особенности получения данных ФЛ
[64](#особенности-получения-данных-фл)

4.3.2 Особенности получения данных ЮЛ
[65](#особенности-получения-данных-юл)

4.3.3 Особенности получения данных ИС
[65](#особенности-получения-данных-ис)

Приложение А. Сервисы ЕСИА на базе подхода REST
[66](#сервисы-есиа-на-базе-подхода-rest)

А.1 Общие сведения о программном интерфейсе ЕСИА
[66](#общие-сведения-о-программном-интерфейсе-есиа)

А.2 Предоставление персональных данных пользователей
[72](#предоставление-персональных-данных-пользователей)

А.3 Проверка факта удаления УЗ и связанных с ней персональных данных
пользователя из ЕСИА
[89](#проверка-факта-удаления-уз-и-связанных-с-ней-персональных-данных-пользователя-из-есиа)

А.4 Предоставление данных из профиля организации
[89](#предоставление-данных-из-профиля-организации)

А.5 Предоставление списка участников организации
[98](#предоставление-списка-участников-организации)

А.6 Предоставление сведений о вхождении пользователя в группы
[101](#предоставление-сведений-о-вхождении-пользователя-в-группы)

А.7 Управление данными организации
[104](#управление-данными-организации)

А.7.1 Изменение данных профиля организации
[105](#изменение-данных-профиля-организации)

А.7.2 Лицензии. Получение от лицензирующих органов в ЕСИА сведений о
выдаче/отзыве/изменениях в лицензиях
[152](#лицензии.-получение-от-лицензирующих-органов-в-есиа-сведений-о-выдачеотзывеизменениях-в-лицензиях)

А.7.3 Финансы. Предоставление сведений о налогах из налоговой
декларации, о наличии (отсутствии) задолженности и фактически уплаченных
налогах, предоставление бухгалтерской отчетности
[178](#финансы.-предоставление-сведений-о-налогах-из-налоговой-декларации-о-наличии-отсутствии-задолженности-и-фактически-уплаченных-налогах-предоставление-бухгалтерской-отчетности)

А.7.4 Реестр МСП. Предоставление сведений из реестра МСП. Просмотр
списка сведений из реестра МСП, запрос/обновление сведений из реестра
МСП
[296](#реестр-мсп.-предоставление-сведений-из-реестра-мсп.-просмотр-списка-сведений-из-реестра-мсп-запрособновление-сведений-из-реестра-мсп)

А.7.5 Управление сведениями о наличии счетов организаций и ИП в банках
[305](#управление-сведениями-о-наличии-счетов-организаций-и-ип-в-банках)

А.7.6 Управление сведениями о наличии действующих решений о
приостановлении операций по счетам налогоплательщика
[315](#управление-сведениями-о-наличии-действующих-решений-о-приостановлении-операций-по-счетам-налогоплательщика)

А.7.7 Управление приглашениями должностным лицам, зарегистрированным в
ЕСИА, на присоединение к УЗ соответствующей организации
[325](#управление-приглашениями-должностным-лицам-зарегистрированным-в-есиа-на-присоединение-к-уз-соответствующей-организации)

А.7.8 Управление служебными данными присоединенных сотрудников, а также
блокировка и удаление должностных лиц организации
[328](#управление-служебными-данными-присоединенных-сотрудников-а-также-блокировка-и-удаление-должностных-лиц-организации)

А.7.9 Управление полномочиями должностных лиц посредством изменения их
членства в группах доступа
[329](#управление-полномочиями-должностных-лиц-посредством-изменения-их-членства-в-группах-доступа)

А.7.10 Управление доступом к непубличным группам
[329](#управление-доступом-к-непубличным-группам)

А.7.11 Добавление и изменение данных филиалов организации
[332](#добавление-и-изменение-данных-филиалов-организации)

А.7.12 Добавление и обновление данных филиала, представительства
иностранных юридических лиц
[333](#добавление-и-обновление-данных-филиала-представительства-иностранных-юридических-лиц)

А.7.13 Присоединение руководителя к филиалу, представительству
иностранных юридических лиц
[338](#присоединение-руководителя-к-филиалу-представительству-иностранных-юридических-лиц)

А.8 Предоставление списка измененных пользователей или организаций за
период времени
[339](#предоставление-списка-измененных-пользователей-или-организаций-за-период-времени)

А.9 Импорт УЗ пользователя [339](#импорт-уз-пользователя)

А.9.1 Модернизированный сервис импорта учетных записей пользователя из
внешних ИС
[370](#модернизированный-сервис-импорта-учетных-записей-пользователя-из-внешних-ис)

А.9.2 Автоматический поиск СНИЛС при регистрации УЗ пользователя методом
импорта
[372](#автоматический-поиск-снилс-при-регистрации-уз-пользователя-методом-импорта)

А.9.3 Операция по восстановлению доступа к подтвержденной УЗ в ЕСИА
через импорт УЗ
[378](#операция-по-восстановлению-доступа-к-подтвержденной-уз-в-есиа-через-импорт-уз)

А.10 Управление изображением (аватаром) в профиле пользователя
[388](#управление-изображением-аватаром-в-профиле-пользователя)

А.10.1 Получение сжатого изображения (аватара) пользователя по OID
[388](#получение-сжатого-изображения-аватара-пользователя-по-oid)

А.10.2 Получение исходного изображения (аватара) пользователя по OID
[389](#получение-исходного-изображения-аватара-пользователя-по-oid)

А.11 Сервис управления внешними ИС ЦО организаций
[390](#сервис-управления-внешними-ис-цо-организаций)

А.11.1 Сервис REST API управления ЦО
[390](#сервис-rest-api-управления-цо)

А.11.2 Сервис REST API безусловного добавления сотрудников в организацию
[399](#_Toc179203169)

А.11.3 Сервис REST API получения списка ЦО организации
[401](#_Toc179203170)

А.11.4 Сервис REST API прикрепления сотрудников к ЦО
[408](#сервис-rest-api-прикрепления-сотрудников-к-цо)

А.12 Сервис получения маркера доступа по идентификационному ключу
[410](#сервис-получения-маркера-доступа-по-идентификационному-ключу)

Приложение Б. Сервисы ЕСИА, основанные на протоколе OAuth2.0 и OpenID
Connect 1.0
[414](#сервисы-есиа-основанные-на-протоколе-oauth2.0-и-openid-connect-1.0)

Б.1 Общие сведения [414](#общие-сведения)

Б.2 Модель контроля на основе делегированного принятия решения
[415](#модель-контроля-на-основе-делегированного-принятия-решения)

Б.2.1 Общие принципы [415](#общие-принципы)

Б.2.2 Получение авторизационного кода (рекомендован к выводу из
эксплуатации и не допускается к использованию при подключении новых
систем-клиентов)
[418](#получение-авторизационного-кода-рекомендован-к-выводу-из-эксплуатации-и-не-допускается-к-использованию-при-подключении-новых-систем-клиентов)

Б.2.3 Получение авторизационного кода (v2/ac)
[422](#получение-авторизационного-кода-v2ac)

Б.2.4 Получение маркера доступа в обмен на авторизационный код
(рекомендован к выводу из эксплуатации и не допускается к использованию
при подключении новых систем-клиентов)
[426](#получение-маркера-доступа-в-обмен-на-авторизационный-код-рекомендован-к-выводу-из-эксплуатации-и-не-допускается-к-использованию-при-подключении-новых-систем-клиентов)

Б.2.5 Получение маркера доступа в обмен на авторизационный код (v3/te)
[428](#получение-маркера-доступа-в-обмен-на-авторизационный-код-v3te)

Б.2.6 Получение нового маркера доступа в обмен на маркер обновления
[432](#получение-нового-маркера-доступа-в-обмен-на-маркер-обновления)

Б.3 Модель контроля доступа на основе полномочий системы-клиента
[433](#модель-контроля-доступа-на-основе-полномочий-системы-клиента)

Б.3.1 Общие принципы [433](#общие-принципы-1)

Б.3.2 Получение маркера доступа [434](#получение-маркера-доступа)

Б.4 Особенности указания области доступа (scope)
[436](#особенности-указания-области-доступа-scope)

Б.5 Сведения о структуре и проверке маркера доступа
[446](#сведения-о-структуре-и-проверке-маркера-доступа)

Б.6 Использование OpenID Connect 1.0 для аутентификации пользователя
[449](#использование-openid-connect-1.0-для-аутентификации-пользователя)

Б.6.1 Общие принципы [449](#общие-принципы-2)

Б.6.2 Получение авторизационного кода
[450](#получение-авторизационного-кода)

Б.6.3 Получение маркера идентификации в обмен на авторизационный код
(рекомендован к выводу из эксплуатации и не допускается к использованию
при подключении новых систем-клиентов)
[456](#получение-маркера-идентификации-в-обмен-на-авторизационный-код-рекомендован-к-выводу-из-эксплуатации-и-не-допускается-к-использованию-при-подключении-новых-систем-клиентов)

Б.6.4 Взаимодействие с API Gateway c использованием «authorization code
flow»
[458](#взаимодействие-с-api-gateway-c-использованием-authorization-code-flow)

Б.6.5 Получение маркера идентификации в обмен на авторизационный код
(v3/te)
[460](#получение-маркера-идентификации-в-обмен-на-авторизационный-код-v3te)

Б.6.6 Проверка маркера идентификации
[462](#проверка-маркера-идентификации)

Б.6.7 Выход из системы (Logout) [463](#выход-из-системы-logout)

Б.7 Сведения о структуре маркера идентификации
[464](#сведения-о-структуре-маркера-идентификации)

Б.8 Удаленная идентификация с использованием биометрической
идентификации
[466](#удаленная-идентификация-с-использованием-биометрической-идентификации)

Б.9 Использование API Gateway для получения маркера доступа
[472](#использование-api-gateway-для-получения-маркера-доступа)

Б.9.1 Общие принципы [472](#общие-принципы-3)

Б.9.2 Взаимодействие с API Gateway с использованием «client credentials
flow»
[472](#взаимодействие-с-api-gateway-с-использованием-client-credentials-flow)

Б.9.3 Взаимодействие с API Gateway с использованием OpenID Connect 1.0
[474](#взаимодействие-с-api-gateway-с-использованием-openid-connect-1.0)

Б.10 Использование механизма делегированной авторизации для получения
маркера доступа
[475](#использование-механизма-делегированной-авторизации-для-получения-маркера-доступа)

Б.11 Общие принципы [475](#общие-принципы-4)

Б.12 Получение и обработка делегированного запроса на аутентификацию
[476](#получение-и-обработка-делегированного-запроса-на-аутентификацию)

Приложение В. Виды сведений СМЭВ для работы с учетной записью и данными
профиля пользователя ЕСИА
[477](#виды-сведений-смэв-для-работы-с-учетной-записью-и-данными-профиля-пользователя-есиа)

В.1 Рекомендации по взаимодействию с видами сведений в СМЭВ 3.X
[478](#рекомендации-по-взаимодействию-с-видами-сведений-в-смэв-3.x)

Приложение Г. Нерекомендуемые к дальнейшему использованию функциональные
возможности ЕСИА
[480](#нерекомендуемые-к-дальнейшему-использованию-функциональные-возможности-есиа)

Г.1 Общие сведения [480](#общие-сведения-1)

Г.2 Устаревшие утверждения SAML [480](#устаревшие-утверждения-saml)

Г.3 Устаревшие параметры сервиса регистрации
[481](#устаревшие-параметры-сервиса-регистрации)

Г.4 Устаревшие области доступа (scope)
[481](#устаревшие-области-доступа-scope)

Г.5 Устаревший импорт УЗ [482](#устаревший-импорт-уз)

Г.6 Устаревший сервис получения кода авторизации
[503](#устаревший-сервис-получения-кода-авторизации)

Г.7 Устаревший сервис получения маркера доступа
[504](#устаревший-сервис-получения-маркера-доступа)

Приложение Д. Требования по безопасности сервисов ЕСИА, основанных
на протоколах Oauth2.0 и OpenId Connect 1.0
[505](#требования-по-безопасности-сервисов-есиа-основанных-на-протоколах-oauth2.0-и-openid-connect-1.0)

Д.1 Требования к безопасности серверной части ИС
[505](#требования-к-безопасности-серверной-части-ис)

Д.1.1 Выбор типового решения [505](#выбор-типового-решения)

Д.1.2 Требования к реализации собственного решения
[505](#требования-к-реализации-собственного-решения)

Д.1.3 Требования по безопасности собственного решения
[507](#требования-по-безопасности-собственного-решения)

Д.1.4 Требования к применению типового решения
[508](#требования-к-применению-типового-решения)

Д.1.5 Общая безопасность ИС [508](#общая-безопасность-ис)

Д.1.6 Требования по защите каналов при подключении пользователей к ИС
Участников взаимодействия, а также пользователей к ЕСИА
[510](#требования-по-защите-каналов-при-подключении-пользователей-к-ис-участников-взаимодействия-а-также-пользователей-к-есиа)

**Таблица изменений**

+------+-------+--------------+---------------------------------------+
| **   | **Д   | **Автор**    | **Изменение**                         |
| Верс | ата** |              |                                       |
| ия** |       |              |                                       |
+======+=======+==============+=======================================+
| 1.0  | --    | --           | Документ создан                       |
+------+-------+--------------+---------------------------------------+
| 2.0  | --    | --           | Создана новая версия документа в      |
|      |       |              | рамках развития ЕСИА в 2013 г.        |
+------+-------+--------------+---------------------------------------+
| 2.1  | --    | --           | Внесены исправления в документ:       |
|      |       |              |                                       |
|      |       |              | -   уточнено описание процедуры       |
|      |       |              |     подписания запроса                |
|      |       |              |                                       |
|      |       |              | > при аутентификации с помощью        |
|      |       |              | > протокола SAML;                     |
|      |       |              |                                       |
|      |       |              | -   уточнено описание перечня         |
|      |       |              |     SAML-атрибутов;                   |
|      |       |              |                                       |
|      |       |              | -   уточнено описание электронного    |
|      |       |              |     сервиса по регистрации            |
|      |       |              |     пользователей ЕСИА,               |
|      |       |              |     опубликованного в СМЭВ (добавлено |
|      |       |              |     описание процедуры получения      |
|      |       |              |     доступа к сервису, добавлены      |
|      |       |              |     идентификаторы сервиса ЕСИА       |
|      |       |              |     в СМЭВ, уточнено описание метода  |
|      |       |              |     восстановления доступа);          |
|      |       |              |                                       |
|      |       |              | -   уточнено описание областей        |
|      |       |              |     доступа (scope), используемых     |
|      |       |              |     программными интерфейсами         |
|      |       |              |     на основе REST                    |
+------+-------+--------------+---------------------------------------+
| 2.2  | --    | --           | Исключено приложение с описанием      |
|      |       |              | электронных сервисов ЕСИА для работы  |
|      |       |              | с должностными лицами ОГВ;            |
|      |       |              | Произведена перенумерация остальных   |
|      |       |              | приложений; Внесены уточнения и       |
|      |       |              | детализации в технические описания во |
|      |       |              | всех приложениях                      |
+------+-------+--------------+---------------------------------------+
| 2.3  | --    | --           | Детализация описания механизма        |
|      |       |              | аутентификации с использованием       |
|      |       |              | OpenID Connect 1.0                    |
+------+-------+--------------+---------------------------------------+
| 2.4  | --    | --           | Добавлено описание программного       |
|      |       |              | интерфейса на основе REST по          |
|      |       |              | получению данных о филиалах и ОГВ;    |
|      |       |              |                                       |
|      |       |              | Уточнено описание программного        |
|      |       |              | интерфейса на основе REST по          |
|      |       |              | получению данных о системных группах; |
|      |       |              |                                       |
|      |       |              | Изменено обозначение типов УЗ;        |
|      |       |              |                                       |
|      |       |              | Добавлены ссылки на Технологический   |
|      |       |              | портал ЕСИА;                          |
|      |       |              |                                       |
|      |       |              | Уточнено описание redirect_uri при    |
|      |       |              | использовании сервиса авторизации     |
|      |       |              | ЕСИА на основе Oauth 2.0;             |
|      |       |              |                                       |
|      |       |              | Уточнено описание сервиса получения   |
|      |       |              | данных о субъекте (Приложение А.7);   |
|      |       |              |                                       |
|      |       |              | Уточнен формат адреса, используемый в |
|      |       |              | REST-сервисе ЕСИА                     |
+------+-------+--------------+---------------------------------------+
| 2    | --    | --           | Уточнен формат запроса на получение   |
| .4.1 |       |              | маркера доступа при реализации модели |
|      |       |              | контроля доступа на основе полномочий |
|      |       |              | системы-клиента;                      |
|      |       |              |                                       |
|      |       |              | Уточнен процесс завершения активной   |
|      |       |              | сессии пользователя при использовании |
|      |       |              | протокола SAML                        |
+------+-------+--------------+---------------------------------------+
| 2.5  | --    | --           | Добавлено описание:                   |
|      |       |              |                                       |
|      |       |              | -   новых типов документов физических |
|      |       |              |     лиц, получаемых через REST API    |
|      |       |              |     ЕСИА;                             |
|      |       |              |                                       |
|      |       |              | -   данных о детях, получаемых через  |
|      |       |              |     REST API ЕСИА;                    |
|      |       |              |                                       |
|      |       |              | -   новых возможностей по             |
|      |       |              |     использованию аутентификации с    |
|      |       |              |     использованием OpenID Connect 1.0 |
|      |       |              |     (проверка аутентификации в        |
|      |       |              |     фоновом режиме и открытие         |
|      |       |              |     страницы аутентификации           |
|      |       |              |     в всплывающем окне);              |
|      |       |              |                                       |
|      |       |              | -   возможностей по управлению        |
|      |       |              |     данными организации;              |
|      |       |              |                                       |
|      |       |              | -   новых разрешений на доступ к      |
|      |       |              |     данным (scope);                   |
|      |       |              |                                       |
|      |       |              | -   возможности возврата пользователя |
|      |       |              |     в систему, направившую            |
|      |       |              |     пользователя в ЕСИА               |
|      |       |              |     для выполнения операций           |
+------+-------+--------------+---------------------------------------+
| 2.6  | --    | --           | Добавлено описание сервиса «Единый    |
|      |       |              | сервис упрощенной идентификации       |
|      |       |              | пользователей Единой системы          |
|      |       |              | идентификации и аутентификации»       |
+------+-------+--------------+---------------------------------------+
| 2.7  | --    | --           | Добавлено описание использования      |
|      |       |              | разрешения (scope) для передачи       |
|      |       |              | сведений о детях                      |
+------+-------+--------------+---------------------------------------+
| 2.8  | --    | --           | Добавлено описание использования      |
|      |       |              | разрешения (scope) «openid» для       |
|      |       |              | интеграции информационных систем      |
+------+-------+--------------+---------------------------------------+
| 2.9  | --    | --           | Добавлен в Таблицу 11 «Состав набора  |
|      |       |              | данных» пункт -- место рождения, при  |
|      |       |              | вызове scope id_doc                   |
|      |       |              | и foreign_passport_doc                |
+------+-------+--------------+---------------------------------------+
| 2.10 | --    | --           | Из Таблицы 11 исключен пункт «место   |
|      |       |              | рождения»;                            |
|      |       |              |                                       |
|      |       |              | Добавлено описание сервиса УПРИД;     |
|      |       |              |                                       |
|      |       |              | Уточнена информация по сервису        |
|      |       |              | регистрации;                          |
|      |       |              |                                       |
|      |       |              | Добавлен раздел Б.9 Предоставление    |
|      |       |              | списка измененных пользователей или   |
|      |       |              | организаций за период времени;        |
|      |       |              |                                       |
|      |       |              | В таблицу 6 добавлены параметры       |
|      |       |              | ответа на запрос о персональных       |
|      |       |              | данных пользователя: verifying и      |
|      |       |              | status                                |
+------+-------+--------------+---------------------------------------+
| 2.11 | --    | --           | К Таблице 11 в примечание добавлено   |
|      |       |              | описание scope, позволяющих получить  |
|      |       |              | гражданство пользователя              |
+------+-------+--------------+---------------------------------------+
| 2.12 | --    | --           | Уточнено описание структуры маркера   |
|      |       |              | идентификации (Приложение Б.7)        |
+------+-------+--------------+---------------------------------------+
| 2.13 | --    | --           | В Таблицу 11 добавлен scope           |
|      |       |              | «birthplace»                          |
+------+-------+--------------+---------------------------------------+
| 2.14 | --    | --           | В Таблице 10 исправлены коды ошибок   |
+------+-------+--------------+---------------------------------------+
| 2.15 | --    | --           | В Таблицу 11 добавлен scope usr_org   |
+------+-------+--------------+---------------------------------------+
| 2.16 | --    | --           | Добавлено описание полей «district» и |
|      |       |              | «settlement» для атрибута             |
|      |       |              | orgAddresses (Таблица 5)              |
+------+-------+--------------+---------------------------------------+
| 2.17 | 17.01 | Пригарина    | В Таблицу 10 добавлен новый код       |
|      | .2017 | Д.А.         | ошибки при отсутствии разрешения на   |
|      |       |              | доступ к указанному scope;            |
|      |       |              |                                       |
|      |       |              | В таблицу 6 добавлены параметры       |
|      |       |              | ответа на запрос о контактах          |
|      |       |              | пользователя: vrfValStu и             |
|      |       |              | verifyingValue                        |
+------+-------+--------------+---------------------------------------+
| 2.18 | 31.01 | Пригарина    | Добавлен раздел с описанием метода    |
|      | .2017 | Д.А.         | импорта УЗ пользователя (Приложение   |
|      |       |              | А.9)                                  |
+------+-------+--------------+---------------------------------------+
| 2.19 | 08.02 | Маслова Г.В. | В таблице 6 изменен параметр fiasCode |
|      | .2017 |              | ответа на запрос\                     |
|      |       |              | о сведениях об отдельной записи в     |
|      |       |              | перечне адресов физического лица      |
+------+-------+--------------+---------------------------------------+
| 2.20 | 09.03 | Пригарина    | Обновлен алгоритм импорта УЗ, пример  |
|      | .2017 | Д.А.         | ответа на запрос, обязательность      |
|      |       |              | полей адреса (Приложение А.9)         |
+------+-------+--------------+---------------------------------------+
| 2.21 | 10.04 | Пригарина    | Добавлено описание получения          |
|      | .2017 | Д.А.         | информации для scope usr_org          |
|      |       |              | (Приложение Б.4).                     |
|      |       |              |                                       |
|      |       |              | В Приложени А.9 добавлено описание    |
|      |       |              | заголовков запроса (Request--Data,    |
|      |       |              | Request--Data Sign). Обновлено        |
|      |       |              | описание параметров series и number   |
|      |       |              | для документа, удостоверяющего        |
|      |       |              | личность                              |
+------+-------+--------------+---------------------------------------+
| 2.22 | 02.05 | Горбунова    | В Приложение Б.4 в перечень scope     |
|      | .2017 | О.Е.         | добавлен scope usr_avt.               |
|      |       |              |                                       |
|      |       |              | Добавлено описание получения          |
|      |       |              | информации для scope usr_avt          |
|      |       |              | (Приложение А.9.1)                    |
+------+-------+--------------+---------------------------------------+
| 2.23 | 04.05 | Пригарина    | Добавлено описание ошибок для         |
|      | .2017 | Д.А.         | параметра errorStatusInfo (Приложение |
|      |       |              | А.9)                                  |
|      |       |              |                                       |
|      |       |              | Обновлено описание ответа для         |
|      |       |              | запроса:                              |
|      |       |              | <https://e                            |
|      |       |              | sia-portal1.test.gosuslugi.ru/rs/orgs |
|      |       |              | /100000/emps?embed=(elements.person)> |
|      |       |              | (Приложение А.1)                      |
+------+-------+--------------+---------------------------------------+
| 2.24 | 20.06 | Маслова Г.В. | Обновлен пример запроса (вызов        |
|      | .2017 |              | сервиса в среде разработки) в         |
|      |       |              | Приложении Б.11 (добавлен параметр    |
|      |       |              | «birthplace»                          |
+------+-------+--------------+---------------------------------------+
| 2.25 | 03.07 | Пригарина    | В разделе 3.1.1 добавлена информация  |
|      | .2017 | Д.А.         | о прекращении поддержки SAML 2.0 в    |
|      |       |              | ЕСИА;                                 |
|      |       |              |                                       |
|      |       |              | В разделах А.2, Б.2.2, Б.4, Б.5       |
|      |       |              | обновлены примеры, касающиеся scope   |
|      |       |              | id_doc;                               |
|      |       |              |                                       |
|      |       |              | В разделах Б.6.2.2, Б.6.2.3 обновлены |
|      |       |              | примеры запросов                      |
+------+-------+--------------+---------------------------------------+
| 2.26 | 18.07 | Маслова Г.В. | Добавлена Таблица 10 с кодами ошибок  |
|      | .2017 |              | от сервиса импорта;                   |
|      |       |              |                                       |
|      |       |              | Для параметров запроса импорта        |
|      |       |              | актуализированы форматы данных и      |
|      |       |              | значение обязательности для отправки  |
|      |       |              | в запросе;                            |
|      |       |              |                                       |
|      |       |              | В Приложениях Б.8, B 3.2, B.4 удалена |
|      |       |              | информация о scope sbj_inf;           |
|      |       |              |                                       |
|      |       |              | Добавлено приложение Д.4 по           |
|      |       |              | устаревшим scope ЕСИА                 |
+------+-------+--------------+---------------------------------------+
| 2.27 | 17.08 | Пригарина    | Обновлена обязательность следующих    |
|      | .2017 | Д.А.         | полей запроса метода импорта (А.9):   |
|      |       |              | birthplace, series, number, issuedBy  |
+------+-------+--------------+---------------------------------------+
| 2.28 | 29.08 | Пригарина    | В описании метода импорта (А.9)       |
|      | .2017 | Д.А.         | добавлен новый тип документа --       |
|      |       |              | FRGN_PASS (заграничный паспорт        |
|      |       |              | гражданина РФ), обновлено описание    |
|      |       |              | параметров запроса для документа,     |
|      |       |              | удостоверяющего личность;             |
|      |       |              |                                       |
|      |       |              | В Таблице 74 для параметра            |
|      |       |              | flowDetails в поле name добавлено     |
|      |       |              | новое значение --                     |
|      |       |              | raRegistrationEndorsement             |
|      |       |              | (подтверждение регистрации            |
|      |       |              | пользователем по СМС)                 |
+------+-------+--------------+---------------------------------------+
| 2.29 | 08.11 | Пригарина    | Обновлена обязательность поля         |
|      | .2017 | Д.А.         | middleName запроса метода импорта     |
|      |       |              | (А.9)                                 |
+------+-------+--------------+---------------------------------------+
| 2.30 | 19.12 | Маслова Г.В. | Обновлена обязательность поля         |
|      | .2017 |              | middleName запроса метода импорта     |
|      |       |              | (А.9)                                 |
+------+-------+--------------+---------------------------------------+
| 2.31 | 26.12 | Жукова Д.А.  | Добавлены новые параметры в ответе на |
|      | .2017 |              | запрос при получении данных           |
|      |       |              | организации (rs/orgs, А.4);           |
|      |       |              |                                       |
|      |       |              | Добавлены новые параметры при ответе  |
|      |       |              | на запрос при получении списка        |
|      |       |              | организации пользователя              |
|      |       |              | (rs/prns/{prn_oid}/roles, Б.4)        |
+------+-------+--------------+---------------------------------------+
| 2.32 | 30.01 | Маслова Г.В. | Внесены уточнения в таблицу 14        |
|      | .2018 |              |                                       |
+------+-------+--------------+---------------------------------------+
| 2.33 | 02.02 | Маслова Г.В. | Внесены изменения в раздел 3.5        |
|      | .2018 |              | «Возврат пользователя в систему,      |
|      |       |              | вызвавшую профиль пользователя\       |
|      |       |              | в ЕСИА или регистрацию пользователя в |
|      |       |              | ЕСИА»                                 |
+------+-------+--------------+---------------------------------------+
| 2.34 | 09.02 | Маслова Г.В. | Исправлены опечатки                   |
|      | .2018 |              |                                       |
+------+-------+--------------+---------------------------------------+
| 2.35 | 01.03 | Цирихов А.М. | Внесены изменения в Приложение Б.9    |
|      | .2018 |              | Импорт УЗ пользователя:               |
|      |       |              |                                       |
|      |       |              | -   в таблице с описанием параметров  |
|      |       |              |     запроса: обязательность параметра |
|      |       |              |     документа issuedBy --             |
|      |       |              |     наименование подразделения,       |
|      |       |              |     выдавшего паспорт -- указана как  |
|      |       |              |     Y/N (обязателен только для        |
|      |       |              |     паспорта гражданина РФ);          |
|      |       |              |                                       |
|      |       |              | -   в примере запроса импорта УЗ      |
|      |       |              |     скорректировано содержимое        |
|      |       |              |     элемента addresses;               |
|      |       |              |                                       |
|      |       |              | -   скорректированы примеры ответов   |
|      |       |              |     на запрос импорта УЗ;             |
|      |       |              |                                       |
|      |       |              | -   Таблица 10 -- Коды и описание     |
|      |       |              |     ошибок от сервиса импорта:        |
|      |       |              |     добавлены коды ESIA-030007,       |
|      |       |              |     ESIA-032205, ESIA-039812,         |
|      |       |              |     ESIA-039815, и их описания;       |
|      |       |              |                                       |
|      |       |              | -   Таблица 11 -- Параметры ответа на |
|      |       |              |     запрос о статусе проверки данных  |
|      |       |              |     пользователя: в описание добавлен |
|      |       |              |     параметр personOid --             |
|      |       |              |     идентификатор зарегистрированной  |
|      |       |              |     учетной записи;                   |
|      |       |              |                                       |
|      |       |              | -   Таблица 11 -- Параметры ответа на |
|      |       |              |     запрос о статусе проверки данных  |
|      |       |              |     пользователя: в перечень          |
|      |       |              |     возможных значений атрибута name  |
|      |       |              |     параметра flowDetails добавлено   |
|      |       |              |     значение «C» -- операция          |
|      |       |              |     отменена;                         |
|      |       |              |                                       |
|      |       |              | -   Скорретирован основной и          |
|      |       |              |     добавлены дополнительные примеры  |
|      |       |              |     ответов на запрос о статусе       |
|      |       |              |     выполнения заявки                 |
+------+-------+--------------+---------------------------------------+
| 2.36 | 07.03 | Жукова Д.А.  | Добавлен раздел «Удаленная            |
|      | .2018 |              | идентификация с использованием        |
|      |       |              | биометрической идентификации»         |
|      |       |              | (Приложение Б.8)                      |
+------+-------+--------------+---------------------------------------+
| 2.37 | 12.03 | Маслова Г.В. | Исправлены опечатки                   |
|      | .2018 |              |                                       |
+------+-------+--------------+---------------------------------------+
| 2.37 | 13.03 | Цирихов А.М. | Выполнены доработки и внесены         |
|      | .2018 |              | изменения в Приложение Б.9 Импорт УЗ  |
|      |       |              | пользователя:                         |
|      |       |              |                                       |
|      |       |              | -   обновлена схема, представленная   |
|      |       |              |     на рисунке 14 -- Алгоритм импорта |
|      |       |              |     УЗ в ЕСИА;                        |
|      |       |              |                                       |
|      |       |              | -   скорректирована таблица с         |
|      |       |              |     параметрами ответа                |
|      |       |              |                                       |
|      |       |              | > на запрос импорта УЗ в ЕСИА:        |
|      |       |              |                                       |
|      |       |              | -   в примечаниях добавлено описание  |
|      |       |              |     возможных значений возращаемого   |
|      |       |              |     параметра code (Код завершения    |
|      |       |              |     операции);                        |
|      |       |              |                                       |
|      |       |              | -   в примечаниях добавлено описание  |
|      |       |              |     назначения возращаемого параметра |
|      |       |              |     description (Текстовое описание   |
|      |       |              |     кода завершения операции);        |
|      |       |              |                                       |
|      |       |              | -   в примечаниях добавлено описание  |
|      |       |              |     назначения возращаемого параметра |
|      |       |              |     message (Текстовое описание кода  |
|      |       |              |     ошибки выполнения операции);      |
|      |       |              |                                       |
|      |       |              | -   Таблица 10 -- Коды и описание     |
|      |       |              |     ошибок от сервиса импорта:        |
|      |       |              |                                       |
|      |       |              | -   скорректировано содержимое        |
|      |       |              |     столбца с описанием кодов         |
|      |       |              |     возврата для некоторых кодов      |
|      |       |              |     ошибок;                           |
|      |       |              |                                       |
|      |       |              | -   добавлен код ошибки ESIA-910307 и |
|      |       |              |     его описание                      |
+------+-------+--------------+---------------------------------------+
| 2.38 | 10.04 | Цирихов А.М. | Выполнены доработки и внесены         |
|      | .2018 |              | изменения в Приложение Б.9 Импорт УЗ  |
|      |       |              | пользователя:                         |
|      |       |              |                                       |
|      |       |              | -   Таблица 11 -- Параметры ответа на |
|      |       |              |     запрос о статусе проверки данных  |
|      |       |              |     пользователя: перечень возможных  |
|      |       |              |     значений атрибута name параметра  |
|      |       |              |     flowDetails разделен на две       |
|      |       |              |     возвращаемые группы:              |
|      |       |              |                                       |
|      |       |              | -   задачи и статусы из выполнения до |
|      |       |              |     момента завершения проверки       |
|      |       |              |     СНИЛС;                            |
|      |       |              |                                       |
|      |       |              | -   задачи и статусы их выполнения    |
|      |       |              |     после успешного завершения        |
|      |       |              |     проверки СНИЛС и создания         |
|      |       |              |     упрощенной УЗ;                    |
|      |       |              |                                       |
|      |       |              | -   скорректированы примеры ответов   |
|      |       |              |     на запрос о статусе выполнения    |
|      |       |              |     заявки -- в соответствие          |
|      |       |              |     с разделением статусов на две     |
|      |       |              |     возвращаемые группы (до и после   |
|      |       |              |     проверки СНИЛС)                   |
+------+-------+--------------+---------------------------------------+
| 2.39 | 28.04 | Маслова Г.В. | Внесены изменения в Приложение Б.1    |
|      | .2018 |              | Общие сведения\                       |
|      |       |              | о программном интерфейсе ЕСИА         |
+------+-------+--------------+---------------------------------------+
| 2.40 | 29.06 | Жукова Д.А.  | Обновлено описание информации о       |
|      | .2018 |              | получении аватара пользователя        |
|      |       |              | (Приложение А.9.1).                   |
|      |       |              |                                       |
|      |       |              | Дополнен раздел об удаленной          |
|      |       |              | идентификации с использованием        |
|      |       |              | биометрической идентификации          |
|      |       |              | примерами получаемых маркеров доступа |
|      |       |              | (Приложение Б.8) и общей схемой       |
|      |       |              | взаимодействия участников             |
+------+-------+--------------+---------------------------------------+
| 2.41 | 04.07 | Жукова Д.А.  | Добавлено описание нового scope --    |
|      | .2018 |              | «ext_auth_result» (Приложение Б.4);   |
|      |       |              |                                       |
|      |       |              | Обновлена информация о структуре      |
|      |       |              | маркера доступа, выдаваемого ЕСИА, в  |
|      |       |              | частности об алгоритме шифрования     |
|      |       |              | (Приложение Б.5)                      |
+------+-------+--------------+---------------------------------------+
| 2.42 | 17.07 | Жукова Д.А.  | Добавлены новые типы свидетельства о  |
|      | .2018 |              | рождении и новый параметр (номер      |
|      |       |              | актовой записи) при получении         |
|      |       |              | информации о документах пользователя  |
|      |       |              | и о документах детей пользователя.    |
|      |       |              | (Приложение А.2)                      |
+------+-------+--------------+---------------------------------------+
| 2.43 | 30.07 | Жукова Д.А.  | Добавлена информация о необходимости  |
|      | .2018 |              | наличия подтвержденного мобильного    |
|      |       |              | телефона в профиле пользователя при   |
|      |       |              | изменении основных данных             |
|      |       |              | в стандартной и подтвержденной УЗ (п. |
|      |       |              | 4.2.1)                                |
+------+-------+--------------+---------------------------------------+
| 2.44 | 26.09 | Жукова Д.А.  | Обновлена информация о завершении     |
|      | .2018 |              | удаленной идентификации пользователя  |
|      |       |              | (получение пользовательского маркера  |
|      |       |              | доступа) (Приложение Б.8,\            |
|      |       |              | п. 2);                                |
|      |       |              |                                       |
|      |       |              | Добавлен новый код ошибки в Таблицу   |
|      |       |              | 73 -- ESIA-032110 (Приложение А.9);   |
|      |       |              |                                       |
|      |       |              | Добавлена информация о завершении     |
|      |       |              | сессии ЕСИА                           |
|      |       |              |                                       |
|      |       |              | при закрытии браузера (п. 3.2.1, п.   |
|      |       |              | 3.2);                                 |
|      |       |              |                                       |
|      |       |              | Добавлена информация о возможности    |
|      |       |              | обмена авторизационного кода на один  |
|      |       |              | маркер доступа (Приложения Б.2.3 и    |
|      |       |              | Б.6.3)                                |
+------+-------+--------------+---------------------------------------+
| 2.45 | 5.10  | Жукова Д.А.  | Добавлена информация о настройке      |
|      | .2018 |              | сроков жизни маркера доступа и        |
|      |       |              | маркера обновления (Приложение А.1);  |
|      |       |              |                                       |
|      |       |              | Добавлена информация о дополнительных |
|      |       |              | возможных кодах ошибок при получении  |
|      |       |              | маркера доступа в обмен\              |
|      |       |              | на маркер обновления (Приложение      |
|      |       |              | Б.2.5)                                |
+------+-------+--------------+---------------------------------------+
| 2.45 | 22.10 | Цирихов А.М. | Приложение В.7 -- в подраздел         |
|      | .2018 |              | Сведения о структуре маркера          |
|      |       |              | идентификации: добавлено описание     |
|      |       |              | возможных типов субъекта              |
|      |       |              | («urn:esia:sbj:typ»);                 |
|      |       |              |                                       |
|      |       |              | Приложение В.8 -- Удаленная           |
|      |       |              | идентификация с использованием        |
|      |       |              | биометрической идентификации:         |
|      |       |              | в подразделе «2. Завершение удаленной |
|      |       |              | идентификации пользователя, получение |
|      |       |              | пользовательского маркера доступа»    |
|      |       |              | скорректирован пример состава         |
|      |       |              | расширенного маркера доступа          |
|      |       |              | (PAYLOAD-часть)                       |
+------+-------+--------------+---------------------------------------+
| 2.46 | 26.11 | Маслова Г.В. | В Приложени Б.2 REST API              |
|      | .2018 |              | /prns/{oid}/ctts/{ctt_id} удалена     |
|      |       |              | информация о служебной электронной    |
|      |       |              | почте                                 |
+------+-------+--------------+---------------------------------------+
| 2.47 | 27.11 | Мезин Д.А.   | В таблице 10 скорректировано описание |
|      | .2018 |              | кодов возврата для кодов ошибок:      |
|      |       |              |                                       |
|      |       |              | -   ESIA-032205;                      |
|      |       |              |                                       |
|      |       |              | -   ESIA-039815                       |
+------+-------+--------------+---------------------------------------+
| 2.48 | 06.12 | Маслова Г.В. | Добавлена информация о поддержке ГОСТ |
|      | .2018 |              | Р 34.10-2012                          |
+------+-------+--------------+---------------------------------------+
| 2.49 | 18.12 | Мезин Д.А.   | В таблице 10 скорректировано описание |
|      | .2018 |              | кода возврата                         |
|      |       |              |                                       |
|      |       |              | для кода ошибки: ESIA-032205          |
+------+-------+--------------+---------------------------------------+
| 2.50 | 21.12 | Мезин Д.А.   | В таблице 10 удалена информация о     |
|      | .2018 |              | коде ошибки: ESIA-039815              |
+------+-------+--------------+---------------------------------------+
| 2.51 | 26.12 | Маслова Г.В. | В Приложени В.5 скорректированы       |
|      | .2018 |              | сведения о структуре                  |
|      |       |              |                                       |
|      |       |              | и проверке маркера доступа: добавлено |
|      |       |              | описание информации о наличии         |
|      |       |              | делегирования полномочий              |
+------+-------+--------------+---------------------------------------+
| 2.51 | 26.12 | Мезин Д.А.   | Добавлено описание областей доступа   |
|      | .2018 |              | (scopes): gosbar и gosbar_org         |
|      |       |              | (Приложение Б.4)                      |
+------+-------+--------------+---------------------------------------+
| 2.51 | 28.12 | Цирихов А.М. | В Приложени А.5 Описание метаданных   |
|      | .2018 |              | поставщика услуг в таблице 5          |
|      |       |              | расширено описание атрибута           |
|      |       |              | principalDocuments в части типов      |
|      |       |              | документа «Свидетельство о рождении»; |
|      |       |              |                                       |
|      |       |              | В Приложения А.2 и А.4 (сервисы ЕСИА  |
|      |       |              | на базе подхода REST, предоставление  |
|      |       |              | персональных данных пользователей и   |
|      |       |              | предоставление данных из профиля      |
|      |       |              | организации) добавлено описание       |
|      |       |              | методов REST API ЕСИА для получения   |
|      |       |              | данных о транспортных средствах       |
|      |       |              | пользователей и организаций в         |
|      |       |              | соответствии;                         |
|      |       |              |                                       |
|      |       |              | с выполненными доработками (параметры |
|      |       |              | пагинации, общее количество           |
|      |       |              | транспортных средств, полная          |
|      |       |              | информация о транспортном средстве)   |
+------+-------+--------------+---------------------------------------+
| 2.52 | 11.01 | Жукова Д.А.  | -   Обновлено описание метода импорта |
|      | .2019 |              |     УЗ пользователя:                  |
|      |       |              |                                       |
|      |       |              | -   Текущее описание перенесено в     |
|      |       |              |     Приложение Г.5;                   |
|      |       |              |                                       |
|      |       |              | -   как устаревшее. Добавлен новый    |
|      |       |              |     код ошибки ESIA-039600;           |
|      |       |              |                                       |
|      |       |              | -   Приложение А.9 было обновлено:    |
|      |       |              |     добавлена информация об адресе    |
|      |       |              |     новой версии метода импорта,      |
|      |       |              |     новых кодах ошибок (ESIA-039601,  |
|      |       |              |     ESIA-039602, ESIA-039603,         |
|      |       |              |     ESIA-039815), новой функции       |
|      |       |              |     подтверждения упрощенных УЗ.      |
|      |       |              |     Обновлен алгоритм работы метода   |
|      |       |              |     импорта                           |
+------+-------+--------------+---------------------------------------+
| 2.53 | 18.01 | Маслова Г.В. | В таблице 96 в состав набора данных   |
|      | .2019 |              | для scope «id_doc»\                   |
|      |       |              | и «foreign_passport_doc» добавлено    |
|      |       |              | значение «гражданство».               |
|      |       |              |                                       |
|      |       |              | В разделе А.9 добавлен код ошибки     |
|      |       |              | ESIA-035116                           |
+------+-------+--------------+---------------------------------------+
| 2.54 | 30.01 | Мезин Д.А    | В разделе А.9 добавлен код ошибки     |
|      | .2019 |              | ESIA-039805, скорректировано описание |
|      |       |              | кода возврата для кода ошибки         |
|      |       |              | ESIA-035116                           |
+------+-------+--------------+---------------------------------------+
| 2.54 | 13.02 | Цирихов А.М. | Приложение В.7 -- в подразделе        |
|      | .2019 |              | «Сведения о структуре маркера         |
|      |       |              | идентификации» скорректировано        |
|      |       |              | описание возможных типов субъекта     |
|      |       |              | («urn:esia:sbj:typ»): «P» --          |
|      |       |              | физическое лицо                       |
+------+-------+--------------+---------------------------------------+
| 2.55 | 13.03 | Цирихов А.М. | Приложение В.8 «Удаленная             |
|      | .2019 |              | идентификация с использованием        |
|      |       |              | биометрической идентификации» --      |
|      |       |              | добавлена ссылка на раздел документа  |
|      |       |              | «Методические рекомендации по работе  |
|      |       |              | с Единой биометрической системой»,    |
|      |       |              | описывающий интеграцию внешних систем |
|      |       |              |                                       |
|      |       |              | с Единой биометрической системой, в   |
|      |       |              | том числе содержащий указания по      |
|      |       |              | использованию защищенных сетей        |
|      |       |              | передачи данных при использовании     |
|      |       |              | методов REST API Биометрической       |
|      |       |              | верификации.                          |
|      |       |              |                                       |
|      |       |              | Исправлено описание формата параметра |
|      |       |              | «irthdate» (Таблица 3)                |
+------+-------+--------------+---------------------------------------+
| 2.56 | 11.04 | Мезин Д.А.   | В таблицу 10 добавлен код ошибки      |
|      | .2019 |              | ESIA-039810                           |
+------+-------+--------------+---------------------------------------+
| 2.57 | 26.04 | Жукова Д.А.  | Указание информации о scope «bio» в   |
|      | .2019 |              | Приложениях Б.4\                      |
|      |       |              | и Б.8                                 |
+------+-------+--------------+---------------------------------------+
| 2.58 | 05.06 | Мезин Д.А    | В Приложение Г Добавлен новый раздел  |
|      | .2019 |              | Г.9.5 Рекомендации по взаимодействию  |
|      |       |              | с видами сведений в СМЭВ 3.X          |
+------+-------+--------------+---------------------------------------+
| 2.59 | 11.06 | Цирихов А.М. | В документ добавлено Приложение Б.11  |
|      | .2019 |              | «Сервис управления внешними ИС        |
|      |       |              | центрами обслуживания организаций»В   |
|      |       |              | подразделы 3.1.1 и 3.1.2 добавлена    |
|      |       |              | информация и ссылка на сертификаты    |
|      |       |              | тестовой и продуктивной сред ЕСИА,    |
|      |       |              | используемые для формирования         |
|      |       |              | электронных подписей ответов как      |
|      |       |              | поставщика                            |
+------+-------+--------------+---------------------------------------+
| 2.60 | 16.07 | Мезин Д.А    | В пункте Б.11 скорректировано         |
|      | .2019 |              | описание сервиса REST API             |
+------+-------+--------------+---------------------------------------+
| 2.61 | 07.08 | Мезин Д.А    | В Приложении Б Обновлен формат        |
|      | .2019 |              | fiasCode                              |
+------+-------+--------------+---------------------------------------+
| 2.61 | 08.10 | Цирихов А.М. | Исключено указание на возможность     |
|      | .2019 |              | использования ИС самоподписанных      |
|      |       |              | сертификатов электронных подписей.    |
|      |       |              |                                       |
|      |       |              | Исключено указание на возможность     |
|      |       |              | использования сертификатов            |
|      |       |              | электронных подписей, выпущенных\     |
|      |       |              | с использованием криптографических    |
|      |       |              | алгоритмов, отличных от ГОСТ Р        |
|      |       |              | 34.10-2012 и ГОСТ Р 34.11-2012 (кроме |
|      |       |              | раздела 3.1.1 Аутентификация          |
|      |       |              | с использование стандарта SAML и      |
|      |       |              | приложения А. Использование ЕСИА\     |
|      |       |              | в целях идентификации                 |
|      |       |              | и аутентификации посредством          |
|      |       |              | стандарта SAML 2.0)                   |
+------+-------+--------------+---------------------------------------+
| 2.62 | 23.10 | Мезин Д.А    | В Приложени В.3.2 скорректировано     |
|      | .2019 |              | описание получения маркера доступа    |
+------+-------+--------------+---------------------------------------+
| 2.63 | 02.12 | Мезин Д.А    | В Приложении В.3.1.1 и В.3.1.2        |
|      | .2019 |              | скорректировано описание              |
+------+-------+--------------+---------------------------------------+
| 2.64 | 24.12 | Мезин Д.А    | В Приложении Б.11.3 актуализирован    |
|      | .2019 |              | пример ответа метода сервиса REST API |
|      |       |              | получения списка ЦО организации       |
+------+-------+--------------+---------------------------------------+
| 2.65 | 26.12 | Мезин Д.А    | В Приложение Б.11 «Сервис управления  |
|      | .2019 |              | внешними ИС центрами» добавлено       |
|      |       |              | описание для поля opnModes            |
+------+-------+--------------+---------------------------------------+
| 2.66 | 26.02 | Мезин Д.А    | Добавлено новое Приложение Б.10       |
|      | .2019 |              | Сервис подтверждения операций по      |
|      |       |              | регистрации УЗ через интеграционный   |
|      |       |              | модуль ЕПГУ.                          |
|      |       |              |                                       |
|      |       |              | В Приложение Б.9 добавлен код ошибки  |
|      |       |              | ESIA- 032010.                         |
|      |       |              |                                       |
|      |       |              | В пункты 3.2.2 и В.6.5 добавлена      |
|      |       |              | информации об обязательности вызова   |
|      |       |              | Logout                                |
+------+-------+--------------+---------------------------------------+
| 2.67 | 26.03 | Петраков     | В Приложене Б.12.2 «Сервис REST API   |
|      | .2020 | С.В.         | безусловного добавления сотрудников в |
|      |       |              | организацию в перечень возвращаемых   |
|      |       |              | ошибок» добавлено описание ошибки     |
|      |       |              | ESIA-036102                           |
+------+-------+--------------+---------------------------------------+
| 2.68 | 14.04 | Мезин Д.А    | В Приложении Б.4 «Предоставление      |
|      | .2020 |              | данных из профиля организации»        |
|      |       |              | актуализированы коды типов ОГВ        |
+------+-------+--------------+---------------------------------------+
| 2.69 | 28.05 | Тихонова     | В раздел А.9 добавлен код ошибки      |
|      | .2020 | Е.Н.         | ESIA-039803, скорректировано описание |
|      |       |              | кода возврата для кода ошибки         |
|      |       |              | ESIA-032010.                          |
|      |       |              |                                       |
|      |       |              | В раздел А.9 добавлено описание       |
|      |       |              | способа формирования подписи запроса  |
|      |       |              | (Request--Data--Sign) для метода      |
|      |       |              | импорта                               |
+------+-------+--------------+---------------------------------------+
| 2.70 | 15.07 | Цирихов А.М. | В документ добавлено Приложение Б.13  |
|      | .2020 |              | «Сервис получения маркера доступа по  |
|      |       |              | идентификационному ключу»             |
+------+-------+--------------+---------------------------------------+
| 2.71 | 17.08 | Жукова Д.А.  | В Таблицу 3 добавлен новый параметр   |
|      | .2020 |              | \<actDate\> -- дата актовой записи    |
|      |       |              | (только для свидетельства о рождении  |
|      |       |              | ребенка РФ) для свидетельства о       |
|      |       |              | рождении РФ ребенка                   |
+------+-------+--------------+---------------------------------------+
| 2.72 | 21.08 | Мезин Д.А    | В Приложении Б «Сервисы ЕСИА на базе  |
|      | .2020 |              | подхода REST» скорректировано         |
|      |       |              | описание для метода «Сведения\        |
|      |       |              | об отдельной записи в перечне         |
|      |       |              | документов физического лица»          |
+------+-------+--------------+---------------------------------------+
| 2.73 | 08.09 | Маркелова    | В Приложение А.4 добавлено описание   |
|      | .2020 | М.Н.         | методов REST API ЕСИА для получения   |
|      |       |              | данных о категориях организации.      |
|      |       |              |                                       |
|      |       |              | В Приложение Б.4 в перечень scope     |
|      |       |              | добавлен scope categories             |
+------+-------+--------------+---------------------------------------+
| 2.74 | 17.09 | Тихонова Е.  | В Приложение А.2 добавлена информация |
|      | .2020 | Н.           | о самозанятых\                        |
|      |       |              | и добавлено описание методов REST API |
|      |       | Маркелова    | ЕСИА\                                 |
|      |       | М.Н.         | для получения данных о категориях     |
|      |       |              | самозанятого.                         |
|      |       |              |                                       |
|      |       |              | В Приложение Б.4 в перечень scope     |
|      |       |              | добавлен scope self_employed.         |
|      |       |              |                                       |
|      |       |              | В Приложении Б «Сервисы ЕСИА на базе  |
|      |       |              | подхода REST» скорректировано         |
|      |       |              | описание для методов «Данные\         |
|      |       |              | о пользователе с идентификатором      |
|      |       |              | prn--id» и «Сведения об отдельной     |
|      |       |              | записи в перечне документов           |
|      |       |              | физического лица»                     |
+------+-------+--------------+---------------------------------------+
| 2.75 | 05.10 | Мезин Д.А    | В Приложение Б добавлен новый         |
|      | .2020 |              | подраздел Б.9.1 «Модернизированный    |
|      |       |              | сервис импорта УЗ пользователя\       |
|      |       |              | из внешних ИС»                        |
+------+-------+--------------+---------------------------------------+
| 2.76 | 27.10 | Мезин Д.А    | В Приложение Б.12.4 «Сервис REST API  |
|      | .2020 |              | прикрепления сотрудников к ЦО»        |
|      |       |              | добавлен код ошибки: ESIA-039961      |
+------+-------+--------------+---------------------------------------+
| 2.77 | 03.12 | Цветкова     | В Приложение Б.9 в Таблице 13         |
|      | .2020 | Г.А.         | добавлено описание кодов ошибок       |
|      |       |              | ESIA-910100 и ESIA-910001             |
|      |       |              |                                       |
|      |       |              | В Приложении Б.9 скорректировано      |
|      |       |              | описание примера\                     |
|      |       |              | с ошибкой ESIA-910100                 |
+------+-------+--------------+---------------------------------------+
| 2.78 | 08.12 | Тихонова     | В Приложение В4 -- для получения      |
|      | .2020 | М.А.         | информации об организациях, в которые |
|      |       |              | включен пользователь -- к данному     |
|      |       |              | REST API добавлен атрибут \<admin\>   |
|      |       |              | с его значением                       |
+------+-------+--------------+---------------------------------------+
| 2.79 | 25.12 | Маркелова    | В Приложении А.5 и А.4 изменено       |
|      | .2020 | М.Н.         | наименование параметра телефон с      |
|      |       |              | «PHN» на «OPH» в контактах            |
|      |       |              | организации                           |
+------+-------+--------------+---------------------------------------+
| 2.80 | 19.03 | Тихонова     | В Приложении А.9:                     |
|      | .2021 | М.А.         |                                       |
|      |       |              | -   Актуализирована схема импорта     |
|      |       |              |     (Рисунок 4 -- Обобщенный алгоритм |
|      |       |              |     импорта в ЕСИА)                   |
|      |       |              |                                       |
|      |       |              | -   Внесены изменения в таблицу ФЛК   |
|      |       |              |     -- Параметры ответа на запрос о   |
|      |       |              |     статусе проверки данных           |
|      |       |              |     пользователя для полей: ФИО,      |
|      |       |              |     наименование подразделения,       |
|      |       |              |     выдавшего документ и номер        |
|      |       |              |     подразделения для паспорта РФ;    |
|      |       |              |     фамилия и имя                     |
|      |       |              |                                       |
|      |       |              | -   на латинице и наименование        |
|      |       |              |     подразделения, выдавшего документ |
|      |       |              |     для заграничного паспорта;        |
|      |       |              |                                       |
|      |       |              | -   Внесены изменения в таблицу       |
|      |       |              |     с параметрами ответа.             |
|      |       |              |                                       |
|      |       |              | -   В параметр «code» добавлено       |
|      |       |              |     примечание\                       |
|      |       |              |     по возращению значения ответа;    |
|      |       |              |                                       |
|      |       |              | -   Удален параметр «message» из      |
|      |       |              |     таблицы, которая хранит в себе    |
|      |       |              |     параметры, передающиеся в ответе\ |
|      |       |              |     от вызова метода импорта;         |
|      |       |              |                                       |
|      |       |              | -   Добавлены коды ответов на запрос  |
|      |       |              |     о статусе выполнения заявки       |
|      |       |              |     (Таблица 73 -- Коды и описание    |
|      |       |              |     ошибок от сервиса импорта);       |
|      |       |              |                                       |
|      |       |              | В Приложени А.2:                      |
|      |       |              |                                       |
|      |       |              | -   Изменено описание https-адреса    |
|      |       |              |     REST API, добавлено описание      |
|      |       |              |     версии v2;                        |
|      |       |              |                                       |
|      |       |              | -   Добавлена информация об адресе    |
|      |       |              |     временной регистрации (Таблица    |
|      |       |              |     3);                               |
|      |       |              |                                       |
|      |       |              | В Приложении Б.4:                     |
|      |       |              |                                       |
|      |       |              | -   Добавлен scope addresses, удален  |
|      |       |              |     scope contacts (Таблица 96);      |
|      |       |              |                                       |
|      |       |              | В Приложении Г.4:                     |
|      |       |              |                                       |
|      |       |              | -   -- Добавлен scope contacts        |
|      |       |              |     (Таблица 104)                     |
+------+-------+--------------+---------------------------------------+
| 2.81 | 14.04 | Тихонова     | В Приложение Б.4 добавлен пункт 7     |
|      | .2021 | М.А.         | «Перечень scope\                      |
|      |       |              | для предоставления доступа к API      |
|      |       |              | ЕПГУ»                                 |
+------+-------+--------------+---------------------------------------+
| 2.82 | 21.04 | Тихонова     | В Приложении А.9:                     |
|      | .2021 | М.А.         |                                       |
|      |       |              | -   Добавлены коды ESIA-020016,       |
|      |       |              |     ESIA-033448, ESIA-033445 и        |
|      |       |              |     описание ошибок от сервиса        |
|      |       |              |     импорта (Таблица 73 -- Коды и     |
|      |       |              |     описание ошибок от сервиса        |
|      |       |              |     импорта);                         |
|      |       |              |                                       |
|      |       |              | -   Актуализирована схема импорта     |
|      |       |              |     (Рисунок 4);                      |
|      |       |              |                                       |
|      |       |              | -   В конце документа приложен архив  |
|      |       |              |     со схемой импорта в rar-формате;  |
|      |       |              |                                       |
|      |       |              | В Приложении Б.6.2.2 добавлено        |
|      |       |              | описание реализации механизма         |
|      |       |              | бесшовной аутентификации              |
+------+-------+--------------+---------------------------------------+
| 2.83 | 23.04 | Жукова Д.А.  | В Таблице 93 добавлен новый код       |
|      | .2021 |              | ошибки -- ESIA-007023                 |
+------+-------+--------------+---------------------------------------+
| 2.84 | 27.04 | Тихонова     | В Приложении А.9:                     |
|      | .2021 | М.А.         |                                       |
|      |       |              | -   Добавлен параметр «message» в     |
|      |       |              |     таблицу, которая хранит в себе    |
|      |       |              |     параметры, передающиеся в ответе  |
|      |       |              |     от вызова метода импорта;         |
|      |       |              |                                       |
|      |       |              | -   Добавлено описание условий        |
|      |       |              |     отображения параметром «message»  |
|      |       |              |     и «decription»                    |
+------+-------+--------------+---------------------------------------+
| 2.85 | 18.06 | Тихонова     | Обновлен список сокращений, НПА в п.  |
|      | .2021 | М.А.         | 1.2, исправлены опечатки и            |
|      |       |              | форматирование;                       |
|      |       |              |                                       |
|      |       |              | В Приложении А.2 добавлено описание   |
|      |       |              | атрибутов полей, приходящих в ответе  |
|      |       |              | по типу документа MDCL_PLCY           |
+------+-------+--------------+---------------------------------------+
| 2.86 | 13.07 | Тихонова     | Скорректирована информация            |
|      | .2021 | М.А.         | по использованию сертификатов по      |
|      |       |              | ГОСТ--2012                            |
+------+-------+--------------+---------------------------------------+
| 2.87 | 04.08 | Тихонова     | В Приложении А.9 скорректировано      |
|      | .2021 | М.А.         | описание подраздела                   |
+------+-------+--------------+---------------------------------------+
| 2.88 | 30.09 | Мезин Д.А    | В Приложении А.9 скорректировано      |
|      | .2021 |              | описание подраздела                   |
+------+-------+--------------+---------------------------------------+
| 2.89 | 14.01 | Волков В.В.  | В п. 2.3 скорректирована информация   |
|      | .2022 |              | получения токена доступа;             |
|      |       |              |                                       |
|      |       |              | В Приложение Д добавлено описание     |
|      |       |              | устаревших сервисов:                  |
|      |       |              |                                       |
|      |       |              | -   Д.6 -- получение кода             |
|      |       |              |     авторизации;                      |
|      |       |              |                                       |
|      |       |              | -   Д.7 -- полученияе маркера доступа |
+------+-------+--------------+---------------------------------------+
| 2.90 | 16.03 | Ларина Н.В.  | Обращение к /ac отмечено как          |
|      | .2022 |              | нерекомендуемое\                      |
|      |       |              | к использованию в разделе «Получение  |
|      |       |              | авторизационного кода (рекомендован к |
|      |       |              | выводу\                               |
|      |       |              | из эксплуатации и не допускается к    |
|      |       |              | использованию при подключении новых   |
|      |       |              | систем-клиентов)»;                    |
|      |       |              |                                       |
|      |       |              | Добавлено описание v2/ac в разделе    |
|      |       |              | «Получение авторизационного кода      |
|      |       |              | (v2/ac)»;                             |
|      |       |              |                                       |
|      |       |              | Обращение к /te отмечено как          |
|      |       |              | нерекомендуемое\                      |
|      |       |              | к использованию в разделе «Получение  |
|      |       |              | маркера доступа в обмен на            |
|      |       |              | авторизационный код (рекомендован к   |
|      |       |              | выводу из эксплуатации и не           |
|      |       |              | допускается к использованию           |
|      |       |              | при подключении новых                 |
|      |       |              | систем-клиентов)»;                    |
|      |       |              |                                       |
|      |       |              | Добавлено описание v3/te в разделе    |
|      |       |              | «Получение маркера доступа в обмен на |
|      |       |              | авторизационный код (v3/te)»;         |
|      |       |              |                                       |
|      |       |              | Обращение к /ac отмечено как          |
|      |       |              | нерекомендуемое\                      |
|      |       |              | к использованию в разделе             |
|      |       |              | «Стандартный режим запроса            |
|      |       |              | авторизационного кода (рекомендован к |
|      |       |              | выводу из эксплуатации и не           |
|      |       |              | допускается к использованию           |
|      |       |              | при подключении новых                 |
|      |       |              | систем-клиентов)»;                    |
|      |       |              |                                       |
|      |       |              | Добавлено описание v2/ac в разделе    |
|      |       |              | «Стандартный режим запроса            |
|      |       |              | авторизационного кода (v2/ac)»;       |
|      |       |              |                                       |
|      |       |              | Обращение к /te отмечено как          |
|      |       |              | нерекомендуемое\                      |
|      |       |              | к использованию в разделе «Получение  |
|      |       |              | маркера идентификации в обмен на      |
|      |       |              | авторизационный код (рекомендован к   |
|      |       |              | выводу из эксплуатации и не           |
|      |       |              | допускается к использованию           |
|      |       |              | при подключении новых                 |
|      |       |              | систем-клиентов)»;                    |
|      |       |              |                                       |
|      |       |              | Добавлено описание v3/te в разделе    |
|      |       |              | Б.6.4;                                |
|      |       |              |                                       |
|      |       |              | Добавлено описание ошибки ESIA-007046 |
|      |       |              | в таблицах 93, 94                     |
+------+-------+--------------+---------------------------------------+
| 2.91 | 18.03 | Губанов В.Ю. | Добавлен подраздел с описанием        |
|      | .2022 |              | сервиса получения сведений о          |
|      |       |              | лицензиях ЮЛ и ИП, ранее переданных   |
|      |       |              | лицензирующими органами в ЕСИА:       |
|      |       |              |                                       |
|      |       |              | -   Б.7.1.5 Лицензии. Получение от    |
|      |       |              |     регулирующих организаций в ЕСИА   |
|      |       |              |     сведений;                         |
|      |       |              |                                       |
|      |       |              | -   о выдаче/отзыве/изменениях в      |
|      |       |              |     лицензиях                         |
+------+-------+--------------+---------------------------------------+
| 2.92 | 14.04 | Яковлева     | В Приложение Б раздел Б.7 добавлены   |
|      | .2022 | М.Ю.         | подразделы:                           |
|      |       |              |                                       |
|      |       |              | -   Б.7.7 «Добавление и обновление    |
|      |       |              |     данных филиала, представительства |
|      |       |              |     иностранных юридических лиц»;     |
|      |       |              |                                       |
|      |       |              | -   Б.7.8 «Присоединение руководителя |
|      |       |              |     к филиалу, представительству      |
|      |       |              |     иностранных юридических лиц»      |
+------+-------+--------------+---------------------------------------+
| 2.93 | 21.04 | Ларина Н.В.  | В раздел «Общее описание ЕСИА»        |
|      | .2022 |              | добавлена информация                  |
|      |       |              |                                       |
|      |       |              | о необходимости использования         |
|      |       |              | протокола защиты TLS версии 1.2;      |
|      |       |              |                                       |
|      |       |              | В раздел Получение авторизационного   |
|      |       |              | кода (v2/ac) добавлено описание:      |
|      |       |              |                                       |
|      |       |              | -   формирования client_secret;       |
|      |       |              |                                       |
|      |       |              | -   формирования                      |
|      |       |              |     client_certificate_hash;          |
|      |       |              |                                       |
|      |       |              | -   формирования code_challenge;      |
|      |       |              |                                       |
|      |       |              | > В раздел «Получение маркера доступа |
|      |       |              | > в обмен на авторизационный код      |
|      |       |              | > (v3/te)» добавлено описание:        |
|      |       |              |                                       |
|      |       |              | -   формирования client_secret;       |
|      |       |              |                                       |
|      |       |              | -   формирования                      |
|      |       |              |     client_certificate_hash;          |
|      |       |              |                                       |
|      |       |              | -   верификации code_challenge.       |
|      |       |              |                                       |
|      |       |              | В раздел Стандартный режим запроса    |
|      |       |              | авторизационного кода (v2/ac)         |
|      |       |              | добавлено описание:                   |
|      |       |              |                                       |
|      |       |              | -   формирования client_secret;       |
|      |       |              |                                       |
|      |       |              | -   формирования                      |
|      |       |              |     client_certificate_hash;          |
|      |       |              |                                       |
|      |       |              | -   формирования code_challenge.      |
|      |       |              |                                       |
|      |       |              | > В раздел добавлено описание:        |
|      |       |              |                                       |
|      |       |              | -   формирования client_secret;       |
|      |       |              |                                       |
|      |       |              | -   формирования                      |
|      |       |              |     client_certificate_hash;          |
|      |       |              |                                       |
|      |       |              | -   верификации code_challenge        |
+------+-------+--------------+---------------------------------------+
| 2.94 | 31.05 | Ларина Н.В.  | Добавлено описание scope citizenship  |
|      | .2022 |              | в раздел «Особенности указания        |
|      |       |              | области доступа (scope)»              |
+------+-------+--------------+---------------------------------------+
| 2.95 | 01.07 | Тюрин И.А.   | В таблицу 73 «Коды и описание ошибок\ |
|      | .2022 |              | от сервиса импорта» добавлены новые   |
|      |       |              | коды ошибок\                          |
|      |       |              | с описанием;                          |
|      |       |              |                                       |
|      |       |              | На схему «Рисунок 14» добавлены новые |
|      |       |              | коды ошибок\                          |
|      |       |              | с описанием                           |
+------+-------+--------------+---------------------------------------+
| 2.96 | 12.07 | Панкратов    | Добавлена информация о запросе        |
|      | .2022 | А.А.         | данных\                               |
|      |       |              | по согласиям в раздел 4.3;            |
|      |       |              |                                       |
|      |       |              | Добавлена информация о доступе к      |
|      |       |              | сведениям организации при наличии     |
|      |       |              | действующего согласия\                |
|      |       |              | в раздел 4.3.2;                       |
|      |       |              |                                       |
|      |       |              | Добавлен раздел по согласиям;         |
|      |       |              |                                       |
|      |       |              | Добавлен раздел по генеральному       |
|      |       |              | согласию А.7.1.6.1 Генеральное        |
|      |       |              | согласие                              |
+------+-------+--------------+---------------------------------------+
| 2.97 | 22.07 | Панкратов    | В Приложение Б.4, в Таблицу 98        |
|      | .2022 | А.А.         | добавлен scope org_ra                 |
+------+-------+--------------+---------------------------------------+
| 2.98 | 29.07 | Пустынская   | В Таблицу 73 «Коды и описание ошибок  |
|      | .2022 | Т.Н.         | от сервиса импорта» добавлены коды    |
|      |       |              | ошибок с описанием\                   |
|      |       |              | из устаревшего импорта (из таблицы    |
|      |       |              | 107), которые используются в текущей  |
|      |       |              | версии метода                         |
+------+-------+--------------+---------------------------------------+
| 2.99 | 09.08 | Сергеев М.А. | В Таблице 94 «Список ошибок при       |
|      | .2022 |              | получении маркеров доступа» исключен  |
|      |       |              | код ошибки «ESIA-007046: Запрос otp   |
|      |       |              | невозможен, а в scope указано         |
|      |       |              | обязательное прохождение              |
|      |       |              | пользователем двухфакторной           |
|      |       |              | авторизации»                          |
+------+-------+--------------+---------------------------------------+
| 3.0  | 15.08 | Сапронов     | Скорректировано форматирование в      |
|      | .2022 | П.В.         | соответствии\                         |
|      |       |              | с ГОСТ Р 2.105-2019                   |
+------+-------+--------------+---------------------------------------+
| 3.1  | 05.09 | Савицкий     | Добавлено описание ошибки ESIA-020326 |
|      | .2022 | Д.А.         | в Таблицу 73 -- Коды и описание       |
|      |       |              | ошибок от сервиса импорта             |
+------+-------+--------------+---------------------------------------+
| 3.2  | 07.09 | Волков В.В.  | В Приложение А.12, в текст запроса    |
|      | .2022 |              | REST API GET, добавленo «/esia-rs/»,  |
|      |       |              | а также формат кодирования\           |
|      |       |              | для параметра «signature»             |
+------+-------+--------------+---------------------------------------+
| 3.3  | 06.10 | Кравченко    | Приложение Б.7.1.5 «Лицензии.         |
|      | .2022 | П.А.         | Получение\                            |
|      |       |              | от лицензирующих органов в ЕСИА       |
|      |       |              | сведений\                             |
|      |       |              | о выдаче/отзыве/изменениях в          |
|      |       |              | лицензиях» выделено\                  |
|      |       |              | в п. А.7.2 и внесены изменения:       |
|      |       |              |                                       |
|      |       |              | -   информация из приложения Б.7.1.5  |
|      |       |              |     выделена\                         |
|      |       |              |     в отдельный п. А.7.2.1, внесены   |
|      |       |              |     корректировки\                    |
|      |       |              |     в описание;                       |
|      |       |              |                                       |
|      |       |              | -   добавлен новый п. А.7.2.2         |
|      |       |              |     «Получение и отображение          |
|      |       |              |     управляющих элементов для         |
|      |       |              |     перехода по ссылкам\              |
|      |       |              |     на услуги по лицензированию       |
|      |       |              |     ЕПГУ».                            |
|      |       |              |                                       |
|      |       |              | Добавлен п. А.7.3 «Налоги.            |
|      |       |              | Предоставление сведений\              |
|      |       |              | из налоговой декларации. Просмотр     |
|      |       |              | списка сведений\                      |
|      |       |              | из декларации по налогу, выгрузка     |
|      |       |              | сведений из декларации по налогу».    |
|      |       |              |                                       |
|      |       |              | Добавлен п. А.7.3.24 «Реестр МСП.     |
|      |       |              | Предоставление сведений из реестра    |
|      |       |              | МСП. Просмотр списка сведений из      |
|      |       |              | реестра МСП, запрос/обновление        |
|      |       |              | сведений\                             |
|      |       |              | из реестра МСП».                      |
|      |       |              |                                       |
|      |       |              | Добавлен п. А.7.5 «Управление         |
|      |       |              | сведениями о наличии счетов           |
|      |       |              | организаций и ИП в банках»            |
+------+-------+--------------+---------------------------------------+
| 3.4  | 09.10 | Жернаков     | Из Приложения Б.6.2.3 «Проверка       |
|      | .2022 | А.А.         | наличия аутентификации в фоновом      |
|      |       |              | режиме» исключен ранее поддерживаемый |
|      |       |              | браузер Internet Explorer             |
+------+-------+--------------+---------------------------------------+
| 3.5  | 12.10 | Цветкова     | В разделе Приложение А, п. А.9:       |
|      | .2022 | Г.А.         |                                       |
|      |       |              | -   обновлен Рисунок 4 -- Обобщенный  |
|      |       | Ларина Н.В.  |     алгоритм импорта в ЕСИА;          |
|      |       |              |                                       |
|      |       |              | -   уточнено описание обязательности  |
|      |       |              |     параметра «snils» (СНИЛС) в       |
|      |       |              |     запросе на импорт;                |
|      |       |              |                                       |
|      |       |              | -   уточнено описание обязательности  |
|      |       |              |     параметра «EML» (электронная      |
|      |       |              |     почта) в запросе на импорт.       |
|      |       |              |                                       |
|      |       |              | В разделе Приложение А добавлен п.    |
|      |       |              | А.9.2 «Автоматический поиск СНИЛС при |
|      |       |              | регистрации УЗ пользователя методом   |
|      |       |              | импорта».                             |
|      |       |              |                                       |
|      |       |              | В приложении А.11 в состав атрибутов  |
|      |       |              | адреса ЦО (элемент «address»)         |
|      |       |              | добавлен атрибут «vrfDdt».            |
|      |       |              |                                       |
|      |       |              | Добавлено описание принудительной     |
|      |       |              | двухфакторной аутентификации (scope   |
|      |       |              | otp):                                 |
|      |       |              |                                       |
|      |       |              | -   добавлен раздел «Аутентификация   |
|      |       |              |     посредством ЕСИА с обязательным   |
|      |       |              |     использованием второго фактора»;  |
|      |       |              |                                       |
|      |       |              | -   добавлено описание ошибки         |
|      |       |              |     ESIA-007046 (Таблица 93 -- Список |
|      |       |              |     ошибок при получении маркеров     |
|      |       |              |     доступа, Таблица 94 -- Список     |
|      |       |              |     ошибок при получении маркеров     |
|      |       |              |     доступа (/v3/te));                |
|      |       |              |                                       |
|      |       |              | -   добавлено описание claim 2fa в    |
|      |       |              |     раздел «Сведения о структуре      |
|      |       |              |     маркера идентификации»            |
+------+-------+--------------+---------------------------------------+
| 3.6  | 19.10 | Гельзина     | В раздел 4.1.1.1 «Регистрация УЗ ФЛ»  |
|      | .2022 | А.С.         | добавлено описание возможности        |
|      |       |              | регистрации пользователем УЗ ребенка. |
|      |       |              |                                       |
|      |       |              | В раздел 4.2.1 «Управление данными    |
|      |       |              | ФЛ» добавлено описание способа        |
|      |       |              | управления данными в УЗ ребенка       |
+------+-------+--------------+---------------------------------------+
| 3.7  | 02.11 | Чуприс С.Н.  | В Приложение А, пункте А.12 изменено: |
|      | .2022 |              |                                       |
|      |       |              | «signature -- подпись запроса в       |
|      |       |              | формате PKCS#7 detached signature в   |
|      |       |              | формате urlSafeBase64 в кодировке     |
|      |       |              | UTF-8 -- подписанный параметр UUID    |
|      |       |              | сертификатом организации, на          |
|      |       |              | сотрудника которой был выдан          |
|      |       |              | (сформирован) идентификационный ключ» |
|      |       |              | на:                                   |
|      |       |              |                                       |
|      |       |              | «signature -- подпись запроса в       |
|      |       |              | формате PKCS#7 detached signature в   |
|      |       |              | формате urlSafeBase64 в кодировке     |
|      |       |              | UTF-8 -- подписанный не ранее, чем за |
|      |       |              | 24 часа (86400 с) параметр UUID       |
|      |       |              | сертификатом организации, на          |
|      |       |              | сотрудника которой был выдан          |
|      |       |              | (сформирован) идентификационный       |
|      |       |              | ключ».                                |
|      |       |              |                                       |
|      |       |              | В пунктах Б.2.3, Б.2.5, Б.6.2.2,      |
|      |       |              | Б.6.4 изменена фраза\                 |
|      |       |              | на «сертифицированных Российских      |
|      |       |              | криптографических средств защиты      |
|      |       |              | информации»                           |
+------+-------+--------------+---------------------------------------+
| 3.8  | 03.11 | Космачева    | В раздел А.7.1.4 добавлен новый       |
|      | .2022 | М.А.         | подраздел А.7.1.5.2 Полученные из     |
|      |       |              | ведомства транспортные средства       |
+------+-------+--------------+---------------------------------------+
| 3.9  | 22.11 | Ларина Н.В.  | Добавлено описание ошибки             |
|      | .2022 |              | «ESIA-07002» в Таблица 93.            |
|      |       |              |                                       |
|      |       |              | В разделы Б.2.2, Б.2.3 добавлена      |
|      |       |              | информация о проверке                 |
|      |       |              | авторизационного кода                 |
+------+-------+--------------+---------------------------------------+
| 3.10 | 25.11 | Кругликова   | Добавлены разделы:                    |
|      | .2022 | Е.И.         |                                       |
|      |       |              | -   А.7.1.3 «Управление сведениями о  |
|      |       |              |     среднесписочной численности       |
|      |       |              |     работников\                       |
|      |       |              |     за предшествующий календарный     |
|      |       |              |     год»;                             |
|      |       |              |                                       |
|      |       |              | -   А.7.6 «Управление сведениями о    |
|      |       |              |     наличии действующих решений\      |
|      |       |              |     о приостановлении операций по     |
|      |       |              |     счетам налогоплательщика»         |
+------+-------+--------------+---------------------------------------+
| 3.11 | 14.12 | Ларина Н.В.  | Добавлено ошибки «ESIA-007055» в      |
|      | .2022 |              | таблицу 93.                           |
|      |       | > Азизов     |                                       |
|      |       | > И.Т.       | Добавлено описание «person_filter» в  |
|      |       |              | разделы Б.2.2, Б.2.3, Б.6.2.1,        |
|      |       |              | Б.6.2.2.                              |
|      |       |              |                                       |
|      |       |              | Добавлено описание ошибок             |
|      |       |              | «ESIA-910313», «ESIA-035109» и        |
|      |       |              | «ESIA-039841» в таблицу 73            |
+------+-------+--------------+---------------------------------------+
| 3.12 | 27.12 | Сапронов     | В раздел 4.1.1 добавлены способы      |
|      | .2022 | П.В.         | подтверждения УЗ.                     |
|      |       |              |                                       |
|      |       | Кравченко    | В Таблица 3 добавлено описание видов  |
|      |       | П.А.         | адресов (MVD/PTU).                    |
|      |       |              |                                       |
|      |       |              | Обновлен Рисунок 4.                   |
|      |       |              |                                       |
|      |       |              | Обновлено название и описание раздела |
|      |       |              | А.7.3.                                |
|      |       |              |                                       |
|      |       |              | Добавлены разделы:                    |
|      |       |              |                                       |
|      |       |              | -   А.7.3.24 «Запуск обновления       |
|      |       |              |     сведений из налоговой деклараций, |
|      |       |              |     предоставленных ИП, применяющими  |
|      |       |              |     специальные налоговые режимы      |
|      |       |              |     по идентификатору организации и   |
|      |       |              |     году документа»;                  |
|      |       |              |                                       |
|      |       |              | -   А.7.3.27 «Проверка запуска        |
|      |       |              |     обновления сведений о наличии     |
|      |       |              |     (отсутствии) задолженности по     |
|      |       |              |     уплате налогов, сборов, страховых |
|      |       |              |     взносов, пеней, штрафов,          |
|      |       |              |     процентов»;                       |
|      |       |              |                                       |
|      |       |              | -   А.7.3.28 «Запуск обновления       |
|      |       |              |     сведений о наличии (отсутствии)   |
|      |       |              |     задолженности по уплате налогов,  |
|      |       |              |     сборов, страховых взносов, пеней, |
|      |       |              |     штрафов, процентов»;              |
|      |       |              |                                       |
|      |       |              | -   А.7.3.29 «Отмена обновления       |
|      |       |              |     сведений о наличии (отсутствии)   |
|      |       |              |     задолженности по уплате налогов,  |
|      |       |              |     сборов, страховых взносов, пеней, |
|      |       |              |     штрафов, процентов»;              |
|      |       |              |                                       |
|      |       |              | -   А.7.3.30 «Получение сведений о    |
|      |       |              |     сумме фактически уплаченных       |
|      |       |              |     юридическим лицом налогов»;       |
|      |       |              |                                       |
|      |       |              | -   А.7.3.31 «Проверка запуска        |
|      |       |              |     обновления сведений о сумме       |
|      |       |              |     фактически уплаченных юридическим |
|      |       |              |     лицом налогов»;                   |
|      |       |              |                                       |
|      |       |              | -   А.7.3.32 «Запуск обновления       |
|      |       |              |     сведений о сумме фактически       |
|      |       |              |     уплаченных юридическим лицом      |
|      |       |              |     налогов»;                         |
|      |       |              |                                       |
|      |       |              | -   А.7.3.33 «Отмена обновления       |
|      |       |              |     сведений о сумме фактически       |
|      |       |              |     уплаченных юридическим лицом      |
|      |       |              |     налогов»;                         |
|      |       |              |                                       |
|      |       |              | -   А.7.3.34 «Получение сведений о    |
|      |       |              |     бухгалтерской отчетности»;        |
|      |       |              |                                       |
|      |       |              | -   А.7.3.35 «Запуск обновления       |
|      |       |              |     сведений о бухгалтерской          |
|      |       |              |     отчетности»;                      |
|      |       |              |                                       |
|      |       |              | -   А.7.3.36 «Отмена обновления       |
|      |       |              |     сведений о бухгалтерской          |
|      |       |              |     отчетности»                       |
+------+-------+--------------+---------------------------------------+
| 3.13 | 29.12 | Пустынская   | Обновлены ссылки на: ВС «Получение    |
|      | .2022 | Т.Н.         | сведений\                             |
|      |       |              | о лицензиях от лицензирующих органов  |
|      |       |              | в ЕСИА в целях обеспечения доступа к  |
|      |       |              | ним в личном кабинете лицензиата в    |
|      |       |              | ЕПГУ» в разделе А.7.2.1, ВС           |
|      |       |              | «Предоставление сведений из налоговой |
|      |       |              | декларации по налогу на прибыль       |
|      |       |              | организаций» в разделе А.7.3.11       |
+------+-------+--------------+---------------------------------------+
| 3.14 | 01.02 | Кравченко    | Изменена информация о возможности     |
|      | .2023 | П.А.         | редактирования поля ОПФ в разделах    |
|      |       |              | 4.1.2, 4.2.2.1, А.7.1, А.7.1.1.       |
|      |       | Сапронов     |                                       |
|      |       | П.В.         | ПФР заменен на СФР, актуализирована   |
|      |       |              | ссылка\                               |
|      |       |              | на Руководство пользователя ЕСИА      |
+------+-------+--------------+---------------------------------------+
| 3.15 | 06.02 | Пальчикова   | Приложение В.7 -- в подразделе        |
|      | .2023 | Е.А.         | «Сведения о структуре маркера         |
|      |       |              | идентификации» добавлено описание     |
|      |       |              | нового поля со статусом УЗ            |
|      |       |              | («urn:esia:sbj:lvl»)                  |
+------+-------+--------------+---------------------------------------+
| 3.16 | 14.02 | Зорин Д.А.   | Удалены упоминания по vehicles        |
|      | .2023 |              | физического лица в разделах А.1, А.2, |
|      |       |              | в Таблица 3 -- Параметры ответа на    |
|      |       |              | запрос о персональных данных          |
|      |       |              | пользователя, строки 13, 14, 15 и     |
|      |       |              | сноска 32. В разделе Б.4, в Таблица   |
|      |       |              | 96 -- Предоставляемые ЕСИА наборы     |
|      |       |              | данных о пользователе удалена строка  |
|      |       |              | 16 (упоминание scope vehicles)        |
+------+-------+--------------+---------------------------------------+
| 3.17 | 15.02 | Пальчикова   | Добавлено описание новых значений     |
|      | .2023 | Е.А.         | параметра «person_filter» в разделы   |
|      |       |              | Б.2.2, Б.2.3, Б.6.2.1, Б.6.2.2        |
+------+-------+--------------+---------------------------------------+
| 3.18 | 20.02 | Гельзина     | В Таблица 96 -- Предоставляемые ЕСИА  |
|      | .2023 | А.С.         | наборы данных о пользователе добавлен |
|      |       |              | новый scope «usr_reg_cxt» --просмотр  |
|      |       |              | статуса валидации УЗ.                 |
|      |       |              |                                       |
|      |       |              | В разделе Б.4 исправлена опечатка     |
+------+-------+--------------+---------------------------------------+
| 3.19 | 09.03 | Кравченко    | В приложении Б.7.3 добавлены разделы  |
|      | .2023 | П.А.         | А.7.3.5, А.7.3.6, А.7.3.11, А.7.3.12, |
|      |       |              | А.7.3.18, А.7.3.19, А.7.3.24,         |
|      |       |              | А.7.3.25                              |
+------+-------+--------------+---------------------------------------+
| 3.20 | 23.03 | Чертенко     | Добавлены информативные описания      |
|      | .2023 | И.С.         | ошибок в Б.7.3.5, таблица 28,         |
|      |       |              | Б.7.3.6, таблица 29, Б.7.3.11,        |
|      |       |              | таблица 34, Б.7.3.12, таблица 35,     |
|      |       |              | Б.7.3.18, таблица 40, Б.7.3.19,       |
|      |       |              | таблица 41, Б.7.3.24, таблица 46,     |
|      |       |              | Б.7.3.25, таблица 47                  |
+------+-------+--------------+---------------------------------------+
| 3.21 | 06.04 | Яковлева     | В раздел А.7.1 добавлен подраздел     |
|      | .2023 | М.Ю.         | А.7.1.4                               |
+------+-------+--------------+---------------------------------------+
| 3.22 | 10.04 | Кузькин А.А. | В разделе 4.2 изменен URL профиля     |
|      | .2023 |              | пользователя                          |
+------+-------+--------------+---------------------------------------+
| 3.23 | 13.04 | Савицкий     | В разделе А.2 добавлена информация в  |
|      | .2023 | Д.А.         | таблицу Таблица 3 (по типам полей,    |
|      |       |              | возвращаемых в адресах пользователя). |
|      |       | Гельзина     |                                       |
|      |       | А.С.         | В раздел А.2 внесены изменения в      |
|      |       |              | пример ответа на запрос конкретного   |
|      |       |              | адреса ФЛ.                            |
|      |       |              |                                       |
|      |       |              | В Таблица 97 -- Предоставляемые ЕСИА  |
|      |       |              | наборы данных о детях пользователя    |
|      |       |              | добавлены новые области доступа       |
|      |       |              | (scope) «kid_email» и «kid_mobile» -- |
|      |       |              | просмотр электронной почты и номера   |
|      |       |              | телефона ребенка                      |
+------+-------+--------------+---------------------------------------+
| 3.24 | 05.05 | Пальчикова   | В разделе Б.2.4 обновлена информация  |
|      | .2023 | Е.А.         | о формировании client_secret          |
+------+-------+--------------+---------------------------------------+
| 3.25 | 11.05 | Пальчикова   | Добавлено описание ошибки ESIA-007053 |
|      | .2023 | Е.А.         | в таблицах 93, 94.                    |
|      |       |              |                                       |
|      |       | Гельзина     | Добавлено описание параметра «status» |
|      |       | А.С.         | в данных, предоставляемых методом     |
|      |       |              | /prns/{oid}/docs/{doc_id},\           |
|      |       |              | в таблице Таблица 3.                  |
|      |       |              |                                       |
|      |       |              | В таблицу «Обозначения и сокращения»  |
|      |       |              | добавлен термин ЕГР ЗАГС              |
+------+-------+--------------+---------------------------------------+
| 3.26 | 11.05 | Сапронов     | Удалено Приложение Е «Единый сервис   |
|      | .2023 | П.В.         | упрощенной идентификации              |
|      |       |              | пользователей ЕСИА»                   |
+------+-------+--------------+---------------------------------------+
| 3.27 | 22.05 | Пальчикова   | В раздел Б.2.4 и Б.2.5 добавлена      |
|      | .2023 | Е.А.         | информация о необязательности         |
|      |       |              | параметра token_type                  |
+------+-------+--------------+---------------------------------------+
| 3.28 | 24.05 | Пальчикова   | В разделы Б.2.3, Б.2.5, Б.6.2.2 и     |
|      | .2023 | Е.А.         | Б.6.4 добавлена сноска\               |
|      |       |              | с примером реализации алгоритма data  |
|      |       |              | hash на языке Java                    |
+------+-------+--------------+---------------------------------------+
| 3.29 | 02.06 | Цветкова     | В разделе А.5 (таблица 5) внесено     |
|      | .2023 | Г.А.         | изменение в описание формата          |
|      |       |              | параметра «personSNILS»               |
+------+-------+--------------+---------------------------------------+
| 3.30 | 15.06 | Пальчикова   | В раздел Б.2.2 добавлен код ошибки    |
|      | .2023 | Е.А.         | ESIA-007194.                          |
+------+-------+--------------+---------------------------------------+
| 3.31 | 20.06 | Пальчикова   | В разделе Б.3.2 актуализирована       |
|      | .2023 | Е.А.         | информация о доступных к              |
|      |       |              | использованию типах областей доступа\ |
|      |       |              | при grant_type = client_credentials   |
+------+-------+--------------+---------------------------------------+
| 3.32 | 21.06 | Цветкова     | В раздел А.2 добавлен метод           |
|      | .2023 | Г.А.         | prns/{oid}/docs/{id_doc}/attrs для    |
|      |       |              | запроса перечня атрибутов             |
|      |       |              | иностранного документа, полученного   |
|      |       |              | от СФР, на основе которого был        |
|      |       |              | подтвержден документ иностранного     |
|      |       |              | гражданина взрослого пользователя     |
+------+-------+--------------+---------------------------------------+
| 3.33 | 29.06 | Кузькин А.А. | В раздел А.2 добавлены методы         |
|      | .2023 |              | prns/{oid}/bios-type (запрос перечня  |
|      |       |              | описании биометрий пользователя)\     |
|      |       |              | и prns/{oid}/bios-type-exp (запрос    |
|      |       |              | перечня описаний\                     |
|      |       |              | и сроков действия биометрий           |
|      |       |              | пользователя).                        |
|      |       |              |                                       |
|      |       |              | В разделе Б.4 актуализирована         |
|      |       |              | информация о доступных\               |
|      |       |              | к использованию типах областей        |
|      |       |              | доступа                               |
+------+-------+--------------+---------------------------------------+
| 3.34 | 30.06 | Гельзина     | В подразделе 4.2.1 обновлена ссылка   |
|      | .2023 | А.С.         | на веб-интерфейс ЛК ФЛ.               |
|      |       |              |                                       |
|      |       |              | В разделе А.1 дополнен перечень       |
|      |       |              | ссылок, которые могут быть встроены   |
|      |       |              | через указание «embed» для            |
|      |       |              | физического лица: добавлено указание  |
|      |       |              | возможности получения сведений о      |
|      |       |              | детях пользователя.                   |
|      |       |              |                                       |
|      |       |              | Обновлена информация в сноске 21.     |
|      |       |              |                                       |
|      |       |              | В разделе А.2 (Таблица 3, строка 9)   |
|      |       |              | обновлено описание метода запроса     |
|      |       |              | перечня записей о детях физического   |
|      |       |              | лица (строка 9).                      |
|      |       |              |                                       |
|      |       |              | В разделе А.2 (Таблица 3, строка 10)  |
|      |       |              | обновлено описание метода запроса     |
|      |       |              | сведений об отдельной записи в        |
|      |       |              | перечне детей физического лица:       |
|      |       |              | обновлен состав возвращаемых данных,  |
|      |       |              | добавлена ссылка на сноску 31.        |
|      |       |              |                                       |
|      |       |              | В разделе А.2 (Таблица 3, строка 12)  |
|      |       |              | обновлено описание метода запроса     |
|      |       |              | перечня записей о детях физического   |
|      |       |              | лица                                  |
+------+-------+--------------+---------------------------------------+
| 3.35 | 04.08 | Пальчикова   | В разделы Б.2.1, Б.2.3, Б.2.5 и Б.2.6 |
|      | .2023 | Е.А.         | добавлены сноски\                     |
|      |       |              | о получении и обмене маркеров         |
|      |       |              | обновления                            |
+------+-------+--------------+---------------------------------------+
| 3.36 | 11.08 | Пальчикова   | Удалены разделы «3.1.1                |
|      | .2023 | Е.А.         | Аутентификация\                       |
|      |       |              | с использованием стандарта SAML»,     |
|      |       |              | «3.2 Рекомендуемые сценарии           |
|      |       |              | интеграции по SAML», «Приложение А.   |
|      |       |              | Использование ЕСИА в целях            |
|      |       |              | идентификации\                        |
|      |       |              | и аутентификации посредством          |
|      |       |              | стандарта SAML 2.0», «4.3.3           |
|      |       |              | Особенности получения данных ОГВ и    |
|      |       |              | полномочий должностных лиц».          |
|      |       |              |                                       |
|      |       |              | Убрано упоминание механизма SAML из   |
|      |       |              | разделов 3, 4 4.1.5, 4.2.2.3, 4.3,    |
|      |       |              | 4.3.1, 4.3.2, А.4, А.5, Б.7.1.3.1.1   |
|      |       |              | -- Б.7.1.3.1.4, Б.7.1.4.1.1 --        |
|      |       |              | Б.7.1.4.1.4, А.7.3.1 -- А.7.3.12,     |
|      |       |              | А.7.3.14 -- А.7.3.36, А.7.4.2 --      |
|      |       |              | А.7.4.4, А.7.5.2 -- А.7.5.4, А.7.6.2  |
|      |       |              | -- А.7.6.5, Б.5                       |
+------+-------+--------------+---------------------------------------+
| 3.37 | 15.09 | Пальчикова   | В разделы А.2, Б.2.2, Б.2.3, Б.2.4,   |
|      | .2023 | Е.А.         | Б.2.5, Б.4, Б.6.2.1, Б.6.2.2,         |
|      |       |              | Б.6.2.3, Б.6.3, Б.6.4 добавлена       |
|      |       |              | сноска\                               |
|      |       |              | об ограничении использования областей |
|      |       |              | доступа (scope), предоставляющих      |
|      |       |              | доступ к персональным данным          |
|      |       |              | физических лиц, и необходимости       |
|      |       |              | перехода на согласия.                 |
|      |       |              |                                       |
|      |       |              | В таблицы 89 и 90 добавлен код ошибки |
|      |       |              | ESIA-007071: authCanOnlyByPermissions |
+------+-------+--------------+---------------------------------------+
| 3.38 | 19.10 | Мезин Д.А.   | Добавлен новый раздел А.9.3 «Операция |
|      | .2023 |              | по восстановлению доступа к           |
|      |       |              | подтвержденной УЗ в ЕСИА через импорт |
|      |       |              | УЗ»                                   |
+------+-------+--------------+---------------------------------------+
| 3.39 | 25.10 | Прошина А.В. | В таблицах 92 и 93 скорректирован код |
|      | .2023 |              | ошибки ESIA-008010 для кода параметра |
|      |       |              | invalid_client. Корректное значение   |
|      |       |              | ESIA-007010                           |
+------+-------+--------------+---------------------------------------+
| 3.40 | 30.10 | Прошина А.В. | Удалены ссылки на внутренние ресурсы  |
|      | .2023 |              | в контрольных примерах                |
+------+-------+--------------+---------------------------------------+
| 3.41 | 27.12 | Толочина     | В таблицу 72 добавлен код ошибки      |
|      | .2023 | О.В.         | ESIA-039807 \                         |
|      |       |              | при попытке подтверждения уже         |
|      |       |              | подвержденной УЗ\                     |
|      |       |              | через импорт.                         |
|      |       |              |                                       |
|      |       |              | В таблицу 98 добавлен код ошибки      |
|      |       |              | ESIA-032304 \                         |
|      |       |              | при удалении УЗ через ВС без номера   |
|      |       |              | телефона                              |
+------+-------+--------------+---------------------------------------+
| 3.42 | 15.01 | Шаркова М.С. | Добавлено описание областей доступа   |
|      | .2024 |              | (scope) Реестра сведений о            |
|      |       |              | доверенностях ЕСИА: pow_reg,          |
|      |       |              | pow_reg_search, pow_reg_inf           |
|      |       |              | (Приложение Б.4)                      |
+------+-------+--------------+---------------------------------------+
| 3.43 | 19.01 | Шаркова М.С. | Скорректировано название области      |
|      | .2024 |              | доступа (scope) Реестра сведений о    |
|      |       |              | доверенностях ЕСИА: pow_reg_search    |
|      |       |              | (Приложение Б.4)                      |
+------+-------+--------------+---------------------------------------+
| 3.44 | 31.01 | Киселева     | Добавлено описание сервиса ЕСИА в     |
|      | .2024 | М.И.         | части взаимодействия с API Gateway с  |
|      |       |              | использованием OpenID Connect 1.0     |
|      |       |              | (Приложение Б.9.4).                   |
|      |       |              |                                       |
|      |       |              | Скорректировано текстовое описание    |
|      |       |              | (Приложение Б).                       |
|      |       |              |                                       |
|      |       |              | Добавлено Приложение Д «Требования по |
|      |       |              | безопасности сервисов ЕСИА,           |
|      |       |              | основанных на протоколах Oauth2.0 и   |
|      |       |              | OpenId Connect 1.0»                   |
+------+-------+--------------+---------------------------------------+
| 3.45 | 22.03 | Стрелец В.Н. | Добавлено описание ошибки             |
|      | .2024 |              | «ESIA-007036»\                        |
|      |       |              | в таблицах 93 -- 95.                  |
|      |       |              |                                       |
|      |       |              | Удален п. Б.6.2.3 «Проверка наличия   |
|      |       |              | аутентификации\                       |
|      |       |              | в фоновом режиме».                    |
|      |       |              |                                       |
|      |       |              | Удалено описание аутентификации в     |
|      |       |              | фоновом режиме\                       |
|      |       |              | в п. 3.3.                             |
|      |       |              |                                       |
|      |       |              | Добавлено Приложение «Использование   |
|      |       |              | механизма делегированной авторизации  |
|      |       |              | для получения маркера доступа»        |
+------+-------+--------------+---------------------------------------+
| 3.46 | 04.06 | Шустров Ю.М. | Приложение Д «Требования по           |
|      | .2024 |              | безопасности сервисов ЕСИА,           |
|      |       |              | основанных на протоколах Oauth2.0 и   |
|      |       |              | OpenId Connect 1.0» дополнено         |
|      |       |              | положением о необходимости размещения |
|      |       |              | СВТ системы-клиента на территории     |
|      |       |              | Российской Федерации, а также         |
|      |       |              | компенсирующими мерами для систем.    |
|      |       |              |                                       |
|      |       |              | Скорректировано Приложение В в части  |
|      |       |              | замены Сервиса регистрации            |
|      |       |              | пользователя и подтвеждения личности\ |
|      |       |              | на перечень соответствующих его       |
|      |       |              | функциям виды сведений СМЭВ3          |
+------+-------+--------------+---------------------------------------+
| 3.47 | 09.07 | Прошина А.В. | Приложение А.9 «Импорт УЗ             |
|      | .2024 |              | пользователя» расширено информацией о |
|      |       |              | направлении ЕСИА запроса\             |
|      |       |              | на формирование адреса электронной    |
|      |       |              | почты в российский почтовый сервис    |
|      |       |              | mail.ru в случае отсутствия контакта  |
|      |       |              | данного типа у                        |
|      |       |              | регистрируемой/подтверждаемой/        |
|      |       |              | переподтверждаемой УЗ                 |
+------+-------+--------------+---------------------------------------+
| 3.48 | 07.10 | Шипилова     | В Приложении Б.4 добавлена информация |
|      | .2024 | А.А.         | о данных документа, удостоверяющего   |
|      |       |              | личность ребенка (таблица 97)         |
+------+-------+--------------+---------------------------------------+

# Обозначения и сокращения {#обозначения-и-сокращения .unnumbered}

  -----------------------------------------------------------------------
  **Обозначение /        **Полное наименование / описание**
  сокращение**           
  ---------------------- ------------------------------------------------
  БГИР                   Базовый государственный информационный ресурс

  БИК                    Банковский идентификационный код

  ВИС                    Внешняя информационная система

  ЕГР ЗАГС               Единый государственный реестр записей актов
                         гражданского состояния

  ЕГРИП                  Единый государственный реестр индивидуальных
                         предпринимателей

  ЕГРЮЛ                  Единый государственный реестр юридических лиц

  ЕНВД                   Единый налог на вмененный доход

  ЕПГУ                   Федеральная государственная информационная
                         система «Единый портал государственных и
                         муниципальных услуг (функций)»

  ЕСИА                   Федеральная государственная информационная
                         система «Единая система идентификации и
                         аутентификации в инфраструктуре, обеспечивающей
                         информационно-технологическое взаимодействие
                         информационных систем, используемых для
                         предоставления государственных и муниципальных
                         услуг в электронной форме»

  ЕСКС (Единая система   Справочный интернет-ресурс, доступный по адресу
  контекстных справок)   https://info.gosuslugi.ru/

  ЗСПД                   Защищенная сеть передачи данных

  ИНН                    Идентификационный номер налогоплательщика

  ИП                     Индивидуальный предприниматель

  ИС                     Информационная система

  ИЭП (Инфраструктура    Инфраструктура, обеспечивающая
  электронного           информационно-технологическое взаимодействие
  правительства)         информационных систем при предоставлении
                         государственных и муниципальных услуг,
                         исполнении государственных и муниципальных
                         функций в электронной форме, а также в иных
                         случаях, предусмотренных федеральными законами,
                         актами Президента Российской Федерации и
                         Правительства Российской Федерации, решениями
                         президиума Правительственной комиссии по
                         цифровому развитию, использованию информационных
                         технологий для улучшения качества жизни и
                         условий ведения предпринимательской деятельности

  КГРКО                  Книга государственной регистрации кредитных
                         организаций

  КПП                    Код причины постановки

  КЭП                    Усиленная квалифицированная электронная подпись

  МСП                    Малое и среднее предпринимательство

  МЧД                    Доверенность в электронной форме в
                         машиночитаемом виде (машиночитаемая
                         доверенность, электронная машиночитаемая
                         доверенность)

  НДС                    Налог на добавленную стоимость

  Область доступа        Тип данных, к которым система-клиент намерена
  (scope)                получить доступ). Перечень актуальных и
                         устаревших областей доступа приведен в настоящем
                         документе
                         (<https://digital.gov.ru/ru/documents/6186/>)

  ОГВ                    Орган государственной власти. Федеральные органы
                         исполнительной власти, государственные
                         внебюджетные фонды, органы исполнительной власти
                         субъектов Российской Федерации, органы местного
                         самоуправления, государственные и муниципальные
                         учреждения, многофункциональных центров
                         предоставления государственных и муниципальных
                         услуг, а также иные организации, определенные
                         федеральными законами, актами Президента
                         Российской Федерации и актами Правительства
                         Российской Федерации

  ОГРН                   Основной государственный регистрационный номер

  ОГРНИП                 Основной государственный регистрационный номер
                         индивидуального предпринимателя

  ОКСМ                   Общероссийский классификатор стран мира

  ОКТМО                  Общероссийский классификатор территорий
                         муниципальных образований

  ОПФ                    Организационно-правовая форма

  ПАО                    Публичное акционерное общество

  ПЭП                    Простая электронная подпись

  Реестр ЕСИА            Реестр сведений о доверенностях ЕСИА

  СВТ                    Средства вычислительной техники

  СМС (Служба мобильных  Технология, позволяющая осуществлять прием и
  сообщений или          передачу коротких текстовых сообщений с помощью
  сокращение\            устройства сотовой связи
  от англ. Short Message 
  Service, служба        
  коротких сообщений)    

  СМЭВ                   Федеральная государственная информационная
                         система «Единая система межведомственного
                         электронного взаимодействия»

  СНИЛС                  Страховой номер индивидуального лицевого счета
                         застрахованного лица в системе
                         персонифицированного учета Социального фонда
                         Российской Федерации

  СФР                    Социальный фонд Российской Федерации

  Технологический портал Специализированное веб-приложение, размещенное
  ЕСИА                   по адресу:
                         <https://esia.gosuslugi.ru/console/tech>.
                         Предназначено, в частности,\
                         для управления ИС организаций

  ТС                     Транспортное средство

  УЗ                     Учетная запись

  УСН                    Упрощенная система налогообложения

  ФИАС                   Федеральная информационная адресная система

  ФИО                    Фамилия, имя, отчество

  ФЛ                     Физическое лицо

  ЦО (Центр              Центр обслуживания органа или организации,
  обслуживания)          имеющей право создания (замены) и выдачи ключа
                         ПЭП. В Центре обслуживания специалистами
                         осуществляется регистрация и/или подтверждение
                         личности пользователей ЕСИА

  ЭП                     Электронная подпись

  ЮЛ                     Юридическое лицо

  API (Application       Набор готовых классов, процедур, функций,
  Programming Interface, структур и констант, предоставляемых приложением
  программный интерфейс  (библиотекой, сервисом)\
  приложения, интерфейс  или операционной системой для использования во
  прикладного            внешних программных продуктах
  программирования)      

  ACF (Authorization     Модель контроля доступа на основе
  Сode Аlow, Модель      делегированного принятия решения 
  контроля доступа)      

  HTTPS (HyperText       Расширение протокола HTTP для поддержки
  Transfer Protocol      шифрования в целях повышения безопасности.
  Secure)                Данные в протоколе HTTPS передаются поверх
                         криптографических протоколов SSL или TLS. В
                         отличие от HTTP с TCP--портом 80, для HTTPS по
                         умолчанию используется TCP-порт 443

  JSON (JavaScript       Текстовый формат обмена данными, основанный на
  Object Notation)       JavaScript

  OAuth2.0               Открытый протокол авторизации, который позволяет
                         предоставить третьей стороне ограниченный доступ
                         к защищенным ресурсам пользователя без
                         необходимости передавать данной третьей стороне
                         логин и пароль

  REST (Representational Архитектурный стиль взаимодействия компонентов
  State Transfer,        распределенного приложения в сети. REST
  передача               представляет собой согласованный набор
  репрезентативного      ограничений, учитываемых при проектировании
  состояния)             распределенной гипермедиа-системы. То есть REST
                         -- это набор принципов\
                         и ограничений взаимодействия клиента и сервера в
                         сети Интернет, использующий существующие
                         стандарты (протокол HTTP, стандарт построения
                         URL, форматы данных JSON и XML) в ходе
                         взаимодействия

  SAML (Security         Открытый стандарт обмена данными аутентификации
  Assertion Markup       и авторизации между участниками, в частности,
  Language, язык         между поставщиком учетных записей (identity
  разметки декларации    provider) и поставщиком сервиса
  безопасности)          

  URL (Uniform Resource  Стандартизированный способ записи адреса ресурса
  Locator, единый        в сети Интернет
  указатель ресурса)     

  XML (eXtensible Markup Язык для создания структурированных
  Language, расширяемый  машиночитаемых документов
  язык разметки)         
  -----------------------------------------------------------------------

# Термины и определения {#термины-и-определения ._Заг1_безНом .unnumbered}

  -----------------------------------------------------------------------
  **Термин**           **Определение**
  -------------------- --------------------------------------------------
  Администратор        Уполномоченное должностное лицо заявителя, которое
  профиля              является пользователем ЕСИА и обладает
  государственной      полномочиями по ведению профиля государственной
  организации          организации в ЕСИА

  Аутентификация       Процедура идентификации и установления подлинности
                       источника информации

  Внешний маркер       Маркер доступа (токен), выдаваемый внешней ИС,
  доступа              который формируется\
                       в выделенном экземпляре сервиса OAuth ЕСИА. Не
                       предоставляет доступ\
                       к вызову методов ИЭП, кроме вызова API Gateway.
                       Единственный токен, передающийся внешней ИС

  Внешняя ИС           Информационная система коммерческой организации,
                       взаимодействующая\
                       с сервисами ИЭП через шлюзовой модуль ЕПГУ

  Внутренний маркер    Маркер доступа (токен), выдаваемый API Gateway в
  доступа              результате обмена\
                       на внешний маркер доступа. Предоставляет ИС API
                       Gateway доступ\
                       к вызову методов ИЭП от имени внешней ИС

  Маркер доступа       Программный объект, описывающий контекст
                       безопасности процесса\
                       или потока OAuth2.0, содержащий сведения по
                       безопасности сеанса, идентификации пользователя,
                       который выдается системе-клиенту для получения
                       доступа к запрашиваемому ресурсу

  Маркер идентификации Необходим для проведения идентификации и
                       аутентификации пользователя. Содержит
                       идентификационные данные пользователя, а также ряд
                       служебных параметров (дату выдачи, время окончания
                       срока действия и пр.)

  Оператор выдачи      Орган или организация, обладающая правом создания
  ключа ПЭП            (замены) ключа ПЭП в соответствии с постановлением
                       Правительства Российской Федерации\
                       от 25 января 2013 г. № 33 «Об использовании
                       простой электронной подписи при оказании
                       государственных и муниципальных услуг»

  Оператор ЕСИА        Министерство цифрового развития, связи и массовых
                       коммуникаций Российской Федерации

  Оператор ИС          Орган, организация или лицо, ИС которых
                       зарегистрирована\
                       или регистрируется в регистре информационных
                       систем ЕСИА

  Пользователь ЕСИА    Пользователь информационно--телекоммуникационной
                       сети Интернет, зарегистрированный в ЕСИА в
                       качестве физического лица. Может иметь роли
                       индивидуального предпринимателя, сотрудника
                       юридического лица, должностного лица ОГВ

  Поставщик услуг      ИС, интегрированная с ЕСИА и осуществляющая
                       предоставление пользователям ЕСИА данных и услуг,
                       в частности, государственных и муниципальных услуг
                       в электронной форме

  Регламент            Регламент взаимодействия участников
                       информационного взаимодействия\
                       с оператором ЕСИА и оператором инфраструктуры
                       электронного правительства при организации
                       информационно--технологического взаимодействия
                       информационных систем с использованием ЕСИА:
                       <https://digital.gov.ru/ru/documents/4244/>

  Специалист Центра    Сотрудник Оператора выдачи ключа ПЭП,
  обслуживания         осуществляющий подтверждение личности
                       пользователей ЕСИА

  Цифровой профиль     Инфраструктура, функционирующая в рамках ЕСИА,
  (ЦП)                 обеспечивающая доступ физических лиц, юридических
                       лиц, индивидуальных предпринимателей к имеющимся в
                       распоряжении государственных органов и органов
                       местного самоуправления сведениям и документам,
                       используемым для предоставления государственных и
                       муниципальных услуг, исполнения государственных и
                       муниципальных функций,\
                       и к сведениям, сформированным в результате их
                       оказания и исполнения и содержащимся в
                       государственных и муниципальных информационных
                       системах, а также доступ организаций к необходимым
                       сведениям о физическом лице, юридическом лице,
                       индивидуальном предпринимателе

  Шлюзовой модуль      Компонент, обеспечивающий взаимодействие ИС
  ЕПГУ,\               коммерческой организации с ЕСИА и ЕПГУ
  API Gateway          
  -----------------------------------------------------------------------

# Введение

Переход к оказанию государственных и муниципальных услуг в электронном
виде требует от государства предоставить гражданам и органам
государственной власти возможность безопасно идентифицировать друг друга
онлайн. Когда граждане и органы государственной власти могут доверять
результатам идентификации друг друга, они могут предоставлять и
потреблять услуги, чего нельзя было бы достичь в другом случае\
из-за большой сложности или важности услуг.

В текущей онлайн среде от граждан требуется ведение десятков различных
имен пользователей и паролей -- по одной паре для каждого вебсайта, с
которым пользователь взаимодействует. Сложность такого подхода является
сложностью для граждан\
и потворствует такому поведению, как повторное использование паролей,
что упрощает онлайн мошенничества и нарушение идентификации. В то же
время органы государственной власти сталкиваются с постоянно
возрастающими затратами\
на управление УЗ пользователей, последствиями онлайн мошенничеств\
и неэффективностью электронных услуг в результате нежелания
потенциальными пользователями проходить регистрацию еще одной УЗ.

Созданная Минцифры России ФГИС ЕСИА:

1)  Предоставляет использующим ее ИС органов государственной власти и ИС
    коммерческих организаций решение по достоверной идентификации
    пользователей (коммерческих огранизаций и ОГВ), достигнутой
    благодаря:

    регистрации лица в ЕСИА с проверкой значимых\
    для удостоверения личности критериев;

    обеспечиваемой ЕСИА защиту размещенной в ней информации\
    в соответствии с законодательством Российской Федерации.

2)  Ориентированности на пользователя -- предоставляет ему возможности:

    идентификации и аутентификации с использованием единой УЗ и широкого
    спектра поддерживаемых методов аутентификации при доступе
    к различным ИС;

    управления своими персональными данными, размещенными в ЕСИА,\
    и контроля над их предоставлением в ИС.

## Назначение документа

Настоящий документ:

1)  описывает базовые сценарии использования ЕСИА:

    идентификация и аутентификация пользователей при доступе к ИС\
    (раздел 3);

    ведение идентификационных данных и полномочий пользователей\
    (раздел 4);

    получение ИС данных из регистров, хранимых в ЕСИА (раздел 4);

```{=html}
<!-- -->
```
3)  поясняет порядок ведения в ЕСИА регистров (справочников),
    необходимых для реализации базовых сценариев использования ЕСИА:

    регистр физических лиц;

    регистр юридических лиц и должностных лиц юридических лиц;

    регистр ОГВ и должностных лиц ОГВ;

    регистр ИС;

4)  предоставляет методические рекомендации по интеграции ИС с ЕСИА\
    и обеспечению соответствия положениям нормативно--правовых актов в
    части использования ЕСИА.

## Нормативные ссылки

Настоящий документ разработан в целях реализации и во исполнение
следующих нормативно--правовых актов:

Федеральный закон от 27 июля 2010 г. № 210-ФЗ «Об организации
предоставления государственных и муниципальных услуг»;

Федеральный закон от 6 апреля 2011 г. № 63-ФЗ «Об электронной подписи»;

Государственная программа Российской Федерации «Информационное общество,
утвержденная постановлением Правительства Российской Федерации
от 15 апреля 2014 г. № 313;

Постановление Правительства Российской Федерации от 28 ноября 2011 г.
№ 977 «О федеральной государственной информационной системе «Единая
система идентификации и аутентификации в инфраструктуре, обеспечивающей
информационно--технологическое взаимодействие информационных систем,
используемых для предоставления государственных и муниципальных услуг
в электронной форме»;

Постановление Правительства Российской Федерации от 9 февраля 2012 г.
№ 111 «Об электронной подписи, используемой органами исполнительной
власти и органами местного самоуправления при организации электронного
взаимодействия между собой, о порядке ее использования, а также\
об установлении требований к обеспечению совместимости средств
электронной подписи»;

Постановление Правительства Российской Федерации от 25 января 2013 г.
№ 33 «Об использовании простой электронной подписи при оказании
государственных и муниципальных услуг»;

Постановление Правительства Российской Федерации от 10 июля 2013 г.
№ 584 «Об использовании федеральной государственной информационной
системы «Единая система идентификации и аутентификации\
в инфраструктуре, обеспечивающей информационно--технологическое
взаимодействие информационных систем, используемых для предоставления
государственных и муниципальных услуг в электронной форме»;

Постановление Правительства Российской Федерации от 8 июня 2011 г. № 451
«Об инфраструктуре, обеспечивающей информационно--технологическое
взаимодействие информационных систем, используемых для предоставления
государственных и муниципальных услуг в электронной форме»;

Приказ Минкомсвязи России от 13 апреля 2012 г. № 107 «О федеральной
государственной информационной системе «Единая система идентификации
и аутентификации в инфраструктуре, обеспечивающей
информационно--технологическое взаимодействие информационных систем,
используемых для предоставления государственных и муниципальных услуг в
электронной форме».

# Общее описание ЕСИА

В соответствии с Постановлением Правительства Российской Федерации\
от 28 ноября 2011 г. № 977 ЕСИА должна обеспечивать санкционированный
доступ участников информационного взаимодействия (заявителей и
должностных лиц ОГВ)\
к информации, содержащейся в ГИС, муниципальных ИС и иных ИС.

При этом ЕСИА не обеспечивает выполнение процессов идентификации,
аутентификации и авторизации участников межведомственного
взаимодействия, возникающих в процессе использования СМЭВ, в частности,
при взаимодействии ИС\
с использованием СМЭВ.

Основные функциональные возможности ЕСИА:

1)  Идентификация и аутентификация пользователей, в том числе:

    однократная аутентификация[^1], которая дает пользователям ЕСИА
    следующее преимущество: пройдя процедуру идентификации\
    и аутентификации в ЕСИА, пользователь может в течение одного сеанса
    работы обращаться к любым ИС, использующим ЕСИА, при этом повторная
    идентификация и аутентификация не требуется;

    поддержка различных методов аутентификации: по паролю,\
    по электронной подписи, по QR-коду, а также двухфакторная
    аутентификация (по постоянному паролю и одноразовому паролю,
    высылаемому в виде СМС-сообщения, с использованием одноразового кода
    (TOTP) или биометрии);

    поддержка уровней достоверности идентификации пользователя
    (упрощенная УЗ, стандартная УЗ, подтвержденная УЗ);

2)  ведение идентификационных данных[^2], а именно -- ведение регистров
    ФЛ, ЮЛ, органов и организаций, должностных лиц органов и организаций
    и ИС;

3)  авторизация уполномоченных лиц при доступе к следующим функциям
    ЕСИА:

    ведение регистра должностных лиц в ЕСИА;

    ведение справочника полномочий в отношении ИС и предоставление
    пользователям ЕСИА (зарегистрированным в ЕСИА как должностные лица)
    полномочий по доступу к ресурсам ИС, зарегистрированным ЕСИА;

    делегирование вышеуказанных полномочий уполномоченным лицам
    нижестоящих организаций;

4)  ведение и предоставление информации о полномочиях пользователей\
    в отношении ИС, зарегистрированных в ЕСИА.

Обращение участников информационного взаимодействия к ЕСИА должно
происходить только по протоколу HTTPS (использовать протокол HTTP
запрещено)\
и только с использованием протокола защиты TLS версии 1.2.

# Аутентификация пользователей через ЕСИА

Разработчики государственных сайтов, порталов и прочих мобильных или
веб-приложений могут предоставить своим пользователям возможность
входить в систему, используя УЗ ЕСИА. Это избавляет разработчиков от
необходимости делать собственное хранилище УЗ, обеспечивать безопасность
хранения паролей, разрабатывать механизмы регистрации, аутентификации
пользователей, поддерживать их в рабочем состоянии.

Под пользователями ЕСИА понимаются следующие категории участников
информационного взаимодействия:

-   ФЛ, имеющие УЗ в регистре физических лиц ЕСИА;

-   ИП, т.е. ФЛ, имеющие признак ИП;

-   должностные лица ЮЛ, т.е. ФЛ, присоединенные к УЗ ЮЛ ЕСИА;

-   должностные лица органов и организаций, т.е. ФЛ, присоединенные к УЗ
    ОГВ.

Пользователи получают возможность однократной аутентификации. Это
означает, что пройдя процедуру аутентификации в ЕСИА, пользователь может
в течение одного сеанса работы войти в несколько систем, и при этом
повторно вводить логин и пароль\
не потребуется.

С целью обеспечения указанной функциональности в ЕСИА реализован
механизм, основанный на модели OpenID Connect 1.0.

**Аутентификация с использованием модели OpenID Connect**

В ЕСИА создан механизм аутентификации пользователей, основанный\
на спецификациях протокола авторизации OAuth 2.0 и расширении OpenID
Connect 1.0.

Протокол определяет взаимодействие следующих сторон:

-   владелец ресурса (resource owner) -- сущность, которая может
    предоставить доступ к защищаемому ресурсу (например, ФЛ, заявитель);

-   система-клиент (client) -- приложение, которое запрашивает доступ\
    к защищаемому ресурсу от имени его владельца;

-   сервис авторизации (authorization server) -- сервис, который
    выпускает\
    для системы-клиента маркеры идентификации с разрешениями от
    владельца ресурса, а также маркеры доступа, позволяющие получать
    доступ к данным;

-   поставщик ресурса (resource server) -- сервис, обеспечивающий
    доступ\
    к защищаемому ресурсу на основе проверки маркеров идентификации\
    и маркеров доступа (например, к идентификационным данным
    пользователя).

Расширение OpenID Connect 1.0 предполагает использование маркера
идентификации (ID Token) в целях проведения идентификации и
аутентификации пользователя. Маркер идентификации содержит
идентификационные данные пользователя, а также ряд служебных параметров
(дата выдачи, время окончания срока действия и пр.).

Для иллюстрации использования OpenID Connect 1.0 в ЕСИА принята
следующая терминология:

-   владелец ресурса -- это пользователь;

-   система-клиент -- это ИС, интегрированная с ЕСИА с целью
    идентификации и аутентификации, например, региональный портал услуг;

-   сервис авторизации и поставщик ресурса -- это ЕСИА.

Общая схема подключения системы к ЕСИА для проведения аутентификации
представлена на рисунке 1.

![](media/image1.emf)

Рисунок 1 -- Схема подключения системы к ЕСИА

## Как обеспечить вход пользователей через ЕСИА

Для предоставления пользователям вашей системы возможности входа через
ЕСИА, используя тот или иной механизм, со стороны подключающейся системы
необходимо обеспечить:

-   Регистрацию ИС в регистре ИС ЕСИА (в соответствии с
    Регламентом[^3]).

-   Регистрацию системы с целью идентификации и аутентификации в
    тестовой среде в соответствии с Регламентом[^4]. Исполнение этого
    процесса предоставляет возможность участнику производить
    взаимодействие с ЕСИА\
    в тестовой среде.

-   Выполнение доработки интегрируемой системы с целью обеспечения
    поддержки выбранного механизма идентификации и аутентификации.

-   Подключение продуктивной версии интегрируемой системы к продуктивной
    среде ЕСИА в соответствии с Регламентом[^5].

Далее каждый из шагов рассмотрен подробнее.

### Аутентификация с использованием OpenID Connect 1.0

**1 шаг: зарегистрировать ИС**

Регистрация ИС осуществляется согласно Регламенту (раздел 6).

При использовании способа аутентификации, основанного на протоколе
авторизации OAuth 2.0 и расширении OpenID Connect, не требуется
формирование метаданных.

**2 шаг: доработать систему**

Рекомендуемая последовательность действий:

1)  Выпустить ключевой контейнер и сертификат ключа квалифицированной
    электронной подписи для подключаемой ИС (должен содержать ОГРН ЮЛ,
    являющегося оператором ИС).

2)  Сертификат требуется для идентификации ИС при взаимодействии с ЕСИА.
    ЕСИА использует сертификаты в формате X.509 и криптографические
    алгоритмы ГОСТ Р 34.10-2012 для формирования электронной подписи и\
    ГОСТ Р 34.11-2012 для хэширования.

3)  Сертификаты тестовой и продуктивной сред ЕСИА, используемые\
    для формирования электронных подписей ответов как поставщика,
    доступны по ссылке: <https://esia.gosuslugi.ru/public/esia.zip>.

4)  Реализовать интерфейсы системы-клиента REST-сервисов ЕСИА и модели
    контроля доступа, основанной на OAuth 2.0. Детальная информация
    содержится в Приложениях Приложение А и Приложение Б.

5)  Доработать дизайн сайта, выбрав место для размещения кнопки
    авторизации через Госуслуги[^6], и реализовать в системе логику
    запроса данных\
    о пользователях, получаемых с помощью программного интерфейса ЕСИА.
    Недопустимо отображать страницу аутентификации ЕСИА во фрейме сайта.

6)  Обеспечить в соответствии с требованиями законодательства Российской
    Федерации комплекс мер, необходимых для обеспечения информационной
    безопасности и защиты персональных данных пользователей, получаемых
    ИС в процессе ее взаимодействия с системой ЕСИА (см. Приложение Д).

7)  Синхронизировать системное время сервера, на котором установлен
    поставщик услуг, со значением точного времени. Расхождение более
    чем\
    в минуту может приводить к возникновению ошибок при взаимодействии
    поставщика услуг с поставщиком идентификации ЕСИА.

8)  Осуществить подключение ИС к тестовой среде и отладить
    взаимодействие\
    с ЕСИА в тестовой среде.

**3 шаг: ввести доработку в эксплуатацию**

1)  Осуществить подключение ИС к промышленной версии ЕСИА в
    соответствии\
    с Регламентом[^7].

2)  После подключения ИС к промышленной версии ЕСИА проверить
    взаимодействие промышленной версии ЕСИА с промышленной версией вашей
    системы.

## Рекомендуемый сценарий аутентификации при интеграции по OpenID Connect 1.0

**Базовый сценарий аутентификации**

Базовым сценарием аутентификации при использовании OpenID Connect 1.0
является сценарий аутентификации ФЛ (например, заявителя).

Сценарий включает следующие шаги (рисунок 2):

1)  Пользователь нажимает на веб-странице (или в мобильном приложении)
    системы-клиента кнопку авторизации через Госуслуги.

2)  Система-клиент формирует и отправляет в ЕСИА запрос на
    аутентификацию и перенаправляет браузер пользователя на специальную
    страницу предоставления доступа.

3)  ЕСИА осуществляет аутентификацию пользователя одним из доступных
    способов. Если пользователь еще не зарегистрирован в ЕСИА, то он
    может перейти к процессу регистрации.

4)  Когда пользователь аутентифицирован, ЕСИА сообщает пользователю,\
    что система-клиент запрашивает данные о нем в целях проведения
    идентификации и аутентификации, предоставляя перечень запрашиваемых
    системой-клиентом сведений.

5)  Если пользователь дает разрешение на проведение аутентификации
    системой-клиентом, то ЕСИА выдает системе-клиенту специальный
    авторизационный код.

6)  Система-клиент формирует в адрес ЕСИА запрос на получение маркера
    идентификации, включая в запрос полученный ранее авторизационный
    код.

7)  ЕСИА проверяет корректность запроса (например, что система-клиент
    зарегистрирована в ЕСИА) и авторизационного кода и передает
    системе-клиенту маркер идентификации.

8)  Система-клиент извлекает идентификатор пользователя из маркера
    идентификации. Если идентификатор получен, а маркер проверен, то
    система-клиент считает пользователя аутентифицированным.

После получения маркера идентификации система-клиент использует
REST-сервисы ЕСИА для получения дополнительных данных о пользователе,
предварительно получив соответствующий маркер доступа (см. Приложения
Приложение А\
и Приложение Б).

![](media/image2.png){width="6.278472222222222in"
height="4.851388888888889in"}

Рисунок 2 -- Идентификация и аутентификация пользователей\
при использовании механизма OpenID Connect 1.0

**Дополнительный сценарий аутентификации пользователя в качестве
представителя организации**

ЕСИА также позволяет аутентифицировать пользователя в качестве
представителя организации, для этого ИС должна:

-   запросить у ЕСИА не только маркер идентификации, но и маркер
    доступа\
    (на получение данных пользователя);

-   с использованием маркера доступа и программного интерфейса ЕСИА,
    основанного на REST, получить информацию о том, сотрудником каких
    организаций является пользователь;

-   запросить у пользователя, от имени какой организации он будет
    работать\
    в данной ИС (если пользователь является сотрудником нескольких
    организаций).

При необходимости ИС также может проверять, включен ли пользователь\
в необходимые системные группы ЮЛ, является ли он руководителем
организации.

Необходимо помнить, что выбор организации, от имени которой будет
работать пользователь в ИС, должен происходить на стороне самой ИС с
использованием ее средств.

**Сценарий с установкой локальной сессии**

После прохождения пользователем аутентификации ЕСИА устанавливает
пользовательскую сессию, продолжительность которой составляет 3 часа.
Факт начала сессии записывается в файле cookie, который хранится на
устройстве пользователя.

Система может установить для пользователя свою «локальную» сессию.
Рекомендуемая продолжительность сессии -- от 15 минут до 3 часов. При
завершении «локальной» сессии система должна направлять в ЕСИА новый
запрос на аутентификацию.

**Сценарий с авторизацией пользователя**

ЕСИА обладает функциональностью по предоставлению системе-клиенту
информации, на основании которой возможно проведение авторизации
аутентифицированного пользователя. Решение об авторизации пользователя
принимает система, в которой пользователь авторизуется.

Для получения авторизационных данных следует использовать программный
интерфейс, основанный на архитектурном стиле REST (см. п. 4.3 и
Приложение Приложение А). В этом случае помимо маркера идентификации
система должна также запросить маркер доступа к необходимым
авторизационным данным.

Получив маркер доступа, ИС может получить данные о пользователе и на их
основе принять решение о предоставлении доступа пользователю к своим
ресурсам.

## Требования к визуальному оформлению входа посредством ЕСИА

При использовании ЕСИА для идентификации и аутентификации пользователей,
а также для их регистрации, варианты размещения кнопок для входа могут
различаться в зависимости от сценария использования ЕСИА:

-   аутентификация исключительно посредством ЕСИА;

-   аутентификация посредством ЕСИА в качестве одного из возможных
    вариантов аутентификации;

-   аутентификация и выбор пользовательской роли посредством ЕСИА.

Независимо от выбранного сценария при оформлении входа\
в систему с использованием ЕСИА не рекомендуется использовать слова
«аутентификация» или «авторизация», вместо этого следует использовать
слово «вход».

### Аутентификация исключительно посредством ЕСИА

Если системой используется аутентификация посредством ЕСИА в качестве
единственного способа аутентификации, то в общем случае рекомендуется
размещать кнопку «Вход» в верхней правой части («в шапке»)
соответствующей страницы.

При нажатии на кнопку «Вход» должно происходить перенаправление
пользователя на страницу аутентификации ЕСИА в соответствии с
применяемым сценарием аутентификации.

### Аутентификация посредством ЕСИА в качестве одного из возможных вариантов аутентификации

Если системой используется аутентификация посредством ЕСИА в качестве
одного из возможных способов аутентификации, то рекомендуется размещать
ссылку или кнопку авторизации через Госуслуги в шапке соответствующего
сайта, расположив ее рядом со ссылкой (кнопкой), позволяющей войти в
систему при помощи альтернативного провайдера аутентификации.

## Аутентификация посредством ЕСИА с обязательным использованием второго фактора

При использовании ЕСИА для идентификации и аутентификации
пользователей с обязательным использованием второго фактора используется
указание области доступа (scope) otp в запросе на получение
авторизационного кода и маркера доступа (подробнее о запросе приведено в
п. Б.2.4).

Информация о прохождении второго фактора пользователем хранится в
маркере идентификации в claims в следущем формате:

\"acr\": {

\"2fa\": \"otp\"

}

Подробная информация о маркере идентификации представлена в п. Б.7.

Получение доступа к области доступа (scope) otp осуществляся в
соответствии с Регламентом.

## Возврат пользователя в систему, вызвавшую профиль пользователя в ЕСИА или регистрацию пользователя в ЕСИА

Если ИС вызывает ЕСИА для проведения идентификации и аутентификации
пользователя, то пользователь будет возвращен в систему сразу после
проведения аутентификации. В то же время ИС может направить пользователя
в ЕСИА со следующими целями:

-   изменение данных в личном профиле (например, прохождение процедуры
    проверки данных пользователя);

-   прохождение процедуры регистрации.

**Возврат пользователей в систему, вызвавшую регистрацию в ЕСИА**

После прохождения процедуры регистрации пользователь автоматически будет
возвращен в ИС. Для возврата в ИС до окончания процедуры регистрации в
ЕСИА пользователю необходимо воспользоваться стандартными средствами
навигации браузера.

Чтобы ЕСИА вернула пользователя в систему после выполнения указанной
операции, ИС при перенаправлении пользователя должна передать корректный
контекст возврата. Контекст возврата определяется следующими
параметрами:

-   \<cid\> -- мнемоника ИС, перенаправившей пользователя в ЕСИА;

-   \<rurl\> -- адрес, на который должен быть возвращен пользователь
    после совершения необходимых действий (этот адрес должен включать в
    себя URL системы, указанный в Технологическом портале);

-   \<imm\> -- признак, позволяющий определить необходимость возврата в
    систему после регистрации упрощенной УЗ (при вызове страницы
    регистрации ЕСИА); возврат после регистрации упрощенной УЗ будет
    произведен только при передаче признака со значением «true».

Пример ссылки с корректным контекстом возврата для процедуры
регистрации:

https://esia-portal1.test.gosuslugi.ru/registration?cid=TESTSYS&rurl=https://test.ru&imm=true.

**Возврат пользователя в систему, вызвавшую профиль пользователя ЕСИА**

В веб-приложении «Профиль пользователя ЕСИА» в течение действия
пользовательской сессии браузера пользователю предоставляется
возможность перейти обратно в вызвавшую ЕСИА систему посредством нажатия
на кнопку «Вернуться назад».

Чтобы ЕСИА вернула пользователя в систему после выполнения указанной
операции, ИС при перенаправлении пользователя должна передать корректный
контекст возврата. Контекст возврата определяется следующими
параметрами:

-   \<cid\> -- мнемоника ИС, перенаправившей пользователя в ЕСИА;

-   \<rurl\> -- адрес, на который должен быть возвращен пользователь
    после совершения необходимых действий (этот адрес должен включать в
    себя URL системы, указанный на Технологическом портале).

Пример ссылки с корректным контекстом возврата:

https://esia-portal1.test.gosuslugi.ru/profile/user?cid=TESTSYS&rurl=https://test.ru.

Следует помнить, что после закрытия пользователем браузера контекст
возврата не будет сохранен.

# Ведение регистров ЕСИА

Процессы и механизмы ведения данных регистров ЕСИА имеют свою специфику
в зависимости от регистра и типа пользователя. Перечень механизмов и
процессов приведен в таблице 1.

Таблица 1 -- Основные механизмы ведения регистров ЕСИА

  --------------------------------------------------------------------------
  Процесс       Регистр      Механизм                        Ссылка на
                                                             раздел
                                                             документа
  ------------- ------------ ------------------------------- ---------------
  Регистрация   Регистр ФЛ   Веб-интерфейс                   4.1.1

                             Программный интерфейс,          Б.9
                             доступный через СМЭВ            

                Регистр ЮЛ   Веб-интерфейс                   4.1.2

                Регистр ОГВ  Веб-интерфейс                   4.1.3

                Регистр ИС   Веб-интерфейс                   4.1.4, 4.1.5

  Управление    Регистр ФЛ   Веб-интерфейс                   4.2.1
  данными                                                    

                Регистр ЮЛ   Веб-интерфейс                   4.2.2

                             Программный интерфейс на основе Приложение А
                             REST                            

                Регистр ОГВ  Веб-интерфейс                   4.2.3

                             Программный интерфейс на основе Приложение А
                             REST                            

                Регистр ИС   Веб-интерфейс                   4.2.4

  Получение     Регистр ФЛ   Программный интерфейс на основе 4.3, Приложение
  данных                     REST                            А

                Регистр ЮЛ   Программный интерфейс на основе 4.3, Приложение
                             REST                            А

                Регистр ОГВ  Программный интерфейс на основе 4.3, Приложение
                             REST                            А

                Регистр ИС   Программный интерфейс на основе 4.3, Приложение
                             REST                            А
  --------------------------------------------------------------------------

## Регистрация

### Регистрация физических лиц и получение ролей

В ЕСИА предусмотрены следующие роли пользователей:

-   ФЛ, имеющие УЗ в регистре ФЛ ЕСИА;

-   ИП, т.е. ФЛ, имеющие признак ИП;

-   должностные лица ЮЛ, т.е. ФЛ, присоединенные в ЕСИА к УЗ ЮЛ ЕСИА;

-   должностные лица органов и организаций, т.е. ФЛ, присоединенные в
    ЕСИА к учетным записям ОГВ.

Наличие у пользователя роли позволяет ИС, взаимодействующим с ЕСИА,
использовать эту информацию для выполнения собственных процессов
(например, для авторизации).

Пользователи могут иметь в ЕСИА одну или несколько ролей. Базовой
является роль ФЛ: чтобы получить одну из указанных ролей, пользователь
должен быть первоначально зарегистрирован в качестве ФЛ.

В ЕСИА предусмотрены учетные записи ФЛ следующих типов, каждый из
которых соответствует определенному уровню идентификации пользователя:

-   упрощенная (непроверенная) УЗ (содержит минимальный набор данных
    о пользователе);

-   стандартная (проверенная) УЗ (данные о пользователе проверены в
    БГИР);

-   подтвержденная учетная запись (данные о пользователе проверены в
    БГИР, а личность пользователя -- ФЛ подтверждена одним из доступных
    способов подтверждения).

Возможны следующие способы подтверждения УЗ:

-   oнлайн в ЛК:

-   через банк, если Вы являетесь клиентом банка-партнера;

-   с помощью КЭП;

-   лично обратиться в Центр обслуживания;

-   заказным письмом через Почту России.

Схема связей между ролями и типами УЗ ФЛ отображена на рисунке 3.

![](media/image3.emf)

Рисунок 3 -- Типы учетных записей и роли пользователя в ЕСИА

#### Регистрация УЗ ФЛ

Регистрация УЗ ФЛ возможна следующими способами:

1)  Самостоятельная регистрация пользователя через веб-интерфейс. В этом
    случае пользователю самостоятельно нужно пройти следующие шаги:

-   регистрация упрощенной (непроверенной) УЗ пользователя (требуется
    указать фамилию, имя, один из возможных подтвержденных каналов
    коммуникации -- мобильный телефон или адрес электронной почты);

-   перевод УЗ в состояние стандартной (проверенной) (включает в себя
    заполнение пользователем личных данных, инициирование процедуры
    проверки личных данных в БГИР и автоматическую верификацию личных
    данных в БГИР);

-   перевод УЗ в состояние подтвержденной (включает в себя подтверждение
    личности пользователя одним из доступных способов подтверждения --
    с помощью обращения в один из ЦО[^8], отправкой кода подтверждения
    личности по почте или с помощью КЭП).

2)  Регистрация пользователя в одном из ЦО, ИС которого осуществляет
    вызов операций с использованием программного интерфейса ЕСИА,
    опубликованного в СМЭВ. Детальная информация о программном
    интерфейсе ЕСИА размещена в Приложении (см. Приложение А).
    В результате регистрации в ЦО пользователь сразу получает
    подтвержденную УЗ ЕСИА.

3)  Регистрация пользователем отдельной учетной записи для ребенка через
    веб-интерфейс. Данная возможность доступна при соблюдении следующих
    условий:

-   пользователь имеет подтвержденную УЗ;

-   в личном кабинете пользователя указаны данные свидетельства
    о рождении и СНИЛС ребенка;

-   ребенок еще не достиг возраста 14 лет;

-   свидетельство о рождении и СНИЛС ребенка успешно проверены в БГИР;

-   ребенок еще не имеет своей учетной записи.

> В процессе регистрации УЗ ребенка требуется указать дополнительные
> сведения:

-   место рождения и адрес постоянной регистрации ребенка;

-   номер мобильного телефона, к которому будет привязана создаваемая УЗ
    (данный шаг можно пропустить);

-   адрес электронной почты, к которому будет привязана создаваемая УЗ.

> УЗ ребенка, зарегистрированная через ЛК родителя, имеет тип
> «упрощенная».

#### Назначение ролей

Назначение всех ролей физического лица в ЕСИА осуществляется с помощью
веб-интерфейса[^9].

Детальная информация о назначении основных ролей ФЛ представлена\
в таблице 2.

Таблица 2 -- Способы назначения ролей

+---------------------+------------------------------------------------+
| Роль                | Способ назначения роли                         |
+=====================+================================================+
| ИП                  | Самостоятельно через веб-интерфейс ЕСИА путем  |
|                     | направления заявки\                            |
|                     | с данными ИП, включающей в себя:               |
|                     |                                                |
|                     | -   ФИО;                                       |
|                     |                                                |
|                     | -   ИНН физического лица;                      |
|                     |                                                |
|                     | -   ОГРНИП.                                    |
|                     |                                                |
|                     | Заявка проходит проверку в БГИР. Если в ЕГРИП  |
|                     | действительно существует запись с указанными   |
|                     | данными, то пользователь получает роль         |
|                     | индивидуального предпринимателя                |
+---------------------+------------------------------------------------+
| Должностное лицо ЮЛ | Получение роли должностного лица ЮЛ в ЕСИА     |
|                     | происходит в результате:                       |
|                     |                                                |
|                     | -   регистрации ЮЛ в ЕСИА, в этом случае       |
|                     |     регистрирующий ЮЛ пользователь получает    |
|                     |     роль должностного лица ЮЛ с правами        |
|                     |     руководителя (см. п. 4.1.2);               |
|                     |                                                |
|                     | -   приглашения руководителем или              |
|                     |     администратором профиля ЮЛ\                |
|                     |     в ЕСИА сотрудника.                         |
|                     |                                                |
|                     | Процедура приглашения сотрудника для           |
|                     | присоединения к организации выполняется с      |
|                     | помощью веб-интерфейса ЕСИА[^10]. Включает в   |
|                     | себя следующие шаги:                           |
|                     |                                                |
|                     | -   Руководитель или администратор УЗ ЮЛ в     |
|                     |     ЕСИА формирует\                            |
|                     |     с помощью веб-интерфейса ЕСИА приглашение  |
|                     |     на присоединение\                          |
|                     |     к организации, включающее в себя:          |
|                     |                                                |
|                     | -   адрес электронной почты пользователя;      |
|                     |                                                |
|                     | -   ФИО пользователя;                          |
|                     |                                                |
|                     | -   СНИЛС пользователя (опционально).          |
|                     |                                                |
|                     | -   ЕСИА отправляет на указанный адрес         |
|                     |     электронной почты пользователя приглашение |
|                     |     со ссылкой для присоединения               |
|                     |     к организации.                             |
|                     |                                                |
|                     | -   Пользователь, имеющий подтвержденную УЗ,   |
|                     |     входит в ЕСИА\                             |
|                     |     по ссылке в приглашении. Если его ФИО и    |
|                     |     СНИЛС совпадают \                          |
|                     |     с данными в приглашении, то он             |
|                     |     присоединяется к УЗ ЮЛ. ФЛ получает роль   |
|                     |     должностного лица ЮЛ                       |
+---------------------+------------------------------------------------+
| Должностное лицо    | Получение роли должностного лица ОГВ в ЕСИА    |
| ОГВ                 | происходит в результате:                       |
|                     |                                                |
|                     | -   регистрации ОГВ в ЕСИА, в этом случае      |
|                     |     регистрирующий ОГВ пользователь получает   |
|                     |     роль должностного лица ОГВ с правами       |
|                     |     руководителя (см. п. 4.1.3);               |
|                     |                                                |
|                     | -   приглашения руководителем или              |
|                     |     администратором профиля ОГВ\               |
|                     |     в ЕСИА сотрудника.                         |
|                     |                                                |
|                     | Процедура приглашения сотрудника для           |
|                     | присоединения к ОГВ выполняется с помощью      |
|                     | веб-интерфейса ЕСИА[^11] и аналогична процессу |
|                     | присоединения сотрудника к УЗ ЮЛ               |
+---------------------+------------------------------------------------+

Один пользователь ЕСИА может одновременно являться должностным лицом
в нескольких ОГВ и ЮЛ, а также иметь роль одного индивидуального
предпринимателя.

### Регистрация ЮЛ

Регистрация ЮЛ (внесение записи в регистр ЮЛ) осуществляется с помощью
веб-интерфейса ЕСИА. Создавать УЗ ЮЛ можно только из подтвержденной
учетной записи физического лица -- руководителя организации или
представителя юридического лица, имеющего право действовать от имени
организации без доверенности.

Процедура регистрации ЮЛ из подтвержденной УЗ пользователя включает в
себя следующие шаги:

1)  Переход во вкладку «Организации» профиля пользователя и
    инициирование процедуры регистрации.

2)  Подключение средства электронной подписи. Для регистрации ЮЛ
    требуется использовать квалифицированную электронную подпись,
    выданную на имя руководителя ЮЛ или на лицо, имеющее право
    действовать от имени ЮЛ без доверенности.

3)  Заполнение формы с данными о ЮЛ и данными о руководителе
    организации. Основные поля предзаполнены, поскольку они были считаны
    из сертификата электронной подписи, дополнительно необходимо указать
    только адрес электронной почты организации.

> Если в личных данных не был указан ИНН, то следует указать ИНН
> пользователя как ФЛ (или отметить, что ИНН отсутствует).

4)  Ожидание окончания автоматической проверки данных организации\
    и руководителя организации в ФНС России. Если ошибок не возникнет,
    то ЮЛ будет зарегистрировано, т.е. будет внесена запись в регистр
    ЮЛ. Руководитель ЮЛ, осуществлявший регистрацию ЮЛ, автоматически
    получит роль должностного лица данного ЮЛ и права руководителя.

### Регистрация ОГВ

В регистр органов и организаций ЕСИА могут быть включены только
организации, подпадающие под действие Постановления Правительства
Российской Федерации от 28 ноября 2011 г. № 977.

Регистрация ОГВ осуществляется с помощью единого веб-интерфейса ЕСИА,
предусмотренного и для ЮЛ. Специфика заключается в том, что руководитель
ОГВ при регистрации в качестве типа своей организации указывает
«Государственный орган или организация», указывает свою территориальную
принадлежность и выбирает свое ведомство, подтверждающее статус
регистрирующейся организации как ОГВ.

После выполнения проверок данных организации формируется запрос в
ведомство, подтверждающее статус регистрирующейся организации как ОГВ.
Если данное ведомство подтверждает, что организация имеет статус ОГВ, то
УЗ будет присвоен этот признак, и она будет включена в регистр ОГВ. Если
не подтверждает, то организация будет иметь УЗ ЮЛ (без признака ОГВ).

### Регистрация ИС

Регистрация ИС выполняется организацией, являющейся оператором данной
ИС. Эта организация предварительно должна быть зарегистрирована в ЕСИА.

В ЕСИА должны быть зарегистрированы ИС, которые:

-   используют ЕСИА как поставщик идентификации (Identity Provider)\
    для идентификации и аутентификации пользователей;

-   используют ЕСИА в качестве поставщика ресурса (для интеграции по
    REST и OAuth 2.0);

-   осуществляют регистрацию пользователей в ЕСИА.

Для регистрации ИС можно воспользоваться функцией Технологического
портала ЕСИА[^12].

### Регистрация системных групп

Для систем, интегрированных с ЕСИА, имеется возможность проверять
наличие у пользователей специфических полномочий на доступ к этой
системе. Данная возможность обеспечивается в ЕСИА посредством механизма
системных групп (групп доступа) -- для проведения авторизации
сотрудников организаций (ЮЛ или ОГВ). Оператор ИС может зарегистрировать
одну или несколько системных групп, которые будут доступны организации;
уполномоченные сотрудники организаций смогут включать/исключать своих
сотрудников с помощью веб-интерфейса ЕСИА (см. п. 4.2.2.3). После
аутентификации данные о принадлежности сотрудника организации к
системным группам данной ИС будут доступны с помощью программного
интерфейса, основанного на архитектуре REST.

Регистрацию системных групп можно осуществлять с помощью
Технологического портала ЕСИА при условии, что данной организации
предоставлено право создания собственных системных групп.

В ЕСИА предусмотрены следующие типы групп доступа:

-   публичная -- доступная для назначения всем организациям.
    Уполномоченный сотрудник организации (не являющийся владельцем
    группы) всегда может включать в эту группу сотрудников своей
    организации;

-   ограниченно доступная (приватная) группа для ОГВ -- доступная всем
    организациям, имеющим признак ОГВ;

-   ограниченно доступная (приватная) -- доступная организациям только
    с разрешения владельца системной группы. Уполномоченный сотрудник
    организации может включать в эту группу сотрудников своей
    организации только после получения организацией прав доступа со
    стороны организации-владельца системной группы.

Организация-владелец ограниченно доступной группы может предоставить
организации доступ к группе в следующих режимах:

-   с возможностью свободного включения в группу сотрудников;

-   с включением в группу сотрудников только с персональным
    согласованием этого включения со стороны организации -- владельца
    этой группы. В этом случае добавление сотрудника в группу с помощью
    веб-интерфейса или программного интерфейса влечет за собой
    направление запроса в УЗ организации -- владельца группы для его
    рассмотрения; только после согласования запроса со стороны
    организации-владельца сотрудник будет добавлен в группу.

## Управление данными

### Управление данными ФЛ

Управление данными пользователя-ФЛ осуществляется им самостоятельно
с помощью веб-интерфейса ЛК ЕПГУ. Доступ к профилю пользователя
производится \
по ссылке: <https://lk.gosuslugi.ru/profile/personal>.

К персональным данным, размещенным в ЕСИА, относятся:

-   основная информация:

    -   фамилия, имя, отчество;

    -   пол;

    -   дата рождения;

    -   реквизиты удостоверяющего личность документа (только для
        стандартной (проверенной) и подтвержденной УЗ);

    -   гражданство (только для стандартной (проверенной) и
        подтвержденной УЗ);

-   идентификаторы:

    -   СНИЛС (только для стандартной (проверенной) и подтвержденной
        УЗ);

    -   ИНН (только для подтвержденной УЗ);

-   документы:

    -   водительское удостоверение;

    -   свидетельство о рождении;

    -   полис ОМС;

    -   заграничный паспорт;

    -   военный билет;

-   данные о детях;

-   контактная информация:

    -   адрес электронной почты;

    -   мобильный телефон;

    -   домашний телефон;

    -   почтовый адрес;

    -   адрес регистрации;

-   транспортные средства:

    -   государственный регистрационный знак транспортного средства
        и реквизиты свидетельства о регистрации транспортного средства.

Процедура редактирования ряда полей различается в зависимости от того,
является ли УЗ пользователя упрощенной (непроверенной), стандартной
(проверенной) или подтвержденной. Для стандартной (проверенной) и
подтвержденной учетных записей изменение ряда полей возможно только
после проверки этих данных в БГИР. До тех пор, пока данные не будут
подтверждены, изменение данных не произойдет.

Для стандартной (проверенной) и подтвержденной УЗ изменение основных
данных возможно только при наличии подтвержденного номера мобильного
телефона.

Управление данными в УЗ ребенка производится только через ЛК родителя,
зарегистрировавшего учетную запись ребенка.

### Управление данными ЮЛ

Управление данными ЮЛ осуществляется самостоятельно руководителем
или администратором профиля ЮЛ с помощью веб-интерфейса ЕСИА[^13].
Доступны следующие функции:

-   управление идентификационными данными ЮЛ;

-   управление сотрудниками ЮЛ;

-   управление филиалами ЮЛ;

-   управление принадлежностью сотрудников к системным группам (группам
    доступа).

Войти в профиль организации ЕСИА и управлять данными организации может
только уполномоченный сотрудник -- т.е. пользователь, который является
руководителем организации, выполнившим регистрацию организации, или
который включен в группу администраторов профиля ЕСИА.

#### Управление идентификационными данными ЮЛ

Уполномоченный сотрудник имеет возможность редактировать следующие
данные ЮЛ:

-   адрес электронной почты;

-   почтовый адрес;

-   телефон организации;

-   факс организации.

#### Управление сотрудниками ЮЛ

Уполномоченный сотрудник с помощью веб-интерфейса ЕСИА имеет возможность
просмотреть перечень сотрудников, т.е. пользователей, присоединенных
к организации. Также он имеет возможность:

-   отредактировать следующие данные сотрудника:

    -   служебный адрес электронной почты;

    -   служебный номер телефона;

    -   должность;

-   отправить приглашение пользователю для его присоединения к
    организации (см. п. 4.1.1.2), а также исключить сотрудника из
    организации.\
    При исключении сотрудника ЕСИА удаляет пользователя из всех
    системных групп и исключает сотрудника из ЮЛ, при этом УЗ сотрудника
    не удаляется из регистра ФЛ[^14].

#### Управление принадлежностью сотрудников к системным группам

Для регулирования доступа сотрудников к интегрированным с ЕСИА ИС
уполномоченный сотрудник организации имеет возможность с помощью
веб-интерфейса ЕСИА включать и исключать сотрудников из системных
групп[^15].

Группы доступа (системные группы) связаны с ИС, доступ к которым они
регулируют. Если сотрудник организации был включен в системную группу,
то соответствующие данные сможет обрабатывать ИС -- владелец данной
системной группы: информация о принадлежности к системной группе может
быть получена с помощью программного интерфейса, основанного на
архитектурном стиле REST.

#### Управление филиалами ЮЛ

Уполномоченный сотрудник с помощью веб-интерфейса ЕСИА имеет возможность
просмотреть перечень филиалов организации, зарегистрировать новый
филиал, а также:

-   изменить данные филиала;

-   управлять сотрудниками филиала и их данными;

-   управлять принадлежностью сотрудников филиала к группам.

Указанные операции с филиалами аналогичны соответствующим операциям с УЗ
организаций.

### Управление данными ОГВ

Управление данными ОГВ осуществляется по аналогии с управлением обычными
организациями -- юридическими лицами, т.е. с помощью веб-интерфейса
ЕСИА.

Управление данными ОГВ включает в себя:

-   управление должностными лицами ОГВ;

-   управление полномочиями должностных лиц ОГВ;

-   управление филиалами ОГВ.

#### Управление должностными лицами ОГВ

Добавление должностных лиц осуществляется в результате выполнения
операции приглашения пользователей -- физических лиц, имеющих
подтвержденную УЗ ЕСИА. Этот процесс может выполняться с помощью
веб-приложения «Профиль организации ЕСИА» по аналогии с управлением
сотрудниками ЮЛ.

#### Управление полномочиями должностных лиц ОГВ

Полномочия должностного лица регулируются при помощи механизма системных
групп. Выполняется по аналогии с тем, как это реализуется у ЮЛ, не
имеющих признака ОГВ (см. п. 4.2.2.3).

#### Управление филиалами ОГВ

Управление филиалами ОГВ выполняется по аналогии с тем, как это
реализуется у юридических лиц, не имеющих признака ОГВ (см. п. 4.2.2.4).

### Управление данными ИС

Изменение данных ИС осуществляется в соответствии с Регламентом.
Уполномоченный сотрудник оператора ИС имеет также возможность с помощью
веб-приложения «Технологический портал ЕСИА» осуществлять следующие
действия:

-   загружать и удалять сертификаты ИС;

-   редактировать системные группы (при наличии необходимого полномочия
    у соответствующей организации).

## Получение данных

ИС, подключенная к ЕСИА с целью идентификации и аутентификации, получает
информацию о субъектах, данные о которых хранятся в регистрах ЕСИА. С
этой целью в ЕСИА предусмотрен программный интерфейс на базе
архитектурного стиля REST. Он позволяет интегрированным с ЕСИА ИС
получать доступ к хранящимся в ЕСИА данным\
в произвольный момент времени после предварительного получения
разрешения\
от пользователя[^16]. Обеспечивается доступ к следующим данным:

-   данные о пользователе (идентификационные данные, данные
    о транспортных средствах, данные о вхождении в организации и др.);

-   данные об организациях (идентификационные данные, данные
    о сотрудниках);

-   данные об ИС (идентификационные данные, данные об
    организации-владельце);

-   данные о согласиях на доступ к сведениям организации для
    потребителя.

Детальная информация об использовании этого программного интерфейса
представлена в Приложениях Приложение А и Приложение Б[^17].

Получение данных, размещаемых в Цифровом профиле, описано в Методических
рекомендациях по интеграции с REST API Цифрового профиля (МР ЦП),
размещаемому\
по адресу <https://digital.gov.ru/ru/documents/7166/>. МР ЦП описывает
базовые сценарии использования REST API с целью получения информации о
цифровых документах владельца УЗ (пользователя).

### Особенности получения данных ФЛ

Получать данные ФЛ (с любыми ролями, за исключением должностных лиц ОГВ)
можно с помощью программных интерфейсов, основанных на REST.

При получении данных ФЛ с помощью интерфейса, основанного на архитектуре
REST, следует принимать во внимание следующую особенность ИС получает
доступ\
к данным о пользователе только после явного разрешения cо стороны
пользователя.\
У пользователя имеется возможность впоследствии отозвать это разрешение.

### Особенности получения данных ЮЛ

При получении данных ЮЛ с помощью интерфейса, основанного на REST,
следует принимать во внимание следующие особенности:

-   возможно получение общих данных обо всех ЮЛ, сотрудником которых
    является данное ФЛ;

-   полный доступ к данным ЮЛ может предоставить только уполномоченный
    сотрудник ЮЛ (например, его руководитель), обычный сотрудник ЮЛ
    может предоставить разрешение на просмотр лишь ограниченного объема
    данных;

-   возможно получение доступа к сведениям организации для потребителя \
    при наличии действующего согласия;

-   доступ к управлению согласиями организаций имеют руководитель
    организации, а также сотрудник с выданным ему полномочием на
    управление согласиями.

Схема получения данных о принадлежности сотрудника к системным группам
представлена в п. 4.2.2.3.

### Особенности получения данных ИС

Получать данные об интегрированных с ЕСИА ИС можно только посредством
программных интерфейсов, основанных на архитектурном стиле REST (см.
п. А.7, Приложение Приложение А).

Чтобы система могла быть идентифицирована средствами ЕСИА, она должна
загрузить в ЕСИА свой сертификат (см. п. 4.2.4).

Чтобы система могла производить идентификацию ИС через ЕСИА, она должна
предварительно получить разрешение на вызов соответствующего
REST-сервиса ЕСИА. Необходимость получать данные об ИС должна быть
указана в Заявке на создание записи регистра ИС в ЕСИА (среди целей
подключения ИС в ЕСИА)[^18].

# Сервисы ЕСИА на базе подхода REST

## Общие сведения о программном интерфейсе ЕСИА

В рамках развития ЕСИА реализован прикладной программный интерфейс на
базе архитектурного стиля «Representational State Transfer» (REST). Он
позволяет интегрированным с ЕСИА ИС получать доступ к хранящимся в ЕСИА
ресурсам, \
т.е. данным (например, о пользователях или других ИС), а также выполнять
ряд операций.

Вызов прикладного программного интерфейса возможен только теми
интегрированными с ЕСИА системами, которые имеют на это соответствующие
полномочия. Контроль доступа к ресурсам ЕСИА осуществляет сервис
авторизации ЕСИА, реализующий модель контроля доступа, основанную на
спецификациях протокола авторизации OAuth 2.0 (см. Приложение Б).

Для обозначения ресурсов используются специальные идентификаторы. Сами
ресурсы организованы иерархически, уровни разделены косой чертой -- «/».
Ресурсы более «низкого» уровня являются составными частями
«родительского уровня».

В ЕСИА используются два типа ресурсов:

-   документ ‒ содержит информацию об отдельном объекте в базе данных,
    который характеризуется некоторыми полями и значениями. Например,
    при доступе к документу об организации сервис возвращает
    наименование организации, ее тип, ОГРН и др. Кроме того, в документе
    могут содержаться ссылки на связанные ресурсы: так, в документе
    об организации размещаются указатели на ресурсы (документы) по ее
    сотрудникам;

-   коллекция ‒ представляет собой список некоторых ресурсов, например,
    документов. Перечень организаций, сотрудников отдельной организации
    -- примеры коллекций. Ресурсы, которые включены в коллекцию,
    снабжены собственными идентификаторами (uri). Обычно для обозначения
    коллекции используются множественные существительные (orgs, sbjs и
    др.).

Для вызова сервиса ЕСИА, позволяющего получить доступ к защищенному
ресурсу, система-клиент должна направить в https-адрес программного
интерфейса ЕСИА запрос. Для этого (в зависимости от типа запроса)
используются методы GET или POST.

В каждом запросе должен быть указан идентификатор ресурса, к которому
запрашивается доступ. Кроме того, в запрос на вызов REST API должен быть
добавлен следующий header:

Authorization: Bearer \<access token\>

где \<access token\> -- маркер доступа, предварительно полученный у
сервиса авторизации ЕСИА. Срок действия маркера доступа различен для
каждой ИС и настраивается Администратором на Технологическом портале
ЕСИА. Он не должен истечь на момент вызова. Маркер доступа должен быть
выдан системе-клиенту на \<scope\>, позволяющий получить запрашиваемый
защищенный ресурс. Пример запроса на получение сведений\
об организации с идентификатором 1000000000:

GET /rs/orgs/1000000000 HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

В случае успешной проверки запроса программный интерфейс возвращает
данные о защищенном ресурсе. При невозможности выполнить запрос
возвращается код ошибки.

При вызове сервиса могут быть заданы параметры запроса (query), которые
оформляются стандартным способом. Следующий запрос позволит получить
первые 15 организаций из соответствующей коллекции orgs:

GET /rs/orgs?pageIndex=0&pageSize=15 HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

При вызове сервиса может быть указана конкретная схема предоставления
данных об объекте. Для этого необходимо дать ссылку на соответствующую
схему\
в заголовке запроса с помощью ACCEPT. Например:

GET /rs/prns/402 HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbd9db403489c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: application/json;
schema=\"https://esia-portal1.test.gosuslugi.ru/rs/model/prn/Person--1\"\\r\\n

Данный запрос позволяет получить сведения о пользователе с
идентификатором 402, сформированные согласно схеме Person-1. Это
означает, что по мере развития ЕСИА может быть изменен передаваемый
атрибутный состав данных о пользователе, в результате чего появляются
новые схемы -- Person-2, Person-3 и т.д. В связи с этим для получения
неизменного состава атрибутов рекомендуется в запросе указывать
конкретную схему. Если в качестве схемы указана схема /model/prn/Person
без явного указания версии,\
то возвращается последняя версия. Если схема не указана вообще, то также
возвращается последняя версия схемы.

В ответе на корректный запрос выдается JSON-документ, который
представляет собой набор пар ключ/значение или массив значений. В
заголовке (headers) ответа содержатся следующие данные:

1.  Ссылки (links) на связанные ресурсы. Например, если в запросе указан
    ресурс\
    с данными конкретного пользователя (prns/402), то ссылки будут
    содержать ресурсы с его контактными данными, документами, адресами,
    транспортными средствами, а также на «родительский» ресурс с
    перечнем всех пользователей в системе;

2.  Тип предоставляемых данных (Content-Type) с указанием схемы
    предоставляемых данных. Например, если запрашиваются данные\
    о пользователе в схеме Person--1, то будет указано следующее
    значение: Content--Type: \[application/json; q=.2;
    schema=\"https://esia-portal1.test.gosuslugi.ru/rs/model/prn/Person-1\"\]

Пример раздела headers (разрывы строк даны для удобства чтения):

Link:

\[\<https://esia-portal1.test.gosuslugi.ru/rs/prns/402/docs\>;rel=documents;schema=\"https://esia-portal1.test.gosuslugi.ru/rs/model/docs/Documents--1\",

\<https://esia-portal1.test.gosuslugi.ru/rs/prns/402/addrs\>;rel=addresses;schema=\"https://esia-portal1.test.gosuslugi.ru/rs/model/addrs/Addresses--1\",

\<https://esia-portal1.test.gosuslugi.ru/rs/prns/402/ctts\>;rel=contacts;schema=\"https://esia-portal1.test.gosuslugi.ru/rs/model/ctts/Contacts--1\",

\<https://esia-portal1.test.gosuslugi.ru/rs/prns/\>;rel=parent;schema=\"https://esia-portal1.test.gosuslugi.ru/rs/model/prns/Persons--1\"\]

Date: \[Tue, 26 Nov 2013 10:04:24 GMT\]

Transfer--Encoding: \[chunked\]

Location: \[https://esia-portal1.test.gosuslugi.ru/rs/prns/402\]

server: \[grizzly/2.2.16\]

Content--Type: \[application/json; q=.2;
schema=\"https://esia-portal1.test.gosuslugi.ru/rs/model/prn/Person--1\"\]

Содержательная часть ответа на запрос содержится в разделе «body».
Пример возвращаемых данных (разрывы строк даны для удобства чтения) о
физическом лице:

{

\"stateFacts\": \[\"Identifiable\"\],

\"firstName\":\"Петр\",

\"lastName\":\"Петров\",

\"birthDate\": \"19.03.1996\" ,

\"gender\":\"M\",

\"trusted\":\"true\",

\"citizenship\":\"RUS\",

\"snils\":\"111--111--111 11\",

\"updatedOn\":\"1385460263\"

}

Каждое описание объекта или коллекции содержит параметр stateFacts,
указывающий на некоторые факты о предоставляемых сведениях. Возможны
следующие значения stateFacts:

-   Identifiable -- имеет идентификатор (например, это конкретный
    контакт\
    или документ);

-   hasSize -- имеет размер (например, для коллекции указывает на число
    элементов коллекции);

-   FirstPage -- первая страница списка;

-   LastPage -- последняя страница списка;

-   Paginated -- постраничный список;

-   EntityRoot -- корневой объект;

-   ReadOnly -- объект только для чтения.

Параметр stateFacts позволяет, в частности, производить разделение
выводимых результатов по страницам. Следующий ответ представляет собой
первую страницу некоторого перечня (фрагмент, разрывы строки даны для
удобства чтения):

{

\"stateFacts\": \[\"Paginated\",\"FirstPage\"\],

\"elements\":\[

\"https://esia-portal1.test.gosuslugi.ru/rs/prns/400\",

\"https://esia-portal1.test.gosuslugi.ru/rs/prns/401\"

\],

\"pageSize\":\"2\",

\"pageIndex\":\"1\"

}

Из данного ответа видно, что на каждой странице отображается по 2
элемента.

Для ряда операций поддерживается возможность *встраивания* (embedding)
связанных данных. Для этого в запросе соответствующего ресурса
необходимо указывать параметр «embed», а в качестве его значения --
сущность, которую требуется включить\
в ответ запроса. Например, при запросе следующего ресурса будут
отображаться *ссылки*\
на контакты пользователя 100000:

https://esia-portal1.test.gosuslugi.ru/rs/prns/100000/ctts

Однако указание параметра «embed» позволяет получить данные о контактах
непосредственно в ответе на следующий запрос:

https://esia-portal1.test.gosuslugi.ru/rs/prns/100000/ctts?embed=(elements)

В этом случае запрос данного ресурса будет возвращать ответ (фрагмент,
разрывы строки даны для удобства чтения):

{

\"stateFacts\": \[\"hasSize\"\],

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 194,

\"type\": \"MBT\",

\"vrfStu\": \"VERIFIED\",

\"value\": \"+7(910)1234567\"

}

\],

\"size\": 1

}

В данном случае на месте ссылок на связанные элементы встраиваются
данные контактов.

При встраивании сохраняется возможность получать схемы возвращаемых
ресурсов, например:

https://esia-portal1.test.gosuslugi.ru/rs/prns/100000/ctts?embed=(elements--1)

В этом случае данные об элементах будут возвращаться согласно первой
схеме.

Также возможно встраивание нескольких ресурсов в запросе, например:

https://esia-portal1.test.gosuslugi.ru/rs/orgs/100000/emps?embed=(elements.person)

В этом случае в ответе вместо ссылок на сотрудников организации будут
передаваться персональные данные сотрудников организации: ФИО, отчество,
дата и место рождения, пол и т.д. Набор данных зависит от информации,
указанной в профиле сотрудника.

При встраивании нескольких ресурсов также возможно указание на версии,
например:

https://esia-portal1.test.gosuslugi.ru/rs/orgs/100000/emps?embed=(elements--1.person--1)

Перечень ссылок, которые могут быть встроены:

-   данные о физических лицах:

    -   контактные данные (contacts);

    -   адреса (addresses);

    -   документы (documents);

    -   сведения о детях (kids);

    -   организации, к которым принадлежит физическое лицо
        (organizations);

-   данные об организациях:

    -   контактные данные (contacts);

    -   адреса (addresses);

    -   транспортные средства (vehicles);

-   данные о сотрудниках организации:

    -   данные о сотруднике как физическом лице (person);

-   данные по ссылкам, отображаемым в содержании ответа в разделе
    «elements» (возможность встраивания elements есть везде, где
    параметр stateFacts имеет значение «hasSize»).

Далее приведены описания следующих операций программного интерфейса
ЕСИА:

-   предоставление персональных данных пользователей;

-   проверка факта удаления УЗ пользователя ЕСИА;

-   предоставление сведений о вхождении пользователя в группы и
    организации;

-   предоставление данных из профиля организации;

-   предоставление списка участников группы или организации;

-   предоставление сведений о вхождении пользователей в группы;

-   управление данными организации;

-   предоставление сведений о субъекте.

## Предоставление персональных данных пользователей

Для получения персональных данных о пользователях система-клиент должна
направить в https-адрес REST API системы ЕСИА[^19] запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные.
Иерархия идентификаторов этих ресурсов в ЕСИА имеет следующий вид:

/rs/prns/{oid}/{collection_name}/{collection_entity_id},

/esia-rs/api/public/{version}/prns/{oid}/{collection_name}/{collection_entity_id},

где:

-   {version} -- версия API верификации, возможные значения:

    -   v1 -- первая версия, по умолчанию;

    -   v2 -- вторая версия;

-   prns -- перечень (коллекция) пользователей, зарегистрированных в
    ЕСИА;

-   {oid} -- внутренний идентификатор объекта, в том числе пользователя,
    в ЕСИА;

-   {collection_name} -- ссылка на перечень (коллекцию) типов данных,
    указанных пользователем с данным oid, возможные значения:

    -   ctts -- контактные данные;

    -   addrs -- адреса, получение адреса временной регистрации возможно
        только с версией API v2;

    -   docs -- документы пользователя;

    -   orgs -- организации, сотрудником которых является данный
        пользователь;

    -   kids -- дети пользователя;

    -   vhls -- транспортные средства пользователя;

    -   bio_type -- биометрии пользователя (только текстовые описания);

    -   bio_type_exp -- биометрии пользователя (текстовые описания и
        сроки окончания их действия);

-   {collection_entity_id} -- внутренний идентификатор элемента
    (например, контакта или документа) пользователя в ЕСИА.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (либо область доступа (*scope*) id_doc
с параметрами, либо один или несколько областей доступа (*scope*),
обеспечивающих доступ к персональным данным пользователя, с
параметрами[^20]).

Пример запроса (вызов сервиса в среде разработки):

GET /rs/prns/6924 HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

Данные, которые ЕСИА возвращает в ответ на запрос, представлены в
таблице Таблица 3.

Таблица 3 -- Параметры ответа на запрос о персональных данных
пользователя

+---+------------+---------------------+------------------------------+
| № | URI        | Описание ресурса    | Предоставляемые данные       |
|   | запр       |                     |                              |
|   | ашиваемого |                     |                              |
|   | ресурса    |                     |                              |
+===+============+=====================+==============================+
| 1 | /          | Данные о            | Данные о физическом лице:    |
| . | prns/{oid} | пользователе        |                              |
|   |            | с идентификатором   | -   \<rIdDoc\> --            |
|   |            | prn-id              |     идентификатор текущего   |
|   |            |                     |     документа пользователя;  |
|   |            |                     |                              |
|   |            |                     | -   \<firstName\> -- имя;    |
|   |            |                     |                              |
|   |            |                     | -   \<lastName\> -- фамилия; |
|   |            |                     |                              |
|   |            |                     | -   \<middleName\> --        |
|   |            |                     |     отчество;                |
|   |            |                     |                              |
|   |            |                     | -   \<birthDate\> -- дата    |
|   |            |                     |     рождения (в формате      |
|   |            |                     |     «ДД.ММ.ГГГГ»);           |
|   |            |                     |                              |
|   |            |                     | -   \<birthPlace\> -- место  |
|   |            |                     |     рождения пользователя;   |
|   |            |                     |                              |
|   |            |                     | -   \<gender\> -- пол;       |
|   |            |                     |                              |
|   |            |                     | -   \<trusted\> -- тип       |
|   |            |                     |     учетной записи           |
|   |            |                     |     (подтверждена («true») / |
|   |            |                     |     не подтверждена          |
|   |            |                     |     («false»));              |
|   |            |                     |                              |
|   |            |                     | -   \<citizenship\> --       |
|   |            |                     |     гражданство              |
|   |            |                     |     (идентификатор страны    |
|   |            |                     |     гражданства);            |
|   |            |                     |                              |
|   |            |                     | -   \<snils\> -- СНИЛС;      |
|   |            |                     |                              |
|   |            |                     | -   \<inn\> -- ИНН;          |
|   |            |                     |                              |
|   |            |                     | -   \<updatedOn\> -- дата    |
|   |            |                     |     последнего изменения     |
|   |            |                     |     учетной записи           |
|   |            |                     |     пользователя (задается   |
|   |            |                     |     как количество секунд,   |
|   |            |                     |     прошедших\               |
|   |            |                     |     с 00:00:00 UTC 1 января  |
|   |            |                     |     1970 года), обновляется  |
|   |            |                     |     только при изменении     |
|   |            |                     |     персональных данных.     |
|   |            |                     |     Дата остается постоянной |
|   |            |                     |     при осуществлении        |
|   |            |                     |     операций, проводимых с   |
|   |            |                     |     данной учетной записью\  |
|   |            |                     |     в организации (например, |
|   |            |                     |     включение/исключение из  |
|   |            |                     |     групп доступа);          |
|   |            |                     |                              |
|   |            |                     | -   \<verifying\> -- процесс |
|   |            |                     |     проверки данных          |
|   |            |                     |     (true/false);            |
|   |            |                     |                              |
|   |            |                     | -   \<status\> -- статус УЗ  |
|   |            |                     |     (Registered --           |
|   |            |                     |     зарегистрирована/Deleted |
|   |            |                     |     -- удалена);             |
|   |            |                     |                              |
|   |            |                     | -   \<selfEmployed\> --      |
|   |            |                     |     информация\              |
|   |            |                     |     о самозанятом:           |
|   |            |                     |                              |
|   |            |                     | -   \<confirmed\> --         |
|   |            |                     |     значение «true» --       |
|   |            |                     |     признак самозанятого     |
|   |            |                     |     есть, «false» --         |
|   |            |                     |     признака самозанятого    |
|   |            |                     |     нет;                     |
|   |            |                     |                              |
|   |            |                     | -   \<confirmDate\> -- дата  |
|   |            |                     |     обновления статуса       |
|   |            |                     |     самозанятого;            |
|   |            |                     |                              |
|   |            |                     | -   \<fmsValid\> --          |
|   |            |                     |     валидность документа     |
|   |            |                     |                              |
|   |            |                     | > в ФМС (false -- документ   |
|   |            |                     | > неактуален,\               |
|   |            |                     | > в таком случае,            |
|   |            |                     | > к параметрам добавляется   |
|   |            |                     | > fmsState; true --          |
|   |            |                     | > документ актуален);\       |
|   |            |                     | > \<fmsState\> -- статус     |
|   |            |                     | > документа в ФМС, может     |
|   |            |                     | > иметь значения:            |
|   |            |                     |                              |
|   |            |                     | -   «PERSON_NOT_FOUND» --\   |
|   |            |                     |     по указанному в запросе  |
|   |            |                     |     СНИЛС пользователь в БД  |
|   |            |                     |     ИС МВД России\           |
|   |            |                     |     не найден;               |
|   |            |                     |                              |
|   |            |                     | -   «PASSPORT_NOT_FOUND» --\ |
|   |            |                     |     в случае, если в         |
|   |            |                     |     полученном досье есть    |
|   |            |                     |     паспорт гражданина РФ, и |
|   |            |                     |     он имеет DOC_STATUS =    |
|   |            |                     |     302 \                    |
|   |            |                     |     и в досье нет паспорта   |
|   |            |                     |     гражданина РФ            |
|   |            |                     |     с DOC_STATUS = 300;      |
|   |            |                     |                              |
|   |            |                     | -   «PASSPORT_INVALID» --\   |
|   |            |                     |     в случае, если           |
|   |            |                     |     в полученном досье есть  |
|   |            |                     |     паспорт гражданина РФ, и |
|   |            |                     |     он имеет DOC_STATUS =    |
|   |            |                     |     301 и его данные (серия, |
|   |            |                     |     номер) совпадают         |
|   |            |                     |     с указанными в УЗ        |
|   |            |                     |     пользователя, при этом   |
|   |            |                     |     в досье нет паспорта     |
|   |            |                     |     гражданина РФ            |
|   |            |                     |     с DOC_STATUS = 300;      |
|   |            |                     |                              |
|   |            |                     | -   «AUTO_UPDATE_SUCCESS»    |
|   |            |                     |     --\                      |
|   |            |                     |     в случае успешного       |
|   |            |                     |     завершения               |
|   |            |                     |     автоматического          |
|   |            |                     |     обновления               |
+---+------------+---------------------+------------------------------+
| 2 | /prns/     | Перечень контактов  | Перечень контактов           |
| . | {oid}/ctts | физического лица    | физического лица (в виде     |
|   |            |                     | ссылок на ресурс c указанием |
|   |            |                     | {ctt_id}, содержащий данные  |
|   |            |                     | о каждом контакте)           |
+---+------------+---------------------+------------------------------+
| 3 | /prns      | Сведения об         | Контактные данные:           |
| . | /{oid}/ctt | отдельной записи    |                              |
|   | s/{ctt_id} | в перечне контактов | -   \<type\> -- тип записи,  |
|   |            | физического лица    |     может иметь значения:    |
|   |            |                     |                              |
|   |            |                     | -   «MBT» -- мобильный       |
|   |            |                     |     телефон;                 |
|   |            |                     |                              |
|   |            |                     | -   «PHN» -- домашний        |
|   |            |                     |     телефон;                 |
|   |            |                     |                              |
|   |            |                     | -   «EML» -- электронная     |
|   |            |                     |     почта;                   |
|   |            |                     |                              |
|   |            |                     | -   \<vrfStu\> -- сведения\  |
|   |            |                     |     о «подтвержденности»     |
|   |            |                     |     контактов, может иметь   |
|   |            |                     |     значения:                |
|   |            |                     |                              |
|   |            |                     | -   «NOT_VERIFIED» -- не     |
|   |            |                     |     подтвержден;             |
|   |            |                     |                              |
|   |            |                     | -   «VERIFIED» --            |
|   |            |                     |     подтвержден.\            |
|   |            |                     |     В настоящее время статус |
|   |            |                     |     «VERIFIED» может быть    |
|   |            |                     |     только\                  |
|   |            |                     |     у мобильного телефона    |
|   |            |                     |     («MBT»)\                 |
|   |            |                     |     и адреса электронной     |
|   |            |                     |     почты («EML»);           |
|   |            |                     |                              |
|   |            |                     | -   \<value\> -- значение    |
|   |            |                     |     контакта;                |
|   |            |                     |                              |
|   |            |                     | -   \<vrfValStu\> --         |
|   |            |                     |     необязательный параметр, |
|   |            |                     |     указывается в случае,\   |
|   |            |                     |     если контакт находится   |
|   |            |                     |     в процессе               |
|   |            |                     |     подтверждения. Может     |
|   |            |                     |     принимать следующее      |
|   |            |                     |     значение:                |
|   |            |                     |                              |
|   |            |                     | -   «VERIFYING» -- в         |
|   |            |                     |     процессе подтверждения.  |
|   |            |                     |     В настоящее время статус |
|   |            |                     |     «VERIFYING» может быть   |
|   |            |                     |     только у мобильного      |
|   |            |                     |     телефона («MBT») и       |
|   |            |                     |     адреса электронной почты |
|   |            |                     |     («EML»);                 |
|   |            |                     |                              |
|   |            |                     | -   \<verifyingValue\> --    |
|   |            |                     |     значение контакта,       |
|   |            |                     |     находящегося в процессе  |
|   |            |                     |     подтверждения            |
+---+------------+---------------------+------------------------------+
| 4 | /prns/{    | Перечень адресов    | Перечень адресов физического |
| . | oid}/addrs | физического лица    | лица (в виде ссылок на       |
|   |            |                     | ресурс c указанием           |
|   |            |                     | {addr_id}, содержащий данные |
|   |            |                     | о каждом адресе)             |
+---+------------+---------------------+------------------------------+
| 5 | /prns/{    | Сведения об         | Адреса:                      |
| . | oid}/addrs | отдельной записи    |                              |
|   | /{addr_id} | в перечне адресов   | -   \<type\> -- тип записи,  |
|   |            | физического лица    |     может иметь значения:    |
|   |            |                     |                              |
|   |            |                     | -   «PLV» -- адрес места     |
|   |            |                     |     проживания;              |
|   |            |                     |                              |
|   |            |                     | -   «PTA» -- адрес временной |
|   |            |                     |     регистрации;             |
|   |            |                     |                              |
|   |            |                     | -   «PRG» -- адрес           |
|   |            |                     |     постоянной регистрации.  |
|   |            |                     |                              |
|   |            |                     | -   \<zipCode\> -- индекс;   |
|   |            |                     |                              |
|   |            |                     | -   \<countryId\> --         |
|   |            |                     |     идентификатор страны;    |
|   |            |                     |                              |
|   |            |                     | -   \<addressStr\> -- адрес  |
|   |            |                     |     в виде строки (не        |
|   |            |                     |     включая дом, строение,   |
|   |            |                     |     корпус, номер квартиры); |
|   |            |                     |                              |
|   |            |                     | -   \<building\> --          |
|   |            |                     |     строение;                |
|   |            |                     |                              |
|   |            |                     | -   \<frame\> -- корпус;     |
|   |            |                     |                              |
|   |            |                     | -   \<frameType\> -- Тип     |
|   |            |                     |     дополнительной части     |
|   |            |                     |     дома (может быть «к» -   |
|   |            |                     |     корпус; литера);         |
|   |            |                     |                              |
|   |            |                     | -   \<house\> -- дом;        |
|   |            |                     |                              |
|   |            |                     | -   \<flat\> -- квартира;    |
|   |            |                     |                              |
|   |            |                     | -   \<room\> -- номер        |
|   |            |                     |     помещения внутри         |
|   |            |                     |     помещения (комнаты);     |
|   |            |                     |                              |
|   |            |                     | -   \<fiasCode\> -- код      |
|   |            |                     |     КЛАДР;                   |
|   |            |                     |                              |
|   |            |                     | -   \<fiasCodeLevel\> --     |
|   |            |                     |     уровень ФИАС-кода;       |
|   |            |                     |                              |
|   |            |                     | -   \<region\> -- регион;    |
|   |            |                     |                              |
|   |            |                     | -   \<city\> -- город;       |
|   |            |                     |                              |
|   |            |                     | -   \<district\> --          |
|   |            |                     |     внутригородской район;   |
|   |            |                     |                              |
|   |            |                     | -   \<area\> -- район;       |
|   |            |                     |                              |
|   |            |                     | -   \<settlement\> --        |
|   |            |                     |     поселение;               |
|   |            |                     |                              |
|   |            |                     | -   \<additionArea\> -- доп. |
|   |            |                     |     территория;              |
|   |            |                     |                              |
|   |            |                     | -   \<additionAreaStreet\>   |
|   |            |                     |     -- улица на доп.         |
|   |            |                     |     территории;              |
|   |            |                     |                              |
|   |            |                     | -   \<street\> -- улица      |
+---+------------+---------------------+------------------------------+
| 6 | /prns/     | Перечень документов | Перечень документов          |
| . | {oid}/docs | физического лица    | физического лица\            |
|   |            |                     | (в виде ссылок на ресурс c   |
|   |            |                     | указанием {doc_id},          |
|   |            |                     | содержащий данные о каждом   |
|   |            |                     | документе)                   |
+---+------------+---------------------+------------------------------+
| 7 | /prns      | Сведения об         | Документы:                   |
| . | /{oid}/doc | отдельной записи    |                              |
|   | s/{doc_id} | в перечне           | -   \<type\> -- тип записи,  |
|   |            | документов          |     может иметь значения:    |
|   |            | физического лица    |                              |
|   |            |                     | -   «RF_PASSPORT» -- паспорт |
|   |            |                     |     гражданина РФ;           |
|   |            |                     |                              |
|   |            |                     | -   «FID_DOC» -- документ    |
|   |            |                     |     иностранного гражданина; |
|   |            |                     |                              |
|   |            |                     | -   «RF_DRIVING_LICENSE» --  |
|   |            |                     |     водительское             |
|   |            |                     |     удостоверение;           |
|   |            |                     |                              |
|   |            |                     | -   «MLTR_ID» -- военный     |
|   |            |                     |     билет;                   |
|   |            |                     |                              |
|   |            |                     | -   «FRGN_PASS» --           |
|   |            |                     |     заграничный паспорт;     |
|   |            |                     |                              |
|   |            |                     | -   «MDCL_PLCY» -- полис     |
|   |            |                     |     ОМС:                     |
|   |            |                     |                              |
|   |            |                     | -   \<medicalOrg\> --        |
|   |            |                     |     наименование медицинской |
|   |            |                     |     организации (юридическое |
|   |            |                     |     лицо);                   |
|   |            |                     |                              |
|   |            |                     | -   \<number\> -- номер или  |
|   |            |                     |     серия и номер полиса     |
|   |            |                     |     ОМС;                     |
|   |            |                     |                              |
|   |            |                     | -   \<unitedNumber\> --      |
|   |            |                     |     Единый номер полиса      |
|   |            |                     |     (ЕНП);                   |
|   |            |                     |                              |
|   |            |                     | -   «RF_BRTH_CERT» --        |
|   |            |                     |     свидетельство о рождении |
|   |            |                     |     -- Россия;               |
|   |            |                     |                              |
|   |            |                     | -   «FID_BRTH_CERT» --       |
|   |            |                     |     свидетельство о рождении |
|   |            |                     |     -- другая страна;        |
|   |            |                     |                              |
|   |            |                     | -   «OLD_BRTH_CERT» --       |
|   |            |                     |     свидетельство о рождении |
|   |            |                     |     -- СССР;                 |
|   |            |                     |                              |
|   |            |                     | -   \<status\> -- сведения о |
|   |            |                     |     статусе проверки         |
|   |            |                     |     документа в ведомстве.   |
|   |            |                     |     Для документов,          |
|   |            |                     |     проверяемых в ЕГР ЗАГС,  |
|   |            |                     |     может иметь значения:    |
|   |            |                     |                              |
|   |            |                     | -   \<verified_by_request\>  |
|   |            |                     |     -- проверено\            |
|   |            |                     |     в ведомстве;             |
|   |            |                     |                              |
|   |            |                     | -   \<unverified\> -- не     |
|   |            |                     |     проверено\               |
|   |            |                     |     в ведомстве;             |
|   |            |                     |                              |
|   |            |                     | -   \<vrfStu\> -- сведения\  |
|   |            |                     |     о «подтвержденности»     |
|   |            |                     |     документов, может иметь  |
|   |            |                     |     значения:                |
|   |            |                     |                              |
|   |            |                     | -   «NOT_VERIFIED» -- не     |
|   |            |                     |     подтвержден;             |
|   |            |                     |                              |
|   |            |                     | -   «VERIFIED» --            |
|   |            |                     |     подтвержден;             |
|   |            |                     |                              |
|   |            |                     | -   \<actNo\> -- номер       |
|   |            |                     |     актовой записи\          |
|   |            |                     |     (для свидетельства о     |
|   |            |                     |     рождении РФ\             |
|   |            |                     |     и СССР);                 |
|   |            |                     |                              |
|   |            |                     | -   \<actDate\> -- дата      |
|   |            |                     |     актовой записи (только   |
|   |            |                     |     для свидетельства о      |
|   |            |                     |     рождении ребенка РФ);    |
|   |            |                     |                              |
|   |            |                     | -   \<series\> -- серия      |
|   |            |                     |     документа;               |
|   |            |                     |                              |
|   |            |                     | -   \<number\> -- номер      |
|   |            |                     |     документа;               |
|   |            |                     |                              |
|   |            |                     | -   \<issueDate\> -- дата    |
|   |            |                     |     выдачи документа;        |
|   |            |                     |                              |
|   |            |                     | -   \<issueId\> -- код       |
|   |            |                     |     подразделения;           |
|   |            |                     |                              |
|   |            |                     | -   \<issuedBy\> -- кем      |
|   |            |                     |     выдан;                   |
|   |            |                     |                              |
|   |            |                     | -   \<expiryDate\> -- срок   |
|   |            |                     |     действия документа;      |
|   |            |                     |                              |
|   |            |                     | -   \<lastName\> -- фамилия  |
|   |            |                     |     (для заграничного        |
|   |            |                     |     паспорта);               |
|   |            |                     |                              |
|   |            |                     | -   \<firstName\> -- имя     |
|   |            |                     |     (для заграничного        |
|   |            |                     |     паспорта);               |
|   |            |                     |                              |
|   |            |                     | -   \<vrfValStu\> --         |
|   |            |                     |     необязательный параметр, |
|   |            |                     |     указывается в случае,    |
|   |            |                     |     если документ находится  |
|   |            |                     |     в процессе               |
|   |            |                     |     подтверждения. Может     |
|   |            |                     |     принимать следующее      |
|   |            |                     |     значение:                |
|   |            |                     |                              |
|   |            |                     | -   «VERIFYING» -- в         |
|   |            |                     |     процессе подтверждения;  |
|   |            |                     |                              |
|   |            |                     | -   «VERIFICATION_FAILED» -- |
|   |            |                     |     ошибки проверки;         |
|   |            |                     |                              |
|   |            |                     | -   «vrfReqId» --            |
|   |            |                     |     идентификатор заявки;    |
|   |            |                     |                              |
|   |            |                     | -   \<eTag\> -- тег          |
|   |            |                     |     изменяемого объекта;     |
|   |            |                     |                              |
|   |            |                     | -   \<fmsValid\> --          |
|   |            |                     |     валидность документа\    |
|   |            |                     |     в ФМС России (false --   |
|   |            |                     |     документ неактуален, в   |
|   |            |                     |     таком случае,            |
|   |            |                     |     к параметрам добавляется |
|   |            |                     |     fmsState; true --        |
|   |            |                     |     документ актуален);\     |
|   |            |                     |     \<fmsState\> -- статус   |
|   |            |                     |     документа в ФМС России,  |
|   |            |                     |     может иметь значения:    |
|   |            |                     |                              |
|   |            |                     | -   «PERSON_NOT_FOUND» --\   |
|   |            |                     |     по указанному в запросе  |
|   |            |                     |     СНИЛС пользователь в БД  |
|   |            |                     |     ИС МВД России\           |
|   |            |                     |     не найден;               |
|   |            |                     |                              |
|   |            |                     | -   «PASSPORT_NOT_FOUND» --\ |
|   |            |                     |     в случае, если в         |
|   |            |                     |     полученном досье есть    |
|   |            |                     |     паспорт гражданина РФ, и |
|   |            |                     |     он имеет DOC_STATUS =    |
|   |            |                     |     302 и в досье нет        |
|   |            |                     |     паспорта гражданина РФ   |
|   |            |                     |     с DOC_STATUS = 300;      |
|   |            |                     |                              |
|   |            |                     | -   «PASSPORT_INVALID» -- в  |
|   |            |                     |     случае, если             |
|   |            |                     |     в полученном досье есть  |
|   |            |                     |     паспорт гражданина РФ, и |
|   |            |                     |     он имеет DOC_STATUS =    |
|   |            |                     |     301 и его данные (серия, |
|   |            |                     |     номер) совпадают         |
|   |            |                     |     с указанными в УЗ        |
|   |            |                     |     пользователя,\           |
|   |            |                     |     при этом в досье нет     |
|   |            |                     |     паспорта гражданина РФ   |
|   |            |                     |     с DOC_STATUS = 300;      |
|   |            |                     |                              |
|   |            |                     | -   «AUTO_UPDATE_SUCCESS»    |
|   |            |                     |     --\                      |
|   |            |                     |     в случае успешного       |
|   |            |                     |     завершения               |
|   |            |                     |     автоматического          |
|   |            |                     |     обновления               |
+---+------------+---------------------+------------------------------+
| 8 | /prns/     | Перечень            | Перечень организаций,        |
| . | {oid}/orgs | организаций,        | сотрудником которых является |
|   |            | сотрудником которых | физическое лицо с данным     |
|   |            | является данное     | {oid} (в виде ссылок на      |
|   |            | физическое лицо     | ресурс c указанием {oid},    |
|   |            |                     | содержащий данные о каждой   |
|   |            |                     | организации)                 |
+---+------------+---------------------+------------------------------+
| 9 | /prns/{o   | Перечень записей    | Перечень детей физического   |
| . | id}/kids?e | о детях физического | лица (возвращаются сведения  |
|   | mbed=(kids | лица                | обо всех детях, добавленных  |
|   | .elements) |                     | в личный кабинет физического |
|   |            |                     | лица)                        |
+---+------------+---------------------+------------------------------+
| 1 | /prns/{oid | Сведения об         | Дети:                        |
| 0 | }/kids/{ki | отдельной записи    |                              |
| . | d_id}[^21] | в перечне детей     | -   \<firstName\> -- имя     |
|   |            | физического лица    |     ребенка;                 |
|   |            |                     |                              |
|   |            |                     | -   \<lastName\> -- фамилия  |
|   |            |                     |     ребенка;                 |
|   |            |                     |                              |
|   |            |                     | -   \<middleName\> --        |
|   |            |                     |     отчество ребенка;        |
|   |            |                     |                              |
|   |            |                     | -   \<birthDate\> -- дата    |
|   |            |                     |     рождения;                |
|   |            |                     |                              |
|   |            |                     | -   \<gender\> -- пол;       |
|   |            |                     |                              |
|   |            |                     | -   \<birthPlace\> -- место  |
|   |            |                     |     рождения (параметр       |
|   |            |                     |     возвращается при наличии |
|   |            |                     |     значения);               |
|   |            |                     |                              |
|   |            |                     | -   \<citizenshipId\> --     |
|   |            |                     |     идентификатор            |
|   |            |                     |     гражданства (параметр    |
|   |            |                     |     возвращается при наличии |
|   |            |                     |     значения);               |
|   |            |                     |                              |
|   |            |                     | -   \<snils\> -- СНИЛС;      |
|   |            |                     |                              |
|   |            |                     | -   \<inn\> -- ИНН;          |
|   |            |                     |                              |
|   |            |                     | -   \<trusted\> -- признак   |
|   |            |                     |     подтвержденности данных  |
|   |            |                     |     о ребенке (подтверждены  |
|   |            |                     |     («true») / не            |
|   |            |                     |     подтверждены («false»)); |
|   |            |                     |                              |
|   |            |                     | -   \<updatedOn\> -- дата    |
|   |            |                     |     последнего изменения     |
|   |            |                     |     данных о ребенке         |
|   |            |                     |     (задается\               |
|   |            |                     |     как количество секунд,   |
|   |            |                     |     прошедших\               |
|   |            |                     |     с 00:00:00 UTC 1 января  |
|   |            |                     |     1970 года);              |
|   |            |                     |                              |
|   |            |                     | -   \<id\> -- kid_id,        |
|   |            |                     |     уникальный идентификатор |
|   |            |                     |     записи о ребенке;        |
|   |            |                     |                              |
|   |            |                     | -   oid -- уникальный        |
|   |            |                     |     идентификатор записи\    |
|   |            |                     |     о ребенке как сущности   |
|   |            |                     |     ЕСИА;                    |
|   |            |                     |                              |
|   |            |                     | -   \<hasAccount\> --        |
|   |            |                     |     признак наличия детской  |
|   |            |                     |     УЗ, привязанной к        |
|   |            |                     |     данному ребенку («true»  |
|   |            |                     |     -- у ребенка есть        |
|   |            |                     |     детская УЗ, «false» -- у |
|   |            |                     |     ребенка нет детской УЗ); |
|   |            |                     |                              |
|   |            |                     | -   \<kidAccount\> -- массив |
|   |            |                     |     с данными\               |
|   |            |                     |     о привязанной к ребенку  |
|   |            |                     |     детской УЗ. Содержит     |
|   |            |                     |     следующие параметры:     |
|   |            |                     |                              |
|   |            |                     | -   \<id\> -- id_obj,        |
|   |            |                     |     уникальный иденификатор  |
|   |            |                     |     учетной записи;          |
|   |            |                     |                              |
|   |            |                     | -   \<oid\> -- уникальный    |
|   |            |                     |     идентификатор записи об  |
|   |            |                     |     УЗ как сущности ЕСИА;    |
|   |            |                     |                              |
|   |            |                     | -   \<firstName\> -- имя     |
|   |            |                     |     физического лица из УЗ;  |
|   |            |                     |                              |
|   |            |                     | -   \<lastName\> -- фамилия  |
|   |            |                     |     физического лица из УЗ;  |
|   |            |                     |                              |
|   |            |                     | -   \<email\> -- адрес       |
|   |            |                     |     электронной почты,\      |
|   |            |                     |     к которому привязана УЗ; |
|   |            |                     |                              |
|   |            |                     | -   \<linkedToChildAccount\> |
|   |            |                     |     -- признак того, что УЗ  |
|   |            |                     |     физического лица         |
|   |            |                     |     привязана к УЗ ребенка   |
|   |            |                     |     («true» -- привязана,    |
|   |            |                     |     «false» --\              |
|   |            |                     |     не привязана);           |
|   |            |                     |                              |
|   |            |                     | -   \<countParentLink\> --   |
|   |            |                     |     количество связок УЗ     |
|   |            |                     |     ребенка с УЗ физических  |
|   |            |                     |     лиц (родителей или иных  |
|   |            |                     |     законных                 |
|   |            |                     |     представителей);         |
|   |            |                     |                              |
|   |            |                     | -   \<personCategory\> --    |
|   |            |                     |     массив с данными\        |
|   |            |                     |     о категориях,            |
|   |            |                     |     присвоенных записи\      |
|   |            |                     |     о ребенке. Содержит      |
|   |            |                     |     следующие параметры:     |
|   |            |                     |                              |
|   |            |                     | -   \<id\> -- уникальный     |
|   |            |                     |     иденификатор присвоенной |
|   |            |                     |     категории;               |
|   |            |                     |                              |
|   |            |                     | -   \<name\> --              |
|   |            |                     |     наименоваение            |
|   |            |                     |     присвоенной категории;   |
|   |            |                     |                              |
|   |            |                     | -   \<deadKid\> -- признак   |
|   |            |                     |     наличия для записи\      |
|   |            |                     |     о ребенке категории      |
|   |            |                     |     «мертвый»\               |
|   |            |                     |     или «мертворожденный»    |
|   |            |                     |     («true» -- есть одна из  |
|   |            |                     |     категорий, «false» --    |
|   |            |                     |     нет ни одной из данных   |
|   |            |                     |     категорий);              |
|   |            |                     |                              |
|   |            |                     | -   \<hiddenByParent\> --    |
|   |            |                     |     признак скрытия карточки |
|   |            |                     |     ребенка из ЛК            |
|   |            |                     |     физического лица («true» |
|   |            |                     |     -- карточка скрыта,      |
|   |            |                     |     «false» -- карточка не   |
|   |            |                     |     скрыта)                  |
+---+------------+---------------------+------------------------------+
| 1 | /prns/{oid | Перечень документов | Перечень документов ребенка  |
| 1 | }/kids/{ki | ребенка физического | данного физического лица (в  |
| . | d_id}/docs | лица                | виде ссылок\                 |
|   |            |                     | на ресурс c указанием        |
|   |            |                     | {doc_id}, содержащий данные  |
|   |            |                     | о каждом документе)          |
+---+------------+---------------------+------------------------------+
| 1 | /prns/{oi  | Сведения об         | Документы ребенка            |
| 2 | d}/kids/{k | отдельной записи    | описываются\                 |
| . | id_id}/doc | в перечне           | по аналогии с документами    |
|   | s/{doc_id} | документов ребенка  | физического лица. Для детей  |
|   |            | физического лица    | предусмотрены следующие типы |
|   |            |                     | (\<type\>) документов^21^:   |
|   |            |                     |                              |
|   |            |                     | -   «MDCL_PLCY» -- полис     |
|   |            |                     |     ОМС;                     |
|   |            |                     |                              |
|   |            |                     | -   «RF_BRTH_CERT» --        |
|   |            |                     |     свидетельство о рождении |
|   |            |                     |     -- Россия;               |
|   |            |                     |                              |
|   |            |                     | -   «FID_BRTH_CERT» --       |
|   |            |                     |     свидетельство о рождении |
|   |            |                     |     -- другая страна;        |
|   |            |                     |                              |
|   |            |                     | -   «OLD_BRTH_CERT» --       |
|   |            |                     |     свидетельство о рождении |
|   |            |                     |     -- СССР;                 |
|   |            |                     |                              |
|   |            |                     | -   «RF_PASSPORT» -- паспорт |
|   |            |                     |     гражданина РФ;           |
|   |            |                     |                              |
|   |            |                     | -   «FID_DOC» -- документ    |
|   |            |                     |     иностранного гражданина, |
|   |            |                     |     удостоверяющий личность\ |
|   |            |                     |     на территории РФ         |
+---+------------+---------------------+------------------------------+
| 1 | prns/{     | Виды адресов        | -   \<MVD\> -- адрес,        |
| 3 | oid}?embed |                     |     полученный от МВД        |
| . | =(document |                     |     России;                  |
|   | s.elements |                     |                              |
|   | ,addresses |                     | -   \<PTU\> -- адрес         |
|   | .elements) |                     |     временной регистрации,   |
|   | -- для     |                     |     который пришел в         |
|   | получения  |                     |     качестве результата      |
|   | адреса;    |                     |     оказания услуги.         |
|   |            |                     |                              |
|   | prns/{     |                     | > Адреса:                    |
|   | oid}/addrs |                     |                              |
|   | -- для     |                     | -   \<type\> -- тип записи,  |
|   | сохранения |                     |     может иметь значения:    |
|   | адреса     |                     |                              |
|   |            |                     | -   «PLV» -- адрес места     |
|   |            |                     |     проживания;              |
|   |            |                     |                              |
|   |            |                     | -   «PTA» -- адрес временной |
|   |            |                     |     регистрации;             |
|   |            |                     |                              |
|   |            |                     | -   «PRG» -- адрес           |
|   |            |                     |     постоянной регистрации   |
+---+------------+---------------------+------------------------------+
| 1 | prns/{oid} | Перечень атрибутов  | Перечень атрибутов           |
| 4 | /docs/{id_ | иностранного        | иностранного документа       |
| . | doc}/attrs | документа,          | должен возвращаться в        |
|   |            | полученный от СФР,  | массиве объектов «elements», |
|   |            | на основе которого  | каждый из объектов должен    |
|   |            | был подтвержден     | состоять из трех параметров: |
|   |            | документ            |                              |
|   |            | иностранного        | -   Название атрибута:       |
|   |            | гражданина          |     «name». Возможные        |
|   |            | взрослого           |     значения атрибута        |
|   |            | пользователя        |     «name»:                  |
|   |            |                     |                              |
|   |            |                     | -   authority.issuedBy (кем  |
|   |            |                     |     выдан документ);         |
|   |            |                     |                              |
|   |            |                     | -   authority.series (серия  |
|   |            |                     |     документа);              |
|   |            |                     |                              |
|   |            |                     | -   authority.number (номер  |
|   |            |                     |     документа);              |
|   |            |                     |                              |
|   |            |                     | -   authority.issueDate      |
|   |            |                     |     (дата выдачи документа); |
|   |            |                     |                              |
|   |            |                     | -   subType.code (код типа   |
|   |            |                     |     документа);              |
|   |            |                     |                              |
|   |            |                     | -   subType.name (описание   |
|   |            |                     |     типа документа);         |
|   |            |                     |                              |
|   |            |                     | > Атрибуты subType.code,     |
|   |            |                     | > subType.name могут иметь   |
|   |            |                     | > следующие значения[^22]:   |
|   |            |                     |                              |
|   |            |                     | -   «ВИД НА ЖИТЕЛЬ», «Вид\   |
|   |            |                     |     на жительство»;          |
|   |            |                     |                              |
|   |            |                     | -   «ИНПАСПОРТ»,             |
|   |            |                     |     «Иностранный паспорт»;   |
|   |            |                     |                              |
|   |            |                     | -   «СВИД БЕЖЕНЦА»,          |
|   |            |                     |     «Свидетельство о         |
|   |            |                     |     регистрации ходатайства  |
|   |            |                     |     о признании иммигранта   |
|   |            |                     |     беженцем»                |
|   |            |                     |                              |
|   |            |                     | -   «УДОСТ БЕЖЕНЦА»,         |
|   |            |                     |     «Удостоверение беженца в |
|   |            |                     |     РФ»;                     |
|   |            |                     |                              |
|   |            |                     | -   «ПРОЧЕЕ», «Иные          |
|   |            |                     |     документы, выдаваемые    |
|   |            |                     |     органами МВД»;           |
|   |            |                     |                              |
|   |            |                     | -   Значение атрибута. В     |
|   |            |                     |     зависимости от типа      |
|   |            |                     |     данных должен            |
|   |            |                     |     передаваться один\       |
|   |            |                     |     из следующих параметров: |
|   |            |                     |                              |
|   |            |                     | -   «stringValue» (значение  |
|   |            |                     |     передается как строка);  |
|   |            |                     |                              |
|   |            |                     | -   «dateValue» (значение    |
|   |            |                     |     передается как дата      |
|   |            |                     |     формате unix timestamp); |
|   |            |                     |                              |
|   |            |                     | -   «numberValue» (значение  |
|   |            |                     |     передается как номер);   |
|   |            |                     |                              |
|   |            |                     | ```{=html}                   |
|   |            |                     | <!-- -->                     |
|   |            |                     | ```                          |
|   |            |                     | -   Дата последнего          |
|   |            |                     |     изменения атрибута\      |
|   |            |                     |     в учетной записи         |
|   |            |                     |     пользователя в формате   |
|   |            |                     |     unix timestamp (задается |
|   |            |                     |     как количество секунд,   |
|   |            |                     |     прошедших с 00:00:00 UTC |
|   |            |                     |     1 января 1970 года):     |
|   |            |                     |     «updatedOn»              |
+---+------------+---------------------+------------------------------+
| 1 | /prns/{oid | Перечень записей о  | Перечень активированных на   |
| 5 | }/bio_type | биометриях (только  | данный момент биометрий      |
| . |            | текстовое описание) | физического лица (в виде     |
|   |            | физического лица    | текстовых описаний каждой из |
|   |            |                     | биометрий)                   |
+---+------------+---------------------+------------------------------+
| 1 | /prn       | Перечень записей о  | Перечень активированных на   |
| 6 | s/{oid}/bi | биометриях          | данный момент биометрий      |
| . | o_type_exp | (текстовое описание | физического лица (текстовое  |
|   |            | и срок действия)    | описание и срок окончания    |
|   |            | физического лица    | действия каждой из           |
|   |            |                     | биометрий)                   |
+---+------------+---------------------+------------------------------+

При отображении всех коллекций используется механизм paging.

Пример ответа на запрос контактных данных физического лица (фрагмент,
разрывы строк даны для удобства чтения):

{

\"stateFacts\": \[\"Identifiable\"\],

\"type\":\"MBT\",

\"vrfStu\":\"VERIFIED\",

\"value\":\"+7(777)7777777\"

}

Пример ответа на запрос конкретного адреса физического лица (фрагмент,
разрывы строк даны для удобства чтения):

{

\"stateFacts\":\[\"Identifiable\"\],

\"eTag\": \"A8EAE82522BC153782009E3A6F95232FCC95FFDA\",

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 84883,

\"type\": \"PRG\",

\"selected\": false,

\"fiasCodeLevel\": \"8\",

\"room\": \"3\",

\"addressStr\": \"край Пермский, г Пермь, ул Попова\",

\"fiasCode\": \"ae18819b-6547-406e-83e7-8e7a2aecf3e4\",

\"flat\": \"109\",

\"countryId\": \"RUS\",

\"house\": \"58\",

\"zipCode\": \"614016\",

\"city\": \"Пермь\",

\"street\": \"Попова\",

\"houseType\": \"д\",

\"region\": \"Пермский\",

\"vrfDdt\": \"-2\",

\"houseTypeFull\": \"дом\",

Пример ответа на запрос конкретного документа физического лица
(фрагмент, разрывы строк даны для удобства чтения):

{

\"stateFacts\": \[\"Identifiable\"\],

\"type\":\"RF_PASSPORT\",

\"vrfStu\":\"VERIFIED\",

\"series\":\"3333\",

\"number\":\"333333\",

\"issueDate\":\"1383249600\",

\"issueId\":\"333333\"

}

Пример ответа на запрос конкретного транспортного средства физического
лица (фрагмент, разрывы строк даны для удобства чтения):

{

\"stateFacts\": \[\"Identifiable\"\],

\"name\": \"Хонда\",

\"numberPlate\": \"А133ОН177\",

\"regCertificate\": {

\"series\": \"77УЕ\",

\"number\": \"204623\"

}

}

Пример ответа на запрос всех транспортных средств физического лица,
полученный с использованием возможностей встраивания (фрагмент, разрывы
строк даны для удобства чтения):

{

\"stateFacts\": \[\"Paginated\"\],

\"size\": 5,

\"pageSize\": 5,

\"pageIndex\": 2,

\"totalSize\": 12,

\"eTag\": \"E6DAE96DADE1CA29F5C50979BBB7C8BF4422FD62\",

\"elements\": \[{

\"stateFacts\": \[\"Identifiable\"\],

\"id\": 6590,

\"name\": \"TOYOTA\",

\"numberPlate\": \"A111AA136\",

\"regCertificate\": {\"series\": \"1234\",\"number\": \"123456\"},

\"eTag\": \"F69EEA8910E298E97C8E6249A130A7195DFE7F1A\"},

\...\...\...\.... }

Для получения категорий самозанятого пользователя система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные.
Иерархия идентификаторов этих ресурсов в ЕСИА имеет следующий вид:

/categories/prns/{oid},

где:

-   categories -- коллекция категорий, имеющихся в ЕСИА;

-   prns -- перечень (коллекция) пользователей, зарегистрированных в
    ЕСИА;

-   {oid} -- внутренний идентификатор объекта, в том числе пользователя,
    в ЕСИА.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (*scope* self_employed).

Пример запроса (вызов сервиса в среде разработки):

GET /categories/prns/1077128402 HTTP/1.1\\r\\n

Authorization: Bearer
eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE2MDAzNDE5NzEsInNjb3BlIjoic2VsZl9lbXBsb3llZD9vaWQ9MTA3NzEyNzk1NSIsImlzcyI6Imh0dHA6XC9cL2VzaWEuZ29zdXNsdWdpLnJ1XC8iLCJ1cm46ZXNpYTpzaWQiOiJjYWRhOTE5N2Q2MDAzZTVmZTI0MDIxOGMyODA1NDc1ZGM4YjIxNTFiZTQ0MGQ1YWQzMTQ3ODFiMDUxNGNmZWM2IiwidXJuOmVzaWE6c2JqX2lkIjoxMDc3MTI3OTU1LCJleHAiOjE2MDAzNDU1NzEsImlhdCI6MTYwMDM0MTk3MSwiY2xpZW50X2lkIjoiUEdVIn0.VySaaGxci6XpwL7V0Df3yLIBENGP7R6ki9sQ4MqdHoc2ItkI4ObI7sClWNaaSQxE_vNXUqszYWUPde_vOWMoNSbjSUbITPrXr9tgb6LuZbCpKSFxwnu8WAjqQfWfcssNWn9--MxpAJHrEfVUu6eMpVfcME_qFDc4YtKVLmWQ8viPpL0E2gokn_E67EibHevnJY13H7GpKL0UYzNV40rr4O8Ai2zaGG8WZ3GM_ZREFMMbH3aW3mfoCSF_QDKqPiZI6OhhvNtgo6VKarverbFo4y1hqQD7p3KTSXjukoeQ2OYnNHQj9V01mJtxXrTxXIcnkyq8Fj60FCBuX6bhtgwBQ9Q

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

Данные, которые ЕСИА возвращает в ответ на запрос, представлены в
таблице 4.

Таблица 4 -- Параметры ответа на запрос о категориях самозанятого

+---+----------------+----------------+--------------------------------+
| № | URI            | Описание       | Предоставляемые данные         |
|   | запрашиваемого | ресурса        |                                |
|   | ресурса        |                |                                |
+===+================+================+================================+
| 1 | /categor       | Данные о       | Данные о категориях            |
| \ | ies/prns/{oid} | категорих      | организации:                   |
| . |                | организации    |                                |
|   |                | с и            | -   \<stateFacts\> --          |
|   |                | дентификатором |     параметр, указывающий\     |
|   |                | {orgOid}       |     на факты о предоставляемых |
|   |                |                |     сведениях (постраничный    |
|   |                |                |     список, имеет размер и     |
|   |                |                |     т.п.);                     |
|   |                |                |                                |
|   |                |                | -   \<size\> -- количество     |
|   |                |                |     категорий в коллекции;     |
|   |                |                |                                |
|   |                |                | -   \<pageSize\> -- параметр   |
|   |                |                |     пагинации (размер страницы |
|   |                |                |     -- количество элементов\   |
|   |                |                |     на странице);              |
|   |                |                |                                |
|   |                |                | -   \<pageIndex\> -- параметр  |
|   |                |                |     пагинации (номер           |
|   |                |                |     страницы);                 |
|   |                |                |                                |
|   |                |                | -   \<elements\> -- массив,    |
|   |                |                |     содержащий информацию      |
|   |                |                |     о категориях:              |
|   |                |                |                                |
|   |                |                | -   \<parentName\> --          |
|   |                |                |     наименование родительской  |
|   |                |                |     категории;                 |
|   |                |                |                                |
|   |                |                | -   \<parentId\> --            |
|   |                |                |     идентификатор родительской |
|   |                |                |     категории;                 |
|   |                |                |                                |
|   |                |                | -   \<catName\> --             |
|   |                |                |     наименование категории;    |
|   |                |                |                                |
|   |                |                | -   \<catId\> -- идентификатор |
|   |                |                |     категории;                 |
|   |                |                |                                |
|   |                |                | -   \<catConfirm\> -- признак  |
|   |                |                |     того,\                     |
|   |                |                |     что категория является     |
|   |                |                |     подтверждаемой (N --       |
|   |                |                |     категория не               |
|   |                |                |     подтверждаемая, Y --       |
|   |                |                |     категория является         |
|   |                |                |     подтверждаемой);           |
|   |                |                |                                |
|   |                |                | -   \<status\> -- статус       |
|   |                |                |     подтверждения категории;   |
|   |                |                |                                |
|   |                |                | -   OK -- Категория присвоена  |
|   |                |                |     и содержится в справочнике |
|   |                |                |     ЕСНСИ и в ЕСИА;            |
|   |                |                |                                |
|   |                |                | -   \<confirmDate\> -- дата и  |
|   |                |                |     время подтверждения        |
|   |                |                |     категории в формате        |
|   |                |                |     timestamp;                 |
|   |                |                |                                |
|   |                |                | -   \<confirmOrgName\> --      |
|   |                |                |     наименование организации,  |
|   |                |                |     подтверждающей категорию   |
|   |                |                |     (указывается только для    |
|   |                |                |     подтверждаемых категорий   |
|   |                |                |     (catConfirm=Y));           |
|   |                |                |                                |
|   |                |                | -   \<confirmOrgOid\> -- OID   |
|   |                |                |     организации в ЕСИА,        |
|   |                |                |     которая подтверждает       |
|   |                |                |     данную категорию           |
|   |                |                |     (указывается только\       |
|   |                |                |     для подтверждаемых         |
|   |                |                |     категорий (catConfirm=Y)); |
|   |                |                |                                |
|   |                |                | -   \<confirmOrgValueType\> -- |
|   |                |                |     тип идентификатора         |
|   |                |                |     организации, которая       |
|   |                |                |     подтверждает данную        |
|   |                |                |     категорию (указывается     |
|   |                |                |     только для подтверждаемых  |
|   |                |                |     категорий (catConfirm=Y)). |
|   |                |                |     Может принимать следующие  |
|   |                |                |     значения:                  |
|   |                |                |                                |
|   |                |                | -   OGRN;                      |
|   |                |                |                                |
|   |                |                | -   \<confirmOrgVal\> --       |
|   |                |                |     значение идентификатора    |
|   |                |                |     организации, которая       |
|   |                |                |     подтверждает данную        |
|   |                |                |     категорию (указывается     |
|   |                |                |     только для подтверждаемых  |
|   |                |                |     категорий (catConfirm=Y))  |
+---+----------------+----------------+--------------------------------+

Пример ответа с категориями самозанятого (разрывы строки даны для
удобства чтения):

{

\"stateFacts\":\[

\"FirstPage\",

\"Paginated\"

\],

\"size\": 2,

\"pageSize\": 100,

\"pageIndex\": 1,

\"elements\":\[

{

\"parentName\": \"Ремонт\",

\"parentId\": \"1001\",

\"catName\": \"Сантехник\",

\"catId\": \"1005\",

\"catConfirm\": \"N\",

\"status\": \"OK\",

\"confirmDate\": 1599078238000

},

{

\"parentName\": \"Развлечения\",

\"parentId\": \"1121\",

\"catName\": \"Торговля фруктовой, ягодной, овощной продукцией,
выращенной самостоятельно\",

\"catId\": \"44\",

\"catConfirm\": \"N\",

\"status\": \"OK\",

\"confirmDate\": 1599077915000

}

\]

}

## Проверка факта удаления УЗ и связанных с ней персональных данных пользователя из ЕСИА

Вызов данной операции предоставляет интегрированным с ЕСИА ИС данные
об удаленных пользователях в ЕСИА (идентификатор пользователя). Для
получения перечня удаленных пользователей система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные. В
качестве этого ресурса используется стандартный идентификатор ресурса
с персональными данными пользователей (/prns), возвращающий перечень
зарегистрированных в системе пользователей (см. п. А.2, Приложение А).
Специфика вызова данной операции состоит в том, что запрос должен
содержать следующие параметры:

-   \<status\> -- статус пользователя, должен иметь значение «DELETED»;

-   \<updatedSince\> -- дата, начиная с которой необходимо отобразить
    удаленных пользователей. Задается как количество секунд, прошедших с
    00:00:00 UTC\
    1 января 1970 года.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (*scope*
http://esia.gosuslugi.ru/tech_inf с параметрами).

Пример запроса (вызов сервиса в среде разработки):

GET /rs/prns?status=DELETED&updatedSince=1384218061 HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

В качестве ответа передается перечень физических лиц, удаленных с
указанной даты. Этот перечень представляет собой список ссылок на ресурс
с указанием {oid}, содержащий идентификаторы всех удаленных физических
лиц начиная с указанной в запросе даты.

## Предоставление данных из профиля организации

Для получения данных об организациях система-клиент должна направить в
https-адрес REST API системы ЕСИА[^23] запрос методом GET. В запросе
должен быть указан ресурс, содержащий необходимые данные. Идентификатор
этого ресурса в ЕСИА имеет следующий вид:

/orgs/{orgOid}/{collection_name}/{collection_entity_id},

где:

-   orgs -- коллекция организаций, имеющихся в ЕСИА;

-   orgOid -- внутренний идентификатор организации в ЕСИА;

-   {collection_name} -- ссылка на перечень (коллекцию) типов данных
    организации с указанным oid, возможные значения:

    -   ctts -- контактные данные;

    -   addrs -- адреса;

    -   vhls -- транспортные средства;

    -   brhs -- филиалы организации;

-   {collection_entity_id} -- внутренний идентификатор контакта, адреса,
    транспортного средства или филиала.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (*scope* в зависимости от полномочий
системы).

Пример запроса (вызов сервиса в среде разработки):

GET /rs/orgs/1000000000 HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

Данные, которые ЕСИА возвращает в ответ на запрос, представлены в
таблице 5.

Таблица 5 -- Параметры ответа на запрос о данных организации

+---+--------------+----------------+---------------------------------+
| № | URI          | Описание       | Предоставляемые данные          |
|   | за           | ресурса        |                                 |
|   | прашиваемого |                |                                 |
|   | ресурса      |                |                                 |
+===+==============+================+=================================+
| 1 | /o           | Данные об      | Данные об организации:          |
| . | rgs/{orgOid} | организации    |                                 |
|   |              | с и            | -   \<shortName\> --            |
|   |              | дентификатором |     сокращенное наименование    |
|   |              | {orgOid}       |     организации;                |
|   |              |                |                                 |
|   |              |                | -   \<fullName\> -- полное      |
|   |              |                |     наименование организации;   |
|   |              |                |                                 |
|   |              |                | -   \<type\> -- тип             |
|   |              |                |     организации.\               |
|   |              |                |     Для государственных         |
|   |              |                |     организаций -- «AGENCY»,    |
|   |              |                |     для юридических лиц --      |
|   |              |                |     «LEGAL»;                    |
|   |              |                |                                 |
|   |              |                | -   \<ogrn\> -- ОГРН            |
|   |              |                |     организации;                |
|   |              |                |                                 |
|   |              |                | -   \<inn\> -- ИНН организации; |
|   |              |                |                                 |
|   |              |                | -   \<leg\> -- код              |
|   |              |                |     организационно-правовой     |
|   |              |                |     формы по общероссийскому    |
|   |              |                |     классификатору              |
|   |              |                |     организационно-правовых     |
|   |              |                |     форм;                       |
|   |              |                |                                 |
|   |              |                | -   \<kpp\> -- КПП организации; |
|   |              |                |                                 |
|   |              |                | -   \<agencyTerRange\> --       |
|   |              |                |     территориальная             |
|   |              |                |     принадлежность ОГВ (только\ |
|   |              |                |     для государственных         |
|   |              |                |     организаций, код            |
|   |              |                |     по справочнику «Субъекты    |
|   |              |                |     Российской Федерации»       |
|   |              |                |     (ССРФ), для Российской      |
|   |              |                |     Федерации используется код  |
|   |              |                |     00;                         |
|   |              |                |                                 |
|   |              |                | -   \<agencyType\> -- тип ОГВ   |
|   |              |                |     (только\                    |
|   |              |                |     для государственных         |
|   |              |                |     организаций)[^24];          |
|   |              |                |                                 |
|   |              |                | -   \<staffCount\> --           |
|   |              |                |     количество сотрудников      |
|   |              |                |     организации;                |
|   |              |                |                                 |
|   |              |                | -   \<branchesCount\> --        |
|   |              |                |     количество филиалов         |
|   |              |                |     организации (только для ЮЛ  |
|   |              |                |     и ОГВ)                      |
+---+--------------+----------------+---------------------------------+
| 2 | /orgs/{      | Перечень       | Перечень филиалов организации   |
| . | orgOid}/brhs | филиалов       | (в виде ссылок\                 |
|   |              | организации    | на ресурс c указанием           |
|   |              |                | {branch_id}, содержащий данные  |
|   |              |                | о каждом филиале)               |
+---+--------------+----------------+---------------------------------+
| 3 | /orgs/{      | Сведения о     | Данные о филиале:               |
| . | orgOid}/brhs | филиале        |                                 |
|   | /{branch_id} | организации    | -   \<name\> -- имя филиала;    |
|   |              |                |                                 |
|   |              |                | -   \<kpp\> -- КПП филиала;     |
|   |              |                |                                 |
|   |              |                | -   \<leg\> -- код              |
|   |              |                |     организационно-правовой     |
|   |              |                |     формы по общероссийскому    |
|   |              |                |     классификатору              |
|   |              |                |     организационно-правовых     |
|   |              |                |     форм;                       |
|   |              |                |                                 |
|   |              |                | -   \<staffCount\> --           |
|   |              |                |     количество сотрудников      |
|   |              |                |     филиала.                    |
|   |              |                |                                 |
|   |              |                | > Для просмотра контактных      |
|   |              |                | > данных и адресов филиала      |
|   |              |                | > следует воспользоваться       |
|   |              |                | > ресурсами                     |
|   |              |                | > /orgs                         |
|   |              |                | /{orgOid}/brhs/{branch_id}/ctts |
|   |              |                |                                 |
|   |              |                | и                               |
|   |              |                | /orgs/                          |
|   |              |                | {orgOid}/brhs/{branch_id}/addrs |
|   |              |                | соответственно. Структура этих  |
|   |              |                | ресурсов аналогична ресурсам    |
|   |              |                | головной организации            |
+---+--------------+----------------+---------------------------------+
| 4 | /orgs/{      | Перечень       | Перечень контактов организации  |
| . | orgOid}/ctts | контактов      | (в виде ссылок на ресурс c      |
|   |              | организации    | указанием {ctt_id}, содержащий  |
|   |              |                | данные о каждом контакте)       |
+---+--------------+----------------+---------------------------------+
| 5 | /org         | Сведения об    | Контактные данные:              |
| . | s/{orgOid}/c | отдельной      |                                 |
|   | tts/{ctt_id} | записи         | -   \<type\> -- тип записи,     |
|   |              | в перечне      |     может иметь значения:       |
|   |              | контактов      |                                 |
|   |              | организации    | -   «OPH» -- телефон;           |
|   |              |                |                                 |
|   |              |                | -   «OFX» -- факс;              |
|   |              |                |                                 |
|   |              |                | -   «OEM» -- электронная почта; |
|   |              |                |                                 |
|   |              |                | -   \<vrfStu\> -- сведения о    |
|   |              |                |     «подтвержденности»          |
|   |              |                |     контактов, может иметь      |
|   |              |                |     значения:                   |
|   |              |                |                                 |
|   |              |                | -   «NOT_VERIFIED» -- не        |
|   |              |                |     подтвержден;                |
|   |              |                |                                 |
|   |              |                | -   «VERIFIED» -- подтвержден;  |
|   |              |                |                                 |
|   |              |                | -   \<value\> -- значение       |
|   |              |                |     контакта                    |
+---+--------------+----------------+---------------------------------+
| 6 | /orgs/{o     | Перечень       | Перечень адресов организации (в |
| . | rgOid}/addrs | адресов        | виде ссылок\                    |
|   |              | организации    | на ресурс c указанием           |
|   |              |                | {addr_id}, содержащий данные о  |
|   |              |                | каждом адресе)                  |
+---+--------------+----------------+---------------------------------+
| 7 | /otg/        | Сведения об    | Контактные данные:              |
| . | {orgOid}/add | отдельной      |                                 |
|   | rs/{addr_id} | записи в       | -   \<type\> -- тип записи,     |
|   |              | перечне        |     может иметь значения:       |
|   |              | адресов        |                                 |
|   |              | организации    | -   «OLG» -- юридический адрес; |
|   |              |                |                                 |
|   |              |                | -   «OPS» -- фактический адрес; |
|   |              |                |                                 |
|   |              |                | -   \<zipCode\> -- индекс;      |
|   |              |                |                                 |
|   |              |                | -   \<countryId\> --            |
|   |              |                |     идентификатор страны;       |
|   |              |                |                                 |
|   |              |                | -   \<addressStr\> -- адрес в   |
|   |              |                |     виде строки\                |
|   |              |                |     (не включая дом, строение,  |
|   |              |                |     корпус, номер квартиры);    |
|   |              |                |                                 |
|   |              |                | -   \<building\> -- строение;   |
|   |              |                |                                 |
|   |              |                | -   \<frame\> -- корпус;        |
|   |              |                |                                 |
|   |              |                | -   \<house\> -- дом;           |
|   |              |                |                                 |
|   |              |                | -   \<flat\> -- квартира;       |
|   |              |                |                                 |
|   |              |                | -   \<fiasCode\> -- код ФИАС;   |
|   |              |                |                                 |
|   |              |                | -   \<region\> -- регион;       |
|   |              |                |                                 |
|   |              |                | -   \<city\> -- город;          |
|   |              |                |                                 |
|   |              |                | -   \<district\> --             |
|   |              |                |     внутригородской район;      |
|   |              |                |                                 |
|   |              |                | -   \<area\> -- район;          |
|   |              |                |                                 |
|   |              |                | -   \<settlement\> --           |
|   |              |                |     поселение;                  |
|   |              |                |                                 |
|   |              |                | -   \<additionArea\> -- доп.    |
|   |              |                |     территория;                 |
|   |              |                |                                 |
|   |              |                | -   \<additionAreaStreet\> --   |
|   |              |                |     улица на доп. территории;   |
|   |              |                |                                 |
|   |              |                | -   \<street\> -- улица         |
+---+--------------+----------------+---------------------------------+
| 8 | /orgs/{      | Перечень       | Перечень транспортных средств,  |
| . | orgOid}/vhls | транспортных   | которыми владеет данная         |
|   |              | средств        | организация                     |
|   |              |                |                                 |
+---+--------------+----------------+---------------------------------+
| 9 | orgs/{orgOi  | Перечень       | Перечень транспортных средств,  |
| . | d}/vhls?embe | транспортных   | которыми владеет данная         |
|   | d=(vehicles) | средств\       | организация, содержащий         |
|   |              | с данными о    | информацию о каждом             |
|   | or           | каждом         | транспортном средстве           |
|   | gs/{orgOid}/ | транспортном   |                                 |
|   | vhls?embed=( | средстве       |                                 |
|   | elements--1) |                |                                 |
+---+--------------+----------------+---------------------------------+
| 1 | /orgs        | Транспортное   | -   \<name\> -- имя автомобиля  |
| 0 | /{orgOid}/vh | средство       |     (например, марка или другое |
| . | ls/{vhl--id} | организации    |     пользовательское описание); |
|   |              |                |                                 |
|   |              |                | -   \<numberPlate\> --          |
|   |              |                |     государственный             |
|   |              |                |     регистрационный знак;       |
|   |              |                |                                 |
|   |              |                | -   \<regCertificate\> --       |
|   |              |                |     данные свидетельства        |
|   |              |                |     о государственной           |
|   |              |                |     регистрации, включает\      |
|   |              |                |     в себя атрибуты:            |
|   |              |                |                                 |
|   |              |                | -   \<series\> -- серия         |
|   |              |                |     свидетельства;              |
|   |              |                |                                 |
|   |              |                | -   \<number\> -- номер         |
|   |              |                |     свидетельства               |
+---+--------------+----------------+---------------------------------+

Пример ответа с кратким наименованием организации (фрагмент, разрывы
строк даны для удобства чтения):

{

\"stateFacts\": \[\"Identifiable\"\],

\"shortName\": \"Банк\"

}

Пример ответа с контактными данными об адресах организации при
использовании возможностей встраивания[^25] (фрагмент, разрывы строк
даны для удобства чтения):

{

\"stateFacts\": \[\"hasSize\"\],

\"elements\": \[

{

\"stateFacts\": \[\"Identifiable\"\],

\"id\": 62,

\"type\": \"OLG\",

\"region\": \"Москва Город\",

\"addressStr\": \"Москва Город, Ангарская улица\",

\"countryId\": \"RUS\",

\"zipCode\": \"125635\",

\"street\": \"Ангарская улица\",

\"house\": \"10\",

\"flat\": \"96\"

}

\],

\"size\": 1

}

Пример ответа на запрос всех транспортных средств организации,
полученный с использованием возможностей встраивания[^26] (фрагмент,
разрывы строк даны\
для удобства чтения):

{

\"stateFacts\": \[\"Paginated\"\],

\"size\": 5,

\"pageSize\": 5,

\"pageIndex\": 2,

\"totalSize\": 12,

\"eTag\": \"E6DAE96DADE1CA29F5C50979BBB7C8BF4422FD62\",

\"elements\": \[{

\"stateFacts\": \[\"Identifiable\"\],

\"id\": 6590,

\"name\": \"TOYOTA\",

\"numberPlate\": \"A111AA136\",

\"regCertificate\": {\"series\": \"1234\",\"number\": \"123456\"},

\"eTag\": \"F69EEA8910E298E97C8E6249A130A7195DFE7F1A\"},

\...\...\...\....

}

Для получения данных о категориях организации система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса

в ЕСИА имеет следующий вид:

/categories/orgs/{orgOid},

где:

-   categories -- коллекция категорий, имеющихся в ЕСИА;

-   orgs -- коллекция организаций, имеющихся в ЕСИА;

-   orgOid -- внутренний идентификатор организации в ЕСИА.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (*scope* в зависимости от полномочий
системы).

Пример запроса (вызов сервиса в среде разработки):

GET categories/orgs/1000364913 HTTP/1.1\\r\\n

Authorization: Bearer
eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IkdPU1QzNDEwXzIwMTJfMjU2In0.eyJuYmYiOjE1OTk1NTQ1MDEsInNjb3BlIjoib3BlbmlkIGNhdGVnb3JpZXM_b2lkPTEwMDAzNjQ5MTMiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiMWQ0OWQ5ZGMzY2FiZThhMjJjNDRhODdlODMyNzMzMDRlOWI1YjE1ODJkNTlkN2E2N2VhZGJjODg5OWM5MjBjZSIsInVybjplc2lhOnNial9pZCI6MTAwMDM2NjU4NywiZXhwIjoxNTk5NTU4MTAxLCJpYXQiOjE1OTk1NTQ1MDEsImNsaWVudF9pZCI6IlJBX1RPT0wifQ.eBzsv8_x6DG5kP--D1Jx2ODUkYJlC71m6aCOum7Q6ufrnu110JrBs9HF1_iO_2GovSnfHH8VZ2U4RkF8wGR3_nA\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

Данные, которые ЕСИА возвращает в ответ на запрос, представлены в
таблице 6.

Таблица 6 -- Параметры ответа на запросы о данных организации

+---+-----------------+----------------+------------------------------+
| № | URI             | Описание       | Предоставляемые данные       |
|   | запрашиваемого  | ресурса        |                              |
|   | ресурса         |                |                              |
+===+=================+================+==============================+
| 1 | /categorie      | Данные о       | Данные о категориях          |
| \ | s/orgs/{orgOid} | категорих      | организации:                 |
| . |                 | организации    |                              |
|   |                 | с и            | -   \<stateFacts\> --        |
|   |                 | дентификатором |     параметр, указывающий\   |
|   |                 | {orgOid}       |     на факты о               |
|   |                 |                |     предоставляемых          |
|   |                 |                |     сведениях (постраничный  |
|   |                 |                |     список, имеет размер\    |
|   |                 |                |     и т.п.);                 |
|   |                 |                |                              |
|   |                 |                | -   \<size\> -- количество   |
|   |                 |                |     категорий\               |
|   |                 |                |     в коллекции;             |
|   |                 |                |                              |
|   |                 |                | -   \<pageSize\> -- параметр |
|   |                 |                |     пагинации (размер        |
|   |                 |                |     страницы -- количество   |
|   |                 |                |     элементов\               |
|   |                 |                |     на странице);            |
|   |                 |                |                              |
|   |                 |                | -   \<pageIndex\> --         |
|   |                 |                |     параметр пагинации       |
|   |                 |                |     (номер страницы);        |
|   |                 |                |                              |
|   |                 |                | -   \<elements\> -- массив,  |
|   |                 |                |     содержащий информацию    |
|   |                 |                |     о категориях:            |
|   |                 |                |                              |
|   |                 |                | -   \<parentName\> --        |
|   |                 |                |     наименование             |
|   |                 |                |     родительской категории;  |
|   |                 |                |                              |
|   |                 |                | -   \<parentId\> --          |
|   |                 |                |     идентификатор            |
|   |                 |                |     родительской категории;  |
|   |                 |                |                              |
|   |                 |                | -   \<catName\> --           |
|   |                 |                |     наименование категории;  |
|   |                 |                |                              |
|   |                 |                | -   \<catId\> --             |
|   |                 |                |     идентификатор категории; |
|   |                 |                |                              |
|   |                 |                | -   \<catConfirm\> --        |
|   |                 |                |     признак того,\           |
|   |                 |                |     что категория является   |
|   |                 |                |     подтверждаемой (N --     |
|   |                 |                |     категория\               |
|   |                 |                |     не подтверждаемая, Y --  |
|   |                 |                |     категория является       |
|   |                 |                |     подтверждаемой);         |
|   |                 |                |                              |
|   |                 |                | -   \<status\> -- статус     |
|   |                 |                |     подтверждения категории; |
|   |                 |                |                              |
|   |                 |                | -   OK -- категория          |
|   |                 |                |     присвоена и содержится   |
|   |                 |                |     в справочнике ЕСНСИ и в  |
|   |                 |                |     ЕСИА;                    |
|   |                 |                |                              |
|   |                 |                | -   \<confirmDate\> -- дата  |
|   |                 |                |     и время подтверждения    |
|   |                 |                |     категории в формате      |
|   |                 |                |     timestamp;               |
|   |                 |                |                              |
|   |                 |                | -   \<confirmOrgName\> --    |
|   |                 |                |     наименование             |
|   |                 |                |     организации,             |
|   |                 |                |     подтверждающей категорию |
|   |                 |                |     (указывается только для  |
|   |                 |                |     подтверждаемых категорий |
|   |                 |                |     (catConfirm=Y));         |
|   |                 |                |                              |
|   |                 |                | -   \<confirmOrgOid\> -- OID |
|   |                 |                |     организации\             |
|   |                 |                |     в ЕСИА, которая          |
|   |                 |                |     подтверждает данную      |
|   |                 |                |     категорию (указывается   |
|   |                 |                |     только\                  |
|   |                 |                |     для подтверждаемых       |
|   |                 |                |     категорий                |
|   |                 |                |     (catConfirm=Y));         |
|   |                 |                |                              |
|   |                 |                | -   \<confirmOrgValueType\>  |
|   |                 |                |     -- тип идентификатора    |
|   |                 |                |     организации, которая     |
|   |                 |                |     подтверждает данную      |
|   |                 |                |     категорию (указывается   |
|   |                 |                |     только для               |
|   |                 |                |     подтверждаемых категорий |
|   |                 |                |     (catConfirm=Y)). Может   |
|   |                 |                |     принимать следующие      |
|   |                 |                |     значения:                |
|   |                 |                |                              |
|   |                 |                | -   OGRN;                    |
|   |                 |                |                              |
|   |                 |                | -   \<confirmOrgVal\> --     |
|   |                 |                |     значение идентификатора  |
|   |                 |                |     организации, которая     |
|   |                 |                |     подтверждает данную      |
|   |                 |                |     категорию (указывается   |
|   |                 |                |     только\                  |
|   |                 |                |     для подтверждаемых       |
|   |                 |                |     категорий                |
|   |                 |                |     (catConfirm=Y))          |
+---+-----------------+----------------+------------------------------+

Пример ответа с категориями, которые являются подтверждаемыми\
и не подтверждаемыми:

{

    \"stateFacts\": \[

        \"Paginated\",

        \"FirstPage\"

    \],

    \"size\": 4,

    \"pageSize\": 100,

    \"pageIndex\": 1,

    \"elements\": \[

        {

            \"parentName\": \"Тестовая родительская категория 1\",

            \"parentId\": \"1\",

            \"catName\": \"Категория 1\",

            \"catId\": \"109\",

            \"catConfirm\": \"N\",

            \"status\": \"OK\",

            \"confirmDate\": 1594760400000

        },

        {

            \"parentName\": \"Тестовая родительская категория 2\",

            \"parentId\": \"2\",

            \"catName\": \"Иные организации\",

            \"catId\": \"24\",

            \"catConfirm\": \"N\",

            \"status\": \"OK\",

            \"confirmDate\": 1593637200000

        },

        {

            \"parentName\": \"Тестовая родительская категория 2\",

            \"parentId\": \"2\",

            \"catName\": \"Банки (Банковские кредитные организации)\",

            \"catId\": \"6\",

            \"catConfirm\": \"Y\",

            \"confirmOrgName\": \"Федеральная налоговая служба\",

            \"confirmOrgOid\": 1000298999,

            \"confirmOrgValueType\": \"OGRN\",

            \"confirmOrgVal\": \"1047707030513\",

            \"status\": \"OK\",

            \"confirmDate\": 1593464400000

        },

        {

            \"parentName\": \"Тестовая родительская категория 2\",

            \"parentId\": \"2\",

            \"catName\": \"Категория 2\",

            \"catId\": \"67\",

            \"catConfirm\": \"Y\",

            \"confirmOrgName\": \"Федеральная налоговая служба\",

            \"confirmOrgOid\": 1000298999,

            \"confirmOrgValueType\": \"OGRN\",

            \"confirmOrgVal\": \"1047707030513\",

            \"status\": \"OK\",

            \"confirmDate\": 1593637200000

        }

    \]

}

## Предоставление списка участников организации

Для получения данных об участниках организации система-клиент должна
направить по в https-адрес REST API системы ЕСИА[^27] запрос методом
GET. В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид для получения
списка сотрудников организации необходимо использовать: uri
/orgs/{orgOid}/emps/{prn_oid}, где:

-   emps -- перечень (коллекция) сотрудников организаций с данным
    {orgOid};

-   prn_oid -- внутренний идентификатор физического лица в ЕСИА.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (*scope*
http://esia.gosuslugi.ru/org_emps с параметрами).

Пример запроса (вызов сервиса в среде разработки):

GET /rs/orgs/1000000000/emps HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

Данные, которые ЕСИА возвращает в ответ на запрос, представлены в
таблице 7.

Таблица 7 -- Параметры ответа на запрос об участниках организации

+---+------------------+----------------+------------------------------+
| № | URI              | Описание       | Предоставляемые данные       |
|   | запрашиваемого   | ресурса        |                              |
|   | ресурса          |                |                              |
+===+==================+================+==============================+
| 1 | /or              | Перечень       | Перечень сотрудников данной  |
| . | gs/{orgOid}/emps | сотрудников    | организации (в виде ссылок   |
|   |                  | организации    | на ресурс c указанием        |
|   |                  |                | {prn_oid}, содержащий данные |
|   |                  |                | о каждом сотруднике). При    |
|   |                  |                | наличии филиалов\            |
|   |                  |                | у организации при запросе    |
|   |                  |                | будет возвращаться перечень  |
|   |                  |                | сотрудников только головной  |
|   |                  |                | организации                  |
+---+------------------+----------------+------------------------------+
| 2 | /orgs/{orgOid    | Данные о       | Данные о сотруднике:         |
| . | }/emps/{prn_oid} | сотруднике     |                              |
|   |                  | организации    | -   \<position\> --          |
|   |                  | с и            |     должность;               |
|   |                  | дентификатором |                              |
|   |                  | {prn_oid}      | -   \<chief\> -- сведения о  |
|   |                  |                |     том, является\           |
|   |                  |                |     ли сотрудник             |
|   |                  |                |     руководителем            |
|   |                  |                |     организации (в этом      |
|   |                  |                |     случае имеет значение    |
|   |                  |                |     «true»)                  |
|   |                  |                |                              |
|   |                  |                | > или нет («false»);         |
|   |                  |                |                              |
|   |                  |                | -   \<orgOid\> --            |
|   |                  |                |     идентификатор            |
|   |                  |                |     организации, сотрудником |
|   |                  |                |     которой является         |
|   |                  |                |     пользователь;            |
|   |                  |                |                              |
|   |                  |                | -   \<brhOid\> --            |
|   |                  |                |     идентификатор филиала    |
|   |                  |                |     организации, сотрудником |
|   |                  |                |     которой является         |
|   |                  |                |     пользователь (если       |
|   |                  |                |     сотрудник присоединен    |
|   |                  |                |     к филиалу);              |
|   |                  |                |                              |
|   |                  |                | -   \<blocked\> -- признак   |
|   |                  |                |     блокировки сотрудника    |
|   |                  |                |     (имеет значение «true»\  |
|   |                  |                |     или «false»)             |
+---+------------------+----------------+------------------------------+

Для просмотра перечня сотрудников филиала организации необходимо
указать\
в запросе параметр brhOid и значение идентификатора соответствующего
филиала. Пример ссылки, по которой будет возвращен перечень сотрудников
филиала с идентификатором 1004082214:

https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000001/emps?brhOid=1004082214

При отображении всех коллекций (orgs, emps) используется механизм
paging.

Пример ответа на запрос сведений о перечне сотрудников организации
с идентификатором 1000000000 (фрагмент, разрывы строк даны для удобства
чтения):

{

\"stateFacts\": \[\"hasSize\"\],

\"elements\":\[

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/222896320\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/240612402\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/243280304\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/243280305\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/243280312\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/1000000008\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/1000000009\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000000/emps/1000000385\"

\],

\"size\":\"8\"

}

Пример ответа с контактными данными о сотрудниках организации\
при использовании возможности встраивания[^28] (разрывы строки даны для
удобства чтения):

{

\"stateFacts\": \[\"Paginated\", \"FirstPage\", \"LastPage\"\],

\"elements\": \[

{

\"stateFacts\": \[\"Identifiable\"\],

\"prnOid\": 1000000125,

\"orgOid\": 100000,

\"chief\": false,

\"corporateContact\": \"mail@example.com\",

\"person\": {

\"stateFacts\": \[\"Identifiable\"\],

\"firstName\": \"Петр\",

\"lastName\": \"Петров\",

\"middleName\": \"Петрович\",

\"gender\": \"M\",

\"updatedOn\": 1387519441

}

},

{

\"stateFacts\": \[\"Identifiable\"\],

\"prnOid\": 1000004892,

\"orgOid\": 100000,

\"position\": \"Руководитель\",

\"chief\": true,

\"person\": {

\"stateFacts\": \[\"Identifiable\"\],

\"firstName\": \"Иван\",

\"lastName\": \"Иванов\",

\"middleName\": \"Иванович\",

\"gender\": \"M\",

\"updatedOn\": 1387466948

}

}

\],

\"pageSize\": 100,

\"pageIndex\": 1

}

## Предоставление сведений о вхождении пользователя в группы

Для получения данных о вхождении пользователя в группы организации
система-клиент должна направить по в https-адрес REST API системы
ЕСИА[^29] запрос методом GET. В запросе должен быть указан ресурс,
содержащий необходимые данные.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу -- *область доступа (scope)*:
http://esia.gosuslugi.ru/org_emps с параметрами.\
Для доступа к полному перечню групп, владельцем которых является данная
организация, необходим *scope*: <http://esia.gosuslugi.ru/org_grps>.

Пример запроса (вызов сервиса в среде разработки):

GET /rs/orgs/1000000000/grps HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

Данные, которые ЕСИА возвращает в ответ на запрос, представлены в
таблице 8.

Таблица 8 -- Параметры ответа на запрос о вхождении сотрудников
организации в группы

+---+-----------------+----------------+------------------------------+
| № | URI             | Описание       | Предоставляемые данные       |
|   | запрашиваемого  | ресурса        |                              |
|   | ресурса         |                |                              |
+===+=================+================+==============================+
| 1 | /org            | Перечень групп | Перечень групп, владельцем   |
| . | s/{orgOid}/grps | организации    | которых является данная      |
|   |                 |                | организация (в виде перечня  |
|   |                 |                | строк grp_id -- указывающих  |
|   |                 |                | на мнемонику имеющихся       |
|   |                 |                | в рамках данной организации  |
|   |                 |                | групп). Для получения этого  |
|   |                 |                | перечня групп запрос должен  |
|   |                 |                | быть добавлен header с       |
|   |                 |                | маркером доступа на область  |
|   |                 |                | доступа (scope):             |
|   |                 |                | http                         |
|   |                 |                | ://esia.gosuslugi.ru/org_ful |
+---+-----------------+----------------+------------------------------+
| 2 | /orgs/{orgOid   | Данные о       | -   Данные о группе:         |
| . | }/grps/{grp_id} | группе         |                              |
|   |                 | организации    | -   \<name\> -- имя;         |
|   |                 | с мнемоникой   |                              |
|   |                 | {grp--id}      | -   \<description\> --       |
|   |                 |                |     описание;                |
|   |                 |                |                              |
|   |                 |                | -   \<system\> -- сведения о |
|   |                 |                |     том, является ли группа  |
|   |                 |                |     системной (в этом случае |
|   |                 |                |     имеет значение «true»)   |
|   |                 |                |     или нет («false»).       |
|   |                 |                |                              |
|   |                 |                | Также при запросе данных о   |
|   |                 |                | конкретной группе            |
|   |                 |                | возвращаются ссылки (links)  |
|   |                 |                | на ИС,\                      |
|   |                 |                | к которым относятся данные   |
|   |                 |                | группы                       |
+---+-----------------+----------------+------------------------------+
| 3 | /org            | Перечень       | Перечень групп, членом       |
| . | s/{orgOid}/emps | групп, членом  | которых является сотрудник с |
|   | /{prn_oid}/grps | которых        | данным {prn_oid} (в виде     |
|   |                 | является       | перечня строк grp_id --      |
|   |                 | данный         | указывающих на мнемонику     |
|   |                 | сотрудник      | имеющихся в рамках данной    |
|   |                 |                | организации групп)           |
+---+-----------------+----------------+------------------------------+

При запросе перечня групп, членом которых является данный сотрудник,
отображается перечень ссылок в следующем формате:

/orgs/{orgOid}/emps/{prn_oid}/grps/{grp_id}/{it_sys_id}, где it_sys_id
-- мнемоника ИС, в рамках которой действует данная группа. Пример ссылки
на группу:

https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000224/emps/1000000105/grps/ORG_ADMIN/ESIA

Данная ссылка означает, что пользователь с идентификатором 1000000105
как сотрудник организации 1000000224 включен в группу администраторов
профиля организации (ORG_ADMIN) системы ЕСИА (мнемоника ESIA). Выполнив
запрос по данной ссылке можно получить краткую информацию о группе,
которая включает в себя:

-   мнемонику группы (grp_id);

-   название группы (name);

-   описание группы (description);

-   признак того, что группа является системной (system);

-   мнемоника системы--владельца группы (itSystem).

Например:

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"grp_id\": \"ORG_ADMIN\",

\"name\": \"Администраторы профиля организации\",

\"description\": \"Сотрудники организации, имеющие право приглашать
сотрудников, а также включать сотрудников в группы доступа\",

\"system\": \"true\",

\"itSystem\": \"ESIA\"

}

Если группа не является системной и не привязана ни к какой системе, то
ссылка на нее имеет следующий формат:
/orgs/{orgOid}/emps/{prn_oid}/grps/{grp_id}.

В кратких данных об этой группе атрибут «system» будет иметь значение
«false».

При запросе перечня групп, членом которых является данный сотрудник,
имеется возможность получить только те группы, которые относятся к
определенной информационной системе. Для этого необходимо добавить
условие на отбор групп выбранной системы (itSystemName), равное
мнемонике данной системы. Пример запроса на получение групп системы ЕСИА
(ESIA), в которые включен сотрудник:

GET /rs/orgs/1000000224/emps/1000000105/grps?itSystemName=ESIA
HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

## Управление данными организации

Программные интерфейсы на основе REST обеспечивают возможность
управления данными организации для ИС этой организации. Обеспечена
возможность:

-   изменять данные профиля организации;

-   управлять приглашениями должностным лицам, зарегистрированным в
    ЕСИА, на присоединение к УЗ соответствующей организации;

-   управлять служебными данными присоединенных сотрудников, а также
    блокировать и удалять должностных лиц организации;

-   управлять полномочиями должностных лиц посредством изменения их
    членства в группах доступа;

-   предоставлять и отзывать доступ к непубличным группам;

-   добавлять и изменять данные филиалов организации.

Для осуществления данных операций система организации должна направить\
в https-адрес программного интерфейса ЕСИА запрос методом POST, PUT или
DELETE. Данный запрос в общем виде включает в себя новые атрибуты
организации. Кроме того, запрос должен включать в себя следующие данные:

-   маркер доступа, выданный системе на область доступа (scope) (в
    зависимости от полномочий системы) с параметром org_oid, принимающим
    значение идентификатора организации;

-   тег объекта -- метка изменяемого объекта (эта метка указывается в
    заголовке «If--Match» и в ряде случаев в теле запроса в параметре
    «eTag»);

Для получения информации о метке изменяемого объекта необходимо сделать
стандартный запрос методом GET на получение изменяемого ресурса --
конкретных данных организации (если последующий запрос делается на адрес
контейнера, то требуется указывать тег контейнера).

Пример метки изменяемого объекта (выделено полужирным шрифтом):

{

\"stateFacts\": \[

\"Identifiable\"

\],

**\"eTag\": \"4C50511FD3F404974C9AC8AB9C15683378DC05F8\"**,

\"oid\": 1000000001,

\"shortName\": \"Тестовая организация\",

\"fullName\": \" Тестовая организация \",

\"type\": \"LEGAL\",

\"ogrn\": \"1047702026701\",

\"inn\": \"0000000000\",

\"leg\": \"65142\"

}

### Изменение данных профиля организации

Программный интерфейс позволяет выполнить следующие операции:

-   задать, изменить и удалить служебные контакты организации (адрес
    электронной почты, номер телефона и факса);

-   задать, изменить и удалить почтовый адрес организации;

-   задать, изменить и удалить транспортные средства организации;

-   запросить, выдать, отозвать согласие на доступ к сведениям
    организации.

#### Редактирование контактов организации

Для добавления контакта организации должен быть выполнен запрос методом
POST на https-адрес программного интерфейса ЕСИА[^30]. В заголовке
запроса должен быть указан маркер доступа и тег контейнера с адресами
(метка, полученная при запросе ресурса
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/ctts). В тело
запроса должны быть включены:

-   \<type\> -- тип добавляемого контакта, принимает значение «OEM» для
    адреса электронной почты, «OPH» -- телефона, «OFX» -- факса;

-   \<value\> -- значение контакта.

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/ctts HTTP/1.1

Host: esia-portal1.test.gosulsugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0.HeKYMBlwx4LAE--dEnAw9cDLrky--g5133Q827J--pOiNC6Zct--KrZerA3AE6MTaHMicgqJrJls4LBg

Content--Type: application/json

If--Match: \"DC48A40EEEE25605ED940193398AF417EE752055\"

Cache--Control: no--cache

{\"type\": \"OEM\",

\"value\": \"test@test.com\"}

Для изменения контакта организации должен быть выполнен запрос методом
POST на https-адрес программного интерфейса ЕСИА[^31]. В заголовке
запроса должен быть указан маркер доступа и тег объекта (метка,
полученная при запросе ресурса:
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/ctts/{ctt_id}). В
тело запроса должны быть включены:

-   \<eTag\> -- тег изменяемого объекта (контакта);

-   \<type\> -- тип изменяемого контакта, принимает значение «OEM» для
    адреса электронной почты, «OPH» -- телефона, «OFX» -- факса;

-   \<value\> -- значение контакта.

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/ctts/58099 HTTP/1.1

Host: esia-portal1.test.gosulsugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0.HeKYMBlwx4LAE--dEnAw9cDLrky--g5133Q827J--pOiNC6Zct--KrZerA3AE6MTaHMicgqJrJls4LBg

Content--Type: application/json

If--Match: \"011EAB0AB1B69D4178158841E8096AE5DD9A233C \"

Cache--Control: no--cache

{ \"eTag\": \"011EAB0AB1B69D4178158841E8096AE5DD9A233C\",

\"type\": \"OPH\",

\"value\": \"+7(999)9999888\" }

Изменение контакта возможно и без указания в URL запроса идентификатора
контакта, в этом случае контакт будет изменен, но ему будет присвоен
другой идентификатор.

Для удаления контакта организации должен быть выполнен запрос методом
DELETE на https-адрес программного интерфейса ЕСИА[^32]. В заголовке
запроса должен быть указан маркер доступа и тег удаляемого объекта.

Пример запроса (разрывы строки даны для удобства чтения):

DELETE /rs/orgs/1000000001/ctts/58099 HTTP/1.1

Host: esia-portal1.test.gosulsugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0.HeKYMBlwx4LAE--dEnAw9cDLrky--g5133Q827J--pOiNC6Zct--KrZerA3AE6MTaHMicgqJrJls4LBg

Content--Type: application/json

If--Match: \"DC48A40EEEE25605ED940193398AF417EE752055\"

Cache--Control: no--cache

#### Редактирование почтового адреса организации

Для добавления почтового адреса организации необходимо сделать запрос
методом POST на https-адрес программного интерфейса ЕСИА[^33]. Заголовок
запроса должен включать в себя маркер доступа и тег контейнера адресов
(метка, полученная при запросе ресурса:
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/addrs).

Тело запроса должно включать следующие данные (указываются все данные,
которые должны отображаться в адресе этого типа):

-   тип адреса (type), принимает значение «OPS»;

-   регион (region);

-   код ФИАС (fiasCode);

-   строка адреса (addressStr), например, «Москва город, Тверская
    улица»;

-   идентификатор страны (countryId), для России -- «RUS»;

-   почтовый индекс (zipCode);

-   улица (street);

-   дом (house);

-   квартира (flat);

-   корпус (frame);

-   строение (building).

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/addrs HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0

Content--Type: application/json

If--Match: \"DE3372D5A4E2499C38C24E03C1919C9CA97FCF78\"

Cache--Control: no--cache

{

\"type\": \"OPS\",

\"region\": \"Псковская Область\",

\"fiasCode\": \"5bf5ddff--6353--4a3d--80c4--6fb27f00c6c1\",

\"addressStr\": \"Псковская область, Невельский район, Невель город,
Невель 1 поселок и(при) станция(и)\",

\"city\": \"Невель Город\",

\"area\": \"Невельский Район\",

\"countryId\": \"RUS\",

\"zipCode\": \"182500\",

\"street\": \"Невель 1 Поселок и(при) станция(и)\",

\"house\": \"5\",

\"flat\": \"5\"

}

Изменение адреса осуществляется по аналогии с добавлением, недопустимо
делать запрос с указанием конкретного идентификатора адреса.

Для удаления почтового адреса организации необходимо сделать запрос
методом DELETE на https-адрес программного интерфейса ЕСИА[^34].
Заголовок запроса должен включать в себя маркер доступа и тег удаляемого
адреса (метка, полученная при запросе ресурса
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/addrs/{addr_id}).

Пример запроса (разрывы строки даны для удобства чтения):

DELETE /rs/orgs/1000000001/addrs/13854 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0

Content--Type: application/json

If--Match: \"DE3372D5A4E2499C38C24E03C1919C9CA97FCF78\"

Cache--Control: no--cache

#### Управление сведениями о среднесписочной численности работников за предшествующий календарный год

В разделе «Общая информация» в подразделе «Среднесписочная численность»
могут быть доступны сведения о среднесписочной численности работников\
за предшествующий календарный год. Они загружаются в личный кабинет из
ФНС России при запросе или обновлении данных.

Запрос и обновление сведений о среднесписочной численности работников\
за предшествующий календарный год доступны при наличии ранее выданного
согласия Минцифры России в разделе «Общая информация» в подразделе
«Среднесписочная численность» (подробную информацию см. в п. А.7.1.6).

Доступность функций для пользователя зависит от его роли и полномочий
(таблица 9).

Таблица 9 -- Доступность функций в зависимости от ролей и полномочий

  -----------------------------------------------------------------------------------
  Действие/ Роль      Руководитель   Администратор   Сотрудник   Сотрудник
                                                                 с полномочиями
                                                                 «Право запроса
                                                                 выписки» \
                                                                 и «Право управления
                                                                 согласиями
                                                                 организации»
  ------------------- -------------- --------------- ----------- --------------------
  Просмотр списка     Да             Да              Да          Да
  сведений\                                                      
  о среднесписочной                                              
  численности                                                    
  работников                                                     

  Запрос/Обновление   Да             Да              Нет         Да
  сведений                                                       
  о среднесписочной                                              
  численности                                                    
  работников                                                     

  Выгрузка сведений\  Да             Да              Нет         Да
  о среднесписочной                                              
  численности                                                    
  работников                                                     
  -----------------------------------------------------------------------------------

##### А.7.1.3.1 Предоставление сведений о среднесписочной численности работников за предшествующий календарный год {#а.7.1.3.1-предоставление-сведений-о-среднесписочной-численности-работников-за-предшествующий-календарный-год .unnumbered}

Для получения сведений о среднесписочной численности работников\
за предшествующий календарный год предназначены внешние сервисы REST API
ЕСИА для ЮЛ, ОГВ и ИП для обеспечения внутреннего взаимодействия со
смежными системами ИЭП и вывода сведений о среднесписочной численности
работников\
за предшествующий календарный год в специальном разделе ЛК организации
ЕПГУ:

-   Получение сведений о среднесписочной численности работников\
    за предшествующий календарный год;

-   Проверка запуска обновления сведений о среднесписочной численности
    работников за предшествующий календарный год;

-   Запуск обновления сведений о среднесписочной численности работников\
    за предшествующий календарный год;

-   Отмена обновления сведений о среднесписочной численности работников\
    за предшествующий календарный год.

###### А.7.1.3.1.1 Получение сведений о среднесписочной численности работников за предшествующий календарный год {#а.7.1.3.1.1-получение-сведений-о-среднесписочной-численности-работников-за-предшествующий-календарный-год .unnumbered}

Для получения сведений о среднесписочной численности работников\
за предшествующий календарный год система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

**/api/public/{version}/org/{org_oid}/doc/srchis,**

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о среднесписочной численности
    работников\
    за предшествующий календарный год;

-   srchis -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope):

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_srchis?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/srchishttps://esia-portal1.test.gosuslugi.ru/

Пример успешного ответа:

Code: 200 OK

{

\"id\": \"4dae1bf2-a385-4065-bfa7-eca81a086d38\",

\"orgOid\": 1077494341,

\"data\": {

\"legalInfo\": {

\"inn\": \"5047053920\",

\"fullName\": \"АО \\\"РТ ЛАБС\\\"\"

},

\"averageHeadcount\": 1101,

\"averageHeadcountDate\": \"2022-01-01\",

\"documentDate\": \"2022-03-23\"

},

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 4,

\"createdOn\": \"2022-10-31T11:14:45.433\",

\"updatedOn\": \"2022-10-31T13:39:01.047\",

\"verifiedOn\": \"2022-03-23\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4636477/77994b7d-b4c9-37f4-0f7a-930d68754c8c.xml/40\",

\"location\": \"00\",

\"objectId\": \"4636477\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"77994b7d-b4c9-37f4-0f7a-930d68754c8c.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4636477/77994b7d-b4c9-37f4-0f7a-930d68754c8c.xml/40\",

\"location\": \"00\",

\"objectId\": \"4636477\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"77994b7d-b4c9-37f4-0f7a-930d68754c8c.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

Структура ответа в формате JSON:

-   orgOid -- идентификатор (oid) организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   data -- вложения ответа в формате JSON:

```{=html}
<!-- -->
```
-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   numberСorrecti -- номер корректировки для корректирующего документа;

-   orgInfo -- сведения о российской организации:

```{=html}
<!-- -->
```
-   legalInfo -- юридическое лицо:

```{=html}
<!-- -->
```
-   name -- наименование организации;

-   inn -- ИНН организации;

-   kpp -- КПП организации;

```{=html}
<!-- -->
```
-   individualInfo -- индивидуальный предприниматель:

```{=html}
<!-- -->
```
-   inn -- ИНН физического лица;

-   individualName -- фамилия, имя, отчество:

```{=html}
<!-- -->
```
-   lastName -- фамилия;

-   firstName -- имя;

-   middleName -- отчество;

```{=html}
<!-- -->
```
-   averageHeadcount -- среднесписочная численность работников;

-   averageHeadcountDate -- среднесписочная численность работников
    по состоянию на дату;

-   documentDate -- дата представления сведений о среднесписочной
    численности в налоговые органы;

```{=html}
<!-- -->
```
-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении\
    на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   attachments -- файл ФНС России:

```{=html}
<!-- -->
```
-   fileLink -- блок информации о файле;

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   location -- локация файла;

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значение 40 (файл имеет формат
    .xml);

-   mnemonic -- мнемоника файлов ответа от ФНС России со сведениями
    выписки о среднесписочной численности работников за предшествующий
    календарный год;

-   mimeType -- тип файла. Может принимать значение «XML» (файл);

-   main -- признак главного файла;

```{=html}
<!-- -->
```
-   mainAttachment -- главный файл;

-   vrs -- блок сведений при технических ошибках:

```{=html}
<!-- -->
```
-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки.

Возможные коды ошибок приведены в таблице 10.

Таблица 10 -- Справочник возможных кодов ошибок

  --------------------------------------------------------------------------
  Ошибка                                    Описание ошибки
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ЮЛ
  пользователь не является руководителем ЮЛ 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

###### А.7.1.3.1.2 Проверка запуска обновления сведений о среднесписочной численности работников за предшествующий календарный год {#а.7.1.3.1.2-проверка-запуска-обновления-сведений-о-среднесписочной-численности-работников-за-предшествующий-календарный-год .unnumbered}

Для проверки запуска обновления сведений о среднесписочной численности
работников за предшествующий календарный год система-клиент должна
направить\
в https-адрес REST-API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

**/api/public/{version}/org/{org_oid}/doc/srchis/check,**

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о среднесписочной численности
    работников\
    за предшествующий календарный год;

-   srchis -- название сведения;

-   сheck -- проверка запущенности обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope)**: **

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_srchis?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/srchis/**check**https://esia-portal1.test.gosuslugi.ru/Пример
ответа (не запущено обновление сведений ФНС России):

Code: 404 - Not Found.

Пример ответа (уже было запущено обновление сведений в ФНС России):

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 10.

###### А.7.1.3.1.3 Запуск обновления сведений о среднесписочной численности работников за предшествующий календарный год {#а.7.1.3.1.3-запуск-обновления-сведений-о-среднесписочной-численности-работников-за-предшествующий-календарный-год .unnumbered}

Для запуска обновления сведений о среднесписочной численности
работников\
за предшествующий календарный год система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

**/api/public/{version}/org/{org_oid}/doc/srchis/refresh**,

где:

-   org -- организация зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о среднесписочной численности
    работников\
    за предшествующий календарный год;

-   srchis -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope):

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/srchis/refreshhttps://esia-portal1.test.gosuslugi.ru/

Пример успешного ответа:

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 10.

###### А.7.1.3.1.4 Отмена обновления сведений о среднесписочной численности работников за предшествующий календарный год {#а.7.1.3.1.4-отмена-обновления-сведений-о-среднесписочной-численности-работников-за-предшествующий-календарный-год .unnumbered}

Для отмены обновления сведений о среднесписочной численности работников\
за предшествующий календарный год система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

**/api/public/{version}/org/{org_oid}/doc/srchis/refresh/cansel**,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о среднесписочной численности
    работников\
    за предшествующий календарный год;

-   srchis -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope):

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/srchis/refresh/cansel
https://esia-portal1.test.gosuslugi.ru/Пример успешного ответа: Code:
200 ОК

Возможные коды ошибок приведены в таблице 10.

#### Управление сведениями об аккредитации ИТ-компаний

##### А.7.1.4.1 Передача статуса аккредитованной ИТ-компании {#а.7.1.4.1-передача-статуса-аккредитованной-ит-компании .unnumbered}

Для получения сведений об аккредитации ИТ-компаний предназначены внешние
сервисы REST API ЕСИА для ЮЛ и ОГВ с целью обеспечения внутреннего
взаимодействия со смежными системами:

-   получение сведений об аккредитации ИТ-компаний;

-   проверка запуска обновления сведений об аккредитации ИТ-компаний;

-   запуск обновления сведений об аккредитации ИТ-компаний;

-   отмена обновления сведений об аккредитации ИТ-компаний.

###### А.7.1.4.1.1 Получение сведений об аккредитации ИТ-компаний {#а.7.1.4.1.1-получение-сведений-об-аккредитации-ит-компаний .unnumbered}

Для получения сведений об аккредитации ИТ-компаний система-клиент должна
направить в https-адрес REST-API системы ЕСИА запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса\
в ЕСИА имеет следующий вид:

**/api/public/{version}/org/{org_oid}/doc/accredited-it-company**,

где:

-   org -- организация зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации;

-   doc -- документ со сведениями об аккредитации ИТ-компаний;

-   accredited-it-company -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope):

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_accredited_it_company ?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/accredited-it-company

Пример успешного ответа:

Code: 200 OK

{

\"id\": \"4edd8c63-c244-4f5d-91cf-0390adc1f5e5\",

\"orgOid\": 1000000000,

\"data\": {

\"registryNumber\": \"5578\",

\"recordDate\": \"2022-03-01\",

\"fullName\": \"ОРГАНИЗАЦИЯ 2\",

\"ogrn\": \"1000000000000\",

\"inn\": \"2000000000\",

\"accreditationDecisionDate\": \"2022-03-03\",

\"accreditationDecisionNumber\": \"91955\",

\"changeDate\": \"2022-03-03\",

\"changesInformation\": \"информация\",

\"status\": \"Действует\"

},

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 14,

\"apiVersion\": \"1\",

\"createdOn\": \"2022-08-04T11:15:39.918\",

\"updatedOn\": \"2022-10-20T16:18:43.524\",

\"verifiedOn\": \"2022-10-20T16:18:43.524\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/11401/99ea9e50-89b0-7e2d-5381-2bf932832abb.xml/40\",

\"location\": \"00\",

\"objectId\": \"11401\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"99ea9e50-89b0-7e2d-5381-2bf932832abb.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/11401/99ea9e50-89b0-7e2d-5381-2bf932832abb.xml/40\",

\"location\": \"00\",

\"objectId\": \"11401\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"99ea9e50-89b0-7e2d-5381-2bf932832abb.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

Структура ответа в формате JSON:

-   id -- идентификатор записи документа (уникальный);

-   orgOid -- идентификатор oid организации;

-   data -- вложения ответа в формате JSON:

```{=html}
<!-- -->
```
-   registryNumber -- регистрационный номер в реестре;

-   recordDate -- дата внесения записи в реестр;

-   name -- полное наименование организации;

-   ogrn -- ОГРН организации;

-   inn -- ИНН организации;

-   accreditationDecisionDate -- дата решения о государственной
    аккредитации ИТ-компании;

-   accreditationDecisionNumber -- номер решения о государственной
    аккредитации ИТ-компании;

-   changeDate -- дата внесения изменения;

-   changesInformation -- сведения об изменениях;

-   status -- статус организации в реестре аккредитованных ИТ-компаний
    (Действует или Аннулирована);

```{=html}
<!-- -->
```
-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом при каждом
    обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   attachments -- xml- файл:

```{=html}
<!-- -->
```
-   fileLink -- блок информации о файле;

-   orignLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.xml/40);

-   location -- локация файла;

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значение 40 (файл имеет формат
    .xml);

-   mnemonic -- мнемоника файлов ответа от ведомства со сведениями
    выписки аккредитованных ИТ-компаний;

-   mimeType -- тип файла. Может принимать значение «XML» (файл);

-   main -- признак главного файла;

-   mainAttachment -- главный файл;

-   vrs -- блок сведений при технических ошибках:

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ведомство;

-   status -- статус технической ошибки.

Возможные коды ошибок приведены в таблице 11.

Таблица 11 -- Возможные коды ошибок

  -----------------------------------------------------------------------
  **Ошибка**                                 **Описание ошибки**
  ------------------------------------------ ----------------------------
  HTTP CODE:   400 {\"code\":   \"           Данный пользователь не
  ESIA-058012\", \"message\": \"Данный       является руководителем ЮЛ
  пользователь не является руководителем ЮЛ  
  \"}                                        

  HTTP CODE:   401 {\"code\":\"              Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен        
  отсутствует \"}                            

  HTTP CODE:   403 {\"code\": \"             Указание в URL запроса
  ESIA-005029\", \"message\":                организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}    пользователя

  HTTP CODE:   404 {\"code\": \"             Документ не найден
  ESIA-020203\", \"message\": \" Not         
  Found\"}                                   
  -----------------------------------------------------------------------

######  А.7.1.4.1.2 Проверка запуска обновления сведений об аккредитации ИТ-компаний  {#а.7.1.4.1.2-проверка-запуска-обновления-сведений-об-аккредитации-ит-компаний .unnumbered}

Для проверки запуска обновления сведений об аккредитации ИТ-компаний
система-клиент должна направить в https-адрес REST-API системы ЕСИА
запрос методом GET. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

**/api/public/{version}/org/{org_oid}/doc/accredited-it-company/check**,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации;

-   doc -- документ со сведениями об аккредитации ИТ-компаний;

-   accredited-it-company -- название сведения;

-   сheck -- проверка запуска обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_accredited-it-company ?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ruhttps://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/accredited-it-company/check

Пример ответа (не запущено обновление сведений в ведомстве):

Code: 404 - Not Found

Пример ответа (уже было запущено обновление сведений в ведомстве):

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 12.

Таблица 12 -- Возможные коды ошибок

  -----------------------------------------------------------------------
  **Ошибка**                                 **Описание ошибки**
  ------------------------------------------ ----------------------------
  HTTP CODE:   400 {\"code\":   \"           Данный пользователь не
  ESIA-058012\", \"message\": \"Данный       является руководителем ЮЛ
  пользователь не является руководителем ЮЛ  
  \"}                                        

  HTTP CODE:   401 {\"code\":\"              Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен        
  отсутствует \"}                            

  HTTP CODE:   403 {\"code\": \"             Указание в URL запроса
  ESIA-005029\", \"message\":                организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}    пользователя

  HTTP CODE:   404 {\"code\": \"             Документ не найден
  ESIA-020203\", \"message\": \" Not         
  Found\"}                                   
  -----------------------------------------------------------------------

###### А.7.1.4.1.3 Запуск обновления сведений об аккредитации ИТ-компаний {#а.7.1.4.1.3-запуск-обновления-сведений-об-аккредитации-ит-компаний .unnumbered}

Для запуска обновления сведений об аккредитации ИТ-компаний
система-клиент должна направить в https-адрес REST-API системы ЕСИА
запрос методом POST. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

**/api/public/{version}/org/{org_oid}/doc/accredited-it-company/refresh**,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации;

-   doc -- документ со сведениями об аккредитации ИТ-компаний;

-   accredited-it-company -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/accredited-it-company**/**refresh

Пример успешного ответа:

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 13.

Таблица 13 -- Возможные коды ошибок

  -----------------------------------------------------------------------
  **Ошибка**                                 **Описание ошибки**
  ------------------------------------------ ----------------------------
  HTTP CODE:   400 {\"code\":   \"           Данный пользователь не
  ESIA-058012\", \"message\": \"Данный       является руководителем ЮЛ
  пользователь не является руководителем ЮЛ  
  \"}                                        

  HTTP CODE:   401 {\"code\":\"              Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен        
  отсутствует \"}                            

  HTTP CODE:   403 {\"code\": \"             Указание в URL запроса
  ESIA-005029\", \"message\":                организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}    пользователя

  HTTP CODE:   404 {\"code\": \"             Документ не найден
  ESIA-020203\", \"message\": \" Not         
  Found\"}                                   
  -----------------------------------------------------------------------

###### А.7.1.4.1.4 Отмена обновления сведений об аккредитации ИТ-компаний {#а.7.1.4.1.4-отмена-обновления-сведений-об-аккредитации-ит-компаний .unnumbered}

Для отмены обновления сведений об аккредитации ИТ-компаний
система-клиент должна направить в https-адрес REST-API системы ЕСИА
запрос методом POST. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

**/api/public/{version}/org/{org_oid}/doc/accredited-it-company/refresh/cansel**,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации;

-   doc -- документ со сведениями об аккредитации ИТ-компаний;

-   accredited-it-company -- название сведения;

-   cansel -- отмена обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope):

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/accredited-it-company**/**refresh/cansel

Пример успешного ответа:

Code: 200 ОК

Возможные коды ошибок приведены в таблице 14.

Таблица 14 -- Возможные коды ошибок

  -----------------------------------------------------------------------
  **Ошибка**                                 **Описание ошибки**
  ------------------------------------------ ----------------------------
  HTTP CODE:   400 {\"code\":   \"           Данный пользователь не
  ESIA-058012\", \"message\": \"Данный       является руководителем ЮЛ
  пользователь не является руководителем ЮЛ  
  \"}                                        

  HTTP CODE:   401 {\"code\":\"              Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен        
  отсутствует \"}                            

  HTTP CODE:   403 {\"code\": \"             Указание в URL запроса
  ESIA-005029\", \"message\":                организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}    пользователя

  HTTP CODE:   404 {\"code\": \"             Документ не найден
  ESIA-020203\", \"message\": \" Not         
  Found\"}                                   
  -----------------------------------------------------------------------

#### Управление транспортными средствами организации

##### А.7.1.5.1 Добавленные вручную транспортные средства {#а.7.1.5.1-добавленные-вручную-транспортные-средства .unnumbered}

###### А.7.1.5.1.1 Добавление записи о транспортном средстве {#а.7.1.5.1.1-добавление-записи-о-транспортном-средстве .unnumbered}

Для добавления записи о транспортном средстве необходимо сделать запрос\
на https-адрес программного интерфейса ЕСИА методом POST[^35]. Заголовок
запроса должен включать в себя маркер доступа, тег контейнера
транспортных средств (метка, полученная при запросе ресурса
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/vhls).

Тело запроса должно включать следующие данные:

-   \<name\> -- название транспортного средства;

-   \<numberPlate\> -- государственный номерной знак;

-   \<regCertificate\> -- данные свидетельства о регистрации:

    -   \<series\> -- серия;

    -   \<number\> -- номер.

Пример запроса (вызов сервиса в тестовой среде):

POST /rs/orgs/1000000001/vhls HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

If--Match: \"3FEA16CB36AFC793234553C1C7CAAF89CD79A32D\"

{

\"name\": \"ВАЗ\",

\"numberPlate\": \"А133ОН199\",

\"regCertificate\":{

\"series\": \"1234\",

\"number\": \"123456\"

}

}

###### А.7.1.5.1.2 Редактирование записи о транспортном средстве {#а.7.1.5.1.2-редактирование-записи-о-транспортном-средстве .unnumbered}

Для изменения записи о транспортном средстве необходимо сделать запрос\
на https-адрес программного интерфейса ЕСИА методом POST[^36]. Заголовок
запроса должен включать в себя маркер доступа, тег записи транспортного
средства (метка, полученная\
при запросе ресурса:
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/vhls/{vhl--id}).

Тело запроса должно включать следующие данные:

-   \<eTag\> -- тег записи транспортного средства;

-   \<name\> -- название транспортного средства;

-   \<numberPlate\> -- государственный номерной знак;

-   \<regCertificate\> -- данные свидетельства о регистрации:

    -   \<series\> -- серия;

    -   \<number\> -- номер.

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/vhls/1000037688 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

If--Match: \"3FEA16CB36AFC793234553C1C7CAAF89CD79A32D\"

{

\"eTag\": \"3FEA16CB36AFC793234553C1C7CAAF89CD79A32D\",

\"name\": \"Новый ВАЗ\",

\"numberPlate\": \"А144ОН199\",

\"regCertificate\":{

\"series\": \"1234\",

\"number\": \"123456\"

}

}

###### А.7.1.5.1.3 Удаление записи о транспортном средстве {#а.7.1.5.1.3-удаление-записи-о-транспортном-средстве .unnumbered}

Для удаления записи о транспортном средстве необходимо сделать запрос на
https-адрес программного интерфейса ЕСИА методом DELETE[^37]. Заголовок
запроса должен включать в себя маркер доступа, тег записи транспортного
средства (метка, полученная\
при запросе ресурса:
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/vhls/{vhl--id}).

Пример запроса (разрывы строки даны для удобства чтения):

DELETE /rs/orgs/1000000001/vhls/1000037688 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

If--Match: \"F040CD4DD62478E6843177FF33BB6BA1AF8ECF8F\"

Cache--Control: no--cache

##### А.7.1.5.2 Полученные из ведомства транспортные средства {#а.7.1.5.2-полученные-из-ведомства-транспортные-средства .unnumbered}

###### А.7.1.5.2.1 Получение документа о ТС организации и его статус {#а.7.1.5.2.1-получение-документа-о-тс-организации-и-его-статус .unnumbered}

Для получения документа о транспортных средствах организации и его
статуса система-клиент должна направить в https-адрес REST API системы
ЕСИА запрос методом GET. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

Путь: api/public/{version}/org/1077482916/doc/vehicle/status

Тип запроса: GET

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметр запроса метода:

-   org_oid -- идентификатор организации, у которой запрашиваются
    данные.

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077482916/doc/vehicle/status

Пример ответа: Code: 200 OK

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| \"id\": \"541cdd0e-2d64-4daa-856b-58cca1e78ab5\",                     |
|                                                                       |
| \"orgOid\": 1077468061,                                               |
|                                                                       |
| \"data\": \[                                                          |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"id\": \"13567aca-ed95-43e0-93b9-a6998f64a7f8\",                     |
|                                                                       |
| \"uniqueRowNumber\": \"222\",                                         |
|                                                                       |
| \"recordStatus\": \"1\",                                              |
|                                                                       |
| \"govRegNumber\": \"K666KK777\",                                      |
|                                                                       |
| \"vin\": \"WVWZZZ16ZEW562333\",                                       |
|                                                                       |
| \"vin2\": \"WVWZZZ16ZEW562242\",                                      |
|                                                                       |
| \"chassisNumber\": \"отсутствует\",                                   |
|                                                                       |
| \"manufacturedYear\": 2018,                                           |
|                                                                       |
| \"registrationDoc\": {                                                |
|                                                                       |
| \"type\": \"321\",                                                    |
|                                                                       |
| \"seriesNumber\": \"99YO 285488\",                                    |
|                                                                       |
| \"documentDate\": \"1957-08-13\",                                     |
|                                                                       |
| \"issueAgency\": \"МРЭО ГИБДД г. Сызрань\",                           |
|                                                                       |
| \"specialTags\": \"26.01.2012 поставлен на учет по договору           |
| купли-продажи в простой письменной форме №1223432 от 09.10.2012 ООО   |
| Эксис кар цвет по ПТС темно-серый эк. класс четвертый\"               |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"pts\": {                                                            |
|                                                                       |
| \"type\": \"321\",                                                    |
|                                                                       |
| \"number\": \"49ТА443888\",                                           |
|                                                                       |
| \"regDate\": \"1957-08-13\",                                          |
|                                                                       |
| \"issueAgency\": \"ООО \\\"Эллада\\\"\",                              |
|                                                                       |
| \"specialTags\": \"Дубликат\"                                         |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"carcaseColor\": \"черный\",                                         |
|                                                                       |
| \"markName\": \"Mazda\",                                              |
|                                                                       |
| \"modelName\": \"6\",                                                 |
|                                                                       |
| \"modelMarkName\": \"Mazda,6\",                                       |
|                                                                       |
| \"carcaseNumber\": \"WVWXXX16ZTN563889\",                             |
|                                                                       |
| \"price\": \"650000.5\",                                              |
|                                                                       |
| \"gazEnvironmentFlag\": true,                                         |
|                                                                       |
| \"manufacturer\": \"ООО \\\"Эллада\\\"\",                             |
|                                                                       |
| \"maxWeight\": \"2130\",                                              |
|                                                                       |
| \"weightWithoutLoading\": \"1870\",                                   |
|                                                                       |
| \"wheelLocation\": \"справа\",                                        |
|                                                                       |
| \"transmissionType\": \"AT\",                                         |
|                                                                       |
| \"driveUnitType\": \"Полный\",                                        |
|                                                                       |
| \"category\": \"B\",                                                  |
|                                                                       |
| \"vehicleTypeTam\": \"L\",                                            |
|                                                                       |
| \"ecologyClass\": \"пятый\",                                          |
|                                                                       |
| \"specTargetName\": \"Автокран\",                                     |
|                                                                       |
| \"engineVolume\": \"2495\",                                           |
|                                                                       |
| \"engineModel\": \"CFNA\",                                            |
|                                                                       |
| \"engineNum\": \"HA226288\",                                          |
|                                                                       |
| \"enginePowerHorse\": \"249\",                                        |
|                                                                       |
| \"enginePowerkVt\": \"210\",                                          |
|                                                                       |
| \"engineType\": \"бензиновый\",                                       |
|                                                                       |
| \"endRegDate\": \"2025-02-23\",                                       |
|                                                                       |
| \"approveDate\": \"2021-02-23\",                                      |
|                                                                       |
| \"approveSerNum\": \"772237183218\",                                  |
|                                                                       |
| \"approveIssueBy\": \"Центральная таможня по гор. Москва\",           |
|                                                                       |
| \"utilizeStatus\": \"Оплачен\",                                       |
|                                                                       |
| \"tdtpo\": \"772237183218\",                                          |
|                                                                       |
| \"tdtpoIssueDate\": \"2021-02-23\",                                   |
|                                                                       |
| \"tdtpoIssueBy\": \"Центральная таможня по гор. Москва\",             |
|                                                                       |
| \"restrictions\": \"Отсутствуют\",                                    |
|                                                                       |
| \"issueCountryCode\": \"отсутствует\",                                |
|                                                                       |
| \"countryName\": \"Германия\",                                        |
|                                                                       |
| \"regActions\": \[                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"actionName\": \"Постановка на учет\",                               |
|                                                                       |
| \"regDate\": \"2022-06-01\",                                          |
|                                                                       |
| \"department\": \"3 отделение МОТОТРЭР ГИБДД УВ по ЮВАО г. Москвы\",  |
|                                                                       |
| \"confidentSign\": true,                                              |
|                                                                       |
| \"leasingFlag\": true                                                 |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"ownerPeriods\": \[                                                  |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"startDate\": \"1977-08-13\",                                        |
|                                                                       |
| \"endDate\": \"1977-08-13\",                                          |
|                                                                       |
| \"ownerType\": \"1\"                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"searchingSpec\": {                                                  |
|                                                                       |
| \"searchingSpecFlag\": true,                                          |
|                                                                       |
| \"operationDate\": \"1957-08-13\",                                    |
|                                                                       |
| \"subDivision\": \"133\"                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"searchingTransportFlag\": true,                                     |
|                                                                       |
| \"restrictionsFlag\": true,                                           |
|                                                                       |
| \"restrictionInfo\": \[                                               |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"restrictionType\": \"2021-11-12\",                                  |
|                                                                       |
| \"status\": \"123\",                                                  |
|                                                                       |
| \"restrictionDate\": \"1957-08-13\",                                  |
|                                                                       |
| \"initiateRegion\": \"Москва\",                                       |
|                                                                       |
| \"gibddDepartment\": \"Подразделение ГИБДД №3, Москва\",              |
|                                                                       |
| \"mainReason\": \"Неуплата налога\",                                  |
|                                                                       |
| \"restrictionDescription\": \"Ограничение выставлено в связи с        |
| задолженностью по транспортному налогу\",                             |
|                                                                       |
| \"enforcementProceedingsNumber\": \"ИП - 281931145\",                 |
|                                                                       |
| \"enforcementProceedingsDate\": \"1957-08-13\",                       |
|                                                                       |
| \"enforcementProceedingsName\": \"2020-12-15\",                       |
|                                                                       |
| \"documentAgency\": \"ФССП по Центральному округу г. Москвы\",        |
|                                                                       |
| \"enforcementProceedingsDocumentNumber\":                             |
| \"String12328348329429999\",                                          |
|                                                                       |
| \"enforcementProceedingsIssueDate\": \"2020-11-13\",                  |
|                                                                       |
| \"ospAddress\": \"Москва, Петровка 38\"                               |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"owner\": {                                                          |
|                                                                       |
| \"legalType\": \"LEGAL_ENT\",                                         |
|                                                                       |
| \"legalData\": {                                                      |
|                                                                       |
| \"name\": \"Заря\",                                                   |
|                                                                       |
| \"inn\": \"1695836605\",                                              |
|                                                                       |
| \"ogrn\": \"5009830565730\",                                          |
|                                                                       |
| \"kpp\": \"123456789\"                                                |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"id\": \"c91cdd5e-96f7-4932-b20c-7113045213fc\",                     |
|                                                                       |
| \"uniqueRowNumber\": \"222\",                                         |
|                                                                       |
| \"recordStatus\": \"1\",                                              |
|                                                                       |
| \"govRegNumber\": \"О111ОО11\",                                       |
|                                                                       |
| \"vin\": \"WVWZZZ16ZEW562888\",                                       |
|                                                                       |
| \"vin2\": \"WVWZZZ16ZEW562444\",                                      |
|                                                                       |
| \"chassisNumber\": \"отсутствует\",                                   |
|                                                                       |
| \"manufacturedYear\": 2018,                                           |
|                                                                       |
| \"registrationDoc\": {                                                |
|                                                                       |
| \"type\": \"123\",                                                    |
|                                                                       |
| \"seriesNumber\": \"2222 222222\",                                    |
|                                                                       |
| \"documentDate\": \"1957-08-13\",                                     |
|                                                                       |
| \"issueAgency\": \"МРЭО ГИБДД г. Сызрань\",                           |
|                                                                       |
| \"specialTags\": \"26.01.2012 поставлен на учет по договору           |
| купли-продажи в простой письменной форме №1223432 от 09.10.2012 ООО   |
| Эксис кар цвет по ПТС темно-серый эк. класс четвертый\"               |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"pts\": {                                                            |
|                                                                       |
| \"type\": \"321\",                                                    |
|                                                                       |
| \"number\": \"2222222222\",                                           |
|                                                                       |
| \"regDate\": \"1957-08-13\",                                          |
|                                                                       |
| \"issueAgency\": \"ООО \\\"Эллада\\\"\",                              |
|                                                                       |
| \"specialTags\": \"Дубликат\"                                         |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"carcaseColor\": \"черный\",                                         |
|                                                                       |
| \"markName\": \"Audi\",                                               |
|                                                                       |
| \"modelName\": \"A6\",                                                |
|                                                                       |
| \"modelMarkName\": \"Audi,A6\",                                       |
|                                                                       |
| \"carcaseNumber\": \"WVWXXX16ZTN563899\",                             |
|                                                                       |
| \"price\": \"650000.5\",                                              |
|                                                                       |
| \"gazEnvironmentFlag\": true,                                         |
|                                                                       |
| \"manufacturer\": \"ООО \\\"Эллада\\\"\",                             |
|                                                                       |
| \"maxWeight\": \"2150\",                                              |
|                                                                       |
| \"weightWithoutLoading\": \"1870\",                                   |
|                                                                       |
| \"wheelLocation\": \"справа\",                                        |
|                                                                       |
| \"transmissionType\": \"AT\",                                         |
|                                                                       |
| \"driveUnitType\": \"Полный\",                                        |
|                                                                       |
| \"category\": \"B\",                                                  |
|                                                                       |
| \"vehicleTypeTam\": \"L\",                                            |
|                                                                       |
| \"ecologyClass\": \"пятый\",                                          |
|                                                                       |
| \"specTargetName\": \"Автокран\",                                     |
|                                                                       |
| \"engineVolume\": \"2495\",                                           |
|                                                                       |
| \"engineModel\": \"CFNA\",                                            |
|                                                                       |
| \"engineNum\": \"HA226288\",                                          |
|                                                                       |
| \"enginePowerHorse\": \"249\",                                        |
|                                                                       |
| \"enginePowerkVt\": \"210\",                                          |
|                                                                       |
| \"engineType\": \"бензиновый\",                                       |
|                                                                       |
| \"endRegDate\": \"2025-02-23\",                                       |
|                                                                       |
| \"approveDate\": \"2021-02-23\",                                      |
|                                                                       |
| \"approveSerNum\": \"772237183218\",                                  |
|                                                                       |
| \"approveIssueBy\": \"Центральная таможня по гор. Москва\",           |
|                                                                       |
| \"utilizeStatus\": \"Оплачен\",                                       |
|                                                                       |
| \"tdtpo\": \"772237183218\",                                          |
|                                                                       |
| \"tdtpoIssueDate\": \"2021-02-23\",                                   |
|                                                                       |
| \"tdtpoIssueBy\": \"Центральная таможня по гор. Москва\",             |
|                                                                       |
| \"restrictions\": \"Отсутствуют\",                                    |
|                                                                       |
| \"issueCountryCode\": \"отсутствует\",                                |
|                                                                       |
| \"countryName\": \"Германия\",                                        |
|                                                                       |
| \"regActions\": \[                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"actionName\": \"Постановка на учет\",                               |
|                                                                       |
| \"regDate\": \"2022-06-01\",                                          |
|                                                                       |
| \"department\": \"3 отделение МОТОТРЭР ГИБДД УВ по ЮВАО г. Москвы\",  |
|                                                                       |
| \"confidentSign\": true,                                              |
|                                                                       |
| \"leasingFlag\": true                                                 |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"ownerPeriods\": \[                                                  |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"startDate\": \"1957-08-13\",                                        |
|                                                                       |
| \"endDate\": \"1957-08-13\",                                          |
|                                                                       |
| \"ownerType\": \"1\"                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"searchingSpec\": {                                                  |
|                                                                       |
| \"searchingSpecFlag\": true,                                          |
|                                                                       |
| \"operationDate\": \"1957-08-13\",                                    |
|                                                                       |
| \"subDivision\": \"123\"                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"searchingTransportFlag\": true,                                     |
|                                                                       |
| \"restrictionsFlag\": true,                                           |
|                                                                       |
| \"restrictionInfo\": \[                                               |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"restrictionType\": \"2021-11-12\",                                  |
|                                                                       |
| \"status\": \"123\",                                                  |
|                                                                       |
| \"restrictionDate\": \"1957-08-13\",                                  |
|                                                                       |
| \"initiateRegion\": \"Москва\",                                       |
|                                                                       |
| \"gibddDepartment\": \"Подразделение ГИБДД №3, Москва\",              |
|                                                                       |
| \"mainReason\": \"Неуплата налога\",                                  |
|                                                                       |
| \"restrictionDescription\": \"граничение выставлено в связи с         |
| задолженностью по транспортному налогу\",                             |
|                                                                       |
| \"enforcementProceedingsNumber\": \"ИП - 281931145\",                 |
|                                                                       |
| \"enforcementProceedingsDate\": \"1957-08-13\",                       |
|                                                                       |
| \"enforcementProceedingsName\": \"2020-12-15\",                       |
|                                                                       |
| \"documentAgency\": \"ФССП по Центральному округу г. Москвы\",        |
|                                                                       |
| \"enforcementProceedingsDocumentNumber\":                             |
| \"String12328348329429999\",                                          |
|                                                                       |
| \"enforcementProceedingsIssueDate\": \"2020-11-13\",                  |
|                                                                       |
| \"ospAddress\": \"Москва, Петровка 38\"                               |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"owner\": {                                                          |
|                                                                       |
| \"legalType\": \"LEGAL_ENT\",                                         |
|                                                                       |
| \"legalData\": {                                                      |
|                                                                       |
| \"name\": \"Заря\",                                                   |
|                                                                       |
| \"inn\": \"1695836605\",                                              |
|                                                                       |
| \"ogrn\": \"5009830565730\",                                          |
|                                                                       |
| \"kpp\": \"123456789\"                                                |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"relevance\": \"ACTUAL\",                                            |
|                                                                       |
| \"status\": \"VERIFIED_BY_REQUEST\",                                  |
|                                                                       |
| \"version\": 14,                                                      |
|                                                                       |
| \"createdOn\": \"2022-10-17T15:38:57.589\",                           |
|                                                                       |
| \"updatedOn\": \"2022-10-18T15:15:49.659\",                           |
|                                                                       |
| \"verifiedOn\": \"2022-10-18\",                                       |
|                                                                       |
| \"attachments\": \[                                                   |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"fileLink\": {                                                       |
|                                                                       |
| \"originLink\":                                                       |
| \"                                                                    |
| terrabyte://00/4559489/df6affd9-995b-aa49-67a1-2955401778bb.xml/40\", |
|                                                                       |
| \"location\": \"00\",                                                 |
|                                                                       |
| \"objectId\": \"4559489\",                                            |
|                                                                       |
| \"objectTypeId\": \"40\",                                             |
|                                                                       |
| \"mnemonic\": \"df6affd9-995b-aa49-67a1-2955401778bb.xml\",           |
|                                                                       |
| \"mimeType\": \"XML\"                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"main\": true                                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"mainAttachment\": {                                                 |
|                                                                       |
| \"fileLink\": {                                                       |
|                                                                       |
| \"originLink\":                                                       |
| \"                                                                    |
| terrabyte://00/4559489/df6affd9-995b-aa49-67a1-2955401778bb.xml/40\", |
|                                                                       |
| \"location\": \"00\",                                                 |
|                                                                       |
| \"objectId\": \"4559489\",                                            |
|                                                                       |
| \"objectTypeId\": \"40\",                                             |
|                                                                       |
| \"mnemonic\": \"df6affd9-995b-aa49-67a1-2955401778bb.xml\",           |
|                                                                       |
| \"mimeType\": \"XML\"                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"main\": true                                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

###### А.7.1.5.2.2 Удаление сведений по всем ТС, полученным из ведомства {#а.7.1.5.2.2-удаление-сведений-по-всем-тс-полученным-из-ведомства .unnumbered}

Для удаления сведений по всем ТС, полученным из ведомства,
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом DELETE.\
В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

Путь**: **/api/public/{version}/org/{org_oid}/doc/vehicle

Тип запроса: DELETE

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметр запроса метода:

-   org_oid -- идентификатор организации, у которой запрашиваются
    данные.

Пример запроса (вызов сервиса в тестовой среде):

DELETE
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/{version}/org/1077482916/doc/vehicle

Пример ответа: Code: 200 ОК

###### А.7.1.5.2.3 Получение детальных сведений о ТС из ведомства {#а.7.1.5.2.3-получение-детальных-сведений-о-тс-из-ведомства .unnumbered}

Для получения детальных сведений о ТС из ведомства система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса\
в ЕСИА имеет следующий вид:

Путь:** **/api/public/{version}/org/{org_oid}/doc/vehicle/{vehicle_id}

Тип запроса: GET

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметры запроса метода:

-   org_oid -- идентификатор организации, у которой запрашиваются
    данные;

-   vehicle_id -- идентификатор транспортного средства (например,
    4e9ef515-2375-401d-8b88-4f966c7faca5).

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/{version}/org/1077482916/doc/vehicle/4e9ef515-2375-401d-8b88-4f966c7faca5

Пример ответа: Code: 200 ОК

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| \"id\": \"4e9ef515-2375-401d-8b88-4f966c7faca5\",                     |
|                                                                       |
| \"uniqueRowNumber\": \"222\",                                         |
|                                                                       |
| \"recordStatus\": \"1\",                                              |
|                                                                       |
| \"govRegNumber\": \"K674KK777\",                                      |
|                                                                       |
| \"vin\": \"WVWZZZ16ZEW562333\",                                       |
|                                                                       |
| \"vin2\": \"WVWZZZ16ZEW562242\",                                      |
|                                                                       |
| \"chassisNumber\": \"отсутствует\",                                   |
|                                                                       |
| \"manufacturedYear\": 2018,                                           |
|                                                                       |
| \"registrationDoc\": {                                                |
|                                                                       |
| \"type\": \"321\",                                                    |
|                                                                       |
| \"seriesNumber\": \"98YO 285488\",                                    |
|                                                                       |
| \"documentDate\": \"1957-08-13\",                                     |
|                                                                       |
| \"issueAgency\": \"МРЭО ГИБДД г. Сызрань\",                           |
|                                                                       |
| \"specialTags\": \"26.01.2012 поставлен на учет по договору           |
| купли-продажи в простой письменной форме №1223432 от 09.10.2012 ООО   |
| Эксис кар цвет по ПТС темно-серый эк. класс четвертый\"               |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"pts\": {                                                            |
|                                                                       |
| \"type\": \"321\",                                                    |
|                                                                       |
| \"number\": \"49ТА445788\",                                           |
|                                                                       |
| \"regDate\": \"1957-08-13\",                                          |
|                                                                       |
| \"issueAgency\": \"ООО \\\"Эллада\\\"\",                              |
|                                                                       |
| \"specialTags\": \"Дубликат\"                                         |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"carcaseColor\": \"черный\",                                         |
|                                                                       |
| \"markName\": \"Рено\",                                               |
|                                                                       |
| \"modelName\": \"6\",                                                 |
|                                                                       |
| \"modelMarkName\": \"Рено,6\",                                        |
|                                                                       |
| \"carcaseNumber\": \"WVWXXX16ZTN563889\",                             |
|                                                                       |
| \"price\": \"650000.5\",                                              |
|                                                                       |
| \"gazEnvironmentFlag\": true,                                         |
|                                                                       |
| \"manufacturer\": \"ООО \\\"Эллада\\\"\",                             |
|                                                                       |
| \"maxWeight\": \"2130\",                                              |
|                                                                       |
| \"weightWithoutLoading\": \"1870\",                                   |
|                                                                       |
| \"wheelLocation\": \"справа\",                                        |
|                                                                       |
| \"transmissionType\": \"AT\",                                         |
|                                                                       |
| \"driveUnitType\": \"Полный\",                                        |
|                                                                       |
| \"category\": \"B\",                                                  |
|                                                                       |
| \"vehicleTypeTam\": \"L\",                                            |
|                                                                       |
| \"ecologyClass\": \"пятый\",                                          |
|                                                                       |
| \"specTargetName\": \"Автокран\",                                     |
|                                                                       |
| \"engineVolume\": \"2495\",                                           |
|                                                                       |
| \"engineModel\": \"CFNA\",                                            |
|                                                                       |
| \"engineNum\": \"HA226288\",                                          |
|                                                                       |
| \"enginePowerHorse\": \"249\",                                        |
|                                                                       |
| \"enginePowerkVt\": \"210\",                                          |
|                                                                       |
| \"engineType\": \"бензиновый\",                                       |
|                                                                       |
| \"endRegDate\": \"2025-02-23\",                                       |
|                                                                       |
| \"approveDate\": \"2021-02-23\",                                      |
|                                                                       |
| \"approveSerNum\": \"772237183218\",                                  |
|                                                                       |
| \"approveIssueBy\": \"Центральная таможня по гор. Москва\",           |
|                                                                       |
| \"utilizeStatus\": \"Оплачен\",                                       |
|                                                                       |
| \"tdtpo\": \"772237183218\",                                          |
|                                                                       |
| \"tdtpoIssueDate\": \"2021-02-23\",                                   |
|                                                                       |
| \"tdtpoIssueBy\": \"Центральная таможня по гор. Москва\",             |
|                                                                       |
| \"restrictions\": \"Отсутствуют\",                                    |
|                                                                       |
| \"issueCountryCode\": \"отсутствует\",                                |
|                                                                       |
| \"countryName\": \"Германия\",                                        |
|                                                                       |
| \"regActions\": \[                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"actionName\": \"Постановка на учет\",                               |
|                                                                       |
| \"regDate\": \"2022-06-01\",                                          |
|                                                                       |
| \"department\": \"3 отделение МОТОТРЭР ГИБДД УВ по ЮВАО г. Москвы\",  |
|                                                                       |
| \"confidentSign\": true,                                              |
|                                                                       |
| \"leasingFlag\": true                                                 |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"ownerPeriods\": \[                                                  |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"startDate\": \"1977-08-13\",                                        |
|                                                                       |
| \"endDate\": \"1977-08-13\",                                          |
|                                                                       |
| \"ownerType\": \"1\"                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"searchingSpec\": {                                                  |
|                                                                       |
| \"searchingSpecFlag\": true,                                          |
|                                                                       |
| \"operationDate\": \"1957-08-13\",                                    |
|                                                                       |
| \"subDivision\": \"133\"                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"searchingTransportFlag\": true,                                     |
|                                                                       |
| \"restrictionsFlag\": true,                                           |
|                                                                       |
| \"restrictionInfo\": \[                                               |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"restrictionType\": \"2021-11-12\",                                  |
|                                                                       |
| \"status\": \"123\",                                                  |
|                                                                       |
| \"restrictionDate\": \"1957-08-13\",                                  |
|                                                                       |
| \"initiateRegion\": \"Москва\",                                       |
|                                                                       |
| \"gibddDepartment\": \"Подразделение ГИБДД №3, Москва\",              |
|                                                                       |
| \"mainReason\": \"Неуплата налога\",                                  |
|                                                                       |
| \"restrictionDescription\": \"Ограничение выставлено в связи с        |
| задолженностью по транспортному налогу\",                             |
|                                                                       |
| \"enforcementProceedingsNumber\": \"ИП - 281931145\",                 |
|                                                                       |
| \"enforcementProceedingsDate\": \"1957-08-13\",                       |
|                                                                       |
| \"enforcementProceedingsName\": \"2020-12-15\",                       |
|                                                                       |
| \"documentAgency\": \"ФССП по Центральному округу г. Москвы\",        |
|                                                                       |
| \"enforcementProceedingsDocumentNumber\":                             |
| \"String12328348329429999\",                                          |
|                                                                       |
| \"enforcementProceedingsIssueDate\": \"2020-11-13\",                  |
|                                                                       |
| \"ospAddress\": \"Москва, Петровка 38\"                               |
|                                                                       |
| }                                                                     |
|                                                                       |
| \],                                                                   |
|                                                                       |
| \"owner\": {                                                          |
|                                                                       |
| \"legalType\": \"LEGAL_ENT\",                                         |
|                                                                       |
| \"legalData\": {                                                      |
|                                                                       |
| \"name\": \"Заря\",                                                   |
|                                                                       |
| \"inn\": \"1695836605\",                                              |
|                                                                       |
| \"ogrn\": \"5009830565730\",                                          |
|                                                                       |
| \"kpp\": \"123456789\"                                                |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

###### А.7.1.5.2.4 Удаление сведений по ТС, полученному из ведомства {#а.7.1.5.2.4-удаление-сведений-по-тс-полученному-из-ведомства .unnumbered}

Для удаления сведений по ТС, полученному из ведомства, система-клиент
должна направить в https-адрес REST API системы ЕСИА запрос методом
DELETE. В запросе должен быть указан ресурс, содержащий необходимые
данные. Идентификатор этого ресурса в ЕСИА имеет следующий вид:

Путь: /api/public/{version}/org/{org_oid}/doc/vehicle/{vehicle_id}

Тип запроса: DELETE

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметры запроса метода:

-   org_oid -- идентификатор организации, у которой запрашиваются
    данные;

-   vehicle_id -- идентификатор транспортного средства.

Пример запроса (вызов сервиса в тестовой среде):

DELETE
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/{version}/org/1077482916/doc/vehicle/5bb39b91-81ec-43d7-a2f5-7818529317fd

Пример ответа: Code: 200 ОК

###### А.7.1.5.2.5 Проверить, запущено ли обновление сведений о ТС {#а.7.1.5.2.5-проверить-запущено-ли-обновление-сведений-о-тс .unnumbered}

Для того чтобы проверить, запущено ли обновление сведений о транспортных
средствах из ведомства, система-клиент должна направить в https-адрес
REST API системы ЕСИА запрос методом GET. В запросе должен быть указан
ресурс, содержащий необходимые данные. Идентификатор этого ресурса в
ЕСИА имеет следующий вид:

Путь: /api/public/{version}/org/{org_oid}/doc/vehicle/check

Тип запроса: GET

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметр запроса метода:

-   org_oid -- идентификатор организации, у которой запрашиваются
    данные.

Параметры ответа:

-   expiresOn -- время действия запроса;

-   requestIds -- идентификатор запроса;

-   orgOid -- идентификатор организации.

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/{version}/org/1077482916/doc/vehicle/check

Пример ответа (не запущено обновление сведений ГИБДД): Code: 404 -- Not
Found.

Пример ответа (уже было запущено обновление сведений в ГИБДД): Code: 200
ОК

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| \"requestIds\": \[                                                    |
|                                                                       |
| 4062245                                                               |
|                                                                       |
| \]                                                                    |
|                                                                       |
| \"orgOid\": 1077383636,                                               |
|                                                                       |
| \"expiresOn\": \"2022-07-01T18:00:25.667+0000\"                       |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

###### А.7.1.5.2.6 Запуск обновления сведений о ТС {#а.7.1.5.2.6-запуск-обновления-сведений-о-тс .unnumbered}

Для запуска обновления сведений о транспортных средствах из ведомства
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом POST.\
В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

Путь: /api/public/{version}/org/{org_oid}/doc/vehicle/refresh

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметр запроса метода:

-   org_oid -- идентификатор организации, у которой запрашиваются
    данные.

Параметры ответа:

-   requestIds -- идентификатор запроса сведений в СМЭВ;

-   orgOid -- идентификатор организации;

-   expiresOn -- время действия запроса.

Пример запроса (вызов сервиса в тестовой среде):

POST
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/{version}/org/1077482916/doc/vehicle/refresh

Пример ответа: Code: 200 ОК

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
|     \"requestIds\": \[                                                |
|                                                                       |
|         4043639                                                       |
|                                                                       |
|     \],                                                               |
|                                                                       |
|     \"orgOid\": 1077383636,                                           |
|                                                                       |
|     \"expiresOn\": \"2022-07-01T15:20:05.818+0000\"                   |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

###### А.7.1.5.2.7 Отмена запроса на поиск/обновление сведений о ТС {#а.7.1.5.2.7-отмена-запроса-на-поискобновление-сведений-о-тс .unnumbered}

Для отмены запроса на поиск/обновление сведений о транспортных
средствах\
из ведомства система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом POST. В запросе должен быть указан ресурс,
содержащий необходимые данные. Идентификатор этого ресурса в ЕСИА имеет
следующий вид:

Путь: /api/public/{version}/org/{org_oid}/doc/vehicle/refresh/cancel

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметр запроса метода:

-   org_oid -- идентификатор организации, у которой запрашиваются
    данные.

Пример запроса (вызов сервиса в тестовой среде):

POST
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/{version}/org/1077482916/doc/vehicle/refresh/cancel

Пример ответа: Code: 200 ОК

#### Согласия бизнеса. Запрос, выдача, отзыв согласий на доступ к сведениям организации

Согласие бизнеса (согласие) -- это право, выданное организацией
потребителю на получение доступа к сведениям данной организации
посредством ЕСИА. Доступ\
к сведениям организации возможен только при наличии действующего
согласия\
для конкретного потребителя, выданного руководителем или уполномоченным
сотрудником. Согласие выдается от имени организации потребителю
(организация, зарегистрированная в ЕСИА, руководители и уполномоченные
сотрудники такой организации) по его запросу.

Согласие содержит следующие параметры:

-   Субъект -- организация, которая предоставляет доступ к своим
    сведениям\
    по запросу от внешних организаций;

-   Объект -- внешняя организация, которой необходим доступ к сведениям
    субъекта;

-   Область доступа -- перечень областей доступа (scope), на которые
    выдано согласие;

-   Срок действия -- срок действия выданного согласия;

-   Статус согласия -- согласие может принимать следующие статусы:
    запрошено (W), выдано (А), отозвано (D);

-   Тип согласия -- определяет обязательность/необязательность области
    доступа (scope) и цель, связанную с типом согласия;

-   Цель согласия -- текстовое поле, которое описывает предполагаемую
    цель использования потребителем полученных данных.

Видимость раздела «Согласия» в личном кабинете юридического лица и
доступ\
к функциям данного раздела определяются в зависимости от роли
пользователя и наличия или отсутствия у него полномочий. Перечень
доступных для пользователей функций\
в зависимости от ролей и полномочий представлен в таблице 15.

Таблица 15 -- Доступность функций в зависимости от ролей и полномочий

  -------------------------------------------------------------------------------------
  **№**   **Действие/ Роль**       **Руководитель**   **Сотрудник с    
                                                      полномочием**    
  ------- ------------------------ ------------------ ---------------- ----------------
                                                      **«Право         **«Право
                                                      управления       просмотра
                                                      согласиями       согласий
                                                      организации»**   организации»**

  1\.     Просмотр списка          Да                 Да               Да
          согласий, просмотр                                           
          согласия                                                     

  2\.     Выдача согласий, выдача  Да                 Да               Нет
          генерального согласия                                        

  3\.     Отзыв согласий, отзыв    Да                 Да               Нет
          генерального согласия                                        

  4\.     Отклонение согласий      Да                 Да               Нет
  -------------------------------------------------------------------------------------

Просмотр согласий

В личном кабинете юридического лица в разделе «Согласия» отображаются
согласия данного юридического лица.

Посредством вызова REST API возможно выполнить следующие функции:

-   получение списка согласий организации;

-   получение согласия организации по ID.

**Получение списка согласий организации**

Path: /api/public/{version}/sbj/{org_oid}/issued

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Параметры запроса:

-   организация, которая выдает согласие oid;

-   статус согласия status (битовая маска) -- необязательно.

Из токена:

-   идентификатор пользователя.

Формат битовой маски для параметра «status» приведен в таблице 16.

Таблица 16 -- Формат битовой маски для параметра «status»

  ------------------------------------------------------------------------
  В активном         Отозванные   Действующие    Ожидающие подтверждения
  статусе\           (D)          (А+)           (W)
  с истекшим сроком                              
  действия (А--)                                 
  ------------------ ------------ -------------- -------------------------
  Х                  Х            Х              Х

  ------------------------------------------------------------------------

Параметры ответа:

-   массив сущностей (согласий);

-   код и описание ошибки.

Возможные ошибки приведены в таблице 17.

Таблица 17 -- Возможные ошибки

  -----------------------------------------------------------------------
  Код ошибки         Описание
  ------------------ ----------------------------------------------------
  ESIA-036701        Согласие не найдено

  -----------------------------------------------------------------------

Пример запроса (вызов сервиса в тестовой среде):

GET [https://esia-portal1.test.gosuslugi.ru/https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/sbj/1077376368/issued](%20https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/sbj/1077376368/issued)

Пример ответа:

{\
\"stateFacts\":\[\
\"EntityRoot\",\
\"hasSize\"\
\],\
\"size\":1,\
\"elements\":\[\
{\
\"stateFacts\":\[\
\"Identifiable\"\
\],\
\"id\":19,\
\"mnemonic\":\"REG_QUESTIONNAIRE\",\
\"name\":\"Оформление анкеты клиента\",\
\"subjectOgrn\":\"2435724954245\",\
\"subjectName\":\"ОРГАНИЗАЦИЯ--1440020240\",\
\"subjectId\":86187576,\
\"subjectOid\":1077376368,\
\"objectOgrn\":\"5107719446115\",\
\"objectName\":\"ОРГАНИЗАЦИЯ546079675\",\
\"objectId\":86191664,\
\"objectOid\":1077380456,\
\"orgGrantId\":2,\
\"context\":{},\
\"purpose\":\"Оформление анкеты клиента\",\
\"issuedOn\":1640293200,\
\"expiredOn\":1642885200,\
\"status\":\"A\",\
\"createdOn\":1640264532,\
\"updatedOn\":1640326189,\
\"scopes\":{\
\"stateFacts\":\[\
\"hasSize\"\
\],\
\"size\":2,\
\"elements\":\[\
{\
\"stateFacts\":\[\
\"ReadOnly\"\
\],\
\"sysname\":\"org_egr\",\
\"name\":\"Просмотр выписки из ЕГРЮЛ/ЕГРИП\",\
\"description\": \"Получение сведений из ЕГРЮЛ/ЕГРИП по запросам органов
государственной власти (полные, открытые)\"\
},\
{\
\"stateFacts\":\[\
\"ReadOnly\"\
\],\
\"sysname\":\"http://esia.gosuslugi.ru/org_vhls\",\
\"name\":\"данных транспортных средств организации{0}\",\
\"description\": \"Данные транспортных средств (государственный
регистрационный знак, серия и номер свидетельства о регистрации),
указанные в организации\"\
}\
\]\
}\
}\
\]\
}

**Получение согласия организации по ID**

Path: /api/public/{version}/sbj/{org_oid}/issued/{id}

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Параметры запроса:

-   организация, которая выдает согласие oid;

-   ID согласия.

Из токена:

-   идентификатор пользователя.

Параметры ответа:

-   кто выдает согласие subject_ogrn;

-   кто получает согласие object_ogrn;

-   наименование (для object_ogrn);

-   статус согласия status;

-   дата выдачи согласия iss_on -- необязательно;

-   дата истечения срока действия согласия exp_on -- необязательно;

-   дата/время отзыва согласия rvk_on -- необязательно;

-   наименование типа согласия name;

-   цель выдачи согласия purpose;

-   область доступа (scope) scopes;

-   флаг необходимости выдачи генерального согласия needGeneralGrant
    (false/ true);

-   флаг для отображения кнопок управления hasRightToManage (false/
    true);

-   код и описание ошибки.

Возможные ошибки приведены в таблице 18.

Таблица 18 -- Возможные ошибки

  -----------------------------------------------------------------------
  Код ошибки         Описание
  ------------------ ----------------------------------------------------
  ESIA-036701        Согласие не найдено

  -----------------------------------------------------------------------

Пример запроса (вызов сервиса в тестовой среде):

GET 
https://esia-portal1.test.gosuslugi.ruhttps://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/sbj/1077376368/issued/19

Пример ответа:

{\
\"stateFacts\":\[\
\"EntityRoot\",\
\"hasSize\"\
\],\
\"size\":1,\
\"elements\":\[\
{\
\"stateFacts\":\[\
\"Identifiable\"\
\],\
\"id\":19,\
\"mnemonic\":\"REG_QUESTIONNAIRE\",\
\"name\":\"Оформление анкеты клиента\",\
\"subjectOgrn\":\"2435724954245\",\
\"subjectName\":\"ОРГАНИЗАЦИЯ--1440020240\",\
\"subjectId\":86187576,\
\"subjectOid\":1077376368,\
\"objectOgrn\":\"5107719446115\",\
\"objectName\":\"ОРГАНИЗАЦИЯ546079675\",\
\"objectId\":86191664,\
\"objectOid\":1077380456,\
\"orgGrantId\":2,\
\"context\":{},\
\"purpose\":\"Оформление анкеты клиента\",\
\"issuedOn\":1640293200,\
\"expiredOn\":1642885200,\
\"status\":\"A\",\
\"createdOn\":1640264532,\
\"updatedOn\":1640326189,\
\"scopes\":{\
\"stateFacts\":\[\
\"hasSize\"\
\],\
\"size\":2,\
\"elements\":\[\
{\
\"stateFacts\":\[\
\"ReadOnly\"\
\],\
\"sysname\":\"org_egr\",\
\"name\":\"Просмотр выписки из ЕГРЮЛ/ЕГРИП\",\
\"description\": \"Получение сведений из ЕГРЮЛ/ЕГРИП по запросам органов
государственной власти (полные, открытые)\"\
},\
{\
\"stateFacts\":\[\
\"ReadOnly\"\
\],\
\"sysname\":\"http://esia.gosuslugi.ru/org_vhls\",\
\"name\":\"данных транспортных средств организации{0}\",\
\"description\": \"Данные транспортных средств (государственный
регистрационный знак, серия и номер свидетельства о регистрации),
указанные в организации\"\
}\
\]\
}\
}\
\]\
}

**Выдача и отклонение согласий**

В личном кабинете юридического лица в разделе «Согласия» доступна
возможность выдачи согласия. Условия доступности функции выдачи согласия
описаны\
в таблице 15.

Выдача согласия возможна только при наличии у организации действующего
генерального согласия (см. описание в п. Б.7.1.5.1).

В личном кабинете юридического лица, в разделе «Согласия», доступна
возможность отклонения организацией--субъектом запроса согласия со
стороны внешней организации. Условия доступности функции отклонения
согласия описаны в таблице 15.

Отклонение согласия возможно только при наличии у организации
действующего генерального согласия (см. описание ниже).

Посредством вызова REST API возможно выполнить следующие функции:

-   утверждение согласия в статусе W (для выдачи согласия);

-   отклонение запроса согласия.

**Утверждение согласия в статусе W **

Path: /api/public/{version}/sbj/{org_oid}/claimed/grant/{id}

Тип запроса: POST, PUT

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\".

Параметры запроса:

-   организация, которая выдает согласие oid;

-   ID согласия;

-   область доступа (scope) scopes.

Из токена:

-   идентификатор пользователя.

Параметры ответа:

-   статус; 

-   код и описание ошибки.

Возможные ошибки приведены в таблице 19.

Таблица 19 -- Возможные ошибки

  -----------------------------------------------------------------------
  Код ошибки         Описание
  ------------------ ----------------------------------------------------
  ESIA-036702        Не указан обязательный scope для типа согласия

  ESIA-036712        Согласие в текущем статусе не может быть утверждено
  -----------------------------------------------------------------------

Пример запроса без тела запроса (вызов сервиса в тестовой среде):

> POST/PUT 
> https://esia-portal1.test.gosuslugi.ru/https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/sbj/{org_oid}/claimed/grant/28

Пример ответа: 200 OK

Пример запроса с телом запроса:

> POST/PUT https://esia-portal1.test.gosuslugi.ru/https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/sbj/{org_oid}/claimed/grant/28

{\
\"scopes\": {\
\"elements\": \[\
{\
\"sysname\": \"org_egr\"\
},\
{\
\"sysname\": \"<http://esia.gosuslugi.ru/org_vhls>\"\
}\]\
}\
}

Пример ответа: 200 OK

**Отклонение запроса согласия**

Path: /api/public/{version}/sbj/{org_oid}/claimed/grant/{id}

Тип запроса: DELETE

Область доступа (scope):

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\".

Параметр запроса:

-   id согласия.

Из токена:

-   идентификатор пользователя.

Параметр ответа:

-   код и описание ошибки.

Возможные ошибки приведены в таблице 20.

Таблица 20 -- Возможные ошибки

  -----------------------------------------------------------------------
  Код ошибки         Описание
  ------------------ ----------------------------------------------------
  ESIA-036701        Согласие не найдено

  ESIA-036713        Согласие в текущем статусе не может быть отклонено
  -----------------------------------------------------------------------

> Пример запроса (вызов сервиса в тестовой среде):
>
> DELETE [https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/sbj/2435724954245/claimed/grant/27](https://esia-dev-k8s.test.gosuslugi.ru/org-grant/api/public/v1/sbj/2435724954245/claimed/grant/27)
>
> Примет ответа: 200 OK
>
> **Отзыв согласий**

В личном кабинете юридического лица в разделе «Согласия» доступна
возможность отзыва организацией--субъектом ранее выданного согласия
внешней организации. Условия доступности функции отзыва согласия описаны
в таблице 15.

Отзыв согласия возможен только при наличии у организации действующего
генерального согласия (см. описание в п. А.7.1.6.1 Генеральное согласие,
Приложение А).

Посредством вызова REST API возможно выполнить следующие функции:

-   отзыв выданного согласия.

> **Отзыв выданного согласия**

Path: /api/public/{version}/sbj/{org_oid}/issued/grant/{id}

Тип запроса: DELETE

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\".

Параметр запроса:

-   id согласия.

Из токена:

-   идентификатор пользователя.

Параметр ответа:

-   код и описание ошибки.

Возможные ошибки приведены в таблице 21.

Таблица 21 -- Возможные ошибки

  -----------------------------------------------------------------------
  Код ошибки         Описание
  ------------------ ----------------------------------------------------
  ESIA-036701        Согласие не найдено

  ESIA-036714        Согласие в текущем статусе не может быть отозвано
  -----------------------------------------------------------------------

Пример запроса (вызов сервиса в тестовой среде):

DELETE [https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/sbj/1077376368/issued/grant/19](https://esia-dev-k8s.test.gosuslugi.ru/org-grant/api/public/v1/sbj/1077376368/issued/grant/19)

Пример ответа: 200

##### А.7.1.6.1 Генеральное согласие {#а.7.1.6.1-генеральное-согласие .unnumbered}

Генеральное согласие -- это согласие, выданное от имени организации
Минцифры России. Генеральное согласие позволяет Минцифры России
запрашивать данные\
об организации из ФОИВ и других источников и отображать эти данные в
цифровом профиле организации.

В личном кабинете юридического лица в разделе «Согласия» доступна
возможность выдачи и отзыва генерального согласия. Условия доступности
указанных функций описаны в таблице 15.

Посредством вызова REST API возможно выполнить следующие функции:

-   проверка необходимости выдать генеральное согласие;

-   выдача генерального согласия;

-   отзыв генерального согласия.

**Проверка необходимости выдать генеральное согласие**

В случае отсутствия у организации генерального согласия пользователю в
личном кабинете юридического лица отображается баннер с предложением
выдать генеральное согласие.

Path: /api/public/{version}/org/{org_oid}/checkGeneralGrant

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_grant?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Параметр запроса:

-   организация, которая выдает согласие oid.

Из токена:

-   идентификатор пользователя.

Параметр ответа:

-   JSON с параметром needGeneralGrant.

Возможные ошибки:

> Отсутствуют.
>
> Пример запроса (вызов сервиса в тестовой среде):
>
> GET [https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/org/1077376368/checkGeneralGrant](https://esia-dev-k8s.test.gosuslugi.ru/org-grant/api/public/v1/org/1077376368/checkGeneralGrant)
>
> Пример ответа:

{

\"needGeneralGrant\":false\
}

**Выдача генерального согласия**

> Path: /api/public/{version}/org/{org_oid}/issueGeneralGrant
>
> Тип запроса: POST
>
> Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\".

> Параметр запроса:

-   организация, которая выдает согласие oid

> Из токена:

-   идентификатор пользователя.

> Параметр ответа:

-   статус.

> Возможные ошибки:
>
> Отсутствуют.
>
> Пример запроса (вызов сервиса в тестовой среде):
>
> POST [https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/org/1077376368/issueGeneralGrant](https://esia-dev-k8s.test.gosuslugi.ru/org-grant/api/public/v1/org/1077376368/issueGeneralGrant)
>
> Пример ответа: 200 ОК

**Отзыв генерального согласия**

> Path: /api/public/{version}/org/{org_oid}/revokeGeneralGrant
>
> Тип запроса: DELETE
>
> Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\".

> Параметр запроса:

-   организация, которая выдает согласие oid

> Из токена:

-   идентификатор пользователя.

> Параметр ответа:

-   статус.

> Возможные ошибки приведены в таблице 22.

Таблица 22 -- Возможные ошибки

  -----------------------------------------------------------------------
  Код ошибки         Описание
  ------------------ ----------------------------------------------------
  ESIA-036701        Согласие не найдено

  -----------------------------------------------------------------------

> Пример запроса (вызов сервиса в тестовой среде):
>
> DELETE [https://esia-portal1.test.gosuslugi.ru/org-grant/api/public/v1/org/1077376368/revokeGeneralGrant](https://esia-dev-k8s.test.gosuslugi.ru/org-grant/api/public/v1/org/1077376368/revokeGeneralGrant)
>
> Пример ответа: 200 OK

### Лицензии. Получение от лицензирующих органов в ЕСИА сведений о выдаче/отзыве/изменениях в лицензиях

#### Получение сведений о лицензиях организации

Для получения сведений о лицензиях, переданных лицензирующими органами\
в ЕСИА, в рамках разработанного ВС «Получение сведений о лицензиях\
от лицензирующих органов в ЕСИА в целях обеспечения доступа к ним в
личном кабинете лицензиата в ЕПГУ» (VS02773v001-TABL00):

<https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/636b117b-ff80-11eb-ba23-33408f10c8dc>
используется сервис REST API ЕСИА.

Получение сведений о лицензиях:

/esia-rs/api/public/{version}/orgs/{org_oid}/doc_type

Метод HTTP -- GET:

doc_type = licenses

Требуемые области доступа (scope):

-   org_inf?org_oid={p.org_oid};

-   org_ful?org_oid={p.org_oid};

-   org_idm?org_oid={p.org_oid};

-   org_profile?org_oid={p.org_oid}.

Передача сведений через ВС осуществляется по типу запроса:
Запрос-Ответ,\
где запрос в ЕСИА, содержащий сведения о лицензиях, отправляет
лицензирующий орган. ЕСИА отправляет ответ, содержащий статус выполнения
операции, а также код и описание ошибки при их наличии.

Сервис REST API ЕСИА разработан для получения ранее переданных\
в ЕСИА лицензирующим органом сведений о лицензиях организации.

Сервис REST API ЕСИА не предусмотрен для использования внешними
информационными системами.

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/orgs/1077378135/licenses

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

В качестве ответа возвращаются сведения о всех лицензиях, переданных
лицензирующим органом в ЕСИА по ЮЛ или ИП:

{

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 5,

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 48,

\"issuerOrgName\": \"Федеральная служба по надзору в сфере транспорта\",

\"issuerOrgOgrn\": \"1234567891234\",

\"issuerOrgInn\": \"1234567891\",

\"orgFullName\": \"ОРГАНИЗАЦИЯ --1440020240\",

\"orgShortName\": \"ОРГАНИЗАЦИЯ --1440020240\",

\"ogrn\": \"2435724954245\",

\"inn\": \"8733990723\",

\"address\": \"Екатеринбург\",

\"addrFias\": \"b3317633--9da0--42c7--be9a--72b9a3e150cf\",

\"telNumber\": \"8 (846) 9517550\",

\"email\": \"samperevozchik@gmail.com\",

\"registrationNumber\": \"00534--ЛС\",

\"issueDate\": 1638738000,

\"startDate\": 1638738000,

\"endDate\": 3768411600,

\"status\": \"Приостановлена\",

\"statusDate\": 1621890000,

\"statusStartDate\": 1622494800,

\"statusEndDate\": 1638306000,

\"changeDate\": 1621890000,

\"createdOn\": 1640177458,

\"updatedOn\": 1640177458,

\"licenseTypeActivities\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 51,

\"licenseId\": 48,

\"name\": \"Лицензирование производства лекарственных средств для
медицинского применения\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 3,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 98,

\"licenseTAId\": 51,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
д. 105\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 99,

\"licenseTAId\": 51,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к.12\",

\"addrFias\": \"e3819b1a--7f18--4a31--b17b--22fb0c45852d\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 100,

\"licenseTAId\": 51,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к.11\",

\"addrFias\": \"e3819b1a--7f18--4a31--b17b--22fb0c45852d\"

}

\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 2,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 74,

\"licenseTAId\": 51,

\"name\": \"1. Производственные операции -- лекарственная
продукция:\\n1.1. Нестерильная продукция:\\n1.1.1. Нестерильная
продукция (операции обработки для следующих лекарственных
форм):\\n1.1.1.1. Капсулы в твердой оболочке: капсулы, капсулы
кишечнорастворимые, капсулы кишечнорастворимые, с пролонгированным
высвобождением, капсулы с модифицированным высвобождением, капсулы с
пролонгированным высвобождением.\\n1.1.1.2. Жевательные лекарственные
формы: таблетки жевательные.\",

\"licenseTypeActivityWorkPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 104,

\"licenseTAWId\": 74,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

}

\]

}

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 75,

\"licenseTAId\": 51,

\"name\": \"2. Производственные операции -- лекарственная
продукция:\\n2.1. Прочая лекарственная продукция или производственные
операции:\\n2.1.1. Производство:\\n2.1.1.1. Растительная продукция:
капсулы.\\n2.1.1.2. Прочая продукция: цитостатики: капсулы, капсулы с
пролонгированным высвобождением, таблетки, таблетки, покрытые пленочной
оболочкой; \\nгормоны: гранулы для приготовления суспензии для приема
внутрь, капсулы, порошок для приготовления суспензии для приема внутрь,
таблетки, таблетки, покрытые пленочной оболочкой; \\nпрепараты,
содержащие сильнодействующие вещества: капсулы, таблетки, таблетки,
покрытые оболочкой.\",

\"licenseTypeActivityWorkPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 2,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 105,

\"licenseTAWId\": 75,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к. 12\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 106,

\"licenseTAWId\": 75,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к. 11\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

}

\]

}

}

\]

}

}

\]

}

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 78,

\"issuerOrgName\": \"Федеральная служба по надзору в сфере связи,
информационных технологий и массовых коммуникаций\",

\"issuerOrgOgrn\": \"1087746736296\",

\"issuerOrgInn\": \"7705846236\",

\"orgFullName\": \"Общество с ограниченной ответственностью
\\\"Телевизионная компания \\\"Брэвис\\\"\",

\"orgShortName\": \"ООО \\\"ТК \\\"Брэвис\\\"\",

\"ogrn\": \"2435724954245\",

\"inn\": \"1007012279\",

\"address\": \"186792, Республика Карелия, г. Сортавала, ул. Гагарина,
д. 4\",

\"telNumber\": \"81430--48378\",

\"email\": \"brevis--tv@mail.ru\",

\"registrationNumber\": \"155699\",

\"issueDate\": 1498078800,

\"startDate\": 1488661200,

\"endDate\": 1804194000,

\"status\": \"действующая\",

\"statusDate\": 1498078800,

\"statusStartDate\": 1498078800,

\"changeDate\": 1641934800,

\"createdOn\": 1643274132,

\"updatedOn\": 1643274132,

\"licenseTypeActivities\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 81,

\"licenseId\": 78,

\"name\": \"Услуги связи для целей кабельного вещания\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements\": \[\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements\": \[\]

}

}

\]

}

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 104,

\"issuerOrgName\": \"Федеральная служба по надзору в сфере связи,
информационных технологий и массовых коммуникаций\",

\"issuerOrgOgrn\": \"1087746736296\",

\"issuerOrgInn\": \"7705846236\",

\"orgFullName\": \"Публичное акционерное общество
\\\"Вымпел--Коммуникации\\\"\",

\"orgShortName\": \"ПАО \\\"ВымпелКом\\\"\",

\"ogrn\": \"2435724954245\",

\"inn\": \"7713076301\",

\"address\": \"127083, г. Москва, ул. 8 Марта, д. 10, стр. 14\",

\"telNumber\": \"(495) 783 07--00\",

\"email\": \"VBondar@beeline.ru\",

\"registrationNumber\": \"86429222\",

\"issueDate\": 1304625600,

\"startDate\": 1304625600,

\"endDate\": 1778014800,

\"status\": \"действующая\",

\"statusDate\": 1304625600,

\"statusStartDate\": 1304625600,

\"changeDate\": 1619038800,

\"createdOn\": 1643384541,

\"updatedOn\": 1643384541,

\"licenseTypeActivities\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 98,

\"licenseId\": 104,

\"name\": \"Услуги 11 подвижной радиотелефонной связи\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 2,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 168,

\"licenseTAId\": 98,

\"address\": \"Республика Саха (Якутия): Абыйский у, Абый с, Абыйский у,
Белая Гора пгт, Абыйский у, Деску с, Абыйский у, Кенг--Кюель с, Абыйский
у, Куберганя с, Абыйский у, Сыаганнах с, Алданский у, Кутана с,
Аллаиховский у, Нычалах с, Аллаиховский у, Оленегорск с, Аллаиховский у,
Чкалов с, Аллаиховский у, Чокурдах п, Амгинский у, Амга с, Амгинский у,
Болугур с, Амгинский у, Михайловка с, Амгинский у, Оннес с, Амгинский у,
Сатагай с, Амгинский у, Сулгаччы с, Амгинский у, Эмиссы с, Булунский у,
Быковский с, Булунский у, Кюсюр с, Булунский у, Найба с, Булунский у,
Намы с, Булунский у, Тикси п, Булунский у, Усть--Оленек с,
Верхневилюйский у, Далыр с, Верхневилюйский у, Липпе--Атах с,
Верхнеколымский у, Зырянка п, Верхнеколымский у, Нелемное с,
Верхнеколымский у, Утая с, Верхоянский у, Алысардах с, Верхоянский у,
Бала с, Верхоянский у, Барылас с, Верхоянский у, Батагай пгт,
Верхоянский у, Мачах с, Верхоянский у, Сысы--Мейите с, Верхоянский у,
Токума с, Верхоянский у, Улахан--Кюель с, Верхоянский у, Юнкюр с,
Вилюйский у, Кирово с, Вилюйский у, Усун с, Горный у, Кептин с, Горный
у, Кюерелях с, Жиганский у, Баханай с, Жиганский у, Бестях с, Жиганский
у, Жиганск с, Кобяйский у, Багадя с, Кобяйский у, Батамай с, Кобяйский
у, Люксюгюн с, Кобяйский у, Мастах с, Кобяйский у, Чагда с, Ленский у,
Батамай с, Ленский у, Крестовский Лесоучасток с, Ленский у, Ленск г,
Ленский у, Нюя Северная с, Ленский у, Толон с, Ленский у, Ярославский с,
Мегино--Кангаласский у, Даркылах с, Мегино--Кангаласский у, Майя с,
Мегино--Кангаласский у, Табага с, Мирнинский у, Айхал п, Мирнинский у,
Светлый п, Мирнинский у, Сюльдюкар с, Намский у, Булус с, Намский у,
Намцы с, Намский у, Харыялах с, Нижнеколымский у, Андрюшкино с,
Нижнеколымский у, Черский п, Нюрбинский у, Накын, Нюрбинский у, Сайылык
с, Нюрбинский у, Хаты с, Оймяконский у, Артык п, Оймяконский у,
Октябрьский с, Оймяконский у, Орто--Балаган с, Оймяконский у, Сарылах с,
Оймяконский у, Терют с, Оймяконский у, Томтор с, Оймяконский у, Ючюгей
с, Олекминский у, Кыллах\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 169,

\"licenseTAId\": 98,

\"address\": \"111ублика Саха (Якутия): Абыйский у, Абый с, Абыйский у,
Белая Гора пгт, Абыйский у, Деску с, Абыйский у, Кенг--Кюель с, Абыйский
у, Куберганя с, Абыйский у, Сыаганнах с, Алданский у, Кутана с,
Аллаиховский у, Нычалах с, Аллаиховский у, Оленегорск с, Аллаиховский у,
Чкалов с, Аллаиховский у, Чокурдах п, Амгинский у, Амга с, Амгинский у,
Болугур с, Амгинский у, Михайловка с, Амгинский у, Оннес с, Амгинский у,
Сатагай с, Амгинский у, Сулгаччы с, Амгинский у, Эмиссы с, Булунский у,
Быковский с, Булунский у, Кюсюр с, Булунский у, Найба с, Булунский у,
Намы с, Булунский у, Тикси п, Булунский у, Усть--Оленек с,
Верхневилюйский у, Далыр с, Верхневилюйский у, Липпе--Атах с,
Верхнеколымский у, Зырянка п, Верхнеколымский у, Нелемное с,
Верхнеколымский у, Утая с, Верхоянский у, Алысардах с, Верхоянский у,
Бала с, Верхоянский у, Барылас с, Верхоянский у, Батагай пгт,
Верхоянский у, Мачах с, Верхоянский у, Сысы--Мейите с, Верхоянский у,
Токума с, Верхоянский у, Улахан--Кюель с, Верхоянский у, Юнкюр с,
Вилюйский у, Кирово с, Вилюйский у, Усун с, Горный у, Кептин с, Горный
у, Кюерелях с, Жиганский у, Баханай с, Жиганский у, Бестях с, Жиганский
у, Жиганск с, Кобяйский у, Багадя с, Кобяйский у, Батамай с, Кобяйский
у, Люксюгюн с, Кобяйский у, Мастах с, Кобяйский у, Чагда с, Ленский у,
Батамай с, Ленский у, Крестовский Лесоучасток с, Ленский у, Ленск г,
Ленский у, Нюя Северная с, Ленский у, Толон с, Ленский у, Ярославский с,
Мегино--Кангаласский у, Даркылах с, Мегино--Кангаласский у, Майя с,
Мегино--Кангаласский у, Табага с, Мирнинский у, Айхал п, Мирнинский у,
Светлый п, Мирнинский у, Сюльдюкар с, Намский у, Булус с, Намский у,
Намцы с, Намский у, Харыялах с, Нижнеколымский у, Андрюшкино с,
Нижнеколымский у, Черский п, Нюрбинский у, Накын, Нюрбинский у, Сайылык
с, Нюрбинский у, Хаты с, Оймяконский у, Артык п, Оймяконский у,
Октябрьский с, Оймяконский у, Орто--Балаган с, Оймяконский у, Сарылах с,
Оймяконский у, Терют с, Оймяконский у, Томтор с, Оймяконский у, Ючюгей
с, Олекминский у, Кыллах \"

}

\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements\": \[\]

}

}

\]

}

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 120,

\"issuerOrgName\": \"Федеральная служба по надзору в сфере связи,
информационных технологий и массовых коммуникаций\",

\"issuerOrgOgrn\": \"1087746736296\",

\"issuerOrgInn\": \"7705846236\",

\"orgFullName\": \"Акционерное общество \\\"Арктиктелекоммм\\\"\",

\"orgShortName\": \"АО \\\"АТК\\\"\",

\"ogrn\": \"2435724954245\",

\"inn\": \"1435360411\",

\"address\": \"677027, Республика Саха (Якутия), г. Якутск, ул.
Октябрьская, д. 10/1\",

\"telNumber\": \"(4112) 351--413, (4112)322--019, 425--820\",

\"email\": \"post@tctr.ru\",

\"registrationNumber\": \"249799\",

\"issueDate\": 1480971600,

\"startDate\": 1620334800,

\"endDate\": 1667509200,

\"status\": \"действующая\",

\"statusDate\": 1480971600,

\"statusStartDate\": 1480971600,

\"changeDate\": 1622754000,

\"createdOn\": 1644237033,

\"updatedOn\": 1644237033,

\"licenseTypeActivities\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 3,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 132,

\"licenseId\": 120,

\"name\": \"Услуги связи для целей эфирного вещания\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 2,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 213,

\"licenseTAId\": 132,

\"address\": \"Якутия): Аббыйский г\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 214,

\"licenseTAId\": 132,

\"address\": \"Якутия2): Аббыйский г\"

}

\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements\": \[\]

}

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 133,

\"licenseId\": 120,

\"name\": \"Услуги связи для целей эфирного вещания2\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 215,

\"licenseTAId\": 133,

\"address\": \"Якутия): Аббыйский г\"

}

\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements\": \[\]

}

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 134,

\"licenseId\": 120,

\"name\": \"Услуги связи для целей эфирного вещания4444\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 216,

\"licenseTAId\": 134,

\"address\": \"Якутия): Аббыйский г\"

}

\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 103,

\"licenseTAId\": 134,

\"name\": \"авыаыаыфваыф\",

\"licenseTypeActivityWorkPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements\": \[\]

}

}

\]

}

}

\]

}

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 125,

\"issuerOrgName\": \"Федеральная служба по надзору в сфере связи,
информационных технологий и массовых коммуникаций\",

\"issuerOrgOgrn\": \"1087746736296\",

\"issuerOrgInn\": \"7705846236\",

\"orgFullName\": \"Акционерное общество \\\"Арктиктелеком\\\"\",

\"orgShortName\": \"АО \\\"АТК\\\"\",

\"ogrn\": \"2435724954245\",

\"inn\": \"1435360411\",

\"address\": \"677027, Республика Саха (Якутия), г. Якутск, ул.
Октябрьская, д. 10/1\",

\"telNumber\": \"(4112) 351--413, (4112)322--019, 425--820\",

\"email\": \"post@tctr.ru\",

\"registrationNumber\": \"149799\",

\"issueDate\": 1480971600,

\"startDate\": 1620334800,

\"endDate\": 1667509200,

\"status\": \"действующая\",

\"statusDate\": 1480971600,

\"statusStartDate\": 1480971600,

\"changeDate\": 1622754000,

\"createdOn\": 1645172469,

\"updatedOn\": 1645172469,

\"licenseTypeActivities\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 144,

\"licenseId\": 125,

\"name\": \"Услуги связи для целей эфирного вещания\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 230,

\"licenseTAId\": 144,

\"address\": \"Якутия): Абыйский у, Абый с, Абыйский у, Белая Гора пгт,
Абыйский у, Деску с, Абыйский у, Кенг--Кюель с, Абыйский у, Куберганя с,
Абыйский у, Сыаганнах с, Алданский у, Кутана с, Аллаиховский у, Нычалах
с, Аллаиховский у, Оленегорск с, Аллаиховский у, Чкалов с, Аллаиховский
у, Чокурдах п, Амгинский у, Амга с, Амгинский у, Болугур с, Амгинский у,
Михайловка с, Амгинский у, Оннес с, Амгинский у, Сатагай с, Амгинский у,
Сулгаччы с, Амгинский у, Эмиссы с, Булунский у, Быковский с, Булунский
у, Кюсюр с, Булунский у, Найба с, Булунский у, Намы с, Булунский у,
Тикси п, Булунский у, Усть--Оленек с, Верхневилюйский у, Далыр с,
Верхневилюйский у, Липпе--Атах с, Верхнеколымский у, Зырянка п,
Верхнеколымский у, Нелемное с, Верхнеколымский у, Утая с, Верхоянский у,
Алысардах с, Верхоянский у, Бала с, Верхоянский у, Барылас с,
Верхоянский у, Батагай пгт, Верхоянский у, Мачах с, Верхоянский у,
Сысы--Мейите с, Верхоянский у, Токума с, Верхоянский у, Улахан--Кюель с,
Верхоянский у, Юнкюр с, Вилюйский у, Кирово с, Вилюйский у, Усун с,
Горный у, Кептин с, Горный у, Кюерелях с, Жиганский у, Баханай с,
Жиганский у, Бестях с, Жиганский у, Жиганск с, Кобяйский у, Багадя с,
Кобяйский у, Батамай с, Кобяйский у, Люксюгюн с, Кобяйский у, Мастах с,
Кобяйский у, Чагда с, Ленский у, Батамай с, Ленский у, Крестовский
Лесоучасток с, Ленский у, Ленск г, Ленский у, Нюя Северная с, Ленский у,
Толон с, Ленский у, Ярославский с, Мегино--Кангаласский у, Даркылах с,
Мегино--Кангаласский у, Майя с, Мегино--Кангаласский у, Табага с,
Мирнинский у, Айхал п, Мирнинский у, Светлый п, Мирнинский у, Сюльдюкар
с, Намский у, Булус с, Намский у, Намцы с, Намский у, Харыялах с,
Нижнеколымский у, Андрюшкино с, Нижнеколымский у, Черский п, Нюрбинский
у, Накын, Нюрбинский у, Сайылык с, Нюрбинский у, Хаты с, Оймяконский у,
Артык п, Оймяконский у, Октябрьский с, Оймяконский у, Орто--Балаган с,
Оймяконский у, Сарылах с, Оймяконский у, Терют с, Оймяконский у, Томтор
с, Оймяконский у, Ючюгей с, Олекминский у, Кыллах с, Олекминский у\"

}

\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements\": \[\]

}

}

\]

}

}

\]

}

Структура ответа в формате JSON:

-   stateFacts -- параметр, указывающий на факты о предоставляемых
    сведениях. Принимает значение:

    -   Identifiable -- имеет идентификатор (например, это конкретный
        контакт\
        или документ);

-   id -- уникальный идентификатор документа, содержащего сведения\
    о лицензиях;

-   issuerOrgName -- наименование лицензирующего органа;

-   issuerOrgOgrn -- ОГРН лицензирующего органа;

-   issuerOrgInn -- ИНН лицензирующего органа;

-   Наименование ИП/ЮЛ:

    -   spName -- Фамилия, Имя, Отчество (при наличии) индивидуального
        предпринимателя;

    -   orgFullName -- полное наименование организации;

    -   orgShortName -- сокращенное наименование организации;

-   ogrn -- ОГРН ЮЛ или ОРГНИП;

-   inn -- ИНН ЮЛ или ИНН ИП;

-   address -- адрес места нахождения организации или сведения о месте
    жительства индивидуального предпринимателя;

-   addrFias -- ФИАС (GUID--код) -- глобальный уникальный идентификатор
    адресного объекта -- адрес места нахождения организации или сведения
    о месте жительства индивидуального предпринимателя;

-   telNumber -- номер телефона организации или номер телефона
    индивидуального предпринимателя;

-   email -- электронная почта организации или электронная почта
    индивидуального предпринимателя;

-   registrationNumber -- регистрационный номер лицензии;

-   issueDate -- дата предоставления лицензии;

-   startDate -- дата начала действия лицензии;

-   endDate -- дата окончания действия лицензии;

-   status -- статус лицензии;

-   statusDate -- дата определения статуса;

-   statusStartDate -- дата вступления статуса в силу;

-   statusEndDate -- дата окончания действия статуса;

-   changeDate -- дата внесения изменений в реестр лицензий;

-   createdOn -- отметка времени создания документа;

-   updatedOn -- отметка времени обновления документа;

-   licenseTypeActivities -- сведения о лицензируемых видах
    деятельности,\
    на которые выдана лицензия. Комплексное поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   hasSize -- имеет размер (например, для коллекции указывает на
        число элементов коллекции);

    -   size -- параметр, указывающий на количество атрибутов в массиве;

    -   elements -- параметр, содержащий информацию о лицензируемых
        видах деятельности, на которые выдана лицензия. Комплексное
        поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   ReadOnly -- объект только для чтения;

    -   id -- уникальный идентификатор документа, содержащего сведения\
        о лицензируемых видах деятельности, на которые выдана лицензия;

    -   licenseId -- параметр, указывающий на уникальный идентификатор
        документа, содержащего сведения о лицензиях;

    -   name -- наименование лицензируемого вида деятельности;

    -   licenseTypeActivityPlaces -- сведения о месте осуществления
        лицензируемого вида деятельности. Комплексное поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   hasSize -- имеет размер (например, для коллекции указывает на
        число элементов коллекции);

    -   size -- параметр, указывающий на количество атрибутов в массиве;

    -   elements -- параметр, содержащий информацию о месте
        осуществления лицензируемого вида деятельности. Комплексное
        поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   ReadOnly -- объект только для чтения;

    -   id -- уникальный идентификатор документа, содержащего информацию
        о месте осуществления лицензируемого вида деятельности;

    -   licenseTAId -- параметр, указывающий на уникальный идентификатор
        документа, содержащего сведения о лицензируемых видах
        деятельности, на которые выдана лицензия;

    -   address -- адрес места осуществления лицензируемого вида
        деятельности;

    -   addrFias -- ФИАС (GUID--код) -- глобальный уникальный
        идентификатор адресного объекта -- адрес места осуществления
        лицензируемого вида деятельности;

    -   licenseTypeActivityWorks -- выполняемые работы, оказываемые
        услуги, составляющие лицензируемый вид деятельности, а также
        сведения\
        о месте осуществления выполняемых работ, оказываемых услуг,
        составляющих лицензируемый вид деятельности. Комплексное поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   hasSize -- имеет размер (например, для коллекции указывает на
        число элементов коллекции);

    -   size -- параметр, указывающий на количество атрибутов в массиве;

    -   elements -- параметр, содержащий информацию о выполняемых
        работах, оказываемых услугах, составляющих лицензируемый вид
        деятельности, а также сведения о месте осуществления выполняемых
        работ, оказываемых услуг, составляющих лицензируемый вид
        деятельности. Комплексное поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   ReadOnly -- объект только для чтения;

    -   id -- уникальный идентификатор документа, содержащего информацию
        о выполняемых работах, оказываемых услугах, составляющих
        лицензируемый вид деятельности, а также сведения\
        о месте осуществления выполняемых работ, оказываемых услуг,
        составляющих лицензируемый вид деятельности;

    -   licenseTAId -- параметр, указывающий на уникальный идентификатор
        документа, содержащего сведения о лицензируемых видах
        деятельности, на которые выдана лицензия;

    -   name -- выполняемые работы, оказываемые услуги, составляющие
        лицензируемый вид деятельности;

    -   licenseTypeActivityWorkPlaces -- сведения о месте осуществления
        выполняемых работ, оказываемых услуг, составляющих лицензируемый
        вид деятельности. Комплексное поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   hasSize -- имеет размер (например, для коллекции указывает\
        на число элементов коллекции);

    -   size -- параметр, указывающий на количество атрибутов в массиве;

    -   elements -- параметр, содержащий информацию о месте
        осуществления выполняемых работ, оказываемых услуг, составляющих
        лицензируемый вид деятельности. Комплексное поле:

    -   stateFacts -- параметр, указывающий на факты о предоставляемых
        сведениях. Принимает значение:

    -   ReadOnly -- объект только для чтения;

    -   id -- уникальный идентификатор документа, содержащего информацию
        о месте осуществления выполняемых работ, оказываемых услуг,
        составляющих лицензируемый вид деятельности;

    -   licenseTAWId -- параметр, указывающий на уникальный
        идентификатор документа, содержащего информацию о выполняемых
        работах, оказываемых услугах, составляющих лицензируемый вид
        деятельности, а также сведения о месте осуществления выполняемых
        работ, оказываемых услуг, составляющих лицензируемый вид
        деятельности;

    -   address -- адрес места осуществления выполняемых работ,
        оказываемых услуг, составляющих лицензируемый вид деятельности;

    -   addrFias -- ФИАС (GUID--код) -- глобальный уникальный
        идентификатор адресного объекта -- адрес места осуществления
        выполняемых работ, оказываемых услуг, составляющих лицензируемый
        вид деятельности.

Для данного REST API реализована возможность запроса данных\
с дополнительным параметром в URL запроса:

?regNumberOrTaName={регистрационный номер лицензии или наименование
лицензируемого вида деятельности} -- осуществление поиска сведений о
лицензиях\
по регистрационному номеру лицензий или наименованию лицензируемого вида
деятельности.

Пример запроса (вызов сервиса в тестовой среде):

GET https://
esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/orgs/1077376368/licenses?regNumberOrTaName=00534--ЛС

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

В качестве ответа возвращаются сведения о лицензиях, содержащие
регистрационный номер лицензии, указанный в запросе:

{

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 48,

\"issuerOrgName\": \"Федеральная служба по надзору в сфере транспорта\",

\"issuerOrgOgrn\": \"1234567891234\",

\"issuerOrgInn\": \"1234567891\",

\"orgFullName\": \"ОРГАНИЗАЦИЯ --1440020240\",

\"orgShortName\": \"ОРГАНИЗАЦИЯ --1440020240\",

\"ogrn\": \"2435724954245\",

\"inn\": \"8733990723\",

\"address\": \"Екатеринбург\",

\"addrFias\": \"b3317633--9da0--42c7--be9a--72b9a3e150cf\",

\"telNumber\": \"8 (846) 9517550\",

\"email\": \"samperevozchik@gmail.com\",

\"registrationNumber\": \"00534--ЛС\",

\"issueDate\": 1638738000,

\"startDate\": 1638738000,

\"endDate\": 3768411600,

\"status\": \"Приостановлена\",

\"statusDate\": 1621890000,

\"statusStartDate\": 1622494800,

\"statusEndDate\": 1638306000,

\"changeDate\": 1621890000,

\"createdOn\": 1640177458,

\"updatedOn\": 1640177458,

\"licenseTypeActivities\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 51,

\"licenseId\": 48,

\"name\": \"Лицензирование производства лекарственных средств для
медицинского применения\",

\"licenseTypeActivityPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 3,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 98,

\"licenseTAId\": 51,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
д. 105\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 99,

\"licenseTAId\": 51,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к.12\",

\"addrFias\": \"e3819b1a--7f18--4a31--b17b--22fb0c45852d\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 100,

\"licenseTAId\": 51,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к.11\",

\"addrFias\": \"e3819b1a--7f18--4a31--b17b--22fb0c45852d\"

}

\]

},

\"licenseTypeActivityWorks\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 2,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 74,

\"licenseTAId\": 51,

\"name\": \"1. Производственные операции -- лекарственная
продукция:\\n1.1. Нестерильная продукция:\\n1.1.1. Нестерильная
продукция (операции обработки для следующих лекарственных
форм):\\n1.1.1.1. Капсулы в твердой оболочке: капсулы, капсулы
кишечнорастворимые, капсулы кишечнорастворимые, с пролонгированным
высвобождением, капсулы с модифицированным высвобождением, капсулы с
пролонгированным высвобождением.\\n1.1.1.2. Жевательные лекарственные
формы: таблетки жевательные.\",

\"licenseTypeActivityWorkPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 104,

\"licenseTAWId\": 74,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

}

\]

}

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 75,

\"licenseTAId\": 51,

\"name\": \"2. Производственные операции -- лекарственная
продукция:\\n2.1. Прочая лекарственная продукция или производственные
операции:\\n2.1.1. Производство:\\n2.1.1.1. Растительная продукция:
капсулы.\\n2.1.1.2. Прочая продукция: цитостатики: капсулы, капсулы с
пролонгированным высвобождением, таблетки, таблетки, покрытые пленочной
оболочкой; \\nгормоны: гранулы для приготовления суспензии для приема
внутрь, капсулы, порошок для приготовления суспензии для приема внутрь,
таблетки, таблетки, покрытые пленочной оболочкой; \\nпрепараты,
содержащие сильнодействующие вещества: капсулы, таблетки, таблетки,
покрытые оболочкой.\",

\"licenseTypeActivityWorkPlaces\": {

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 2,

\"elements\": \[

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 105,

\"licenseTAWId\": 75,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к. 12\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

},

{

\"stateFacts\": \[

\"ReadOnly\"

\],

\"id\": 106,

\"licenseTAWId\": 75,

\"address\": \"Московская обл., г.о. Щелково, г. Щелково, ул. Заречная,
стр. 105Б, к. 11\",

\"addrFias\": \"58b5f765--53da--4772--8b89--4a5359255815\"

}

\]

}

}

\]

}

}

\]

}

}

\]

}

Для ВС, в рамках которого осуществляется передача лицензирующими
органами сведений о лицензиях, предусмотрены возможные коды ошибок и
описания кодов ошибок, приведенные в таблице 23.

Таблица 23 -- Коды ошибок и описания кодов ошибок

+---+---------+-----------------+-------------------------------------+
| № | Код     | Описание кода   | Комментарии                         |
|   | ошибки  | ошибки          |                                     |
+===+=========+=================+=====================================+
| 1 | ESIA    | Недостаточно    | Соответствует ситуации, когда       |
| . | -039230 | прав\           | мнемоника ИС, отправившей запрос,   |
|   |         | для обновления  | содержащий обновленные сведения о   |
|   |         | лицензии        | ранее переданной в ЕСИА лицензии,\  |
|   |         |                 | не совпадает с мнемоникой ИС,       |
|   |         |                 | отправившей запрос, содержащий      |
|   |         |                 | сведения о лицензии, переданной в   |
|   |         |                 | ЕСИА впервые, при условии           |
|   |         |                 | совпадения трех атрибутов ключа --  |
|   |         |                 | идентификатора лицензии в ЕСИА:     |
|   |         |                 | [licenseRegNumber]{.mark},          |
|   |         |                 | licenseDate, ogrn или ogrnip        |
+---+---------+-----------------+-------------------------------------+
| 2 | ESIA    | Неверно указаны | Соответствует ситуации, когда       |
| . | -030003 | параметры       | указанные\                          |
|   |         |                 | в запросе параметры не              |
|   |         |                 | соответствуют требованиям           |
|   |         |                 | руководства пользователя ВС         |
+---+---------+-----------------+-------------------------------------+
| 3 | ESIA    | Внутренняя      | Соответствует ситуации, когда       |
| . | -000001 | ошибка          | произошла внутренняя ошибка на      |
|   |         |                 | стороне ЕСИА                        |
|   |         |                 |                                     |
+---+---------+-----------------+-------------------------------------+

#### Получение и отображение управляющих элементов для перехода по ссылкам на услуги по лицензированию ЕПГУ

Для отображения управляющих элементов для перехода по ссылкам на услуги\
по лицензированию ЕПГУ в разделе «Лицензии» ЛК организации ЕПГУ
разработан внешний сервис REST API ЕСИА.

Путь: esia-rs/api/public/{version}/orgs/{org_oid}/licenses/{id}/services

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Параметры запроса метода:

-   version -- версия API;

-   org_oid -- идентификатор (OID) организации;

-   id -- id лицензии.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/orgs/1077465404/licenses/780/services

Пример ответа (для лицензии нет доступных услуг): Code: 200 ОК.

{

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 0,

\"elements \": \[

\]

}

Пример ответа (для лицензии есть доступные услуги): Code: 200 ОК

{

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 4,

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"serviceName\": \"Внести изменения в лицензию\",

\"url\": \"https://www.gosuslugi.ru/600375/1/form\"

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"serviceName\": \"Изменить контактные данные\",

\"url\": \"https://www.gosuslugi.ru/600379/1/form\"

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"serviceName\": \"Прекратить действие лицензии\",

\"url\": \"https://www.gosuslugi.ru/600364/1/form\"

}

\]

}

Параметры ответа в формате JSON:

-   elements -- массив доступных для лицензии услуг;

-   serviceName -- наименование услуги;

-   url -- ссылка на услугу.

> Возможные коды ошибок приведены в таблице 24.

Таблица 24 -- Возможные коды ошибок

  -----------------------------------------------------------------------
  **Ошибка**                              **Описание ошибки**
  --------------------------------------- -------------------------------
  HTTP CODE:   401 {\"code\":\"           Не указан токен авторизации
  ESIA-005011\", \"message\": \"          
  SecurityErrorEnum.invalidToken\"}       

  HTTP CODE:   403 {\"code\":\"           Указание в URL запроса
  ESIA-005029\", \"message\": \"          организации другого
  SecurityErrorEnum.scopeNotAllowed\"}    пользователя
  -----------------------------------------------------------------------

### Финансы. Предоставление сведений о налогах из налоговой декларации, о наличии (отсутствии) задолженности и фактически уплаченных налогах, предоставление бухгалтерской отчетности

В разделе «Финансы» во вкладке «Налоги» могут быть доступны отдельные
сведения из налоговых деклараций за текущий и три предыдущих года, а
также сведения\
о наличии (отсутствии) задолженности и сумме фактически уплаченных
налогов на дату запроса:

-   Сведения (за последние три отчетных года) из декларации по налогу,
    уплачиваемому в связи с применением УСН;

-   Сведения (за текущий год и за последние три отчетных года) из
    декларации\
    по налогу на добавленную стоимость;

-   Сведения (за текущий год и за последние три отчетных года) из
    налоговой декларации по налогу на прибыль организации;

-   Сведения (за последние три отчетных года) из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   Сведения (на дату запроса) о наличии (отсутствии) задолженности по
    уплате налогов, сборов, страховых взносов, пеней, штрафов,
    процентов;

-   Сведения (на дату запроса) о сумме фактически уплаченных юридическим
    лицом налогов за текущий финансовый год.

Сведения загружаются в личный кабинет организации автоматически из
налоговой отчетности, которую организация представила в ФНС России.
Сведения из налоговой декларации по организации могут отсутствовать в
ФНС России.

Состав данных о налогах в разделе зависит от системы налогообложения
организации и ИП.

Причины отсутствия данных по организации и ИП:

-   организация или ИП не представляла декларацию за данный период;

-   налоговая еще не обработала представленную декларацию;

-   в запрашиваемом периоде организация или ИП применяла другую систему
    налогообложения и не являлась плательщиком данного налога.

Причина отсутствия данных по наличию (отсутствию) задолженности
по организации и ИП -- организация или ИП снята с учета в ФНС России в
связи с прекращением деятельности.

Причина отсутствия данных по по сумме фактически уплаченных налогов --
организация в текущем финансовом году не платила налоги в бюджет любого
уровня (федеральный, муниципальный и т.п.).

Доступность функций для пользователя в разделе «Финансы» зависит от его
роли и полномочий (см. таблицу 25).

Запрос и обновление сведений по налогам, по наличию (отсутствию)
задолженности и фактически уплаченным налогам доступны при наличии ранее
выданного согласия Минцифры России в разделе «Финансы». Подробную
информацию о согласиях Минцифры России см. в п. А.7.1.6.

Таблица 25 -- Доступность функций в зависимости от ролей и полномочий

  --------------------------------------------------------------------------------------------------------------------------------------------------
  **Вид налога**  **Действие/ Роль**  **Руко-води-тель**   **Адми-нист-ратор**   **Сотру-дник**   **Сотрудник с                     
                                                                                                  полномочиями**                    
  --------------- ------------------- -------------------- --------------------- ---------------- ---------------- ---------------- ----------------
                                                                                                  **«Право запроса **«Право         **«Право запроса
                                                                                                  выписки\         просмотра        выписки\
                                                                                                  из налоговой     выписки\         из налоговой
                                                                                                  декларации       из налоговой     декларации
                                                                                                  организации»  и  декларации       организации»**
                                                                                                  «Право           организации»**   
                                                                                                  управления                        
                                                                                                  согласиями                        
                                                                                                  организации»**                    

  УСН             Просмотр списка     Да                   Да                    Нет              Да               Да               Да
                  сведений\                                                                                                         
                  из декларации по                                                                                                  
                  налогу                                                                                                            

                  Запрос/Обновление   Да                   Да                    Нет              Да               Нет              Да
                  сведений\                                                                                                         
                  из декларации по                                                                                                  
                  налогу                                                                                                            

                  Выгрузка сведений\  Да                   Да                    Нет              Да               Да               Да
                  из декларации по                                                                                                  
                  налогу (pdf или все                                                                                               
                  4 документа                                                                                                       
                  архивом)                                                                                                          

  НДС             Просмотр списка     Да                   Да                    Нет              Да               Да               Да
                  сведений\                                                                                                         
                  из декларации по                                                                                                  
                  налогу                                                                                                            

                  Запрос/Обновление   Да                   Да                    Нет              Да               Нет              Да
                  сведений\                                                                                                         
                  из декларации по                                                                                                  
                  налогу                                                                                                            

                  Выгрузка сведений\  Да                   Да                    Нет              Да               Да               Да
                  из декларации по                                                                                                  
                  налогу (pdf или все                                                                                               
                  4 документа                                                                                                       
                  архивом)                                                                                                          

  Налог\          Просмотр списка     Да                   Да                    Нет              Да               Да               Да
  на прибыль      сведений\                                                                                                         
                  из декларации по                                                                                                  
                  налогу                                                                                                            

                  Запрос/Обновление   Да                   Да                    Нет              Да               Нет              Да
                  сведений\                                                                                                         
                  из декларации по                                                                                                  
                  налогу                                                                                                            

                  Выгрузка сведений\  Да                   Да                    Нет              Да               Да               Да
                  из декларации по                                                                                                  
                  налогу (pdf или все                                                                                               
                  4 документа                                                                                                       
                  архивом)                                                                                                          

  Специаль-ные    Просмотр списка     Да                   Да                    Нет              Да               Да               Да
  налоговые       сведений\                                                                                                         
  режимы          из декларации по                                                                                                  
                  налогу                                                                                                            

                  Запрос/Обновление   Да                   Да                    Нет              Да               Нет              Да
                  сведений\                                                                                                         
                  из декларации по                                                                                                  
                  налогу                                                                                                            

  Налоговая       Просмотр сведений   Да                   Да                    Нет              Да               Да               Да
  задолженность                                                                                                                     

                  Запрос/Обновление   Да                   Да                    Нет              Да               Нет              Да
                  сведений                                                                                                          

  Фактически      Просмотр сведений   Да                   Да                    Нет              Да               Да               Да
  уплаченные                                                                                                                        
  налоги                                                                                                                            

                  Запрос/Обновление   Да                   Да                    Нет              Да               Нет              Да
                  сведений                                                                                                          
  --------------------------------------------------------------------------------------------------------------------------------------------------

#### Получение сведений из налоговой декларации по налогу, уплачиваемому в связи с применением УСН

Для получения сведений из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/usn,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   usn -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_usn?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/usn

Пример ответа: Code: 200 OK

+-----------------------------------------------------------------------+
| \[                                                                    |
|                                                                       |
|     {                                                                 |
|                                                                       |
|         \"id\": \"5907674d-d2ec-4c28-a75b-1f05f541ea38\",             |
|                                                                       |
|         \"orgOid\": 1077404126,                                       |
|                                                                       |
|         \"data\": \[                                                  |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"docId\": \"6e82a7dc2c2a4eee8929a83a13581308\",      |
|                                                                       |
|                 \"period\": \"34\",                                   |
|                                                                       |
|                 \"reportYear\": \"2021\",                             |
|                                                                       |
|                 \"numberCorrection\": 0,                              |
|                                                                       |
|                 \"orgInfo\": {                                        |
|                                                                       |
|                     \"individualInfo\": {                             |
|                                                                       |
|                         \"inn\": \"772880774363\",                    |
|                                                                       |
|                         \"individualName\": {                         |
|                                                                       |
|                             \"firstName\": \"ВЛАДИМИР\",              |
|                                                                       |
|                             \"lastName\": \"ЛАДЫГИН\",                |
|                                                                       |
|                             \"middleName\": \"ВИКТОРОВИЧ\"            |
|                                                                       |
|                         }                                             |
|                                                                       |
|                     }                                                 |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"taxInfo\": {                                        |
|                                                                       |
|                     \"income\": \"11165054\",                         |
|                                                                       |
|                     \"expense\": \"0\",                               |
|                                                                       |
|                     \"tax\": \"669903\",                              |
|                                                                       |
|                     \"taxMin\": \"0\"                                 |
|                                                                       |
|                 }                                                     |
|                                                                       |
|             }                                                         |
|                                                                       |
|         \],                                                           |
|                                                                       |
|         \"relevance\": \"ACTUAL\",                                    |
|                                                                       |
|         \"status\": \"VERIFIED_BY_REQUEST\",                          |
|                                                                       |
|         \"version\": 52,                                              |
|                                                                       |
|         \"createdOn\": \"2022-06-16T10:51:21.766\",                   |
|                                                                       |
|         \"updatedOn\": \"2022-06-24T16:21:10.801\",                   |
|                                                                       |
|         \"verifiedOn\": \"2022-06-24\",                               |
|                                                                       |
|         \"attachments\": \[                                           |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5650/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045650\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\", |
|                                                                       |
|                     \"mimeType\": \"PDF\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"signLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/4045650                 |
| /SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045650\",                        |
|                                                                       |
|                     \"objectTypeId\": \"41\",                         |
|                                                                       |
|                     \"mnemonic\"                                      |
| : \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\", |
|                                                                       |
|                     \"mimeType\": \"PKCS7\"                           |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": false                                       |
|                                                                       |
|             },                                                        |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5650/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045650\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                     \"mimeType\": \"XML\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": true                                        |
|                                                                       |
|             },                                                        |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5650/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045650\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                     \"mimeType\": \"XML\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"signLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/4045650                 |
| /SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045650\",                        |
|                                                                       |
|                     \"objectTypeId\": \"41\",                         |
|                                                                       |
|                     \"mnemonic\"                                      |
| : \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\", |
|                                                                       |
|                     \"mimeType\": \"PKCS7\"                           |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": false                                       |
|                                                                       |
|             }                                                         |
|                                                                       |
|         \],                                                           |
|                                                                       |
|         \"year\": \"2021\",                                           |
|                                                                       |
|         \"mainAttachment\": {                                         |
|                                                                       |
|             \"fileLink\": {                                           |
|                                                                       |
|                 \"originLink\": \"s3://00/404                         |
| 5650/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                 \"location\": \"00\",                                 |
|                                                                       |
|                 \"objectId\": \"4045650\",                            |
|                                                                       |
|                 \"objectTypeId\": \"40\",                             |
|                                                                       |
|                 \"mnemon                                              |
| ic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                 \"mimeType\": \"XML\"                                 |
|                                                                       |
|             },                                                        |
|                                                                       |
|             \"main\": true                                            |
|                                                                       |
|         }                                                             |
|                                                                       |
|     },                                                                |
|                                                                       |
|     {                                                                 |
|                                                                       |
|         \"id\": \"adcc8a13-9e53-45d7-9a3e-356bda7556f9\",             |
|                                                                       |
|         \"orgOid\": 1077404126,                                       |
|                                                                       |
|         \"data\": \[                                                  |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"docId\": \"6e82a7dc2c2a4eee8929a83a13581308\",      |
|                                                                       |
|                 \"period\": \"34\",                                   |
|                                                                       |
|                 \"reportYear\": \"2021\",                             |
|                                                                       |
|                 \"numberCorrection\": 0,                              |
|                                                                       |
|                 \"orgInfo\": {                                        |
|                                                                       |
|                     \"individualInfo\": {                             |
|                                                                       |
|                         \"inn\": \"772880774363\",                    |
|                                                                       |
|                         \"individualName\": {                         |
|                                                                       |
|                             \"firstName\": \"ВЛАДИМИР\",              |
|                                                                       |
|                             \"lastName\": \"ЛАДЫГИН\",                |
|                                                                       |
|                             \"middleName\": \"ВИКТОРОВИЧ\"            |
|                                                                       |
|                         }                                             |
|                                                                       |
|                     }                                                 |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"taxInfo\": {                                        |
|                                                                       |
|                     \"income\": \"11165054\",                         |
|                                                                       |
|                     \"expense\": \"0\",                               |
|                                                                       |
|                     \"tax\": \"669903\",                              |
|                                                                       |
|                     \"taxMin\": \"0\"                                 |
|                                                                       |
|                 }                                                     |
|                                                                       |
|             }                                                         |
|                                                                       |
|         \],                                                           |
|                                                                       |
|         \"relevance\": \"ACTUAL\",                                    |
|                                                                       |
|         \"status\": \"VERIFIED_BY_REQUEST\",                          |
|                                                                       |
|         \"version\": 52,                                              |
|                                                                       |
|         \"createdOn\": \"2022-06-16T10:51:21.695\",                   |
|                                                                       |
|         \"updatedOn\": \"2022-06-24T16:21:12.957\",                   |
|                                                                       |
|         \"verifiedOn\": \"2022-06-24\",                               |
|                                                                       |
|         \"attachments\": \[                                           |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5649/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045649\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\", |
|                                                                       |
|                     \"mimeType\": \"PDF\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"signLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/4045649                 |
| /SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045649\",                        |
|                                                                       |
|                     \"objectTypeId\": \"41\",                         |
|                                                                       |
|                     \"mnemonic\"                                      |
| : \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\", |
|                                                                       |
|                     \"mimeType\": \"PKCS7\"                           |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": false                                       |
|                                                                       |
|             },                                                        |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5649/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045649\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                     \"mimeType\": \"XML\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": true                                        |
|                                                                       |
|             },                                                        |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5649/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045649\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                     \"mimeType\": \"XML\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"signLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/4045649                 |
| /SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045649\",                        |
|                                                                       |
|                     \"objectTypeId\": \"41\",                         |
|                                                                       |
|                     \"mnemonic\"                                      |
| : \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\", |
|                                                                       |
|                     \"mimeType\": \"PKCS7\"                           |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": false                                       |
|                                                                       |
|             }                                                         |
|                                                                       |
|         \],                                                           |
|                                                                       |
|         \"year\": \"2020\",                                           |
|                                                                       |
|         \"mainAttachment\": {                                         |
|                                                                       |
|             \"fileLink\": {                                           |
|                                                                       |
|                 \"originLink\": \"s3://00/404                         |
| 5649/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                 \"location\": \"00\",                                 |
|                                                                       |
|                 \"objectId\": \"4045649\",                            |
|                                                                       |
|                 \"objectTypeId\": \"40\",                             |
|                                                                       |
|                 \"mnemon                                              |
| ic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                 \"mimeType\": \"XML\"                                 |
|                                                                       |
|             },                                                        |
|                                                                       |
|             \"main\": true                                            |
|                                                                       |
|         }                                                             |
|                                                                       |
|     },                                                                |
|                                                                       |
|     {                                                                 |
|                                                                       |
|         \"id\": \"7686bf66-e49c-4261-a72f-2a4f834b6e52\",             |
|                                                                       |
|         \"orgOid\": 1077404126,                                       |
|                                                                       |
|         \"data\": \[                                                  |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"docId\": \"6e82a7dc2c2a4eee8929a83a13581308\",      |
|                                                                       |
|                 \"period\": \"34\",                                   |
|                                                                       |
|                 \"reportYear\": \"2021\",                             |
|                                                                       |
|                 \"numberCorrection\": 0,                              |
|                                                                       |
|                 \"orgInfo\": {                                        |
|                                                                       |
|                     \"individualInfo\": {                             |
|                                                                       |
|                         \"inn\": \"772880774363\",                    |
|                                                                       |
|                         \"individualName\": {                         |
|                                                                       |
|                             \"firstName\": \"ВЛАДИМИР\",              |
|                                                                       |
|                             \"lastName\": \"ЛАДЫГИН\",                |
|                                                                       |
|                             \"middleName\": \"ВИКТОРОВИЧ\"            |
|                                                                       |
|                         }                                             |
|                                                                       |
|                     }                                                 |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"taxInfo\": {                                        |
|                                                                       |
|                     \"income\": \"11165054\",                         |
|                                                                       |
|                     \"expense\": \"0\",                               |
|                                                                       |
|                     \"tax\": \"669903\",                              |
|                                                                       |
|                     \"taxMin\": \"0\"                                 |
|                                                                       |
|                 }                                                     |
|                                                                       |
|             }                                                         |
|                                                                       |
|         \],                                                           |
|                                                                       |
|         \"relevance\": \"ACTUAL\",                                    |
|                                                                       |
|         \"status\": \"VERIFIED_BY_REQUEST\",                          |
|                                                                       |
|         \"version\": 57,                                              |
|                                                                       |
|         \"createdOn\": \"2022-06-16T10:51:21.635\",                   |
|                                                                       |
|         \"updatedOn\": \"2022-06-24T16:21:11.931\",                   |
|                                                                       |
|         \"verifiedOn\": \"2022-06-24\",                               |
|                                                                       |
|         \"attachments\": \[                                           |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5648/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045648\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\", |
|                                                                       |
|                     \"mimeType\": \"PDF\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"signLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/4045648                 |
| /SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045648\",                        |
|                                                                       |
|                     \"objectTypeId\": \"41\",                         |
|                                                                       |
|                     \"mnemonic\"                                      |
| : \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\", |
|                                                                       |
|                     \"mimeType\": \"PKCS7\"                           |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": false                                       |
|                                                                       |
|             },                                                        |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5648/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045648\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                     \"mimeType\": \"XML\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": true                                        |
|                                                                       |
|             },                                                        |
|                                                                       |
|             {                                                         |
|                                                                       |
|                 \"fileLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/404                     |
| 5648/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045648\",                        |
|                                                                       |
|                     \"objectTypeId\": \"40\",                         |
|                                                                       |
|                     \"mnemon                                          |
| ic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                     \"mimeType\": \"XML\"                             |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"signLink\": {                                       |
|                                                                       |
|                     \"originLink\": \"s3://00/4045648                 |
| /SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\", |
|                                                                       |
|                     \"location\": \"00\",                             |
|                                                                       |
|                     \"objectId\": \"4045648\",                        |
|                                                                       |
|                     \"objectTypeId\": \"41\",                         |
|                                                                       |
|                     \"mnemonic\"                                      |
| : \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\", |
|                                                                       |
|                     \"mimeType\": \"PKCS7\"                           |
|                                                                       |
|                 },                                                    |
|                                                                       |
|                 \"main\": false                                       |
|                                                                       |
|             }                                                         |
|                                                                       |
|         \],                                                           |
|                                                                       |
|         \"year\": \"2019\",                                           |
|                                                                       |
|         \"mainAttachment\": {                                         |
|                                                                       |
|             \"fileLink\": {                                           |
|                                                                       |
|                 \"originLink\": \"s3://00/404                         |
| 5648/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\", |
|                                                                       |
|                 \"location\": \"00\",                                 |
|                                                                       |
|                 \"objectId\": \"4045648\",                            |
|                                                                       |
|                 \"objectTypeId\": \"40\",                             |
|                                                                       |
|                 \"mnemon                                              |
| ic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\", |
|                                                                       |
|                 \"mimeType\": \"XML\"                                 |
|                                                                       |
|             },                                                        |
|                                                                       |
|             \"main\": true                                            |
|                                                                       |
|         }                                                             |
|                                                                       |
|     }                                                                 |
|                                                                       |
| \]                                                                    |
+=======================================================================+
+-----------------------------------------------------------------------+

Параметры ответа в формате JSON:

-   orgOid -- идентификатор oid Организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   relevance -- релевантность документа, возможные значения:

    -   actual -- данные документа релевантные (актуальный);

    -   expired -- срок релевантности данных истек (истекший);

    -   invalid -- данные некорректные (ошибочный);

-   status -- статус достоверности данных, возможные значения:

    -   verified_by_validate -- сведения, введенные пользователем и
        проверенные\
        в ИС поставщика данных;

    -   verified_by_request -- сведения, полученные из ИС поставщика
        данных по запросу (в данном случае -- система Цифрового профиля
        является инициатором запроса на получение сведений из ИС
        поставщика данных\
        по определенному идентификатору);

    -   verified_by_push -- сведения, полученные из ИС поставщика
        данных\
        в режиме «push» (в данном случае -- система ИС поставщика данных
        является инициатором отправки информации об изменении сведений);

    -   unverified -- сведения, проверка по которым в ИС поставщика
        данных\
        не осуществляется или завершилась ошибкой;

    -   no_data -- сведения отсутствуют в ведомстве (в ответе от ФНС
        России пришел отказ; нет данных в ФНС России, и вложения в
        ответе не пришли);

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   year -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   data -- вложения ответа в формате JSON;

-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   period -- налоговый (отчетный) период;

-   reportYear -- отчетный год. Год, за который запрашивается выписка\
    из декларации;

-   numberСorrection -- номер корректировки для корректирующего
    документа (декларации);

-   orgInfo -- налогоплательщик;

-   legalInfo -- налогоплательщик -- юридическое лицо;

-   name -- наименование организации;

-   inn -- ИНН организации;

-   kpp -- КПП организации;

-   individualInfo -- налогоплательщик -- физическое лицо (при наличии);

-   inn -- ИНН физического лица;

-   individualName -- фамилия, имя, отчество:

-   lastName -- фамилия;

-   firstName -- имя;

-   middleName -- отчество;

-   reorganizationInfo -- сведения о реорганизованной (ликвидированной)
    организации;

-   reorganizationForm -- код формы реорганизации (ликвидации).
    Принимает значения:

    -   0 -- ликвидация;

    -   1 -- преобразование;

    -   2 -- слияние;

    -   3 -- разделение;

    -   5 -- присоединение;

    -   6 -- разделение с одновременным присоединением;

-   reorganizationInn -- ИНН реорганизованной организации. Элемент
    обязателен при \<ФормРеорг\> = 1 \| 2 \| 3 \| 5 \| 6;

-   reorganizationKpp -- КПП реорганизованной организации (обособленного
    подразделения);

-   income -- сумма полученных доходов за налоговый период;

-   expense -- сумма произведенных расходов. Указывается только\
    для налогоплательщиков, применяющих объект налогообложения «доходы,
    уменьшенные на величину расходов»;

-   tax -- сумма исчисленного налога (авансового платежа по налогу);

-   taxMin -- сумма исчисленного минимального налога за налоговый период
    (ставка налога 1%);

-   mainAttachment -- главный файл вложения -- файл описи;

-   attachments -- файлы вложений в описи ФНС России (файлы: xml,
    подпись, pdf, подпись, сам файл описи). Если вложения не пришли от
    ФНС России, то поля пустые;

-   fileLink -- блок информации о файле;

-   signLink -- блок информации о подписи;

-   location -- локация файла;

-   mimeType -- тип файла. Может принимать значения:

    -   \"PDF\" (файл);

    -   \"PKCS7\" (подпись);

    -   \"XML\" (файл);

    -   \"PKCS7\" (подпись);

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значения:

    -   40 -- если файл вложения имеет формат .xml и .pdf, либо это файл
        описи .xml;

    -   41 -- если это файл вложения подписи в формате P7C;

-   Mnemonic -- мнемоника файлов-вложений ответа от ФНС России\
    со сведениями выписки из декларации по УСН. Из ФНС России приходит 5
    файлов:

    -   файл -- SVND_USN_GGGGMMDD_GUID.XML;

    -   подпись -- SVND_USN_GGGGMMDD_GUID_XML.p7s;

    -   файл -- SVND_USN_GGGGMMDD_GUID.PDF;

    -   подпись -- SVND_USN GGGGMMDD_GUID PDF.p7s;

    -   опись файлов -- OPIS_USN_GGGGMMDD_GUID.XML;

-   main -- признак главного файла описи. Может принимать значения:

    -   false;

    -   true;

-   vrs -- блок сведений при технических ошибках;

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки. Может принимать значения:

    -   verification_failed -- произошла техническая ошибка;

    -   verifying -- отправлен запрос в ФНС России, и ответ пока не
        вернулся.

Возможные коды ошибок приведены в таблице 26.

Таблица 26 -- Возможные коды ошибок

  ---------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- ---------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  ---------------------------------------------------------------------------

#### Получение сведения из налоговой декларации по налогу, уплачиваемому в связи с применением УСН по идентификатору документа

Для получения сведения из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/usn/{id},

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   usn -- название сведения;

-   id -- идентификатор записи документа (уникальный).

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope):

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_usn?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/usn/5907674d-d2ec-4c28-a75b-1f05f541ea38

Пример ответа: Code: 200 OK

{

    \"id\": \"5907674d-d2ec-4c28-a75b-1f05f541ea38\",

    \"orgOid\": 1077404126,

    \"data\": \[

        {

            \"docId\": \"6e82a7dc2c2a4eee8929a83a13581308\",

            \"period\": \"34\",

            \"reportYear\": \"2021\",

            \"numberCorrection\": 0,

            \"orgInfo\": {

                \"individualInfo\": {

                    \"inn\": \"772880774363\",

                    \"individualName\": {

                        \"firstName\": \"ВЛАДИМИР\",

                        \"lastName\": \"ЛАДЫГИН\",

                        \"middleName\": \"ВИКТОРОВИЧ\"

                    }

                }

            },

            \"taxInfo\": {

                \"income\": \"11165054\",

                \"expense\": \"0\",

                \"tax\": \"669903\",

                \"taxMin\": \"0\"

            }

        }

    \],

    \"relevance\": \"ACTUAL\",

    \"status\": \"VERIFIED_BY_REQUEST\",

    \"version\": 52,

    \"createdOn\": \"2022-06-16T10:51:21.766\",

    \"updatedOn\": \"2022-06-24T16:21:10.801\",

    \"verifiedOn\": \"2022-06-24\",

    \"attachments\": \[

        {

            \"fileLink\": {

                \"originLink\": \"s3://00/4045650/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf/40\",

                \"location\": \"00\",

                \"objectId\": \"4045650\",

                \"objectTypeId\": \"40\",

                \"mnemonic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\",

                \"mimeType\": \"PDF\"

            },

            \"signLink\": {

                \"originLink\": \"s3://00/4045650/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\",

                \"location\": \"00\",

                \"objectId\": \"4045650\",

                \"objectTypeId\": \"41\",

                \"mnemonic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\",

                \"mimeType\": \"PKCS7\"

            },

            \"main\": false

        },

        {

            \"fileLink\": {

                \"originLink\": \"s3://00/4045650/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

                \"location\": \"00\",

                \"objectId\": \"4045650\",

                \"objectTypeId\": \"40\",

                \"mnemonic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

                \"mimeType\": \"XML\"

            },

            \"main\": true

        },

        {

            \"fileLink\": {

                \"originLink\": \"s3://00/4045650/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

                \"location\": \"00\",

                \"objectId\": \"4045650\",

                \"objectTypeId\": \"40\",

                \"mnemonic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

                \"mimeType\": \"XML\"

            },

            \"signLink\": {

                \"originLink\": \"s3://00/4045650/SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\",

                \"location\": \"00\",

                \"objectId\": \"4045650\",

                \"objectTypeId\": \"41\",

                \"mnemonic\": \"SVND_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\",

                \"mimeType\": \"PKCS7\"

            },

            \"main\": false

        }

    \],

    \"year\": \"2021\",

    \"mainAttachment\": {

        \"fileLink\": {

            \"originLink\": \"s3://00/4045650/OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

            \"location\": \"00\",

            \"objectId\": \"4045650\",

            \"objectTypeId\": \"40\",

            \"mnemonic\": \"OPIS_USN_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

            \"mimeType\": \"XML\"

        },

        \"main\": true

    }

}

Параметры ответа в формате JSON:

-   orgOid -- идентификатор oid Организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   relevance -- релевантность документа, возможные значения:

    -   actual -- данные документа релевантные (актуальный);

    -   expired -- срок релевантности данных истек (истекший);

    -   invalid -- данные некорректные (ошибочный);

-   status -- статус достоверности данных, возможные значения:

    -   verified_by_validate -- сведения, введенные пользователем и
        проверенные\
        в ИС поставщика данных;

    -   verified_by_request -- сведения, полученные из ИС поставщика
        данных по запросу (в данном случае -- система Цифрового профиля
        является инициатором запроса на получение сведений из ИС
        поставщика данных\
        по определенному идентификатору);

    -   verified_by_push -- сведения, полученные из ИС поставщика
        данных\
        в режиме «push» (в данном случае -- система ИС поставщика данных
        является инициатором отправки информации об изменении сведений);

    -   unverified -- сведения, проверка по которым в ИС поставщика
        данных\
        не осуществляется или завершилась ошибкой;

-   no_data -- сведения отсутствуют в ведомстве (ответе от ФНС России
    пришел отказ; в ФНС России нет данных, и вложения в ответе не
    пришли);

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   year -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   data -- вложения ответа в формате JSON;

-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   period -- налоговый (отчетный) период;

-   reportYear -- отчетный год. Год, за который запрашивается выписка\
    из декларации;

-   numberСorrection -- номер корректировки для корректирующего
    документа (декларации);

-   orgInfo -- налогоплательщик;

-   legalInfo -- налогоплательщик -- юридическое лицо;

-   name -- наименование организации;

-   inn -- ИНН организации;

-   kpp -- КПП организации;

-   individualInfo -- налогоплательщик -- физическое лицо (при наличии);

-   inn -- ИНН физического лица;

    -   individualName -- фамилия, имя, отчество:

    -   lastName -- фамилия;

    -   firstName -- имя;

    -   middleName -- отчество;

-   reorganizationInfo -- сведения о реорганизованной (ликвидированной)
    организации;

-   reorganizationForm -- код формы реорганизации (ликвидации).
    Принимает значения:

    -   0 -- ликвидация;

    -   1 -- преобразование;

    -   2 -- слияние;

    -   3 -- разделение;

    -   4 -- присоединение;

    -   5 -- разделение с одновременным присоединением;

-   reorganizationInn -- ИНН реорганизованной организации. Элемент
    обязателен при \<ФормРеорг\> = 1 \| 2 \| 3 \| 5 \| 6;

-   reorganizationKpp -- КПП реорганизованной организации (обособленного
    подразделения);

-   income -- Сумма полученных доходов за налоговый период;

-   expense -- Сумма произведенных расходов. Указывается только\
    для налогоплательщиков, применяющих объект налогообложения «доходы,
    уменьшенные на величину расходов»;

-   tax -- Сумма исчисленного налога (авансового платежа по налогу);

-   taxMin -- Сумма исчисленного минимального налога за налоговый период
    (ставка налога 1%);

-   mainAttachment -- главный файл вложения -- файл описи;

-   attachments -- файлы вложений в описи ФНС России (файлы: xml,
    подпись, pdf, подпись, сам файл описи). Если вложения не пришли от
    ФНС России, то поля пустые;

-   fileLink -- блок информации о файле;

-   signLink -- блок информации о подписи;

-   location -- локация файла;

-   mimeType -- тип файла. Может принимать значения:

    -   \"PDF\" (файл);

    -   \"PKCS7\" (подпись);

    -   \"XML\" (файл);

    -   \"PKCS7\" (подпись);

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значения:

    -   40 -- если файл вложения имеет формат .xml и .pdf, либо это файл
        описи .xml;

    -   41 -- если это файл вложения подписи в формате P7C;

-   Mnemonic -- мнемоника файлов--вложений ответа от ФНС России\
    со сведениями выписки из декларации по УСН. Из ФНС России приходит 5
    файлов:

    -   файл -- SVND_USN_GGGGMMDD_GUID.XML;

    -   подпись -- SVND_USN_GGGGMMDD_GUID_XML.p7s;

    -   файл -- SVND_USN_GGGGMMDD_GUID.PDF;

    -   подпись -- SVND_USN GGGGMMDD_GUID PDF.p7s;

    -   опись файлов -- OPIS_USN_GGGGMMDD_GUID.XML;

-   main -- признак главного файла описи. Может принимать значения:

    -   false;

    -   true;

-   vrs -- блок сведений при технических ошибках;

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки. Может принимать значения:

    -   verification_failed -- произошла техническая ошибка;

    -   verifying -- отправлен запрос в ФНС России, и ответ пока не
        вернулся.

Возможные коды ошибок приведены в таблице 27.

Таблица 27 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Проверка запуска обновления сведений из налоговой декларации по налогу, уплачиваемому в связи с применением УСН

Для получения сведения из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/usn/check,

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   usn -- название сведения;

-   сheck -- проверка запущенности обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_usn?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digitalorg/api/public/v1/org/1077404126/doc/usn/check

Пример ответа (не запущено обновление сведений ФНС России): Code: 404 --
Not Found.

Пример ответа (уже было запущено обновление сведений в ФНС России):
Code: 200 ОК

{

\"requestIds\": \[

4061295,

4061294,

4061296

\],

\"orgOid\": 1077404126,

\"expiresOn\": \"2022-07-28T18:09:25.667+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 28.

Таблица 28 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений из налоговой декларации по налогу, уплачиваемому в связи с применением УСН

Для получения сведения из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/usn/refresh,

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   usn -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/usn/refresh

Пример ответа: Code: 200 ОК

{

    \"requestIds\": \[

        4045649,

        4045648,

        4045650

    \],

    \"orgOid\": 1077404126,

    \"expiresOn\": \"2022-07-24T13:21:05.818+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 29.

Таблица 29 -- Возможные коды ошибок

  ---------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- ---------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  ---------------------------------------------------------------------------

#### Запуск обновления сведений из налоговой декларации по налогу, уплачиваемому в связи с применением УСН по идентификатору организации и году документа

Для получения сведений по идентификатору организации или по году
документа из налоговых деклараций, представленных ИП, применяющими
специальные налоговые режимы, система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST.

Path: /api/public/{version}/org/{org_oid}/doc/usn/refresh/{year},

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   usn -- название сведения;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\"

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/usn/refresh/2020

Пример ответа: Code: 200 ОК

{

\"expiresOn\": \"2023-03-06T15:42:59.870Z\",

\"orgOid\": 0,

\"requestId\": 0,

\"year\": {

\"leap\": true,

\"value\": 0

}

}

Возможные коды ошибок приведены в таблице 30.

Таблица 30 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   400 { \"code\":        | Отсутствует согласие Минцифры  |
| \"ESIA-036718\",                    | России                         |
|                                     |                                |
| \"message\": \"Необходимо           |                                |
| предварительно выдать согласие      |                                |
| Министерству цифрового развития,    |                                |
| связи и массовых коммуникаций       |                                |
| Российской Федерации\"}             |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+

#### Отмена запроса на обновление сведений по идентификатору организации и году документа из налоговой декларации по налогу, уплачиваемому в связи с применением УСН

Для отмены запроса на обновление сведений по идентификатору организации
и году документа из налоговой декларации по налогу, уплачиваемому в
связи с применением УСН, система-клиент должна направить в https-адрес
REST API системы ЕСИА запрос методом POST.

Path: /api/public/{version}/org/{org_oid}/doc/usn/refresh/{year}/cancel,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о сумме фактически уплаченных
    юридическим лицом налогов;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

> Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077494367/doc/usn/refresh/2021/cancel

Пример успешного ответа: Code: 200 ОК

Возможные коды ошибок приведены в таблице 31.

Таблица 31 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   404 {\"code\": \"      | Документ не найден             |
| ESIA-020203\", \"message\": \" Not  |                                |
| Found\"}                            |                                |
+-------------------------------------+--------------------------------+

#### Получение сведений из налоговой декларации по НДС

Для получения сведений из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/nds,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   nds -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_usn?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/nds

Пример ответа: Code: 200 OK

\[

{

\"attachments\": \[

{

\"fileLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

},

\"main\": true,

\"signLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

}

}

\],

\"createdOn\": \"2022-06-02T17:39:32.869Z\",

\"data\": \[

{

\"docDate\": \"string\",

\"docId\": \"string\",

\"numberCorrection\": 0,

\"orgInfo\": {

\"individualInfo\": {

\"individualName\": {

\"firstName\": \"string\",

\"lastName\": \"string\",

\"middleName\": \"string\"

},

\"inn\": \"string\"

},

\"legalInfo\": {

\"inn\": \"string\",

\"kpp\": \"string\",

\"name\": \"string\",

\"reorganizationInfo\": {

\"reorganizationForm\": \"string\",

\"reorganizationInn\": \"string\",

\"reorganizationKpp\": \"string\"

}

}

},

\"period\": \"string\",

\"reportYear\": {

\"leap\": true,

\"value\": 0

},

\"taxInfo\": {

\"expense\": \"string\",

\"income\": \"string\",

\"tax\": \"string\",

\"taxMin\": \"string\"

}

}

\],

\"department\": \"string\",

\"id\": \"string\",

\"mainAttachment\": {

\"fileLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

},

\"main\": true,

\"signLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

}

},

\"orgOid\": 0,

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_VALIDATE\",

\"updatedOn\": \"2022-06-02T17:39:32.869Z\",

\"verifiedOn\": \"string\",

\"version\": 0,

\"year\": {

\"leap\": true,

\"value\": 0

}

}

\]

Параметры ответа в формате JSON:

-   orgOid -- идентификатор oid Организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   relevance -- релевантность документа, возможные значения:

    -   actual -- данные документа релевантные (актуальный);

    -   expired -- срок релевантности данных истек (истекший);

    -   invalid -- данные некорректные (ошибочный);

-   status -- статус достоверности данных, возможные значения:

    -   verified_by_validate -- сведения, введенные пользователем и
        проверенные\
        в ИС поставщика данных;

    -   verified_by_request -- сведения, полученные из ИС поставщика
        данных\
        по запросу (в данном случае -- система Цифрового профиля
        является инициатором запроса на получение сведений из ИС
        поставщика данных\
        по определенному идентификатору);

    -   verified_by_push -- сведения, полученные из ИС поставщика
        данных\
        в режиме «push» (в данном случае -- система ИС поставщика данных
        является инициатором отправки информации об изменении сведений);

    -   unverified -- сведения, проверка по которым в ИС поставщика
        данных\
        не осуществляется или завершилась ошибкой;

    -   no_data -- сведения отсутствуют в ведомстве (в ответе от ФНС
        России пришел отказ; в ФНС России нет данных, и вложения в
        ответе не пришли);

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   year -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   data -- вложения ответа в формате JSON;

-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   period -- налоговый (отчетный) период;

-   reportYear -- отчетный год. Год, за который запрашивается выписка\
    из декларации;

-   numberСorrection -- номер корректировки для корректирующего
    документа (декларации);

-   orgInfo -- налогоплательщик;

-   legalInfo -- налогоплательщик -- юридическое лицо;

-   name -- наименование организации;

-   inn -- ИНН организации;

-   kpp -- КПП организации;

-   individualInfo -- налогоплательщик -- физическое лицо (при наличии);

-   inn -- ИНН физического лица;

-   individualName -- фамилия, имя, отчество:

-   lastName -- фамилия;

-   firstName -- имя;

-   middleName -- отчество;

-   reorganizationInfo -- сведения о реорганизованной (ликвидированной)
    организации;

-   reorganizationForm -- код формы реорганизации (ликвидации).
    Принимает значения:

    -   0 -- ликвидация;

    -   1 -- преобразование;

    -   2 -- слияние;

    -   3 -- разделение;

    -   5 -- присоединение;

    -   6 -- разделение с одновременным присоединением;

-   reorganizationInn -- ИНН реорганизованной организации. Элемент
    обязателен при \<ФормРеорг\> = 1 \| 2 \| 3 \| 5 \| 6;

-   reorganizationKpp -- КПП реорганизованной организации (обособленного
    подразделения);

-   income -- сумма полученных доходов за налоговый период;

-   expense -- сумма произведенных расходов. Указывается только\
    для налогоплательщиков, применяющих объект налогообложения «доходы,
    уменьшенные на величину расходов»;

-   tax -- сумма исчисленного налога (авансового платежа по налогу);

-   taxMin -- сумма исчисленного минимального налога за налоговый период
    (ставка налога 1%);

-   mainAttachment -- главный файл вложения -- файл описи;

-   attachments -- файлы вложений в описи ФНС России (файлы: xml,
    подпись, pdf, подпись, сам файл описи). Если вложения не пришли от
    ФНС России, то поля пустые;

-   fileLink -- блок информации о файле;

-   signLink -- блок информации о подписи;

-   location -- локация файла;

-   mimeType -- тип файла. Может принимать значения:

    -   \"PDF\" (файл);

    -   \"PKCS7\" (подпись);

    -   \"XML\" (файл);

    -   \"PKCS7\" (подпись);

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значения:

    -   40 -- если файл вложения имеет формат .xml и .pdf, либо это файл
        описи .xml;

    -   41 -- если это файл вложения подписи в формате P7C;

-   Mnemonic -- мнемоника файлов--вложений ответа от ФНС России\
    со сведениями выписки из декларации по УСН. Из ФНС России приходит 5
    файлов:

    -   файл -- SVND_NDS_GGGGMMDD_GUID.XML;

    -   подпись -- SVND_NDS_GGGGMMDD_GUID_XML.p7s;

    -   файл -- SVND_NDS_GGGGMMDD_GUID.PDF;

    -   подпись -- SVND_NDS_GGGGMMDD_GUID PDF.p7s;

    -   опись файлов -- OPIS_NDS_GGGGMMDD_GUID.XML;

-   main -- признак главного файла описи. Может принимать значения:

    -   false;

    -   true;

-   vrs -- блок сведений при технических ошибках;

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки. Может принимать значения:

    -   verification_failed -- произошла техническая ошибка;

    -   verifying -- отправлен запрос в ФНС России, и ответ пока не
        вернулся.

Возможные коды ошибок приведены в таблице 32.

Таблица 32 -- Возможные коды ошибок

  ---------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- ---------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  ---------------------------------------------------------------------------

#### Получение сведения из налоговой декларации по налогу, уплачиваемому в связи с применением НДС по идентификатору документа

Для получения сведения из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/nds/{id},

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   usn -- название сведения;

-   id -- идентификатор записи документа (уникальный).

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_usn?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/nds/5907674d-d2ec-4c28-a75b-1f05f541ea38

Пример ответа: Code: 200 OK

{

\"attachments\": \[

{

\"fileLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

},

\"main\": true,

\"signLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

}

}

\],

\"createdOn\": \"2022-06-02T17:54:32.601Z\",

\"data\": \[

{

\"docDate\": \"string\",

\"docId\": \"string\",

\"numberCorrection\": 0,

\"orgInfo\": {

\"individualInfo\": {

\"individualName\": {

\"firstName\": \"string\",

\"lastName\": \"string\",

\"middleName\": \"string\"

},

\"inn\": \"string\"

},

\"legalInfo\": {

\"inn\": \"string\",

\"kpp\": \"string\",

\"name\": \"string\",

\"reorganizationInfo\": {

\"reorganizationForm\": \"string\",

\"reorganizationInn\": \"string\",

\"reorganizationKpp\": \"string\"

}

}

},

\"period\": \"string\",

\"reportYear\": {

\"leap\": true,

\"value\": 0

},

\"taxInfo\": {

\"expense\": \"string\",

\"income\": \"string\",

\"tax\": \"string\",

\"taxMin\": \"string\"

}

}

\],

\"department\": \"string\",

\"id\": \"string\",

\"mainAttachment\": {

\"fileLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

},

\"main\": true,

\"signLink\": {

\"location\": \"string\",

\"mimeType\": \"XML\",

\"mnemonic\": \"string\",

\"objectId\": \"string\",

\"objectTypeId\": \"string\",

\"originLink\": \"string\"

}

},

\"orgOid\": 0,

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_VALIDATE\",

\"updatedOn\": \"2022-06-02T17:54:32.602Z\",

\"verifiedOn\": \"string\",

\"version\": 0,

\"year\": {

\"leap\": true,

\"value\": 0

}

}

Параметры ответа в формате JSON:

-   orgOid -- идентификатор oid Организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   relevance -- релевантность документа, возможные значения:

    -   actual -- данные документа релевантные (актуальный);

    -   expired -- срок релевантности данных истек (истекший);

    -   invalid -- данные некорректные (ошибочный);

-   status -- статус достоверности данных, возможные значения:

    -   verified_by_validate -- сведения, введенные пользователем и
        проверенные в ИС поставщика данных;

    -   verified_by_request -- сведения, полученные из ИС поставщика
        данных по запросу (в данном случае -- система Цифрового профиля
        является инициатором запроса на получение сведений из ИС
        поставщика данных по определенному идентификатору);

    -   verified_by_push -- сведения, полученные из ИС поставщика данных
        в режиме «push» (в данном случае -- система ИС поставщика данных
        является инициатором отправки информации об изменении сведений);

    -   unverified -- сведения, проверка по которым в ИС поставщика
        данных не осуществляется или завершилась ошибкой;

-   no_data -- сведения отсутствуют в ведомстве (ответе от ФНС России
    пришел отказ; в ФНС России нет данных, и вложения в ответе не
    пришли);

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   year -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   data -- вложения ответа в формате JSON;

-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   period -- налоговый (отчетный) период;

-   reportYear -- отчетный год. Год, за который запрашивается выписка\
    из декларации;

-   numberСorrection -- номер корректировки для корректирующего
    документа (декларации);

-   orgInfo -- налогоплательщик;

-   legalInfo -- налогоплательщик -- юридическое лицо;

-   name -- наименование организации;

-   inn -- ИНН организации;

-   kpp -- КПП организации;

-   individualInfo -- налогоплательщик -- физическое лицо (при наличии);

-   inn -- ИНН физического лица;

-   individualName -- фамилия, имя, отчество:

-   lastName -- фамилия;

-   firstName -- имя;

-   middleName -- отчество;

-   reorganizationInfo -- сведения о реорганизованной (ликвидированной)
    организации;

-   reorganizationForm -- код формы реорганизации (ликвидации).
    Принимает значения:

    -   0 -- ликвидация;

    -   1 -- преобразование;

    -   2 -- слияние;

    -   3 -- разделение;

    -   4 -- присоединение;

    -   5 -- разделение с одновременным присоединением;

-   reorganizationInn -- ИНН реорганизованной организации. Элемент
    обязателен при \<ФормРеорг\> = 1 \| 2 \| 3 \| 5 \| 6;

-   reorganizationKpp -- КПП реорганизованной организации (обособленного
    подразделения);

-   income -- Сумма полученных доходов за налоговый период;

-   expense -- Сумма произведенных расходов. Указывается только\
    для налогоплательщиков, применяющих объект налогообложения «доходы,
    уменьшенные на величину расходов»;

-   tax -- Сумма исчисленного налога (авансового платежа по налогу);

-   taxMin -- Сумма исчисленного минимального налога за налоговый период
    (ставка налога 1%);

-   mainAttachment -- главный файл вложения -- файл описи;

-   attachments -- файлы вложений в описи ФНС России (файлы: xml,
    подпись, pdf, подпись, сам файл описи). Если вложения не пришли от
    ФНС России, то поля пустые;

-   fileLink -- блок информации о файле;

-   signLink -- блок информации о подписи;

-   location -- локация файла;

-   mimeType -- тип файла. Может принимать значения:

    -   \"PDF\" (файл);

    -   \"PKCS7\" (подпись);

    -   \"XML\" (файл);

    -   \"PKCS7\" (подпись);

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значения:

    -   40 -- если файл вложения имеет формат .xml и .pdf, либо это файл
        описи .xml;

    -   41 -- если это файл вложения подписи в формате P7C;

-   Mnemonic -- мнемоника файлов--вложений ответа от ФНС России\
    со сведениями выписки из декларации по УСН. Из ФНС России приходит 5
    файлов:

    -   файл -- SVND_NDS_GGGGMMDD_GUID.XML;

    -   подпись -- SVND_NDS_GGGGMMDD_GUID_XML.p7s;

    -   файл -- SVND_NDS_GGGGMMDD_GUID.PDF;

    -   подпись -- SVND_NDS_GGGGMMDD_GUID PDF.p7s;

    -   опись файлов -- OPIS_NDS_GGGGMMDD_GUID.XML;

-   main -- признак главного файла описи. Может принимать значения:

    -   false;

    -   true;

-   vrs -- блок сведений при технических ошибках;

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки. Может принимать значения:

    -   verification_failed -- произошла техническая ошибка;

    -   verifying -- отправлен запрос в ФНС России, и ответ пока не
        вернулся.

Возможные коды ошибок приведены в таблице 33.

Таблица 33 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Проверка запуска обновления сведений из налоговой декларации по налогу, уплачиваемому в связи с применением НДС

Для получения сведения из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/nds/check,

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   usn -- название сведения;

-   сheck -- проверка запущенности обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_usn?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/nds/check

Пример ответа (не запущено обновление сведений ФНС России): Code: 404 --
Not Found.

Пример ответа (уже было запущено обновление сведений в ФНС России):
Code: 200 ОК

{

\"requestIds\": \[

4061295,

4061294,

4061296

\],

\"orgOid\": 1077404126,

\"expiresOn\": \"2022-07-28T18:09:25.667+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 34.

Таблица 34 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений из налоговой декларации по налогу, уплачиваемому в связи с применением НДС

Для получения сведения из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/nds/refresh,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   nds -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/nds/refresh

Пример ответа: Code: 200 ОК

{

    \"requestIds\": \[

        4045649,

        4045648,

        4045650

    \],

    \"orgOid\": 1077404126,

    \"expiresOn\": \"2022-07-24T13:21:05.818+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 35.

Таблица 35 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений из налоговой декларации по налогу, уплачиваемому в связи с применением НДС по идентификатору организации и году документа

Для получения сведений по идентификатору организации или по году
документа из налоговых деклараций, представленных ИП, применяющими
специальные налоговые режимы, система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST.

Path: /api/public/{version}/org/{org_oid}/doc/nds/refresh/{year},

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   nds -- название сведения;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/nds/refresh/2020

Пример ответа: Code: 200 ОК

{

\"expiresOn\": \"2023-03-06T15:42:59.870Z\",

\"orgOid\": 0,

\"requestId\": 0,

\"year\": {

\"leap\": true,

\"value\": 0

}

}

Возможные коды ошибок приведены в таблице 36.

Таблица 36 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   400 { \"code\":        | Отсутствует согласие Минцифры  |
| \"ESIA-036718\",                    | России                         |
|                                     |                                |
| \"message\": \"Необходимо           |                                |
| предварительно выдать согласие      |                                |
| Министерству цифрового развития,    |                                |
| связи и массовых коммуникаций       |                                |
| Российской Федерации\"}             |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+

#### Отмена запроса на обновление сведений по идентификатору организации и году документа из налоговой декларации по налогу, уплачиваемому в связи с применением НДС

Для отмены запроса на обновление сведений по идентификатору организации
и году документа из налоговой декларации по налогу, уплачиваемому в
связи с применением НДС, система-клиент должна направить в https-адрес
REST API системы ЕСИА запрос методом POST.

Path: /api/public/{version}/org/{org_oid}/doc/nds/refresh/{year}/cancel,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о сумме фактически уплаченных
    юридическим лицом налогов;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

> Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077494367/doc/nds/refresh/2021/cancel

Пример успешного ответа: Code: 200 ОК

Возможные коды ошибок приведены в таблице 37.

Таблица 37 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   404 {\"code\": \"      | Документ не найден             |
| ESIA-020203\", \"message\": \" Not  |                                |
| Found\"}                            |                                |
+-------------------------------------+--------------------------------+

#### Сведения из налоговой декларации по налогу на прибыль организации

Для получения в ЕСИА сведений из налоговой декларации по налогу на
прибыль организации из ФНС России с помощью ВС «Предоставление сведений
из налоговой декларации по налогу на прибыль организаций»:

<https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/6377e31e-ff80-11eb-ba23-33408f10c8dc>

разработан сервис REST API ЕСИА.

#### Получение сведений из налоговой декларации по налогу на прибыль организации

Для получения сведений из налоговой декларации по налогу на прибыль
организации система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом GET. В запросе должен быть указан ресурс,
содержащий необходимые данные. Идентификатор этого ресурса в ЕСИА имеет
следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/income-tax,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями из налоговых деклараций по налогу на
    прибыль организации;

-   income-tax -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope): 

-   "org_inf?org_oid={p.org_oid}";

-   "org_ful?org_oid={p.org_oid}";

-   "org_income_tax?org_oid={p.org_oid}";

-   "org_profile?org_oid={p.org_oid}".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077470195/doc/income-tax

Пример ответа: Code: 200 OK

\[

{

\"id\": \"237b6bb2-b4dd-4a95-b6ea-f1142721650c\",

\"orgOid\": 1077470195,

\"data\": \[

{

\"docId\": \"6e82a7dc2c2a4eee8929a83a13581308\",

\"period\": \"34\",

\"reportYear\": \"2021\",

\"numberCorrection\": 0,

\"orgInfo\": {

\"legalInfo\": {

\"inn\": \"5050140162\",

\"kpp\": \"505001001\",

\"name\": \"ООО «Пример»\",

\"ogrn\": \"123145555556\"

}

}

},

\"taxInfo\": {

\"losses\": \"5\",

\"taxBase\": \"6\",

\"incomeReal\": \"1\",

\"incomeInReal\": \"2\",

\"taxCalculated\": \"8\",

\"expendIncomeReal\": \"3\",

\"taxBaseCalculated\": \"7\",

\"expendIncomeInReal\": \"4\",

\"realizePropertyLaw\": \"9\",

\"realizePropertyOther\": \"10\"

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 52,

\"createOn\": \"2022-06-16T10:51:21.066\",

\"updateOn\": \"2022-06-24T16:21:10.001\",

\"verifieOn\": \"2022-06-24\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220704_b747ad64-fb86-11ec-bbd0-ee8c9052e06c.pdf/40\",

\"location\": \"00\",

\"objectId\": \"4045150\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\",

\"mimeType\": \"PDF\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\",

\"location»: \"00\",

\"objectId\": \"4045150\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045150\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045150\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4045150\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

}

\],

\"year\": \"2021\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045150\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

},

{

\"id\": \"adcc8a13-9e53-45d7-9a3e-356bda7551f9\",

\"orgOid\": 1077470195,

\"data\": \[

{

\"docId\": \"6e82a7dc2c2a4eee8929a83a13581108\",

\"period\": \"34\",

\"reportYear": \"2021\",

\"numberCorrection\": 0,

\"orgInfo\": {

\"legalInfo\": {

\"inn\": \"5050140162\",

\"kpp\": \"505001001\",

\"name\": \"ООО «Пример»\",

\"ogrn\": \"123145555556\" }

}

},

\"taxInfo\": {

\"losses\": \"5\",

\"taxBase\": \"6\",

\"incomeReal\": \"1\",

\"incomeInReal\": \"2\",

\"taxCalculated\": \"8\",

\"expendIncomeReal\": \"3\",

\"taxBaseCalculated\": \"7\",

\"expendIncomeInReal\": \"4\",

\"realizePropertyLaw\": \"9\",

\"realizePropertyOther\": \"10\"

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 52,

\"createdOn\": \"2022-06-16T10:51:21.195\",

\"updatedOn\": \"2022-06-24T16:21:12.157\",

\"verifiedOn\": \"2022-06-24\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/4164074/EPGU_PRIB_20220704_b747ad64-fb86-11ec-bbd0-ee8c9052e06c.pdf/40\",

\"location\": \"00\",

\"objectId\": \"4045149\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\",

\"mimeType\": \"PDF\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4164074/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4045149\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4164074/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045149\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4164074/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045149\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4164074/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4045149\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

}

\],

\"year\": \"2020\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/4164074/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045149\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

},

{

\"id\": \"7686bf66-e49c-4261-a72f-2a4f834b6152\",

\"orgOid\": 1077470195,

\"data\": \[

{

\"docId\": \"6e82a7dc2c2a4eee8929a83a13581108\",

\"period\": \"34\",

\"reportYear\": \"2021\",

\"numberCorrection\": 0,

\"orgInfo\": {

\"legalInfo\": {

\"inn\": \"5050140162\",

\"kpp\": \"505001001\",

\"name\": \"ООО «Пример»\",

\"ogrn\": \"123145555556\" }

}

},

\"taxInfo\": {

\"losses\": \"5\",

\"taxBase\": \"6\",

\"incomeReal\": \"1\",

\"incomeInReal\": \"2\",

\"taxCalculated\": \"8\",

\"expendIncomeReal\": \"3\",

\"taxBaseCalculated\": \"7\",

\"expendIncomeInReal\": \"4\",

\"realizePropertyLaw\": \"9\",

\"realizePropertyOther\": \"10\"

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 57,

\"createdOn\": \"2022-06-16T10:51:21.135\",

\"updatedOn\": \"2022-06-24T16:21:11.131\",

\"verifiedOn\": \"2022-06-24\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045648/EPGU_PRIB_20220704_b747ad64-fb86-11ec-bbd0-ee8c9052e06c.pdf/40\",

\"location\": \"00\",

\"objectId\": \"4045148\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\",

\"mimeType\": \"PDF\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4045648/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4045148\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045648/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045148\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045648/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045148\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4045648/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4045148\",

\"objectTypeId\": \"41\",

\"mnemoiic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

}

\],

\"year\": \"2019\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/4045648/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045148\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

\]

Параметры ответа в формате JSON:

-   orgOid -- идентификатор (oid) Организации;

-   id -- идентификатор записи документа (уникальный);

-   relevance -- релевантность документа, возможные значения:

    -   actual -- данные документа релевантные (актуальный);

    -   expired -- срок релевантности данных истек (истекший);

    -   invalid -- данные некорректные (ошибочный);

-   status -- статус достоверности данных, возможные значения:

    -   verified_by_validate -- сведения, введенные пользователем и
        проверенные\
        в ИС поставщика данных;

    -   verified_by_request -- сведения, полученных из ИС поставщика
        данных\
        по запросу (в данном случае -- система Цифрового профиля
        является инициатором запроса на получение сведений из ИС
        поставщика данных\
        по определенному идентификатору);

    -   verified_by_push -- сведения, полученные из ИС поставщика
        данных\
        в режиме «push» (в данном случае -- система ИС поставщика данных
        является инициатором отправки информации об изменении сведений);

    -   unverified -- сведения, проверка по которым в ИС поставщика
        данных\
        не осуществляется или завершилась ошибкой;

    -   no_data -- сведения отсутствуют в ведомстве (ответе от ФНС
        России пришел отказ; в ФНС России нет данных, и вложения в
        ответе не пришли);

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   year -- отчетный год. Год, за который запрашиваются сведения из
    декларации;

-   data -- вложения ответа в формате JSON;

-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   period -- налоговый (отчетный) период;

-   reportYear -- отчетный год. Год, за который запрашиваются сведения\
    из декларации;

-   numberСorrection -- номер корректировки для корректирующего
    документа (декларации);

-   orgInfo -- налогоплательщик:

    -   legalInfo -- налогоплательщик -- юридическое лицо:

        -   name -- наименование организации;

        -   inn -- ИНН организации;

        -   kpp -- КПП организации;

-   reorganizationInfo -- сведения о реорганизованной (ликвидированной)
    организации;

-   reorganizationForm -- код формы реорганизации (ликвидации).
    Принимает значения:

    -   0 -- ликвидация;

    -   1 -- преобразование;

    -   2 -- слияние;

    -   3 -- разделение;

    -   5 -- присоединение;

    -   6 -- разделение с одновременным присоединением;

-   reorganizationInn -- ИНН реорганизованной организации. Элемент
    обязателен при \<ФормРеорг\> = 1, 2, 3, 5, 6;

-   reorganizationKpp -- КПП реорганизованной организации (обособленного
    подразделения);

-   incomeReal -- доходы от реализации;

-   incomeInReal -- внереализационные доходы;

-   expendIncomeReal -- расходы, уменьшающие сумму доходов от
    реализации;

-   expendIncomeInReal -- внереализационные расходы;

-   losses -- убытки;

-   taxBase -- налоговая база;

-   taxBaseCalculated -- налоговая база для исчисления налога;

-   taxCalculated -- сумма исчисленного налога -- всего;

-   realizePropertyLaw -- выручка от реализации имущественных прав,\
    за исключением доходов от реализации прав требований долга,
    указанных\
    в Приложении № 3 к Листу 02;

-   realizePropertyOther -- выручка от реализации прочего имущества;

-   mainAttachment -- главный файл вложения -- файл описи;

-   attachments -- файлы вложений в описи ФНС России (файлы: xml,
    подпись, pdf, подпись, сам файл описи). Если вложения не пришли от
    ФНС России, то поля пустые;

-   fileLink -- блок информации о файле;

-   signLink -- блок информации о подписи;

-   location -- локация файла;

-   mimeType -- тип файла. Может принимать значения:

    -   \"PDF\" (файл);

    -   \"PKCS7\" (подпись);

    -   \"XML\" (файл);

    -   \"PKCS7\" (подпись);

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значения:

    -   40 -- если файл вложения имеет формат .xml и .pdf, либо это файл
        описи .xml;

    -   41 -- если это файл вложения подписи в формате P7C;

-   mnemonic -- мнемоника файлов--вложений ответа от ФНС России\
    со сведениями выписки из декларации по налогу на прибыль
    организации.\
    Из ФНС России приходит 5 файлов:

    -   файл -- EPGU_PRIB_GGGGMMDD_GUID.XML;

    -   подпись -- EPGU_PRIB_GGGGMMDD_GUID_XML.p7s;

    -   файл -- EPGU_PRIB_GGGGMMDD_GUID.PDF;

    -   подпись -- EPGU_PRIB_GGGGMMDD_GUID PDF.p7s;

    -   опись файлов -- OPIS_PRIB_GGGGMMDD_GUID.XML;

-   main -- признак главного файла описи. Может принимать значения:

    -   false;

    -   true;

-   vrs -- блок сведений при технических ошибках:

    -   errorCode -- код технической ошибки;

    -   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки. Может принимать значения:

    -   VERIFICATION_FAILED -- произошла техническая ошибка;

    -   VERIFYING -- отправлен запрос в ФНС России, и ответ пока не
        вернулся.

Возможные коды ошибок приведены в таблице 38.

Таблица 38 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Получение сведений из налоговой декларации по налогу на прибыль организации по идентификатору документа

Для получения сведений из налоговой декларации по налогу на прибыль
организации система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом GET с дополнительным параметром в URL
запроса -- {id} (идентификатор записи документа). В запросе должен быть
указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

/api/public/{version}/org/{org_oid}/doc/income-tax/{id},

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями из налоговых деклараций по налогу на
    прибыль организации;

-   income-tax -- название сведения;

-   id -- идентификатор записи документа (уникальный).

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope):

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org\_ income_tax?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077470195/doc/income-tax/237b6bb2-b4dd-4a95-b6ea-f1142721650c

Пример ответа: Code: 200 OK

{

\"id\": \"237b6bb2-b4dd-4a95-b6ea-f1142721650c\",

\"orgOid\": 1077470195,

\"data\": \[

{

\"docId\": \"6e82a7dc2c2a4eee8929a83a13581308\",

\"period\": \"34\",

\"reportYear\": \"2021\",

\"numberCorrection\": 0,

\"orgInfo\": {

\"legalInfo\": {

\"inn\": \"5050140162\",

\"kpp\": \"505001001\",

\"name\": \"ООО «Пример»\",

\"ogrn\": \"123145555556\"

}

}

},

\"taxInfo\": {

\"losses\": \"5\",

\"taxBase\": \"6\",

\"incomeReal\": \"1\",

\"incomeInReal\": \"2\",

\"taxCalculated\": \"8\",

\"expendIncomeReal\": \"3\",

\"taxBaseCalculated\": \"7\",

\"expendIncomeInReal\": \"4\",

\"realizePropertyLaw\": \"9\",

\"realizePropertyOther\": \"10\"

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 52,

\"createdOn\": \"2022-06-16T10:51:21.766\",

\"updatedOn\": \"2022-06-24T16:21:10.801\",

\"verifiedOn\": \"2022-06-24\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220704_b747ad64-fb86-11ec-bbd0-ee8c9052e06c.pdf/40\",

\"location\": \"00\",

\"objectId\": \"4045650\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220704_b747ad64-fb86-11ec-bbd0-ee8c9052e06c.pdf\",

\"mimeType\": \"PDF\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4045650\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045650\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045650\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4045650/EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4045650\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612_XML.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

}

\],

\"year\": \"2021\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/4045650/OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4045650\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_PRIB_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

Параметры ответа в формате JSON:

-   orgOid -- идентификатор oid Организации;

-   id -- идентификатор записи документа (уникальный);

-   relevance --  релевантность документа, возможные значения:

    -   actual -- данные документа релевантные (актуальный);

    -   expired -- срок релевантности данных истек (истекший);

    -   invalid -- данные некорректные (ошибочный);

-   status -- статус достоверности данных, возможные значения:

    -   verified_by_validate -- сведения, введенные пользователем и
        проверенные\
        в ИС поставщика данных;

    -   verified_by_request -- сведения, полученные из ИС поставщика
        данных\
        по запросу (в данном случае -- система Цифрового профиля
        является инициатором запроса на получение сведений из ИС
        поставщика данных\
        по определенному идентификатору);

    -   verified_by_push -- сведения, полученные из ИС поставщика
        данных\
        в режиме «push» (в данном случае -- система ИС поставщика данных
        является инициатором отправки информации об изменении сведений);

    -   unverified -- сведения, проверка по которым в ИС поставщика
        данных\
        не осуществляется или завершилась ошибкой;

    -   no_data -- сведения отсутствуют в ведомстве (в ответе от ФНС
        России пришел отказ; в ФНС России нет данных, и вложения в
        ответе не пришли);

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   year -- отчетный год. Год, за который запрашиваются сведения из
    декларации;

-   data -- вложения ответа в формате JSON;

-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   period -- налоговый (отчетный) период;

-   reportYear -- отчетный год. Год, за который запрашиваются сведения\
    из декларации;

-   numberСorrection -- номер корректировки для корректирующего
    документа (декларации);

-   orgInfo -- налогоплательщик;

-   legalInfo -- налогоплательщик -- юридическое лицо:

    -   name -- наименование организации;

    -   inn -- ИНН организации;

    -   kpp -- КПП организации;

-   reorganizationInfo -- сведения о реорганизованной (ликвидированной)
    организации;

-   reorganizationForm -- код формы реорганизации (ликвидации).
    Принимает значения:

    -   0 -- ликвидация;

    -   1 -- преобразование;

    -   2 -- слияние;

    -   3 -- разделение;

    -   5 -- присоединение;

    -   6 -- разделение с одновременным присоединением;

-   reorganizationInn -- ИНН реорганизованной организации. Элемент
    обязателен при \<ФормРеорг\> = 1, 2, 3, 5, 6;

-   reorganizationKpp -- КПП реорганизованной организации (обособленного
    подразделения);

-   incomeReal -- доходы от реализации;

-   incomeInReal -- внереализационные доходы;

-   expendIncomeReal -- расходы, уменьшающие сумму доходов от
    реализации;

-   expendIncomeInReal -- внереализационные расходы;

-   losses -- убытки;

-   taxBase -- налоговая база;

-   taxBaseCalculated -- налоговая база для исчисления налога;

-   taxCalculated -- сумма исчисленного налога -- всего;

-   realizePropertyLaw -- выручка от реализации имущественных прав,\
    за исключением доходов от реализации прав требований долга,
    указанных\
    в Приложении № 3 к Листу 02;

-   realizePropertyOther -- выручка от реализации прочего имущества;

-   mainAttachment -- главный файл вложения -- файл описи;

-   attachments -- файлы вложений в описи ФНС России (файлы: xml,
    подпись, pdf, подпись, сам файл описи). Если вложения не пришли от
    ФНС России, то поля пустые;

-   fileLink -- блок информации о файле;

-   signLink -- блок информации о подписи;

-   location -- локация файла;

-   mimeType -- тип файла. Может принимать значения:

    -   \"PDF\" (файл);

    -   \"PKCS7\" (подпись);

    -   \"XML\" (файл);

    -   \"PKCS7\" (подпись);

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значения:

    -   40 -- если файл вложения имеет формат .xml и .pdf, либо это файл
        описи .xml;

    -   41 -- если это файл вложения подписи в формате P7C;

-   mnemonic -- мнемоника файлов--вложений ответа от ФНС России\
    со сведениями выписки из декларации по налогу на прибыль
    организации.\
    Из ФНС России приходит 5 файлов:

    -   файл -- EPGU_PRIB_GGGGMMDD_GUID.XML;

    -   подпись -- EPGU_PRIB_GGGGMMDD_GUID_XML.p7s;

    -   файл -- EPGU_PRIB_GGGGMMDD_GUID.PDF;

    -   подпись -- EPGU_PRIB_GGGGMMDD_GUID PDF.p7s;

    -   опись файлов -- OPIS\_ PRIB_GGGGMMDD_GUID.XML;

-   main -- признак главного файла описи. Может принимать значения:

    -   false;

    -   true;

-   vrs -- блок сведений при технических ошибках:

    -   errorCode -- код технической ошибки;

    -   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки. Может принимать значения:

    -   VERIFICATION_FAILED -- произошла техническая ошибка;

    -   VERIFYING -- отправлен запрос в ФНС России и ответ пока не
        вернулся.

Возможные коды ошибок приведены в таблице 39.

Таблица 39 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Проверка запуска обновления сведений из налоговой декларации по налогу на прибыль организации

Для получения сведений из налоговой декларации по налогу на прибыль
организации система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом GET. В запросе должен быть указан ресурс,
содержащий необходимые данные. Идентификатор этого ресурса в ЕСИА имеет
следующий вид:

/api/public/{version}/org/{org_oid}/doc/income-tax/check,

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации или ИП в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями из налоговой декларации по налогу на
    прибыль организации;

-   income-tax -- название сведения;

-   сheck -- проверка запущенности обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: GET

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_income_tax?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077470195/doc/income-tax/check

Пример ответа (не запущено обновление сведений ФНС России):

Code: 404 -- Not Found.

Пример ответа (уже было запущено обновление сведений в ФНС России):

Code: 200 ОК

{

\"requestIds\": \[

4061225,

4061224,

4061223,

4061222

\],

\"orgOid\": 1077470195,

\"expiresOn\": \"2022-07-25T17:19:15.322+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 40.

Таблица 40 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений из налоговой декларации по налогу на прибыль организации

Для получения сведений из налоговой декларации по налогу на прибыль
организации система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом GET. В запросе должен быть указан ресурс,
содержащий необходимые данные. Идентификатор этого ресурса в ЕСИА имеет
следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/income-tax/refresh,

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями из налоговой декларации по налогу на
    прибыль организации;

-   income-tax -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077470195/doc/income-tax/refresh

Пример ответа: Code: 200 ОК

{

    \"requestIds\": \[

        4061225,

4061224,

4061223,

4061222

    \],

    \"orgOid\": 1077470195,

    \"expiresOn\": \"2022-07-28T16:00:28.713+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 41.

Таблица 41 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений из налоговой декларации по налогу на прибыль организации по идентификатору организации и году документа

Для получения сведений по идентификатору организации или по году
документа из налоговых деклараций, представленных ИП, применяющими
специальные налоговые режимы, система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST.

Path: /api/public/{version}/org/{org_oid}/doc/income-tax/refresh/{year}

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями из налоговой декларации по налогу на
    прибыль организации;

-   income-tax -- название сведения;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\";

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077470195/doc/income-tax/refresh/2020

Пример ответа: Code: 200 ОК

**{**

\"expiresOn\": \"2023-03-07T11:10:37.750Z\",

\"orgOid\": 0,

\"requestId\": 0,

\"year\": {

\"leap\": true,

\"value\": 0

}

}

Возможные коды ошибок приведены в таблице 42.

Таблица 42 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   400 { \"code\":        | Отсутствует согласие Минцифры  |
| \"ESIA-036718\",                    | России                         |
|                                     |                                |
| \"message\": \"Необходимо           |                                |
| предварительно выдать согласие      |                                |
| Министерству цифрового развития,    |                                |
| связи и массовых коммуникаций       |                                |
| Российской Федерации\"}             |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+

#### Отмена запроса на обновление сведений по идентификатору организации и году документа из налоговой декларации по налогу на прибыль организации

Для отмены запроса на обновление сведений по идентификатору организации
и году документа из налоговой декларации по налогу, уплачиваемому в
связи с применением налога на прибыль организации, система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом POST.

Path:
/api/public/{version}/org/{org_oid}/doc/income-tax/refresh/{year}/cancel,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о сумме фактически уплаченных
    юридическим лицом налогов;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

> Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/income-tax/refresh/2023/cancel

Пример успешного ответа: Code: 200 ОК

Возможные коды ошибок приведены в таблице 43.

Таблица 43 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   404 {\"code\": \"      | Документ не найден             |
| ESIA-020203\", \"message\": \" Not  |                                |
| Found\"}                            |                                |
+-------------------------------------+--------------------------------+

#### Получение сведений из налоговых деклараций, представленных ИП, применяющими специальные налоговые режимы 

Для получения сведений из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/special-tax-regimes,

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   special-tax-regimes -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"bss_special_tax_regime?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

[https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/special-tax-regimes](https://esia-dev-k8s.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/special-tax-regimes)

Пример ответа:

Code: 200 OK

\[

{

\"id\": \"e90e546f-3984-4152-aba8-07b1102f5c44\",

\"orgOid\": 1077378806,

\"data\": \[

{

\"orgInfo\": {

\"individualInfo\": {

\"inn\": \"100000000074\",

\"individualName\": {

\"firstName\": \"ИВАН\",

\"lastName\": \"ИВАНОВ\",

\"middleName\": \"ИВАНОВИЧ\"

}

}

},

\"taxInfo\": {

\"eshn\": \[

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"sumIncome\": \"1000\"

}

\],

\"usn\": \[

{

\"period\": \"20\",

\"reportYear\": \"2015\",

\"versionForm\": \"3.00\",

\"info_3_00\": {

\"income\": \"2000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.01\",

\"info_5_01\": {

\"taxationObject\": \"2\",

\"income\": \"2000\",

\"expense\": \"1000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.04\",

\"info_5_04\": {

\"incomeInfo\": {

\"taxationObject\": \"1\",

\"income\": {

\"sumFor1quarter\": \"1000\",

\"sumForHalfYear\": \"2000\",

\"sumFor9months\": \"3000\",

\"sumForTaxYear\": \"4000\"

}

}

}

}

\],

\"envd\": \[

{

\"period\": \"21\",

\"reportYear\": \"2015\",

\"taxBaseKvpd\": \[

{

\"kvpd\": \"01\",

\"taxBase\": \"3000\"

},

{

\"kvpd\": \"07\",

\"taxBase\": \"4000\"

}

\]

}

\]

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 4,

\"createdOn\": \"2022-06-14T17:24:02.139\",

\"updatedOn\": \"2022-06-14T17:33:08.878\",

\"verifiedOn\": \"2022-06-14\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/3403661/d9eb0047-ec27-c72d-65ab-64f48a2abdd1.xml/40\",

\"location\": \"00\",

\"objectId\": \"3403661\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"d9eb0047-ec27-c72d-65ab-64f48a2abdd1.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"year\": \"2021\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/3403661/d9eb0047-ec27-c72d-65ab-64f48a2abdd1.xml/40\",

\"location\": \"00\",

\"objectId\": \"3403661\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"d9eb0047-ec27-c72d-65ab-64f48a2abdd1.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

},

{

\"id\": \"3d4b71c0-50a8-4f21-b836-5d6022a04c72\",

\"orgOid\": 1077378806,

\"data\": \[

{

\"orgInfo\": {

\"individualInfo\": {

\"inn\": \"100000000074\",

\"individualName\": {

\"firstName\": \"ИВАН\",

\"lastName\": \"ИВАНОВ\",

\"middleName\": \"ИВАНОВИЧ\"

}

}

},

\"taxInfo\": {

\"eshn\": \[

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"sumIncome\": \"1000\"

}

\],

\"usn\": \[

{

\"period\": \"20\",

\"reportYear\": \"2015\",

\"versionForm\": \"3.00\",

\"info_3_00\": {

\"income\": \"2000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.01\",

\"info_5_01\": {

\"taxationObject\": \"2\",

\"income\": \"2000\",

\"expense\": \"1000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.04\",

\"info_5_04\": {

\"incomeInfo\": {

\"taxationObject\": \"1\",

\"income\": {

\"sumFor1quarter\": \"1000\",

\"sumForHalfYear\": \"2000\",

\"sumFor9months\": \"3000\",

\"sumForTaxYear\": \"4000\"

}

}

}

}

\],

\"envd\": \[

{

\"period\": \"21\",

\"reportYear\": \"2015\",

\"taxBaseKvpd\": \[

{

\"kvpd\": \"01\",

\"taxBase\": \"3000\"

},

{

\"kvpd\": \"07\",

\"taxBase\": \"4000\"

}

\]

}

\]

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 4,

\"createdOn\": \"2022-06-14T17:24:02.025\",

\"updatedOn\": \"2022-06-14T17:34:06.524\",

\"verifiedOn\": \"2022-06-14\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/3403659/9485beb6-ea4e-2381-b62a-7ee2e3bf9864.xml/40\",

\"location\": \"00\",

\"objectId\": \"3403659\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"9485beb6-ea4e-2381-b62a-7ee2e3bf9864.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"year\": \"2019\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/3403659/9485beb6-ea4e-2381-b62a-7ee2e3bf9864.xml/40\",

\"location\": \"00\",

\"objectId\": \"3403659\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"9485beb6-ea4e-2381-b62a-7ee2e3bf9864.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

},

{

\"id\": \"4ae25b95-1bc2-4604-ba29-a92e713dcc2c\",

\"orgOid\": 1077378806,

\"data\": \[

{

\"orgInfo\": {

\"individualInfo\": {

\"inn\": \"100000000074\",

\"individualName\": {

\"firstName\": \"ИВАН\",

\"lastName\": \"ИВАНОВ\",

\"middleName\": \"ИВАНОВИЧ\"

}

}

},

\"taxInfo\": {

\"eshn\": \[

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"sumIncome\": \"1000\"

}

\],

\"usn\": \[

{

\"period\": \"20\",

\"reportYear\": \"2015\",

\"versionForm\": \"3.00\",

\"info_3_00\": {

\"income\": \"2000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.01\",

\"info_5_01\": {

\"taxationObject\": \"2\",

\"income\": \"2000\",

\"expense\": \"1000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.04\",

\"info_5_04\": {

\"incomeInfo\": {

\"taxationObject\": \"1\",

\"income\": {

\"sumFor1quarter\": \"1000\",

\"sumForHalfYear\": \"2000\",

\"sumFor9months\": \"3000\",

\"sumForTaxYear\": \"4000\"

}

}

}

}

\],

\"envd\": \[

{

\"period\": \"21\",

\"reportYear\": \"2015\",

\"taxBaseKvpd\": \[

{

\"kvpd\": \"01\",

\"taxBase\": \"3000\"

},

{

\"kvpd\": \"07\",

\"taxBase\": \"4000\"

}

\]

}

\]

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 4,

\"createdOn\": \"2022-06-14T17:24:02.083\",

\"updatedOn\": \"2022-06-14T17:34:06.793\",

\"verifiedOn\": \"2022-06-14\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/3403660/16b78ece-312c-60e3-94c1-e88b1653f7be.xml/40\",

\"location\": \"00\",

\"objectId\": \"3403660\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"16b78ece-312c-60e3-94c1-e88b1653f7be.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"year\": \"2020\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/3403660/16b78ece-312c-60e3-94c1-e88b1653f7be.xml/40\",

\"location\": \"00\",

\"objectId\": \"3403660\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"16b78ece-312c-60e3-94c1-e88b1653f7be.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

\]

Структура ответа в формате JSON:

-   Id -- идентификатор записи документа (уникальный);

-   orgOid -- идентификатор ИП;

-   data -- вложения ответа. Комплексное поле:

    -   orgInfo -- налогоплательщик;

    -   individualInfo -- налогоплательщик -- физическое лицо.
        Комплексное поле:

        -   inn -- ИНН физического лица;

        -   individualName -- фамилия, имя, отчество ИП. Комплексное
            поле:

```{=html}
<!-- -->
```
-   lastName -- фамилия ИП;

-   firstName -- имя ИП;

-   middleName -- отчество ИП;

    -   taxInfo -- сведения о специальных налоговых режимах,
        представленных ИП, применяющими специальные налоговые режимы.
        Комплексное поле:

        -   eshn -- сведения о доходах из налоговой декларации по
            единому сельскохозяйственному налогу. Комплексное поле:

-   period -- налоговый период;

-   sumIncome -- сумма доходов за налоговый (отчетный) период,
    учитываемых при определении налоговой базы по единому
    сельскохозяйственному налогу;

-   reportYear -- отчетный год. Год, за который запрашивается выписка из
    декларации;

    -   usn -- сведения о доходах из налоговой декларации по налогу,
        уплачиваемому в связи с применением упрощенной системы
        налогообложения. Комплексное поле:

-   period -- налоговый период;

-   reportYear -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   info_3_00 -- сведения, полученные по формату версии ниже 5.01.
    Комплексное поле:

    -   income -- доходы;

    -   expense -- доходы, уменьшенные на величину расходов;

    -   versionForm -- версия формата;

    -   info_5_01 -- сведения, полученные по формату версии 5.01.
        Комплексное поле:

    -   taxationObject -- объект налогообложения. Комплексное поле:

        -   income -- доходы;

        -   expense -- доходы, уменьшенные на величину расходов;

-   versionForm -- версия формата;

-   reportYear -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   info_5_04 -- сведения, полученные по формату версии 5.04 и 5.05.
    Комплексное поле:

    -   incomeInfo -- расчет налога, уплачиваемого в связи\
        с применением упрощенной системы налогообложения (объект
        налогообложения -- доходы);

        -   taxationObject -- объект налогообложения. Комплексное поле:

        -   income -- доходы. Комплексное поле:

        -   sumFor9months -- за первый квартал;

            -   sumForTaxYear -- за полугодие;

            -   sumFor1quarter -- за 9 месяцев;

            -   sumForHalfYear -- за налоговый год;

-   incomeLessExpenseInfo -- расчет налога, уплачиваемого в связи\
    с применением упрощенной системы налогообложения (объект
    налогообложения -- доходы, уменьшенные на величину расходов);

    -   taxationObject -- объект налогообложения. Комплексное поле:

        -   income -- доходы. Комплексное поле:

        -   sumFor9months -- за первый квартал;

        -   sumForTaxYear -- за полугодие;

        -   sumFor1quarter -- за 9 месяцев;

        -   sumForHalfYear -- за налоговый год;

        -   expense -- расходы. Комплексное поле:

        -   sumFor9months -- за первый квартал;

        -   sumForTaxYear -- за полугодие;

        -   sumFor1quarter -- за 9 месяцев;

-   envd -- сведения из налоговой декларации по единому налогу\
    на вмененный доход для отдельных видов деятельности (ЕНВД).
    Комплексное поле:

    -   period -- налоговый период;

    -   reportYear -- отчетный год. Год, за который запрашивается
        выписка из декларации;

    -   taxBaseKvpd -- налоговая база по коду вида предпринимательской
        деятельности. Комплексное поле:

        -   kvpd -- код вида предпринимательской деятельности;

        -   taxBase -- налоговая база;

```{=html}
<!-- -->
```
-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   verified_on -- дата актуальности информации;

-   attachments -- файлы вложения в ФНС России (файлы: xml). Если
    вложения\
    не пришли от ФНС России, то поля пустые. Комплексное поле:

    -   fileLink -- блок информации о файле. Комплексное поле:

    -   location -- локация файла;

    -   mimeType -- тип файла. Должен принимать значение: \"XML\"
        (файл);

    -   originLink -- ссылка на файл в хранилище (например,
        s3://00/4069034/4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml/40);

    -   objectId -- идентификатор файла;

    -   objectTypeId -- тип файла. Принимает значения: 40 -- файл
        вложения имеет формат .xml;

    -   mnemonic -- ссылка мнемонику файла вложения (например,
        4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml);

    -   main -- признак главного файла. Может принимать значения: true;

-   year -- отчетный год. Год, за который запрашивается выписка из
    декларации. Комплексное поле:

    -   value -- год;

-   mainAttachment -- главный файл вложения. Комплексное поле:

    -   fileLink -- блок информации о файле. Комплексное поле:

        -   location -- локация файла;

        -   mimeType -- тип файла. Должен принимать значение: \"XML\"
            (файл);

        -   originLink -- ссылка на файл в хранилище (например,
            s3://00/4069034/4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml/40);

        -   objectId -- идентификатор файла;

        -   objectTypeId -- тип файла. Принимает значения: 40 -- файл
            вложения имеет формат .xml;

        -   mnemonic -- ссылка мнемонику файла вложения (например,
            4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml);

    -   main -- признак главного файла. Может принимать значения: true.

Возможные коды ошибок приведены в таблице 44.

Таблица 44 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Получение сведений из налоговых деклараций, представленных ИП, применяющими специальные налоговые режимы 

Для получения сведений из налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

/api/public/{version}/org/{org_oid}/doc/special-tax-regimes/{id},

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   special-tax-regimes -- название сведения;

-   id -- идентификатор записи документа (уникальный).

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"bss_special_tax_regime?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077404126/doc/special-tax-regimes/4502256d-d2ec-4c28-a75b-1f05f541ea44

Пример ответа: Code: 200 OK

{

\"id\": \"1e743257-e8ac-46c6-8d24-9f7ab15968c3\",

\"orgOid\": 1077467659,

\"data\": \[

{

\"orgInfo\": {

\"individualInfo\": {

\"inn\": \"100000000074\",

\"individualName\": {

\"firstName\": \"ИВАН\",

\"lastName\": \"ИВАНОВ\",

\"middleName\": \"ИВАНОВИЧ\"

}

}

},

\"taxInfo\": {

\"eshn\": \[

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"sumIncome\": \"1000\"

}

\],

\"usn\": \[

{

\"period\": \"20\",

\"reportYear\": \"2015\",

\"versionForm\": \"3.00\",

\"info_3_00\": {

\"income\": \"2000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.01\",

\"info_5_01\": {

\"taxationObject\": \"2\",

\"income\": \"2000\",

\"expense\": \"1000\"

}

},

{

\"period\": \"30\",

\"reportYear\": \"2015\",

\"versionForm\": \"5.04\",

\"info_5_04\": {

\"incomeInfo\": {

\"taxationObject\": \"1\",

\"income\": {

\"sumFor1quarter\": \"1000\",

\"sumForHalfYear\": \"2000\",

\"sumFor9months\": \"3000\",

\"sumForTaxYear\": \"4000\"

}

}

}

}

\],

\"envd\": \[

{

\"period\": \"21\",

\"reportYear\": \"2015\",

\"taxBaseKvpd\": \[

{

\"kvpd\": \"01\",

\"taxBase\": \"3000\"

},

{

\"kvpd\": \"07\",

\"taxBase\": \"4000\"

}

\]

}

\]

}

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 2,

\"createdOn\": \"2022-06-10T15:49:18.463\",

\"updatedOn\": \"2022-06-10T15:49:20.156\",

\"verifiedOn\": \"2022-06-10\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/3396665/674b1bfc-ae05-1189-20cd-cd208a1f0ad5.xml/40\",

\"location\": \"00\",

\"objectId\": \"3396665\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"674b1bfc-ae05-1189-20cd-cd208a1f0ad5.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"year\": \"2020\",

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/3396665/674b1bfc-ae05-1189-20cd-cd208a1f0ad5.xml/40\",

\"location\": \"00\",

\"objectId\": \"3396665\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"674b1bfc-ae05-1189-20cd-cd208a1f0ad5.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

Структура ответа в формате JSON:

-   Id -- индентификатор записи документа (уникальный);

-   orgOid -- идентификатор ИП;

-   data -- вложения ответа. Комплексное поле:

    -   orgInfo -- налогоплательщик;

    -   individualInfo -- налогоплательщик -- физическое лицо.
        Комплексное поле:

        -   inn -- ИНН физического лица;

        -   individualName -- фамилия, имя, отчество ИП. Комплексное
            поле:

```{=html}
<!-- -->
```
-   lastName -- фамилия ИП;

-   firstName -- имя ИП;

-   middleName -- отчество ИП;

    -   taxInfo -- сведения о специальных налоговых режимах,
        представленных ИП, применяющими специальные налоговые режимы.
        Комплексное поле:

        -   eshn -- сведения о доходах из налоговой декларации по
            единому сельскохозяйственному налогу. Комплексное поле:

-   period -- налоговый период;

-   sumIncome -- сумма доходов за налоговый (отчетный) период,
    учитываемых при определении налоговой базы по единому
    сельскохозяйственному налогу;

-   reportYear -- отчетный год. Год, за который запрашивается выписка из
    декларации;

    -   usn -- сведения о доходах из налоговой декларации по налогу,
        уплачиваемому в связи с применением упрощенной системы
        налогообложения. Комплексное поле:

-   period -- налоговый период;

-   reportYear -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   info_3_00 -- сведения, полученные по формату версии ниже 5.01.
    Комплексное поле:

    -   income -- доходы;

    -   expense -- доходы, уменьшенные на величину расходов;

    -   versionForm -- версия формата;

-   info_5_01 -- сведения, полученные по формату версии 5.01.
    Комплексное поле:

    -   taxationObject -- объект налогообложения. Комплексное поле:

        -   income -- доходы;

        -   expense -- доходы, уменьшенные на величину расходов;

-   versionForm -- версия формата;

-   reportYear -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   info_5_04 -- сведения, полученные по формату версии 5.04 и 5.05.
    Комплексное поле:

    -   incomeInfo -- расчет налога, уплачиваемого в связи\
        с применением упрощенной системы налогообложения (объект
        налогообложения -- доходы);

    -   taxationObject -- объект налогообложения. Комплексное поле:

        -   income -- доходы. Комплексное поле:

        ```{=html}
        <!-- -->
        ```
        -   sumFor9months -- за первый квартал;

        -   sumForTaxYear -- за полугодие;

        -   sumFor1quarter -- за 9 месяцев;

        -   sumForHalfYear -- за налоговый год;

    -   incomeLessExpenseInfo -- расчет налога, уплачиваемого в связи с
        применением упрощенной системы налогообложения (объект
        налогообложения -- доходы, уменьшенные на величину расходов);

    -   taxationObject -- объект налогообложения. Комплексное поле:

        -   income -- доходы. Комплексное поле:

        ```{=html}
        <!-- -->
        ```
        -   sumFor9months -- за первый квартал;

        -   sumForTaxYear -- за полугодие;

        -   sumFor1quarter -- за 9 месяцев;

        -   sumForHalfYear -- за налоговый год;

        ```{=html}
        <!-- -->
        ```
        -   expense -- расходы. Комплексное поле:

        ```{=html}
        <!-- -->
        ```
        -   sumFor9months -- за первый квартал;

        -   sumForTaxYear -- за полугодие;

        -   sumFor1quarter -- за 9 месяцев;

    ```{=html}
    <!-- -->
    ```
    -   envd -- сведения из налоговой декларации по единому налогу\
        на вмененный доход для отдельных видов деятельности (ЕНВД).
        Комплексное поле:

-   period -- налоговый период;

-   reportYear -- отчетный год. Год, за который запрашивается выписка из
    декларации;

-   taxBaseKvpd -- налоговая база по коду вида предпринимательской
    деятельности. Комплексное поле:

    -   kvpd -- код вида предпринимательской деятельности;

    -   taxBase -- налоговая база;

```{=html}
<!-- -->
```
-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   verified_on -- дата актуальности информации;

-   attachments -- файлы вложения в ФНС России (файлы: xml). Если
    вложения не пришли от ФНС России, то поля пустые. Комплексное поле:

    -   fileLink -- блок информации о файле. Комплексное поле:

        -   location -- локация файла;

        -   mimeType -- тип файла. Должен принимать значение: \"XML\"
            (файл);

        -   originLink -- ссылка на файл в хранилище (например,
            s3://00/4069034/4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml/40);

        -   objectId -- идентификатор файла;

        -   objectTypeId -- тип файла. Принимает значения: 40 -- файл
            вложения имеет формат .xml;

        -   mnemonic -- ссылка мнемонику файла вложения (например,
            4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml);

    -   main -- признак главного файла. Может принимать значения: true.

-   year -- отчетный год. Год, за который запрашивается выписка из
    декларации. Комплексное поле:

    -   value -- год;

-   mainAttachment -- главный файл вложения. Комплексное поле:

    -   fileLink -- блок информации о файле. Комплексное поле:

        -   location -- локация файла;

        -   mimeType -- тип файла. Должен принимать значение: \"XML\"
            (файл);

        -   originLink -- ссылка на файл в хранилище (например,
            s3://00/4069034/4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml/40);

        -   objectId -- идентификатор файла;

        -   objectTypeId -- тип файла. Принимает значения: 40 -- файл
            вложения имеет формат .xml;

        -   mnemonic -- ссылка мнемонику файла вложения (например,
            4af9eee5-9216-f7c3-3ca9-f401f75acc87.xml);

    -   main -- признак главного файла. Может принимать значения: true.

Возможные коды ошибок приведены в таблице 45.

Таблица 45 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Проверка запуска обновления сведений из налоговых деклараций, представленных ИП, применяющими специальные налоговые режимы

Для проверки запуска обновления сведений налоговых деклараций,
представленных ИП, применяющими специальные налоговые режимы,
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом GET. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

Path: /api/public/{version}/org/{org_oid}/doc/special-tax-regimes/check,

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   special-tax-regimes -- название сведения;

-   сheck -- проверка запущенности обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"bss_special_tax_regime?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\"

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077383636/doc/special-tax-regimes/check

Пример ответа (не запущено обновление сведений ФНС России): Code: 404 --
Not Found.

Пример ответа (уже было запущено обновление сведений в ФНС России):
Code: 200 ОК

{

\"requestIds\": \[

4062245,

4062244,

4062246

\],

\"orgOid\": 1077383636,

\"expiresOn\": \"2022-07-01T18:00:25.667+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА\
    (у которой проверяется наличие согласия Минцифры России -- INN\
    или OGRN);

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 46.

Таблица 46 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений из налоговых деклараций, представленных ИП, применяющими специальные налоговые режимы

Для запуска обновления сведений налоговых деклараций, представленных ИП,
применяющими специальные налоговые режимы, система-клиент должна
направить\
в https-адрес REST API системы ЕСИА запрос методом POST. В запросе
должен быть указан ресурс, содержащий необходимые данные. Идентификатор
этого ресурса в ЕСИА имеет следующий вид:

Path:
/api/public/{version}/org/{org_oid}/doc/special-tax-regimes/refresh,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями, полученный из налоговых деклараций,
    представленных ИП, применяющими специальные налоговые режимы;

-   special-tax-regimes -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077383636/doc/special-tax-regimes/refresh

Пример ответа: Code: 200 ОК

{

    \"requestIds\": \[

        4043639,

        4043638,

        4043640

    \],

    \"orgOid\": 1077383636,

    \"expiresOn\": \"2022-07-01T15:20:05.818+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА (у которой
    проверяется наличие согласия Минцифры России -- INN или OGRN);

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 47.

Таблица 47 -- Возможные коды ошибок

  -------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- -------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}   пользователя

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  -------------------------------------------------------------------------

#### Запуск обновления сведений из налоговой деклараций, предоставленных ИП, применяющими специальные налоговые режимы по идентификатору организации и году документа

Для получения сведений по идентификатору организации или по году
документа из налоговых деклараций, представленных ИП, применяющими
специальные налоговые режимы, система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST.

Path:
/api/public/{version}/org/{org_oid}/doc/special-tax-regimes/refresh/{year},

где:

-   org -- организация, имеющиеся в ЕСИА;

-   org_oid -- внутренний идентификатор организации в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями из налоговой декларации по налогу на
    прибыль организации;

-   special-tax-regimes -- название сведения;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

Тип запроса: POST

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077470195/doc/special-tax-regimes/refresh/2020

Пример ответа: Code: 200 ОК

{

\"expiresOn\": \"2023-03-07T12:33:08.512Z\",

\"orgOid\": 0,

\"requestId\": 0,

\"year\": {

\"leap\": true,

\"value\": 0

}

}

Возможные коды ошибок приведены в таблице 48.

Таблица 48 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   400 { \"code\":        | Отсутствует согласие Минцифры  |
| \"ESIA-036718\",                    | России                         |
|                                     |                                |
| \"message\": \"Необходимо           |                                |
| предварительно выдать согласие      |                                |
| Министерству цифрового развития,    |                                |
| связи и массовых коммуникаций       |                                |
| Российской Федерации\"}             |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+

#### Отмена запроса на обновление сведений по идентификатору организации и году документа из налоговых деклараций, предоставленных ИП, применяющими специальные налоговые режимы 

Для отмены запроса на обновление сведений по идентификатору организации
и году документа из налоговой декларации, предоставленной ИП,
применяющей специальные налоговые режимы, система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом POST.

Path:
/api/public/{version}/org/{org_oid}/doc/special-tax-regimes/refresh/{year}/cancel,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о сумме фактически уплаченных
    юридическим лицом налогов;

-   year -- период (год);

-   refresh -- запуск обновления сведений.

> Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/
special-tax-regimes/refresh/2023/cancel

Пример успешного ответа: Code: 200 ОК

Возможные коды ошибок приведены в таблице 49.

Таблица 49 -- Возможные коды ошибок

+-------------------------------------+--------------------------------+
| **Ошибка**                          | **Описание ошибки**            |
+=====================================+================================+
| HTTP CODE:   401 {\"code\":         | Доступ запрещен                |
| \"ESIA-005003\",                    |                                |
|                                     |                                |
| \"message\": \"Доступ запрещен\"}   |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   403 {\"code\":         | Указание в URL запроса         |
| \"ESIA-005029\",                    | организации другого            |
|                                     | пользователя                   |
| \"message\":                        |                                |
| \"S                                 |                                |
| ecurityErrorEnum.scopeNotAllowed\"} |                                |
+-------------------------------------+--------------------------------+
| HTTP CODE:   404 {\"code\": \"      | Документ не найден             |
| ESIA-020203\", \"message\": \" Not  |                                |
| Found\"}                            |                                |
+-------------------------------------+--------------------------------+

#### Получение сведений о наличии (отсутствии) задолженности по уплате налогов, сборов, страховых взносов, пеней, штрафов, процентов

Для получения сведений о наличии (отсутствии) задолженности по уплате
налогов, сборов, страховых взносов, пеней, штрафов, процентов
система-клиент должна направить\
в https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/debt,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии (отсутствии) задолженности;

-   debt -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_debt?org_oid={p.org_oid}»;

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/debt

Пример ответа (при наличии задолженности):

Code: 200 OK

{

\"id\": \"d4e541e2-5050-447e-be18-f726ee59252b\",

\"orgOid\": 1077481741,

\"data\": {

\"documentDate\": \"1957-08-13\",

\"hasDebt\": true,

\"inn\": \"0100000000\",

\"taxAuthorities\": \[

{

\"codeIFNS\": \"0000\"

},

{

\"codeIFNS\": \"0000\"

},

{

\"codeIFNS\": \"0000\"

}

\]

},

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 1,

\"createdOn\": \"2022-11-21T16:02:47.389\",

\"updatedOn\": \"2022-11-21T16:02:47.812\",

\"verifiedOn\": \"1957-08-13\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4749334/642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml/40\",

\"location\": \"00\",

\"objectId\": \"4749334\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4749334/642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml/40\",

\"location\": \"00\",

\"objectId\": \"4749334\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

Структура ответа в формате JSON:

-   orgOid -- идентификатор oid организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   data -- вложения ответа в формате JSON:

-   documentDate -- дата запроса документа;

-   hasDebt -- признак задолженности (true -- задолженность
    присутствует);

-   inn -- ИНН организации/ИП;

-   taxAuthorities -- перечень территориальных налоговых органов, в
    которых имеется неисполненная обязанность по уплате налогов, сборов:

```{=html}
<!-- -->
```
-   codeIFNS -- код инспекции ФНС России;

```{=html}
<!-- -->
```
-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   attachments -- файл ФНС России:

-   fileLink -- блок информации о файле:

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   location -- локация файла;

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значение «40» (файл имеет
    формат .xml);

-   mnemonic -- мнемоника файлов ответа от ФНС России\
    со сведениями выписки о среднесписочной численности работников за
    предшествующий календарный год;

-   mimeType -- тип файла. Может принимать значение «XML» (файл);

-   main -- признак главного файла;

-   mainAttachment -- главный файл;

-   vrs -- блок сведений при технических ошибках:

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки.

> Возможные коды ошибок приведены в таблице 50.

Таблица 50 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

Пример ответа (при отсутствии задолженности):

Code: 200 OK

Code: 200 OK

{

\"id\": \"d4e541e2-5050-447e-be18-f726ee59252b\",

\"orgOid\": 1077481741,

\"data\": {

\"documentDate\": \"1957-08-13\",

\"hasDebt\": false,

\"inn\": \"0100000000\"

},

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 1,

\"createdOn\": \"2022-11-21T16:02:47.389\",

\"updatedOn\": \"2022-11-21T16:02:47.812\",

\"verifiedOn\": \"1957-08-13\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4749334/642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml/40\",

\"location\": \"00\",

\"objectId\": \"4749334\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4749334/642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml/40\",

\"location\": \"00\",

\"objectId\": \"4749334\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"642ab423-725e-e1ac-6c4d-530c35eb6ab4.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

Структура ответа в формате JSON:

-   orgOid -- идентификатор oid организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   data -- вложения ответа в формате JSON:

-   documentDate -- дата запроса документа;

-   hasDebt -- признак задолженности (false -- задолженность
    отсутствует);

-   inn -- ИНН организации/ИП;

-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   attachments -- файл ФНС России:

-   fileLink -- блок информации о файле:

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   location -- локация файла;

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значение «40» (файл имеет
    формат .xml);

-   mnemonic -- мнемоника файлов ответа от ФНС России\
    со сведениями выписки о среднесписочной численности работников за
    предшествующий календарный год;

-   mimeType -- тип файла. Может принимать значение «XML» (файл);

-   main -- признак главного файла;

-   mainAttachment -- главный файл;

-   vrs -- блок сведений при технических ошибках:

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки.

Возможные коды ошибок приведены в таблице 44.

#### Проверка запуска обновления сведений о наличии (отсутствии) задолженности по уплате налогов, сборов, страховых взносов, пеней, штрафов, процентов

Для проверки запуска обновления сведений о наличии (отсутствии)
задолженности по уплате налогов, сборов, страховых взносов, пеней,
штрафов, процентов система-клиент должна направить в https-адрес REST
API системы ЕСИА запрос методом GET. В запросе должен быть указан
ресурс, содержащий необходимые данные. Идентификатор этого ресурса в
ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/debt **/**check,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии (отсутствии) задолженности\
    по уплате налогов, сборов, страховых взносов, пеней, штрафов,
    процентов;

-   debt -- название сведения;

-   сheck -- проверка запуска обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_debt?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/debt/check

Пример ответа (не запущено обновление сведений ФНС России):

Code: 404 - Not Found.

Пример ответа (уже было запущено обновление сведений в ФНС России):

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481741,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 44.

#### Запуск обновления сведений о наличии (отсутствии) задолженности по уплате налогов, сборов, страховых взносов, пеней, штрафов, процентов

Для запуска обновления сведений о наличии (отсутствии) задолженности по
уплате налогов, сборов, страховых взносов, пеней, штрафов, процентов
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом POST. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса\
в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/debt/refresh,

где:

-   org -- организация зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии (отсутствии) задолженности\
    по уплате налогов, сборов, страховых взносов, пеней, штрафов,
    процентов;

-   debt -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/debt/refresh

Пример успешного ответа:

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481741,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 51.

Таблица 51 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Отмена обновления сведений о наличии (отсутствии) задолженности по уплате налогов, сборов, страховых взносов, пеней, штрафов, процентов

Для отмены обновления сведений о наличии (отсутствии) задолженности по
уплате налогов, сборов, страховых взносов, пеней, штрафов, процентов
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом POST. В запросе должен быть указан ресурс, содержащий
необходимые данные.

Идентификатор этого ресурса в ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/debt**/**refresh/cancel,

где:

-   org -- организация зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии (отсутствии) задолженности\
    по уплате налогов, сборов, страховых взносов, пеней, штрафов,
    процентов;

-   debt -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/debt/refresh/cancel

Пример успешного ответа: Code: 200 ОК

> Возможные коды ошибок приведены в таблице 52.

Таблица 52 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Получение сведений о сумме фактически уплаченных юридическим лицом налогов

Для получения сведений о сумме фактически уплаченных юридическим лицом
налогов система-клиент должна направить в https-адрес REST API системы
ЕСИА запрос методом GET. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

Path: /api/public/{version}/org/{org_oid}/doc/paid-tax,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии (отсутствии) задолженности;

-   paid_tax -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"paid_tax?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/paid_tax

Пример ответа (при наличии задолженности):

Code: 200 OK

Code: 200 OK

{

\"id\": \"5247016429_ID\",

\"orgOid\": 1000000000,

\"data\": {

\"amountPaidTaxes\": \"22222220\",

\"date\": \"2015-09-29\",

\"inn\": \"5247016429\",

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 14,

\"apiVersion\": \"1\",

\"createdOn\": \"2022-08-04T11:15:39.918\",

\"updatedOn\": \"2022-10-20T16:18:43.524\",

\"verifiedOn\": \"2015-09-29\",

\"vrs\": {

\"errorCode\": \"string\",

\"newValue\": \"string\",

\"reqId\": 0,

\"status\": \"VERIFICATION_FAILED\"

},

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/11401/99ea9e50-89b0-7e2d-5381-2bf932832abb.xml/40\",

\"location\": \"00\",

\"objectId\": \"11401\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"99ea9e50-89b0-7e2d-5381-2bf932832abb.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/11401/99ea9e50-89b0-7e2d-5381-2bf932832abb.xml/40\",

\"location\": \"00\",

\"objectId\": \"11401\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"99ea9e50-89b0-7e2d-5381-2bf932832abb.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

}

Структура ответа в формате JSON:

-   orgOid -- идентификатор (oid) организации;

-   id -- идентификатор записи документа (уникальный);

-   data -- вложения ответа в формате JSON:

-   amountPaidTaxes -- сумма фактически уплаченного организацией налога;

-   date -- дата запроса документа;

-   inn -- ИНН организации;

-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   attachments -- файл ФНС России:

-   fileLink -- блок информации о файле:

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   location -- локация файла;

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значение «40» (файл имеет
    формат .xml);

-   mnemonic -- мнемоника файлов ответа от ФНС России\
    со сведениями выписки о среднесписочной численности работников за
    предшествующий календарный год;

-   mimeType -- тип файла. Может принимать значение «XML» (файл);

-   main -- признак главного файла;

-   mainAttachment -- главный файл;

-   vrs -- блок сведений при технических ошибках:

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки.

> Возможные коды ошибок приведены в таблице 53.

Таблица 53 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Проверка запуска обновления сведений о сумме фактически уплаченных юридическим лицом налогов

Для проверки запуска обновления сведений о сумме фактически уплаченных
юридическим лицом налогов система-клиент должна направить в https-адрес
REST API системы ЕСИА запрос методом GET. В запросе должен быть указан
ресурс, содержащий необходимые данные. Идентификатор этого ресурса в
ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/paid-tax**/**check,

где:

-   org -- организация зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о сумме фактически уплаченных
    юридическим лицом налогов;

-   paid-tax -- название сведения;

-   сheck -- проверка запуска обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"paid_tax?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/paid-tax/check

Пример ответа (не запущено обновление сведений ФНС России):

Code: 404 - Not Found.

Пример ответа (уже было запущено обновление сведений в ФНС России):

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481741,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 54.

Таблица 54 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем ИП 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений о сумме фактически уплаченных юридическим лицом налогов

Для запуска обновления сведений о сумме фактически уплаченных
юридическим лицом налогов система-клиент должна направить в https-адрес
REST API системы ЕСИАзапрос методом POST. В запросе должен быть указан
ресурс, содержащий необходимые данные. Идентификатор этого ресурса в
ЕСИА имеет следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/paid-tax**/**refresh,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о сумме фактически уплаченных
    юридическим лицом налогов;

-   paid-tax -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/paid-tax**/**refresh

Пример успешного ответа:

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481741,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 55.

Таблица 55 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ИП
  пользователь не является руководителем    
  ИП\"}                                     

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Отмена обновления сведений о сумме фактически уплаченных юридическим лицом налогов

Для отмены обновления сведений о сумме фактически уплаченных юридическим
лицом налогов система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом POST. В запросе должен быть указан ресурс,
содержащий необходимые данные. Идентификатор этого ресурса в ЕСИА имеет
следующий вид:

Path: /api/public/{version}/org/{org_oid}/doc/paid-tax/refresh/cancel,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о сумме фактически уплаченных
    юридическим лицом налогов;

-   paid-tax -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/paid-tax/refresh/cansel

Пример успешного ответа: Code: 200 ОК

Возможные коды ошибок приведены в таблице 56.

Таблица 56 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем
  пользователь не является руководителем \" 

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Получение сведений о бухгалтерской отчетности 

Для получения сведений о бухгалтерской отчетности система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса\
в ЕСИА имеет следующий вид:

Path:GET/api/public/{version}/org/{org_oid}/doc/bfo,

где:

-   org -- организация, имеющаяся в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ с бухгалтерской отчетностью;

-   bfo -- название сведения.

Тип запроса: GET

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_bfo?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

> Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/bfo

> Пример ответа (при бухгалтерской отчетности):
>
> Code: 200 OK

{

\"id\": \"4dae1bf2-a385-4065-bfa7-eca81a086d38\",

\"orgOid\": 1077481776,

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 4,

\"createdOn\": \"2022-10-31T11:14:45.433\",

\"updatedOn\": \"2022-10-31T13:39:01.047\",

\"verifiedOn\": \"2022-03-23\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"terrabyte://00/V_4636477/77994b7d-b4c9-37f4-0f7a-930d68754c8c.zip/40\",

\"location\": \"00\",

\"objectId\": \"4636477\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"V_77994b7d-b4c9-37f4-0f7a-930d68754c8c.zip\",

\"mimeType\": \"ZIP\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"terrabyte://00/V_4636477/77994b7d-b4c9-37f4-0f7a-930d68754c8c.zip/40\",

\"location\": \"00\",

\"objectId\": \"4636477\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"V_77994b7d-b4c9-37f4-0f7a-930d68754c8c.zip\",

\"mimeType\": \"ZIP\"

},

\"main\": true

}

}

Структура ответа в формате JSON:

-   orgOid -- идентификатор (oid) организации;

-   id -- идентификатор записи документа (уникальный);

-   relevance -- релевантность документа, возможные значения:

-   actual -- данные документа релевантные (актуальный);

-   expired -- срок релевантности данных истек (истекший);

-   invalid -- данные некорректные (ошибочный);

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   attachments -- файл ФНС России:

-   fileLink -- блок информации о файле;

-   originLink -- ссылка на файл в хранилище;

-   location -- локация файла;

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла;

-   mnemonic -- мнемоника файлов ответа от ФНС России с бухгалтерской
    отчетностью;

-   mimeType -- тип файла. Может принимать значение «XML» (файл);

-   main -- признак главного файла;

-   mainAttachment -- главный файл;

-   vrs -- блок сведений при технических ошибках:

-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки.

> Возможные коды ошибок приведены в таблице 57.

Таблица 57 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем
  пользователь не является руководителем    
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Запуск обновления сведений о бухгалтерской отчетности

Для запуска обновления сведений о бухгалтерской отчетности
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом POST. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

Path: /api/public/{version}/org/{org_oid}/doc/bfo/refresh,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о бухгалтерской отчетности;

-   paid-tax -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/bfo**/**refresh

Пример успешного ответа:

{

\"expiresOn\": \"2022-11-30T13:54:38.274Z\",

\"orgOid\": 0,

\"requestIds\": \[

0

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

> Возможные коды ошибок приведены в таблице 58.

Таблица 58 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем
  пользователь не является руководителем    
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

#### Отмена обновления сведений о бухгалтерской отчетности

Для отмены обновления сведений о бухгалтерской отчетности система-клиент
должна направить в https-адрес REST API системы ЕСИА запрос методом
POST. В запросе должен быть указан ресурс, содержащий необходимые
данные. Идентификатор этого ресурса в ЕСИА имеет следующий вид:

Path:/api/public/{version}/org/{org_oid}/doc/bfo/refresh/cancel,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о бухгалтерской отчетности;

-   bfo -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/bfo
refresh/cansel

Пример успешного ответа: Code: 200 ОК

Возможные коды ошибок приведены в таблице 59.

Таблица 59 -- Возможные коды ошибок

  --------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- --------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем
  пользователь не является руководителем    
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого пользователя
  \" SecurityErrorEnum.scopeNotAllowed\"}   

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  --------------------------------------------------------------------------

### Реестр МСП. Предоставление сведений из реестра МСП. Просмотр списка сведений из реестра МСП, запрос/обновление сведений из реестра МСП

В разделе «Реестр МСП» могут быть доступны сведения из реестра МСП.
Загрузка сведений осуществляется в ЛК автоматически из ФНС России при
запросе или обновлении данных.

Сведения из реестра МСП по организации могут отсутствовать.

Причины отсутствия данных по организации:

-   сведения в налоговую поданы с опозданием;

-   предприятие перестало соответствовать
    [МСП](https://rmsp.nalog.ru/about.html?section=conditions).

Доступность функций для пользователя в разделе «Реестр МСП» зависит от
его роли и полномочий (таблица 60).

Запрос и обновление сведений по реестру МСП доступны при наличии ранее
выданного согласия Минцифры России. Подробная информация о согласиях
Минцифры России приведена в п. А.7.1.6.

Таблица 60 -- Доступность функций в зависимости от ролей и полномочий

  ------------------------------------------------------------------------------------------------------------------------
  **Действие/ Роль**  **Руково-дитель**   **Админи-стратор**   **Сотру-дник**   **Сотрудник с                 
                                                                                полномочиями**                
  ------------------- ------------------- -------------------- ---------------- ---------------- ------------ ------------
                                                                                **«Право запроса **«Право     **«Право
                                                                                выписки» \       просмотра    запроса
                                                                                и «Право         выписки»**   выписки»**
                                                                                управления                    
                                                                                согласиями                    
                                                                                организации»**                

  Просмотр списка     Да                  Да                   Нет              Да               Да           Да
  сведений\                                                                                                   
  из реестра МСП                                                                                              

  Запрос/Обновление   Да                  Да                   Нет              Да               Нет          Да
  сведений\                                                                                                   
  из реестра МСП                                                                                              
  ------------------------------------------------------------------------------------------------------------------------

#### Предоставление сведений из реестра МСП

Для получения сведений из реестра МСП предназначены внешние сервисы REST
API ЕСИА для ЮЛ и ИП для обеспечения внутреннего взаимодействия со
смежными системами ИЭП и вывода сведений в специальном разделе ЛК
организации ЕПГУ:

-   получение сведений из реестра МСП;

-   проверка запуска обновления сведений из реестра МСП;

-   запуск обновления сведений из реестра МСП.

#### Получение сведений из реестра МСП 

Для получения сведений из реестра МСП система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

/digital-org/api/public/{version}/org/{org_oid}/doc/msp,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями;

-   msp -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_msp?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

В ответе возвращается список атрибутов из реестра МСП.

Код и описание ошибок:

-   Если сведения по реестру МСП не найдены -- бизнес ошибка, то в JSON
    вернется: блок data, а поле status = no_data;

-   Если при запросе сведений из реестра МСП произошла техническая
    ошибка, то в JSON вернется: vrs (errorCode, reqId, status =
    VERIFICATION_FAILED).

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077453783/doc/msp

Пример успешного ответа:

Code: 200 OK

{

\"id\": \"298d3075-bf78-4676-8a8b-f3de5e49c083\",

\"orgOid\": 1077453783,

\"data\": {

\"legalInfo\": {

\"dateMsp\": \"2016-08-01\",

\"typeSubjectMsp\": \"1\",

\"categorySubjectMsp\": \"3\",

\"inn\": \"5123422222\",

\"ogrn\": \"1094173422222\",

\"orgNewMsp\": \"2\",

\"infoSocOrg\": \"1\",

\"infoWorker\": \"10\",

\"address\": {

\"regionCode\": \"77\",

\"region\": {

\"regionType\": \"ГОРОД\",

\"regionName\": \"МОСКВА\"

}

},

\"economicActivitiesType\": {

\"mainEconomicActivity\": {

\"economicActivityCode\": \"64.20.1\",

\"economicActivityName\": \"ДЕЯТЕЛЬНОСТЬ В ОБЛАСТИ ТЕЛЕФОННОЙ СВЯЗИ И
ДОКУМЕНТАЛЬНОЙ ЭЛЕКТРОСВЯЗИ\",

\"catalogVersion\": \"2001\"

},

\"additionalEconomicActivities\": \[

{

\"economicActivityCode\": \"51.70\",

\"economicActivityName\": \"ПРОЧАЯ ОПТОВАЯ ТОРГОВЛЯ\",

\"catalogVersion\": \"2001\"

},

{

\"economicActivityCode\": \"52.12\",

\"economicActivityName\": \"ПРОЧАЯ РОЗНИЧНАЯ ТОРГОВЛЯ В
НЕСПЕЦИАЛИЗИРОВАННЫХ МАГАЗИНАХ\",

\"catalogVersion\": \"2001\"

},

{

\"economicActivityCode\": \"64.11.14\",

\"economicActivityName\": \"ПРОЧАЯ ДЕЯТЕЛЬНОСТЬ ПОЧТОВОЙ СВЯЗИ\",

\"catalogVersion\": \"2001\"

},

{

\"economicActivityCode\": \"64.20.2\",

\"economicActivityName\": \"ДЕЯТЕЛЬНОСТЬ В ОБЛАСТИ ПЕРЕДАЧИ (ТРАНСЛЯЦИИ)
И РАСПРЕДЕЛЕНИЯ ПРОГРАММ ТЕЛЕВИДЕНИЯ И РАДИОВЕЩАНИЯ\",

\"catalogVersion\": \"2001\"

},

{

\"economicActivityCode\": \"64.20.3\",

\"economicActivityName\": \"ПРОЧАЯ ДЕЯТЕЛЬНОСТЬ В ОБЛАСТИ
ЭЛЕКТРОСВЯЗИ\",

\"catalogVersion\": \"2001\"

}

\]

},

\"licenses\": \[

{

\"numberLicense\": \"108565 1\",

\"dateLicense\": \"2013-05-07\",

\"dateBeginLicense\": \"2013-05-07\",

\"dateEndLicense\": \"2018-05-07\",

\"issuingOrganization\": \"ФЕДЕРАЛЬНАЯ СЛУЖБА ПО НАДЗОРУ В СФЕРЕ СВЯЗИ,
ИНФОРМАЦИОННЫХ ТЕХНОЛОГИЙ И МАССОВЫХ КОММУНИКАЦИЙ\",

\"licenseActivityNames\": \[

\"УСЛУГИ СВЯЗИ ПО ПЕРЕДАЧЕ ДАННЫХ, ЗА ИСКЛЮЧЕНИЕМ УСЛУГ СВЯЗИ ПО
ПЕРЕДАЧЕ ДАННЫХ ДЛЯ ЦЕЛЕЙ ПЕРЕДАЧИ ГОЛОСОВОЙ ИНФОРМАЦИИ\"

\]

}

\],

\"products\": \[

{

\"productCode\": \"61.20.20.000-0000\",

\"productName\": \"Услуги операторов связи в сфере беспроводных
телекоммуникаций\",

\"productInnovation\": \"1\"

},

{

\"productCode\": \"61.20.30.110-0000\",

\"productName\": \"Услуги подвижной связи для целей передачи голоса\",

\"productInnovation\": \"2\"

},

{

\"productCode\": \"63.99.10.140-0000\",

\"productName\": \"Услуги компьютерные информационные телефонной
связи\",

\"productInnovation\": \"1\"

},

{

\"productCode\": \"63.99.10.140-0000\",

\"productName\": \"Услуги компьютерные информационные телефонной
связи\",

\"productInnovation\": \"1\"

}

\],

\"partnershipPrograms\": \[

{

\"partnershipProgramName\": \"ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ
\\\"ЕВРОСЕТЬ-РИТЕЙЛ\\\"\",

\"partnershipProgramINN\": \"7714617793\",

\"partnershipProgramNumber\": \"ЕСЕТЬ-1\",

\"partnershipProgramDate\": \"2015-06-07\"

},

{

\"partnershipProgramName\": \"ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ
\\\"КОМПЬЮТЕРНЫЙ ЦЕНТР ДНС\\\"\",

\"partnershipProgramINN\": \"2536120293\",

\"partnershipProgramNumber\": \"ДНС-98-2015\",

\"partnershipProgramDate\": \"2015-12-28\"

}

\],

\"contracts\": \[

{

\"contractNameOrg\": \"ФГБУЗ ЦСМ ФМБА России\",

\"contractOrgInn\": \"7730102110\",

\"contractSubject\": \"Оказание услуг связи: доступ к сети Интернет по
универсальной беспроводной технологии 4G LTE\",

\"contractRegistryNumber\": \"1\",

\"contractDate\": \"2012-03-05\"

},

{

\"contractNameOrg\": \"Государственное унитарное предприятие
\\\"Агентство по государственному заказу, инвестиционной деятельности и
межрегиональным связям Республики Татарстан\\\"\",

\"contractOrgInn\": \"1655043818\",

\"contractSubject\": \"Услуги связи YOTA\",

\"contractRegistryNumber\": \"2\",

\"contractDate\": \"2014-10-29\"

}

\],

\"agreements\": \[\],

\"fullName\": \"Новая Надежда\"

}

},

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 56,

\"createdOn\": \"2022-04-03T18:30:18.911\",

\"updatedOn\": \"2022-07-05T17:03:37.945\",

\"verifiedOn\": \"2022-06-16\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/3325111/464686c2-1847-10f0-ac86-83166b92c097.xml/40\",

\"location\": \"00\",

\"objectId\": \"3325111\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"464686c2-1847-10f0-ac86-83166b92c097.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/3325111/464686c2-1847-10f0-ac86-83166b92c097.xml/40\",

\"location\": \"00\",

\"objectId\": \"3325111\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"464686c2-1847-10f0-ac86-83166b92c097.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

#### Проверка запуска обновления сведений из реестра МСП в ведомстве 

Для проверки запуска обновления сведений о наличии счетов организаций и
ИП\
в банках система-клиент должна направить в https-адрес REST API системы
ЕСИА запрос методом GET. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

/api/public/{version}/org/{org_oid}/doc/msp/check,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями;

-   msp -- название сведения;

-   сheck -- проверка запущенности обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (scope в зависимости от полномочий
системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_msp?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

В ответе возвращается объект с информацией о запущенной проверке.\
Если проверка не выполняется, то ошибка: HTTP 404 -- Not found.

Параметры запроса:

-   org_oid -- идентификатор Организации или ИП.

Если не запущено обновление в ФНС России:

Code: 404 -- Not found

Если запущено обновление в ФНС России:

-   expiresOn -- время действия запроса;

-   orgOid -- идентификатор Организации или ИП;

-   requestIds -- идентификаторы запросов в СМЭВ.

Code: 200 OK

Параметры ответа: 

{

\"expiresOn\": \"2022-06-28T15:38:50.068Z\",

\"orgOid\": 0,

\"requestIds\": \[0\]

}

#### Запуск обновления сведений из реестра МСП

Для запуска обновления сведений о наличии счетов организаций и ИП в
банках система-клиент должна направить в https-адрес REST API системы
ЕСИА запрос методом POST. В запросе должен быть указан ресурс,
содержащий необходимые данные. Идентификатор этого ресурса в ЕСИА имеет
следующий вид:

/digital-org/api/public/{version}/org/{org_oid}/doc/msp/refresh,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями;

-   msp -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Параметры запроса:

-   org_oid -- идентификатор Организации или ИП.

Параметры ответа:

-   expiresOn -- время действия запроса;

-   orgOid -- идентификатор Организации или ИП;

-   requestIds -- идентификаторы запросов в СМЭВ.

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481741/doc/bank-account/refresh

Пример ответа:

{

expiresOn: \"2022-10-05T09:14:13.167+0000\"

orgOid: 1077481741

requestIds: \[4332553\]

}

### Управление сведениями о наличии счетов организаций и ИП в банках

В разделе «Банковские карты и счета» на вкладке «Счета» могут быть
доступны отдельные сведения о наличии счетов организаций и ИП в банках.
Они загружаются\
в ЛК из ФНС России при запросе или обновлении данных.

Запрос и обновление сведений о наличии счетов организаций и ИП в банках
доступны при наличии ранее выданного согласия Минцифры России в разделе
«Банковские карты и счета» на вкладке «Счета» (подробная информация
приведена в п. А.7.1.6).

Доступность функций для пользователя зависит от его роли и полномочий
(таблица 61).

Таблица 61 -- Доступность функций в зависимости от ролей и полномочий

  ------------------------------------------------------------------------------------------------------------------------
  **Действие/ Роль**  **Руково-дитель**   **Админи-стратор**   **Сотру-дник**   **Сотрудник с                 
                                                                                полномочиями**                
  ------------------- ------------------- -------------------- ---------------- ---------------- ------------ ------------
                                                                                **«Право запроса **«Право     **«Право
                                                                                выписки» \       просмотра    Запроса
                                                                                и «Право         выписки»**   выписки»**
                                                                                управления                    
                                                                                согласиями                    
                                                                                организации»**                

  Просмотр списка     Да                  Да                   Нет              Да               Да           Да
  сведений\                                                                                                   
  о наличии счетов                                                                                            
  организаций\                                                                                                
  и ИП в банках                                                                                               

  Запрос/Обновление   Да                  Да                   Нет              Да               Нет          Нет
  сведений\                                                                                                   
  о наличии счетов                                                                                            
  организаций\                                                                                                
  и ИП в банках                                                                                               

  Выгрузка сведений\  Да                  Да                   Нет              Да               Да           Да
  о наличии счетов                                                                                            
  организаций\                                                                                                
  и ИП в банках (pdf                                                                                          
  или все 4 документа                                                                                         
  архивом)                                                                                                    
  ------------------------------------------------------------------------------------------------------------------------

#### Предоставление сведений о наличии счетов организаций и ИП в банках

Для получения сведений о наличии счетов организаций и ИП в банках были
разработаны внешние сервисы REST API ЕСИА для ЮЛ, ОГВ и ИП для
обеспечения внутреннего взаимодействия со смежными системами ИЭП и
вывода сведений о наличии счетов организаций и ИП в банках в специальном
разделе ЛК организации ЕПГУ:

-   получение сведений о наличии счетов организаций и ИП в банках;

-   проверка запуска обновления сведений о наличии счетов организаций и
    ИП\
    в банках;

-   запуск обновления сведений о наличии счетов организаций и ИП в
    банках.

#### Получение сведений о наличии счетов организаций и ИП в банках

Для получения сведений о наличии счетов организаций и ИП в банках
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом GET.\
В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

/api/public/{version}/org/{org_oid}/doc/bank-account,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии счетов организаций и ИП в
    банках;

-   bank_account -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_bank_account?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\"

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/bank-account

Пример успешного ответа:

Code: 200 OK

\[

{

\"id\": \"2ab76e29-a5ba-4e93-9437-aa71e74ba3c9\",

\"orgOid\": 1077481776,

\"data\": \[

{

\"docId\": \"a\",

\"docDate\": \"1957-08-13\",

\"orgInfo\": {

\"individualInfo\": {

\"inn\": \"010000000000\",

\"individualName\": {

\"firstName\": \"Алексей\",

\"lastName\": \"Филипов\",

\"middleName\": \"Александрович\"

},

\"ogrn\": \"000000000000000\"

}

},

\"bankAccounts\": \[

{

\"bank\": {

\"regNumber\": \"А777\",

\"branchNumber\": \"5555\",

\"name\": \"Супер Банк\",

\"bik\": \"000000000\",

\"inn\": \"0100000000\"

},

\"accounts\": \[

{

\"number\": \"40817810099910004312\",

\"openDate\": \"2020-08-13\",

\"changeDate\": \"2020-08-13\",

\"closeDate\": \"2021-08-13\",

\"type\": \"a\",

\"statusCode\": \"1\"

}

\]

}

\]

}

\],

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 2,

\"createdOn\": \"2022-07-14T14:17:53.886\",

\"updatedOn\": \"2022-07-14T14:17:58.254\",

\"verifiedOn\": \"2022-07-14\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"s3://00/4103989/EPGU_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf/40\",

\"location\": \"00\",

\"objectId\": \"4103989\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGU_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.pdf\",

\"mimeType\": \"PDF\"

},

\"signLink\": {

\"originLink\":
\"s3://00/4103989/EPGU_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C/41\",

\"location\": \"00\",

\"objectId\": \"4103989\",

\"objectTypeId\": \"41\",

\"mnemonic\":
\"EPGU_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612_PDF.P7C\",

\"mimeType\": \"PKCS7\"

},

\"main\": false

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4103989/OPIS_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4103989\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

},

{

\"fileLink\": {

\"originLink\":
\"s3://00/4103989/EPGUFULL_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4103989\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"EPGUFULL_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": false

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"s3://00/4103989/OPIS_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml/40\",

\"location\": \"00\",

\"objectId\": \"4103989\",

\"objectTypeId\": \"40\",

\"mnemonic\":
\"OPIS_SVSCHETBANK_20220530_10a22db9-e01d-11ec-add9-3e153c423612.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

\]

Структура ответа в формате JSON:

-   orgOid -- идентификатор (oid) организации или ИП;

-   id -- идентификатор записи документа (уникальный);

-   relevanc -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   data -- вложения ответа в формате JSON;

-   docId -- идентификатор документа;

-   docDate -- дата документа;

-   numberСorrecti -- номер корректировки для корректирующего документа;

-   orgInfo -- сведения о российской организации:

    -   legalInfo -- юридическое лицо:

    -   name -- наименование организации;

    -   inn -- ИНН организации;

    -   kpp -- КПП организации;

    -   ogrn -- ОГРН организации;

-   individualInfo -- индивидуальный предприниматель:

    -   inn -- ИНН физического лица;

    -   ogrn -- ОГРН индивидуального предпринимателя;

    -   individualName -- фамилия, имя, отчество:

    -   lastName -- фамилия;

    -   firstName -- имя;

    -   middleName -- отчество;

-   bankAccounts -- сведения о банковском счете:

    -   bank -- сведения о банке (филиале банка), учреждении Банка
        России:

-   regNumber -- регистрационный номер банка по КГРКО;

-   branchNumber -- порядковый номер филиала банка по КРГО;

-   name -- сокращенное наименование банка (филиала банка), учреждения
    Банка России;

-   bik -- БИК банка (филиала банка), учреждения Банка России,
    используемый в расчетах БИК;

-   inn -- ИНН банка (филиала банка), учреждения Банка России;

-   accounts -- сведения о банковском счете:

    -   number -- номер счета;

    -   openDate -- дата открытия счета (депозита);

    -   changeDate -- дата изменения счета (депозита);

    -   closeDate -- дата закрытия счета (депозита);

    -   type -- вид счета (депозита);

    -   statusCode -- код состояния счета (депозита);

-   mainAttachment -- главный файл вложения -- файл описи;

-   attachments -- файлы вложений в описи ФНС России (файлы: xml,
    подпись, pdf, подпись, сам файл описи). Если вложения не пришли от
    ФНС России, то поля пустые;

-   fileLink -- блок информации о файле;

-   signLink -- блок информации о подписи;

-   location -- локация файла;

-   mimeType -- тип файла. Может принимать значения: \"PDF\" (файл),
    \"PKCS7\" (подпись), \"XML\" (файл), \"PKCS7\" (подпись);

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла. Принимает значения: 40 (если файл
    вложения имеет формат .xml и .pdf, либо это файл описи .xml);

-   mnemonic -- мнемоника файлов-вложений ответа от ФНС России со
    сведениями выписки о наличии счетов организаций и ИП в банках;

-   main -- признак главного файла описи. Может принимать значения true\
    или false;

-   vrs -- блок сведений при технических ошибках:

    -   errorCode -- код технической ошибки;

    -   reqId -- идентификатор отправленного запроса в ФНС России;

    -   status -- статус технической ошибки.

Возможные коды ошибок приведены в таблице 62.

Таблица 62 -- Возможные коды ошибок

  -------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- -------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ЮЛ
  пользователь не является руководителем ЮЛ 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}   пользователя

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  -------------------------------------------------------------------------

#### Проверка запуска обновления сведений о наличии счетов организаций и ИП в банках 

Для проверки запуска обновления сведений о наличии счетов организаций и
ИП\
в банках система-клиент должна направить в https-адрес REST API системы
ЕСИА запрос методом GET. В запросе должен быть указан ресурс, содержащий
необходимые данные. Идентификатор этого ресурса в ЕСИА имеет следующий
вид:

/api/public/{version}/org/{org_oid}/doc/bank-account/check,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии счетов организаций и ИП в
    банках;

-   bank_account -- название сведения;

-   сheck -- проверка запущенности обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_bank_account?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/bank-account/check

Пример ответа (не запущено обновление сведений ФНС России):

Code: 404 -- Not Found

Пример ответа (уже было запущено обновление сведений в ФНС России):

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 63.

Таблица 63-- Возможные коды ошибок

  -------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- -------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ЮЛ
  пользователь не является руководителем ЮЛ 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}   пользователя

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  -------------------------------------------------------------------------

#### Запуск обновления сведений о наличии счетов организаций и ИП в банках

Для запуска обновления сведений о наличии счетов организаций и ИП в
банках система-клиент должна направить в https-адрес REST API системы
ЕСИА запрос методом POST. В запросе должен быть указан ресурс,
содержащий необходимые данные. Идентификатор этого ресурса в ЕСИА имеет
следующий вид:

/api/public/{version}/org/{org_oid}/doc/bank-account/refresh,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии счетов организаций и ИП в
    банках;

-   bank_account -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077481776/doc/bank-account/refresh

Пример успешного ответа:

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА,\
    у которой проверяется наличие согласия Минцифры России;

-   expiresOn -- дата запуска обновления.

Возможные коды ошибок приведены в таблице 64.

Таблица 64 -- Возможные коды ошибок

  -------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- -------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ЮЛ
  пользователь не является руководителем ЮЛ 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}   пользователя

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  -------------------------------------------------------------------------

### Управление сведениями о наличии действующих решений о приостановлении операций по счетам налогоплательщика

В разделе «Банковские карты и счета» на вкладке «Счета» могут быть
доступны отдельные сведения о наличии действующих решений о
приостановлении операций\
по счетам налогоплательщика. Они загружаются в ЛК из ФНС России при
запросе\
или обновлении данных.

Запрос и обновление сведений о наличии действующих решений\
о приостановлении операций по счетам налогоплательщика доступны при
наличии ранее выданного согласия Минцифры России в разделе «Банковские
карты и счета» на вкладке «Счета» (подробная информация о согласиях
Минцифры России приведена в п. А.7.1.6).

Доступность функций для пользователя зависит от его роли, полномочий и
наличия выданного согласия Минцифры России (таблица 65).

Таблица 65 -- Доступность функций в зависимости от ролей и полномочий

+-------------+------------------+---------------+--------------------+
| **Роль**    | **Полномочия**   | **Доступность |                    |
|             |                  | действий**    |                    |
+=============+==================+===============+====================+
|             |                  | **Просмотр    | **Запрос/          |
|             |                  | сведений**    | Обновление**       |
+-------------+------------------+---------------+--------------------+
| **Р         | **-**            | Да            | Да                 |
| уководитель |                  |               |                    |
| ЮЛ / ИП**   |                  |               |                    |
+-------------+------------------+---------------+--------------------+
| **Адми      | **-**            | Да            | Да                 |
| нистратор** |                  |               |                    |
+-------------+------------------+---------------+--------------------+
| **          | **-**            | Нет           | Нет                |
| Сотрудник** |                  |               |                    |
+-------------+------------------+---------------+--------------------+
|             | Полномочие на    | Да            | Нет                |
|             | просмотр         |               |                    |
|             | сведений\        |               |                    |
|             | о наличии счетов |               |                    |
|             | организаций\     |               |                    |
|             | и ИП в банках    |               |                    |
+-------------+------------------+---------------+--------------------+
|             | Полномочие на    | Да            | Да *(при наличии   |
|             | запрос сведений\ |               | выданного согласия |
|             | о наличии счетов |               | Минцифры России)*  |
|             | организаций\     |               |                    |
|             | и ИП в банках    |               |                    |
+-------------+------------------+---------------+--------------------+
|             |                  |               | Нет *(при          |
|             |                  |               | отсутствии         |
|             |                  |               | выданного согласия |
|             |                  |               | Минцифры России)*  |
+-------------+------------------+---------------+--------------------+
|             | Полномочие на    | Да            | Да                 |
|             | запрос сведений\ |               |                    |
|             | о наличии счетов |               |                    |
|             | организаций\     |               |                    |
|             | и ИП в банках,   |               |                    |
|             |                  |               |                    |
|             | Полномочие на    |               |                    |
|             | выдачу согласия  |               |                    |
|             | Минцифры России  |               |                    |
+-------------+------------------+---------------+--------------------+

#### Предоставление сведений о наличии действующих решений о приостановлении операций по счетам налогоплательщика

Для получения и вывода в специальном разделе ЛК организации ЕПГУ
сведений\
о наличии действующих решений о приостановлении операций по счетам
налогоплательщика, а также для обеспечения внутреннего взаимодействия со
смежными системами ИЭП предназначены внешние сервисы REST API ЕСИА для
ЮЛ, ОГВ и ИП:

-   получение сведений о наличии действующих решений о приостановлении
    операций по счетам налогоплательщика;

-   проверка запуска обновления сведений о наличии действующих решений
    о приостановлении операций по счетам налогоплательщика;

-   запуск обновления сведений о наличии действующих решений
    о приостановлении операций по счетам налогоплательщика;

-   отмена обновления сведений о наличии действующих решений
    о приостановлении операций по счетам налогоплательщика.

#### Получение сведений о наличии действующих решений о приостановлении операций по счетам налогоплательщика

Для получения сведений о наличии действующих решений о приостановлении
операций по счетам налогоплательщика система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом GET. В запросе должен
быть указан ресурс, содержащий необходимые данные. Идентификатор этого
ресурса в ЕСИА имеет следующий вид:

/api/public/{version}/org/{org_oid}/doc/bank-account-block,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии действующих решений\
    о приостановлении операций по счетам налогоплательщика;

-   bank-account-block -- название сведения.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_bank_acc_block?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\"

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/v1/org/1077482916/doc/bank-account-block

Пример успешного ответа:

Code: 200 OK

{

\"id\": \"3449d870-4d84-4374-aca8-ed846fabd33d\",

\"orgOid\": 1077482916,

\"data\": {

\"legalInfo\": {

\"name\": \"ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ
\\\"АВТ-ДОРСТРОЙ\\\"\",

\"inn\": \"6321137880\"

},

\"individualInfo\": {},

\"requestResult\": \"1\",

\"requestBik\": \"041203729\",

\"requestDate\": \"2022-11-07T11:05:15\",

\"decisions\": \[

{

\"number\": \"8002\",

\"date\": \"2019-10-02\",

\"fnsCode\": \"6350\",

\"bik\": \"043601878\",

\"databaseDate\": \"2019-10-03T08:27:25\"

},

{

\"number\": \"8001\",

\"date\": \"2019-10-02\",

\"fnsCode\": \"6350\",

\"bik\": \"042202803\",

\"databaseDate\": \"2019-10-03T08:27:25\"

},

{

\"number\": \"8000\",

\"date\": \"2019-10-02\",

\"fnsCode\": \"6350\",

\"bik\": \"044525187\",

\"databaseDate\": \"2019-10-03T08:27:24\"

},

{

\"number\": \"19731\",

\"date\": \"2019-09-12\",

\"fnsCode\": \"3443\",

\"bik\": \"043601878\",

\"databaseDate\": \"2019-09-12T16:15:39\"

},

{

\"number\": \"17119\",

\"date\": \"2014-12-19\",

\"fnsCode\": \"3443\",

\"bik\": \"043601927\",

\"databaseDate\": \"2014-12-19T14:01:06\"

}

\]

},

\"relevance\": \"ACTUAL\",

\"status\": \"VERIFIED_BY_REQUEST\",

\"version\": 1,

\"createdOn\": \"2022-11-10T16:57:00.981\",

\"updatedOn\": \"2022-11-10T16:57:11.252\",

\"verifiedOn\": \"2022-11-10\",

\"attachments\": \[

{

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4686728/503d1c71-63df-d666-d99f-9029adc15728.xml/40\",

\"location\": \"00\",

\"objectId\": \"4686728\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"503d1c71-63df-d666-d99f-9029adc15728.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

\],

\"mainAttachment\": {

\"fileLink\": {

\"originLink\":
\"terrabyte://00/4686728/503d1c71-63df-d666-d99f-9029adc15728.xml/40\",

\"location\": \"00\",

\"objectId\": \"4686728\",

\"objectTypeId\": \"40\",

\"mnemonic\": \"503d1c71-63df-d666-d99f-9029adc15728.xml\",

\"mimeType\": \"XML\"

},

\"main\": true

}

}

Структура ответа в формате JSON:

-   id -- идентификатор записи документа (уникальный);

-   orgOid -- идентификатор (oid) организации или ИП;

-   data -- вложения ответа в формате JSON;

```{=html}
<!-- -->
```
-   legalInfo -- юридическое лицо:

-   name -- наименование организации;

-   inn -- ИНН организации;

-   individualInfo -- индивидуальный предприниматель:

-   inn -- ИНН физического лица;

-   individualName -- фамилия, имя, отчество:

-   lastName -- фамилия;

-   firstName -- имя;

-   middleName -- отчество;

```{=html}
<!-- -->
```
-   requestResult -- результат запроса (0 -- действующие решения\
    о приостановлении отсутствуют; 1 -- действующие решения о
    приостановлении имеются);

-   requestBik -- БИК банка (филиала банка), учреждения Банка России,
    выполняющего запрос;

-   requestDate -- дата и время получения запроса;

-   decisions -- список решений о приостановлении операций по счетам
    налогоплательщика;

-   number -- номер решения о приостановлении;

-   date -- дата решения о приостановлении;

-   fnsCode -- код налогового органа;

-   bik -- БИК банка, в который направлено решение;

-   databaseDate -- дата и время поступления информации в федеральную
    БД;

-   bankName -- наименование банка, в который направлено решение;

-   relevance -- релевантность документа;

-   status -- статус достоверности данных;

-   version -- версия документа (изменяется при каждом обновлении на 1);

-   verified_on -- дата актуальности информации;

-   createdOn -- дата первоначального запроса данных;

-   updatedOn -- дата последнего запроса данных;

-   attachments -- файлы xml;

-   fileLink -- блок информации о файле;

-   originLink -- ссылка на файл в хранилище (например,
    s3://00/3081820/response.pdf/40);

-   location -- локация файла;

-   objectId -- идентификатор файла;

-   objectTypeId -- тип файла, принимает значение: «40»;

-   mnemonic -- мнемоника файлов-вложений ответа от ФНС России со
    сведениями выписки о наличии действующих решений о приостановлении
    операций\
    по счетам налогоплательщика;

-   mimeType -- тип файла, принимает значение: «XML»;

-   main -- признак главного файла описи. Может принимать значения true\
    или false;

-   mainAttachment -- главный файл вложения;

-   vrs -- блок сведений при технических ошибках:

```{=html}
<!-- -->
```
-   errorCode -- код технической ошибки;

-   reqId -- идентификатор отправленного запроса в ФНС России;

-   status -- статус технической ошибки.

Возможные коды ошибок приведены в таблице 66.

Таблица 66 -- Возможные коды ошибок

  -------------------------------------------------------------------------
  **Ошибка**                                **Описание ошибки**
  ----------------------------------------- -------------------------------
  HTTP CODE:   400 {\"code\":   \"          Данный пользователь не является
  ESIA-058012\", \"message\": \"Данный      руководителем ЮЛ
  пользователь не является руководителем ЮЛ 
  \"}                                       

  HTTP CODE:   401 {\"code\":\"             Не указан токен авторизации
  ESIA-005013\", \"message\": \"Токен       
  отсутствует \"}                           

  HTTP CODE:   403 {\"code\": \"            Указание в URL запроса
  ESIA-005029\", \"message\":               организации другого
  \" SecurityErrorEnum.scopeNotAllowed\"}   пользователя

  HTTP CODE:   404 {\"code\": \"            Документ не найден
  ESIA-020203\", \"message\": \" Not        
  Found\"}                                  
  -------------------------------------------------------------------------

#### Проверка запуска обновления сведений о наличии действующих решений о приостановлении операций по счетам налогоплательщика 

Для проверки запуска обновления сведений о наличии действующих решений\
о приостановлении операций по счетам налогоплательщика система-клиент
должна направить в https-адрес REST API системы ЕСИА запрос методом GET.
В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса\
в ЕСИА имеет следующий вид:

/api/public/{version}/org/{org_oid}/doc/bank-account-block/check,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии счетов организаций и ИП в
    банках;

-   bank-account-block -- название сведения;

-   сheck -- проверка запущенного обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_inf?org_oid={p.org_oid}\";

-   \"org_ful?org_oid={p.org_oid}\";

-   \"org_bank_acc_block?org_oid={p.org_oid}\";

-   \"org_profile?org_oid={p.org_oid}\".

Пример запроса (вызов сервиса в тестовой среде):

GET https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/%7Bversion%7D/org/1077482916/doc/bank-account-block/check

Пример ответа (не запущено обновление сведений ФНС России):

Code: 404 -- Not Found

Пример ответа (уже было запущено обновление сведений в ФНС России):

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА;

-   expiresOn -- время действия запроса.

Возможные коды ошибок приведены в таблице 66.

#### Запуск обновления сведений о наличии действующих решений о приостановлении операций по счетам налогоплательщика

Для запуска обновления сведений о наличии действующих решений\
о приостановлении операций по счетам налогоплательщика система-клиент
должна направить в https-адрес REST API системы ЕСИА запрос методом
POST. В запросе должен быть указан ресурс, содержащий необходимые
данные. Идентификатор этого ресурса\
в ЕСИА имеет следующий вид:

/api/public/{version}/org/{org_oid}/doc/bank-account-block/refresh,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии счетов организаций и ИП в
    банках;

-   bank-account-block -- название сведения;

-   refresh -- запуск обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (scope в зависимости от полномочий
системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

POST https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/%7Bversion%7D/org/1077482916/doc/bank-account-block/refresh

Пример успешного ответа:

Code: 200 ОК

{

\"requestIds\": \[

4103989

\],

\"orgOid\": 1077481776,

\"expiresOn\": \"2022-08-13T11:17:55.134+0000\"

}

Структура ответа в формате JSON:

-   requestIds -- идентификаторы запроса сведений;

-   orgOid -- внутренний идентификатор организации в ЕСИА, у которой
    проверяется наличие согласия Минцифры России;

-   expiresOn -- время действия запроса.

Возможные коды ошибок приведены в таблице 66.

#### Отмена обновления сведений о наличии действующих решений о приостановлении операций по счетам налогоплательщика

Для отмены обновления сведений о наличии действующих решений\
о приостановлении операций по счетам налогоплательщика система-клиент
должна направить в https-адрес REST API системы ЕСИА запрос методом
POST. В запросе должен быть указан ресурс, содержащий необходимые
данные. Идентификатор этого ресурса\
в ЕСИА имеет следующий вид:

/api/public/{version}/org/{org_oid}/doc/bank-account-block/refresh/cancel,

где:

-   org -- организация, зарегистрированная в ЕСИА;

-   org_oid -- внутренний идентификатор организации, у которой
    проверяется наличие согласия Минцифры России;

-   doc -- документ со сведениями о наличии счетов организаций и ИП в
    банках;

-   bank-account-block -- название сведения;

-   refresh/cancel -- запуск отмены обновления сведений.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (область доступа (scope) в зависимости
от полномочий системы).

Область доступа (scope): 

-   \"org_idm?org_oid={p.org_oid}\";

-   \"org_inf?org_oid={p.org_oid}&mode=w\";

-   \"org_profile?org_oid={p.org_oid}&mode=w\".

Пример запроса (вызов сервиса в тестовой среде):

POST https://esia-portal1.test.gosuslugi.ru/digital-org/api/public/%7Bversion%7D/org/1077482916/doc/bank-account-block/refresh/cancel

Пример успешного ответа:

Code: 200 ОК

Возможные коды ошибок приведены в таблице 66.

### Управление приглашениями должностным лицам, зарегистрированным в ЕСИА, на присоединение к УЗ соответствующей организации

Программный интерфейс ЕСИА позволяет выполнять следующие функции:

-   просмотр отправленных, но не принятых приглашений;

-   формирование нового приглашения;

-   отзыв ранее отправленного приглашения.

Для просмотра отправленных приглашений необходимо сделать запрос на
https-адрес программного интерфейса ЕСИА методом GET[^38]. Заголовок
запроса должен включать в себя маркер доступа. Пример запроса (вызов
сервиса в тестовой среде):

GET /rs/orgs/1000000001/invts HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

В качестве ответа ЕСИА возвращает перечень приглашений на присоединение\
к данной организации. Пример ответа:

{

\"stateFacts\": \[

\"LastPage\",

\"Paginated\",

\"FirstPage\"

\],

\"pageSize\": 10,

\"pageIndex\": 1,

\"elements\": \[

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000001/invts/671621\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000001/invts/671620\",

\"https://esia-portal1.test.gosuslugi.ru/rs/orgs/1000000001/invts/671600\"

\]

}

Для получения данных об отдельном приглашении необходимо выполнить
запрос методом GET по адресу с данными конкретного приглашения. Каждое
приглашение описывается следующими параметрами:

-   \<invtId\> -- идентификатор приглашения;

-   \<eTag\> -- тег записи приглашения;

-   \<email\> -- адрес, на который было отправлено приглашение;

-   \<firstName\> -- имя приглашаемого сотрудника;

-   \<lastName\> -- фамилия приглашаемого сотрудника;

-   \<middleName\> -- отчество приглашаемого сотрудника (необязательно);

-   \<snils\> -- СНИЛС приглашаемого сотрудника (необязательно);

-   \<status\> -- статус приглашения (принимает значение «A» (активно) и
    «I» (инициировано, но не отправлено));

-   \<createdOn\> -- дата отправления приглашения;

-   \<groups\> -- группа, в которую будет включен пользователь
    (указывается мнемоника группы) (необязательно).

Пример описания приглашения:

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"eTag\": \"E4EFE25E314136A0EB0DC4EB68DF4B5C185D3E4E\",

\"invtId\": 671600,

\"email\": \"test@mail.ru\",

\"firstName\": \"Иван\",

\"lastName\": \"Иванов\",

\"middleName\": \"Владимирович\",

\"status\": \"A\",

\"createdOn\": \"23.10.2015\",

\"groups\": \[

\"ORG_ADMIN\"

\]

}

Чтобы отправить приглашение, необходимо сделать запрос на https-адрес
программного интерфейса ЕСИА методом PUT[^39]. Заголовок запроса должен
включать\
в себя маркер доступа, а тело запроса должно включать следующие данные:

-   \<email\> -- адрес, на который отправлять приглашение;

-   \<firstName\> -- имя приглашаемого сотрудника;

-   \<lastName\> -- фамилия приглашаемого сотрудника;

-   \<middleName\> -- отчество приглашаемого сотрудника (необязательно);

-   \<snils\> -- СНИЛС приглашаемого сотрудника (необязательно).

Пример запроса (разрывы строки даны для удобства чтения):

PUT /rs/orgs/1000000001/invts HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

{

\"email\": \"test@yandex.ru\",

\"snils\": \"000--333--333 66\",

\"firstName\": \"Михаил\",

\"lastName\": \"Иванов\",

\"middleName\": \"Иванович\"

}

Чтобы удалить приглашение, необходимо сделать запрос на https-адрес
программного интерфейса ЕСИА методом DELETE[^40]. Заголовок запроса
должен включать в себя маркер доступа. Пример запроса (вызов сервиса в
тестовой среде):

DELETE /rs/orgs/1000000001/invts/671774 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

### Управление служебными данными присоединенных сотрудников, а также блокировка и удаление должностных лиц организации

Для изменения данных сотрудника организации, в том числе изменения
признака блокировки, необходимо сделать запрос на https-адрес
программного интерфейса ЕСИА методом POST[^41]. Заголовок запроса должен
включать в себя маркер доступа, тег данных сотрудника (метка, полученная
при запросе ресурса:
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/emps/{emp_id}).

Тело запроса должно включать следующие данные (все параметры
обязательны):

-   \<eTag\> -- тег данных сотрудника;

-   \<position\> -- должность сотрудника;

-   \<corporateContact\> -- адрес электронной почты сотрудника;

-   \<blocked\> -- признак блокировки («false» -- не заблокирован,
    «true» --\
    заблокирован).

Если какой-либо параметр не будет указан, то он будет очищен.

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/emps/1000000128 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

If--Match: \"523E509CBEB781E992EFC503CBC878AC67BAD414\"

Cache--Control: no--cache

{

\"eTag\": \"523E509CBEB781E992EFC503CBC878AC67BAD414\",

\"position\": \"должность\",

\"corporateContact\": \"test@example3.com\",

\"blocked\": false

}

Для удаления сотрудника необходимо сделать запрос на https-адрес
программного интерфейса ЕСИА методом DELETE[^42]. Заголовок запроса
должен включать в себя маркер доступа. Пример запроса (вызов сервиса в
тестовой среде):

DELETE /rs/orgs/1000000001/emps/1000000128 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

### Управление полномочиями должностных лиц посредством изменения их членства в группах доступа

Чтобы включить сотрудника в группу, необходимо знать его идентификатор,
мнемонику группы и мнемонику системы, к которой принадлежит данная
группа.

Добавление сотрудника в группу осуществляется запросом методом PUT\
на следующий https-адрес программного интерфейса ЕСИА:

https://esia-portal1.test.gosulsugi.ru/rs/orgs/1000000001/emps/{emp_id}/grps/{grp_id}/{it_sys_id}

Параметр \<it_sys_id\> -- мнемоника ИС, в рамках которой создана данная
группа. Пример запроса (вызов сервиса в тестовой среде):

PUT /rs/orgs/1000000001/emps/1000023747/grps/ORG_ADMIN/ESIA HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Данный запрос включает сотрудника с идентификатором 1000023747 в группу
«Администраторы профиля организации», принадлежащей ЕСИА.

Для исключения сотрудника из группы нужно вызвать программный интерфейс
ЕСИА по указанному выше адресу (адрес для добавления сотрудника в
группу) методом DELETE. Пример запроса (вызов сервиса в тестовой среде):

DELETE /rs/orgs/1000000001/emps/1000023747/grps/ORG_ADMIN/ESIA HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

### Управление доступом к непубличным группам

Программный интерфейс позволяет предоставить другой организации доступ
к непубличной группе (если организация, вызывающая сервис, является
владельцем данной группы), а также отозвать доступ.

Пусть организация с идентификатором 1000000001 -- владелец приватной
группы RA.USR_CFM («Операторы системы подтверждения личности»). С
помощью программного интерфейса эта организация может:

-   посмотреть перечень организаций, которым предоставлена данная
    группа;

-   дать некоторой организации доступ к данной группе;

-   отозвать у организации доступ к группе.

Для просмотра списка организаций, которым предоставлен доступ к
указанной группе, необходимо выполнить запрос методом GET в адрес
программного интерфейса ЕСИА[^43]. В заголовке запроса должен быть
указан маркер доступа. Имеется возможность вызвать этот сервис с
функцией встраивания (embed), чтобы сразу был виден перечень
организаций, которым предоставлен доступ. Пример запроса (вызов сервиса
в тестовой среде):

GET
/rs/orgs/1000000001/emps/1000023747/grps/RA.USR_CFM/perms?embed=(elements)
HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Cache--Control: no--cache

Пример ответа, из которого видно, что доступ предоставлен четырем
организациям (указаны их ОГРН и идентификаторы разрешений):

{

\"stateFacts\": \[

\"hasSize\"

\],

\"size\": 4,

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"permId\": 732,

\"ogrn\": \"1047707030513\"

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"permId\": 21,

\"ogrn\": \"1023101651154\"

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"permId\": 104,

\"ogrn\": \"1027700367507\"

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"permId\": 107,

\"ogrn\": \"1027802761282\"

}

\]

}

Для добавления организации в этот перечень необходимо выполнить запрос
методом POST в адрес этого же программного интерфейса ЕСИА[^44]. В
заголовке запроса должен быть указан маркер доступа. В теле запроса
должны быть указаны параметры:

-   \<ogrn\> -- ОГРН организации;

-   \<rqCfm\> -- признак, определяющий, что включение в группу требует
    персонального согласования со стороны владельца группа (для этого
    признак должен иметь значение «true»).

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/grps/RA.USR_CFM/perms/ HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

Cache--Control: no--cache

{ \"ogrn\": \"1047796940465\",

\"rqCfm\": false }

Для отзыва доступа необходимо выполнить запрос методом DELETE по адресу
конкретного разрешения. Пример запроса (вызов сервиса в тестовой среде):

DELETE/rs/orgs/1000000001/grps/RA.USR_CFM/perms/1103 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Cache--Control: no--cache

### Добавление и изменение данных филиалов организации

Программный интерфейс ЕСИА позволяет выполнить следующие операции:

-   добавить филиал организации;

-   изменить данные филиала организации.

Для добавления записи о филиале необходимо сделать запрос на https-адрес
программного интерфейса ЕСИА методом POST[^45]. Заголовок запроса должен
включать\
в себя маркер доступа, тег контейнера филиалов (метка, полученная при
запросе ресурса
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/brhs).

Тело запроса должно включать следующие данные:

-   \<name\> -- название филиала;

-   \<kpp\> -- КПП филиала.

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/brhs HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

If--Match: \"3FEA16CB36AFC793234553C1C7CAAF89CD79A32D\"

{ \"name\": \"Филиал КПП 111111112\",

\"kpp\": \"111111112\" }

Для изменения записи о филиале -- его названия или КПП -- необходимо
сделать запрос на https-адрес программного интерфейса ЕСИА методом
POST[^46]. Заголовок запроса должен включать в себя маркер доступа, тег
записи филиала (метка, полученная\
при запросе ресурса
https://esia-portal1.test.gosuslugi.ru/rs/orgs/{oid}/brhs/{brh--id}).

Тело запроса должно включать следующие данные:

-   \<name\> -- название филиала;

-   \<kpp\> -- КПП филиала.

Пример запроса (разрывы строки даны для удобства чтения):

POST /rs/orgs/1000000001/brhs/1004083064 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

If--Match: \"3FEA16CB36AFC793234553C1C7CAAF89CD79A32D\"

{ \"name\": \"Новый филиал\",

\"kpp\": \"111111113\" }

### Добавление и обновление данных филиала, представительства иностранных юридических лиц

Для регистрации филиала, представительства иностранного юридического
лица система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом POST.

В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

 /api/public/\<version\>/prns/\<prn_oid\>/org/foreign,

где:

-   prn_oid -- идентификатор пользователя в ЕСИА;

-   foreign -- ИНН руководителя.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу.

Пример запроса (вызов сервиса в тестовой среде):

POST [https://
esia-portal1.test.gosuslugi.ru/](https://esia-dev.test.gosuslugi.ru/esia-rs/api/public/v1/prns/1077112791/org/foreign/crtcheck?chief=596764561922)

[/api/public/v1/prns/1077112791/org/foreign/](https://esia-dev.test.gosuslugi.ru/esia-rs/api/public/v1/prns/1077112791/org/foreign/crtcheck?chief=596764561922)

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

Scope: <http://esia.gosuslugi.ru/usr_inf?oid=107712799&mode=w>

Данные, которые ЕСИА возвращает в ответе на запрос -- статус об успешном
результате запроса и идентификатор запроса или статус о неуспешном
результате запроса\
с кодом и наименованием ошибки.

Пример успешного ответа:

HTTP CODE: 200 ОК {"stateFacts:\["Identifiable"\], "id":"1580989"}

Возможные коды ошибок представлены в таблице 67.

Таблица 67 -- Справочник возможных кодов ошибок

  ---------------------------------------------------------------------------------------
  Ошибка                                                     Описание ошибки
  ---------------------------------------------------------- ----------------------------
  HTTP CODE: 400 { \"code\": \"ESIA-039104\",\"message\":    В теле запроса введен
  \"ValidationCommonErrorEnum.organization.type.isWrong\"}   некорректный тип организации

  HTTP CODE: 400 { \"code\": \"ESIA-036201\",                 В запросе введен
  \"message\": \"ИНН должен состоять из 12 цифр\"            некорректный ИНН
  ---------------------------------------------------------------------------------------

Для получения данных о сертификате КЭП аккредитованных филиалов,
представительств иностранных юридических лиц система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом POST.

В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

 /prn_oid/org/foreign/crtcheck,

где:

-   prn_oid -- идентификатор пользователя в ЕСИА.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу.

Пример запроса (вызов сервиса в тестовой среде):

POST [https://
esia-portal1.test.gosuslugi.ru](https://esia-dev.test.gosuslugi.ru/)

/api/public/v1/prns/1077112791/org/foreign/crtcheck?chief=596764561922

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

Scope:
[http://esia.gosuslugi.ru/usr_inf?oid=107712799&mode=w](http://esia.gosuslugi.ru/usr_inf?oid=%7boid%7d&mode=w)

Данные, которые ЕСИА возвращает в ответе на запрос -- статус об
успешном\
или неуспешном результатах запроса. При неуспешном результате запроса
помимо самого статуса должны отображаться код и наименование ошибки.

Пример успешного ответа:

HTTP CODE: 200 ОК

Возможные коды ошибок представлены в таблице 68.

Таблица 68 -- Справочник возможных кодов ошибок

+--------------------------+-------------------------------------------+
| Ошибка                   | Описание ошибки                           |
+==========================+===========================================+
| HTTP CODE: 204 No        | На выбранный сертификат КЭП не            |
| Content                  | зарегистрирован аккредитованный филиал,   |
|                          | представительство иностранного            |
|                          | юридического лица                         |
+--------------------------+-------------------------------------------+
| HTTP                     | На выбранный сертификат КЭП уже           |
| CODE: 400 {\"            | зарегистрирован аккредитованный филиал,   |
| code\": \"ESIA-039974\", | представительство иностранного            |
| \"message\":             | юридического лица                         |
| \"ValidationCommonEr     |                                           |
| rorEnum.reg.org.nza.isBu |                                           |
| syAndStaffUnitIsChief\"} |                                           |
+--------------------------+-------------------------------------------+
| HTTP                     | Выбранный сертификат КЭП не проходит      |
| CODE: 400 {\"            | проверку подлинности                      |
| code\": \"ESIA-039821\", |                                           |
| \"message\": \           |                                           |
| "Электронная подпись не  |                                           |
|                          |                                           |
| прошла проверку.         |                                           |
| Попробуйте еще раз.Если  |                                           |
| ошибка сохранилась, испо |                                           |
| льзуй-те другое средство |                                           |
|  электронной подписи.\"} |                                           |
+--------------------------+-------------------------------------------+

Для поиска данных о филиалах, представительствах иностранных юридических
лиц система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом GET.

В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

/api/public/\<version\>/prns/\<prn_oid\>/org/foreign/exists?nza=\<nza\>,

где:

-   prn_oid -- идентификатор пользователя в ЕСИА;

-   nza -- номер записи об аккредитации.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу.

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/prns/1077112791/org/foreign/exists?nza=10190003395

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

Scope: http://esia.gosuslugi.ru/usr_inf?oid=107712791&mode=w

Данные, которые ЕСИА возвращает в ответе на запрос -- статус об успешном
результате запроса и сведения о филиалах, представительствах иностранных
ЮЛ.\
При неуспешном результате запроса помимо самого статуса должны
отображаться код\
и наименование ошибки.

Пример успешного ответа:

HTTP CODE: 200 ОК

{\"oid\": 1077115592, \"shortName\": \"Представительство сокращенное2\",
    \"fullName\": \"Представительство полное2\",
    \"type\": \"FOREIGN_ORGANIZATION\",     \"ogrn\": \"10190003395\",
    \"inn\": \"9909550720\",     \"leg\": \"\",
    \"kpp\": \"774791001\",     \"createdOn\": \"12.05.2020\"}

Возможные коды ошибок представлены в таблице 69.

Таблица 69 -- Справочник возможных кодов ошибок

  ------------------------------------------------------------------------------------------------------------
  Ошибка                                                                       Описание ошибки
  ---------------------------------------------------------------------------- -------------------------------
  HTTP CODE: 400 {\"code\": \"ESIA-038001\",                                   Значение НЗА
  \"message\": \"ValidationCommonErrorEnum.organization.foreign.notFound\"}    организации не существует 

  ------------------------------------------------------------------------------------------------------------

Для обновления данных о филиалах, представительствах иностранных
юридических лиц система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом POST.

В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

[/api/public/{version}/orgs/{org_oid}/refresh, ](https://esia-dev.test.gosuslugi.ru/esia-rs/swagger-ui.html#/operations/%D0%9E%D1%80%D0%B3%D0%B0%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8,%20%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5/refreshOrganizationUsingPOST)

> где:

-   org_oid -- идентификатор организации в ЕСИА;

-   req_id -- идентификатор реквеста.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу.

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/profile/esia-rs/api/public/v1/orgs/10771/refresh

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

Scope: <http://esia.gosuslugi.ru/usr_inf?oid=107712791&mode=w>

Данные, которые ЕСИА возвращает в ответе на запрос -- статус об успешном
результате запроса и идетификатор запроса или статус о неуспешном
результате запроса\
с кодом и наименованием ошибки.

Пример ответа:

HTTP CODE: 200 ОК {"stateFacts:\["Identifiable"\], "id":"1580989"}

При отмене запроса на обновление данных о филиалах, представительствах
иностранных юридических лиц система-клиент должна направить
в https-адрес REST API системы ЕСИА запрос методом POST.

В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

[/api/public/{version}/orgs/{org_oid}/refresh/{req_id}/cancel,  ](https://esia-dev.test.gosuslugi.ru/esia-rs/swagger-ui.html#/operations/%D0%9E%D1%80%D0%B3%D0%B0%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8,%20%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5/cancelRefreshOrganizationUsingPOST)

где:

-   org_oid -- идентификатор организации в ЕСИА;

-   req_id -- идентификатор реквеста.

В запросе должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу.

Пример запроса (вызов сервиса в тестовой среде):

GET <https://esia-portal1.test.gosuslugi.ru222/cancel>

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

Scope: <http://esia.gosuslugi.ru/usr_inf?oid=107712791&mode=w>

Данные, которые ЕСИА возвращает в ответе на запрос -- статус об успешном
результате запроса и идетификатор запроса или статус о неуспешном
результате запроса\
с кодом и наименованием ошибки.

Пример ответа:

HTTP CODE: 200 ОК {\"id\":\"2985390\",\"status\":\"S\"}

### Присоединение руководителя к филиалу, представительству иностранных юридических лиц

Для присоединения сотрудника в качестве руководителя к филиалу,
представительству иностранного юридического лица система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом POST.

В запросе должен быть указан ресурс, содержащий необходимые данные.
Идентификатор этого ресурса в ЕСИА имеет следующий вид:

api/public/1/prns/\<prn_oid\>/org/foreign/setchieffororg,

где: 

-   prn_oid -- идентификатор пользователя в ЕСИА;

-   chiefin -- ИНН руководителя.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу.

Пример запроса (вызов сервиса в тестовой среде):

POST
https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/prns/1077112791/org/foreign/setchieffororg?chief=596764561922

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlc

Content--Type: application/json

Scope: <http://esia.gosuslugi.ru/usr_inf?oid=107712791&mode=w>

Данные, которые ЕСИА возвращает в ответе на запрос -- статус об успешном
результате запроса и идетификатор запроса или статус о неуспешном
результате запроса\
с кодом и наименованием ошибки.

Пример успешного ответа:

HTTP CODE: 200 ОК {"stateFacts:\["Identifiable"\], "id":"1580989"}

Возможные коды ошибок представлены в таблице 70.

Таблица 70 -- Справочник возможных кодов ошибок

  ---------------------------------------------------------------------------------------------
  Ошибка                                                         Описание ошибки
  -------------------------------------------------------------- ------------------------------
  HTTP CODE: 400**{**\"code\": \"ESIA-038006\",                  В запросе не
  \"message\": \"В запросе отсутствует ЭЦП организации\"**} **   указана ЭЦП организации

  ---------------------------------------------------------------------------------------------

## Предоставление списка измененных пользователей или организаций за период времени

Вызов данной операции предоставляет интегрированным с ЕСИА ИС данные
об измененных пользователях или организациях в ЕСИА. Для получения
перечня измененных пользователей или организаций система-клиент должна
направить в https-адрес REST API системы ЕСИА запрос методом GET. В
запросе должен быть указан ресурс, содержащий необходимые данные. В
качестве этого ресурса используется стандартный идентификатор ресурса с
персональными данными пользователей (/prns), возвращающий перечень
зарегистрированных в системе пользователей (см. п. А.2, Приложение А)\
или стандартный ресурс со списком организаций (/orgs), возвращающий
коллекцию организаций (см. п. А.4, Приложение А). Специфика вызова
данной операции состоит в том, что запрос должен содержать следующий
параметр:

-   \<updatedSince\> -- дата, начиная с которой необходимо отобразить
    измененных пользователей. Задается как количество секунд, прошедших
    с 00:00:00 UTC\
    1 января 1970 года.

В запрос должен быть добавлен header с маркером доступа, позволяющим
получить доступ к данному ресурсу (*область доступа (scope)*
http://esia.gosuslugi.ru/tech_inf).

Пример запроса списка измененных организаций (вызов сервиса в среде
разработки):

GET /rs/prns?updatedSince=1384218061 HTTP/1.1\\r\\n

Authorization: Bearer 75b2c7cbb8da403491c224c9e431cef9\\r\\n

Host: esia-portal1.test.gosuslugi.ru\\r\\n

Accept: \*/\*\\r\\n

\\r\\n

В качестве ответа передается перечень пользователей или организаций,
обновленных с указанной даты. Этот перечень представляет собой список
ссылок на ресурс с указанием {oid}, содержащий идентификаторы всех
измененных пользователей\
или организаций с момента указанной в запросе даты.

## Импорт УЗ пользователя

Программный интерфейс, основанный на архитектурном стиле REST, в целях
обеспечения импорта в ЕСИА учетных записей других ИС, предоставляет
возможность проверки наличия учетной записи пользователя, а в случае ее
отсутствия, регистрации пользователя в ЕСИА. Алгоритм, по которому
производится импорт учетной записи, приводится на рисунке 4.

![](media/image4.emf)

Рисунок 4 -- Обобщенный алгоритм импорта в ЕСИА

Для импорта учетных записей система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST:
https://esia.gosuslugi.ru/esia-rs/api/public/v2/prns/import (для
продуктивной среды). В URL запроса метода необходимо указать параметр
«?confirmWay=REST_API», чтобы подтверждение регистрации учетной записи
осуществлялось с помощью метода REST API (метод POST:
https://esia.gosuslugi.ru/esia-rs/api/public/v2/confirmation/compare
описан ниже в п. А.9).

Если параметр «?confirmWay=REST_API» в URL запроса метода не указать,\
то подтверждение регистрации учетной записи необходимо осуществлять с
помощью ответной СМС от пользователя на специальный номер сервиса
Госуслуг. 

**Внимание! Подтверждение регистрации в ЕСИА отправкой пользователем
ответной СМС является устаревшим способом подтверждения, который
недоступен для подключения новым потребителям сервиса импорта. Новым
потребителям сервиса импорта пользователей в ЕСИА необходимо
использовать подтверждение регистрации через API, добавляя в запрос
параметр «[?confirmWay=REST_API»]{.underline}.**

На рисунке 5 представлена диаграмма последовательности вызова методов
REST API. 

![](media/image5.gif){width="6.0423654855643045in"
height="9.76388888888889in"}

Рисунок 5 -- Диаграмма последовательности вызова методов REST API

В запросе на импорт учетной записи должны быть переданы следующие данные
пользователя, приведенные в таблице 71.

Таблица 71 -- Передаваемые данные пользователя

+-----+---------------+------------+------------+---------------------+
| **  | *             | **Описание | **Обяз     | **Примечания**      |
| №** | *Наименование | п          | ательность |                     |
|     | параметра**   | араметра** | п          |                     |
|     |               |            | араметра** |                     |
+=====+===============+============+============+=====================+
| 1   | firstName     | Имя        | Y          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 2   | lastName      | Фамилия    | Y          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 3   | middleName    | Отчество   | Y          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов.       |
|     |               |            |            | Необязательно, в    |
|     |               |            |            | случае,\            |
|     |               |            |            | если отчество       |
|     |               |            |            | отсутствует\        |
|     |               |            |            | в паспорте          |
+-----+---------------+------------+------------+---------------------+
| 4   | birthDate     | Дата       | Y          | Формат: ДД.ММ.ГГГГ  |
| .   |               | рождения   |            |                     |
+-----+---------------+------------+------------+---------------------+
| 5   | birthPlace    | Место      | Y          | Текстовая строка,   |
| .   |               | рождения   |            | содержащая не более |
|     |               |            |            | 700 символов        |
+-----+---------------+------------+------------+---------------------+
| 6   | citizenship   | Г          | N/Y        | Используется        |
| .   |               | ражданство |            | трехбуквенный код   |
|     |               | по         |            | страны, например,\  |
|     |               | клас       |            | для России он       |
|     |               | сификатору |            | должен принимать    |
|     |               | ОКСМ       |            | значение RUS.\      |
|     |               |            |            | По умолчанию        |
|     |               |            |            | принимается         |
|     |               |            |            | значение «RUS».     |
|     |               |            |            |                     |
|     |               |            |            | Обязателен в        |
|     |               |            |            | случае,\            |
|     |               |            |            | если указанный      |
|     |               |            |            | документ отличен от |
|     |               |            |            | паспорта РФ         |
+-----+---------------+------------+------------+---------------------+
| 7   | gender        | Пол        | Y          | Перечень допустимых |
| .   |               |            |            | значений:           |
|     |               |            |            |                     |
|     |               |            |            | -   «M» -- мужской; |
|     |               |            |            |                     |
|     |               |            |            | -   «F» -- женский  |
+-----+---------------+------------+------------+---------------------+
| 8   | snils         | СНИЛС      | N/Y        | Не требуется, если  |
| .   |               |            |            | перед запросом на   |
|     |               |            |            | импорт УЗ           |
|     |               |            |            | осуществлялся       |
|     |               |            |            | запрос              |
|     |               |            |            | автоматического     |
|     |               |            |            | поиска СНИЛС с      |
|     |               |            |            | получением          |
|     |               |            |            | успешного статуса   |
|     |               |            |            | ответа\             |
|     |               |            |            | (п. А.9.2           |
|     |               |            |            | «Автоматический     |
|     |               |            |            | поиск СНИЛС при     |
|     |               |            |            | регистрации УЗ      |
|     |               |            |            | пользователя        |
|     |               |            |            | методом импорта»).  |
|     |               |            |            |                     |
|     |               |            |            | В остальных случаях |
|     |               |            |            | обязательный,       |
|     |               |            |            | формат:             |
|     |               |            |            | «ХХХ-ХХХ-ХХХ ХХ».   |
+-----+---------------+------------+------------+---------------------+
| 9   | контакт       |            | Y          |                     |
| .   |               |            |            |                     |
+-----+---------------+------------+------------+---------------------+
| 1   | type          | Тип        | Y          | Перечень допустимых |
| .   |               | контакта   |            | значений:           |
|     |               |            |            |                     |
|     |               |            |            | -   «MBT» --        |
|     |               |            |            |     мобильный       |
|     |               |            |            |     телефон         |
|     |               |            |            |     (обязательный   |
|     |               |            |            |     параметр);      |
|     |               |            |            |                     |
|     |               |            |            | -   «EML» --        |
|     |               |            |            |     электронная     |
|     |               |            |            |     почта           |
|     |               |            |            |     (необязательный |
|     |               |            |            |     параметр)       |
+-----+---------------+------------+------------+---------------------+
| 1   | value         | Значение   | Y          | Формат:             |
| .   |               |            |            |                     |
|     |               |            |            | «+X(XXX)XXXXXXX»\   |
|     |               |            |            | (для type = «MBT»); |
|     |               |            |            |                     |
|     |               |            |            | текстовая строка в  |
|     |               |            |            | формате адреса      |
|     |               |            |            | электронной почты\  |
|     |               |            |            | (для type = «EML»)  |
+-----+---------------+------------+------------+---------------------+
| 1   | документ      |            | Y          |                     |
| 0.  |               |            |            |                     |
+-----+---------------+------------+------------+---------------------+
| 1   | type          | Тип        | Y          | Перечень допустимых |
| .   |               | документа  |            | значений:           |
|     |               |            |            |                     |
|     |               |            |            | -   «RF_PASSPORT»   |
|     |               |            |            |     -- паспорт      |
|     |               |            |            |     гражданина РФ;  |
|     |               |            |            |                     |
|     |               |            |            | -   «FID_DOC» --    |
|     |               |            |            |     документ        |
|     |               |            |            |     иностранного    |
|     |               |            |            |     гражданина,     |
|     |               |            |            |     удостоверяющий  |
|     |               |            |            |     личность\       |
|     |               |            |            |     на территории   |
|     |               |            |            |     РФ;             |
|     |               |            |            |                     |
|     |               |            |            | -   «FRGN_PASS» --  |
|     |               |            |            |     заграничный     |
|     |               |            |            |     паспорт         |
|     |               |            |            |     гражданина РФ   |
+-----+---------------+------------+------------+---------------------+
| 1   | series        | серия      | Y/N        | Для паспорта        |
| .   |               |            |            | гражданина РФ       |
|     |               |            |            | в формате XXXX.     |
|     |               |            |            |                     |
|     |               |            |            | Для заграничного    |
|     |               |            |            | паспорта гражданина |
|     |               |            |            | РФ в формате XX.    |
|     |               |            |            |                     |
|     |               |            |            | Необязательный для  |
|     |               |            |            | документа           |
|     |               |            |            | иностранного        |
|     |               |            |            | гражданина          |
+-----+---------------+------------+------------+---------------------+
| 2   | number        | номер      | Y          | Для паспорта        |
| .   |               |            |            | гражданина РФ       |
|     |               |            |            | в формате XXXXXX.   |
|     |               |            |            |                     |
|     |               |            |            | Для заграничного    |
|     |               |            |            | паспорта гражданина |
|     |               |            |            | РФ в формате        |
|     |               |            |            | XXXXXXX             |
+-----+---------------+------------+------------+---------------------+
| 3   | latinLastName | Фамилия    | Y/N        | Только для          |
| .   |               | (          |            | заграничного        |
|     |               | латиницей) |            | паспорта гражданина |
|     |               |            |            | РФ                  |
+-----+---------------+------------+------------+---------------------+
| 4   | l             | Имя        | Y/N        | Только для          |
| .   | atinFirstName | (          |            | заграничного        |
|     |               | латиницей) |            | паспорта гражданина |
|     |               |            |            | РФ                  |
+-----+---------------+------------+------------+---------------------+
| 5   | issueId       | Номер      | Y/N        | Только для паспорта |
| .   |               | подр       |            | гражданина РФ.      |
|     |               | азделения, |            |                     |
|     |               | выдавшего  |            | Необязательный для  |
|     |               | паспорт    |            | документа           |
|     |               |            |            | иностранного        |
|     |               |            |            | гражданина          |
|     |               |            |            |                     |
|     |               |            |            | и заграничного      |
|     |               |            |            | паспорта гражданина |
|     |               |            |            | РФ                  |
+-----+---------------+------------+------------+---------------------+
| 6   | issuedBy      | На         | Y/N        | Только для паспорта |
| .   |               | именование |            | гражданина РФ.      |
|     |               | подр       |            |                     |
|     |               | азделения, |            | Необязательно для   |
|     |               | выдавшего  |            | документа           |
|     |               | паспорт    |            | иностранного        |
|     |               |            |            | гражданина          |
|     |               |            |            | и заграничного      |
|     |               |            |            | паспорта гражданина |
|     |               |            |            | РФ                  |
+-----+---------------+------------+------------+---------------------+
| 7   | issueDate     | Дата       | Y          | Формат: ДД.ММ.ГГГГ  |
| .   |               | выдачи     |            |                     |
|     |               | паспорта   |            |                     |
+-----+---------------+------------+------------+---------------------+
| 8   | expireDate    | Дата       | Y/N        | Только для          |
| .   |               | окончания  |            | заграничного        |
|     |               | срока      |            | паспорта гражданина |
|     |               | действия   |            | РФ.                 |
|     |               | документа  |            |                     |
|     |               |            |            | Формат: ДД.ММ.ГГГГ  |
+-----+---------------+------------+------------+---------------------+
| 1   | адрес         |            | N          |                     |
| 1.  |               |            |            |                     |
+-----+---------------+------------+------------+---------------------+
| 1   | type          | Тип адреса | Y          | Перечень допустимых |
| .   |               |            |            | значений:           |
|     |               |            |            |                     |
|     |               |            |            | -   «PLV» -- адрес  |
|     |               |            |            |     проживания;     |
|     |               |            |            |                     |
|     |               |            |            | -   «PRG» -- адрес  |
|     |               |            |            |     регистрации     |
+-----+---------------+------------+------------+---------------------+
| 1   | addressStr    | Адресная   | Y          | Текстовая строка,   |
| .   |               | строка     |            | содержащая элементы |
|     |               |            |            | адреса              |
|     |               |            |            | (перечисляются\     |
|     |               |            |            | через разделитель   |
|     |               |            |            | «,», не более 2000  |
|     |               |            |            | символов)           |
+-----+---------------+------------+------------+---------------------+
| 2   | countryId     | Тре        | N          | В формате XXX       |
| .   |               | хбуквенный |            |                     |
|     |               | код страны |            |                     |
+-----+---------------+------------+------------+---------------------+
| 3   | zipCode       | Индекс     | N          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 4   | region        | Область    | N          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 5   | area          | Район      | N          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 6   | city          | Город      | N          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 7   | district      | Округ      | N          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 8   | settlement    | Населенный | N          | Текстовая строка,   |
| .   |               | пункт      |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 9   | street        | Улица      | N          | Текстовая строка,   |
| .   |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 1   | additionArea  | Уточнение\ | N          | Текстовая строка,   |
| 0.  |               | по региону |            | содержащая не более |
|     |               | проживания |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 1   | addit         | Уточнение\ | N          | Текстовая строка,   |
| 1.  | ionAreaStreet | по улице   |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 1   | house         | Дом        | N          | Текстовая строка,   |
| 2.  |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 1   | building      | Строение   | N          | Текстовая строка,   |
| 3.  |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 1   | frame         | Корпус     | N          | Текстовая строка,   |
| 4.  |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 1   | flat          | Квартира   | N          | Текстовая строка,   |
| 5.  |               |            |            | содержащая не более |
|     |               |            |            | 256 символов        |
+-----+---------------+------------+------------+---------------------+
| 1   | fiasCode      | Код ФИАС   | N          | Формат:             |
| 6.  |               |            |            | «ХХХ                |
|     |               |            |            | ХХХХХ--ХХХХ--ХХХХ-- |
|     |               |            |            | ХХХХ--ХХХХХХХХХХХХ» |
+-----+---------------+------------+------------+---------------------+

В запросе на импорт учетной записи в составе контактных данных contacts\
в обязательном порядке должен быть передан номер телефона (контакт с
типом MBT).\
Для доверенных систем[^47] допустимо отсутствие в контактных данных
адреса электронной почты (контакт с типом EML). В таком случае при
регистрации/подтверждении/ переподтверждении учетной записи ЕСИА
направляет запрос на формирование адреса электронной почты в российский
почтовый сервис Mail.ru.

В запрос должен быть добавлен header (Authorization: Bearer) с ранее
полученным маркером доступа, выданный на специальную область доступа
(scope) (http://esia.gosuslugi.ru/ext_imp), позволяющий осуществлять
автоматический импорт учетной записи пользователя. Данный маркер
выдается только доверенным системам, имеющим право импорта пользователей
таким образом; выдача маркера осуществляется\
в рамках модели контроля доступа на основе полномочий системы-клиента
(см. п. Б.3, Приложение Б), т.е. право на запрос такого маркера доступа
устанавливается оператором эксплуатации ЕСИА. 

В заголовке (Header) запроса метода импорта, помимо параметра
Authorization (маркер доступа, Bearer\<пробел\>\<тело маркера\>),
необходимо передавать два параметра:

-   Request-Data -- тело параметров запроса (JSON), закодированное в
    base64 url safe;

-   Request-Data-Sign -- подпись запроса -- подписанное сертификатом
    ИС-потребителя (системы, направляющей запрос на импорт) тело (JSON)
    параметров запроса.

Request-Data-Sign -- подпись запроса в формате PKCS#7 detached
signature\
в кодировке UTF-8 от от JSON с параметрами запроса. Request-Data-Sign
должен быть закодирован в формате base64 url safe. Используемый для
проверки подписи сертификат должен быть предварительно зарегистрирован в
ЕСИА и привязан к учетной записи системы-клиента в ЕСИА[^48]. ЕСИА
использует сертификаты в формате X.509\
и криптографические алгоритмы ГОСТ Р 34.10-2012 для формирования
электронной подписи и ГОСТ Р 34.11-2012 для хэширования.

Пример запроса (вызов сервиса в среде разработки):

POST https://esia.gosuslugi.ru/esia-rs/api/public/v2/prns/import
 HTTP/1.1

Accept--Encoding: gzip,deflate

Content--Type: application/json

Authorization: Bearer 

eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE1OTYwMjI3NDMsInNjb3BlIjoiaHR0cDpcL1wvZXNpYS5nb3N1c2x1Z2kucnVcL2V4dF9pbXAiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiY2NjYTExZWUwOGY1MDM4NzE2NzY2ODMyNDdjNzU3ODAwNTFmODRhNGExMWQxMDY5YTEwNmIzNjUyZjgxNjUxNSIsInVybjplc2lhOnNial9pZCI6MTA3NzExNDA1NCwiZXhwIjoxNTk2MDI0NTQzLCJpYXQiOjE1OTYwMjI3NDMsImNsaWVudF9pZCI6IlRFU1RfU1lTIn0.ZG4e0Hs_hHwubfYLc94ph1bPaof3opfeLjw8GczXfI--CKD683KFvPE_mqGo0WjgtarM4Cd1zRU_FitqXQl4DsmZW94aVHjfyS6ti4ERtEwby3ifQfY_8qefnzIpZ2EtlAbGNaj7jWpdJlhKQcigBKi_60eOinrUYwcEy1EdnRKIHDyrrydfh--MN3ZQSEx8aMYMm3IATPrktJPZ8LryD2wlkWq3PuxFAxFLEaLo0r--F8FRU1hPlNyUrTCRp6vNmlLO_TVe2l28gRdcxZJKAdHggXmRXVceT7cMGUOY4b2VnTID3G_w7FuVIjURQZy46HQ3X5tH9IiGfoqi2dhD5y3AQ

Request--Data--Sign:
 MIAGCSqGSIb3DQEHAqCAMIACAQExDzANBglghkgBZQMEAgEFADCABgkqhkiG9w0BBwEAAKCAMIIDJTCCAg0CBFhKg5UwDQYJKoZIhvcNAQELBQAwVzELMAkGA1UEBhMCUlUxDzANBgNVBAgMBk1vc2NvdzENMAsGA1UECgwEVGVzdDENMAsGA1UECwwEVGVzdDEZMBcGA1UEAwwQVGVzdCBSZXN0IFN5c3RlbTAeFw0xNjEyMDkxMDEyMzdaFw0xNzEyMDkxMDEyMzdaMFcxCzAJBgNVBAYTAlJVMQ8wDQYDVQQIDAZNb3Njb3cxDTALBgNVBAoMBFRlc3QxDTALBgNVBAsMBFRlc3QxGTAXBgNVBAMMEFRlc3QgUmVzdCBTeXN0ZW0wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCByEsM2_R1BrtltyJ15AwCW_tChh2euZC3FEqWDY6TFAlVyy9yO4qM_5P1WruplhA9dCCbft5JFsz4n_nE7lMMRaI34tqTyyo24xzX_VrhgTIi05mt1Y5dbldfEiPVNT3aUCjFlbFzDXoUbc8nfQizkPa_CHGO0MBhuVuQWOVzw3FufAlExDjNPUoRRvaYoBWOK_3SnyS7_88xJn--\_yQQVwu0TQkSuqpOsylfBM--Wq10U5x4bJ2NSeL71AzZjCL_mh1daQTQxEwBlVLuMlc5srMyw_QHQ1McsNrqrnx3zhFFNLS5Sk_LrSxqxOsC4sgBw1oudVayUUvGbqe_nxu7P3AgMBAAEwDQYJKoZIhvcNAQELBQADggEBABxK0C1NjQMyvtJvZNRyM21GwQOklaBZuqRErJmpLAR7auYLbZnwEdt1I8KEJBQW6pTb99rnQs--T--qZiChh0PYlbCxXGeVCXk5dJWSiGE_SdrjWvSOH83iUA2Lv8Pi3NlVW2GcNOlFySlzE9HvGYJTIr5I_X--dw64--2NYETLIYPQ7HWwAEwy09ucL9LMjGKYBe5FrwiulAyD20--lnIpYtXdLSpflKangPlPd1xmxEBXMQUmoKg7dTE--q2gYfZLNUKsAezrattHGHTPRnqwWQHmwly_rXXodlgcNxeilT_dvc0o_JfkNmqGCc09RXSx1BWSWGynLeBBjYMy9VN8XYQpQAADGCAfUwggHxAgEBMF8wVzELMAkGA1UEBhMCUlUxDzANBgNVBAgMBk1vc2NvdzENMAsGA1UECgwEVGVzdDENMAsGA1UECwwEVGVzdDEZMBcGA1UEAwwQVGVzdCBSZXN0IFN5c3RlbQIEWEqDlTANBglghkgBZQMEAgEFAKBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTE3MDYyMDE1NTA1NVowLwYJKoZIhvcNAQkEMSIEIOpwKJnoLommyNRoKDDlWVsWuBdYfowQ4byOiN--gSPe2MA0GCSqGSIb3DQEBAQUABIIBADlNWxdZeqGBq8_4WqRs9H4SLde_Sukc1AG6hNj1cbTqxzthzzm1n_JQEZOTYaP9bQdTEhOvKZXxFXC_JjPBMQauZPJc1eOR5DDB_7X4MAgGpMQbhpTQz3Sg7acJuJdWuYxL92BDk4qyzuwgJdQJplVJickBvC78XeJVo1w4_jx5CVEn3pUIPdKxib6da0evB6CsxD98JcsvWZ3u--H3LQ0_ApUOUHeF84r3AZ5mtILYj2w6o8rMAmsTDe7CAUXvDUAp9o5cTPk57rDNaW96d5J3SUtmZdx2nGBS41kJYWJNDiqyfHJ7X4nZVOS0glbT_JnaXtxrZTWp9BJo6NKJaagQAAAAAAAA

Request--Data:
 ew0KICAiZmlyc3ROYW1lIjoiw5DCmMOQwrLDkMKww5DCvcOQwr7DkMKyIiwNCiAgImxhc3ROYW1lIjoiw5DCmMOQwrLDkMKww5DCvSIsDQogICJtaWRkbGVOYW1lIjoiw5DCmMOQwrLDkMKww5DCvcOQwr7DkMKyw5DCuMORwociLA0KICAiYmlydGhEYXRlIjoiMDEuMDEuMTk5OSIsDQogICJiaXJ0aFBsYWNlIjoiw5DCnMOQwr7DkcKBw5DCusOQwrLDkMKwIiwNCiAgImdlbmRlciI6Ik0iLA0KICAic25pbHMiOiIwMDAtMDAwLTAwMCAwNyIsDQogICJjb250YWN0cyI6IHsNCiAgICAiZWxlbWVudHMiOiBbDQogICAgICB7DQogICAgICAgICJ0eXBlIjogIk1CVCIsDQogICAgICAgICJ2YWx1ZSI6ICIrNyg5OTkpOTk5OTk5OSINCiAgICAgIH0sDQogICAgICB7DQogICAgICAgICJ0eXBlIjogIkVNTCIsDQogICAgICAgICJ2YWx1ZSI6ICJ0ZXN0QHRlc3QudHMiDQogICAgICB9DQogICAgXQ0KICB9LA0KICAiZG9jdW1lbnRzIjogew0KICAgICJlbGVtZW50cyI6IFsNCiAgICAgIHsNCiAgICAgICAgInR5cGUiOiJSRl9QQVNTUE9SVCIsDQogICAgICAgICJzZXJpZXMiOiIyMjIyIiwNCiAgICAgICAgIm51bWJlciI6Ijg4OTk5OSIsDQogICAgICAgICJpc3N1ZUlkIjoiMTExMDAxIiwNCiAgICAgICAgImlzc3VlZEJ5Ijoiw5DCoMOQwqPDkMKSw5DClCDDkMKzLsOQwpzDkMK--w5HCgcOQwrrDkMKyw5HCiyIsDQogICAgICAgICJpc3N1ZURhdGUiOiIxOC4wMy4yMDE2Ig0KICAgICAgfQ0KICAgIF0NCiAgfSwNCiAgImFkZHJlc3NlcyI6ew0KICAgICJlbGVtZW50cyI6IFsNCiAgICAgIHsNCiAgICAgICJ0eXBlIjogIlBMViIsDQogICAgICAiYWRkcmVzc1N0ciI6IsOQwprDkMK1w5DCvMOQwrXDkcKAw5DCvsOQwrLDkcKBw5DCusOQwrDDkcKPIMOQwp7DkMKxw5DCu8OQwrDDkcKBw5HCgsORwowsIMOQwqLDkMKww5HCiMORwoLDkMKww5DCs8OQwr7DkMK7w5HCjMORwoHDkMK6w5DCuMOQwrkgw5DCoMOQwrDDkMK5w5DCvsOQwr0sIMOQwqjDkMK1w5HCgMOQwrXDkMKzw5DCtcORwoggw5DCn8OQwr7DkcKBw5DCtcOQwrvDkMK--w5DCuiDDkMKzw5DCvsORwoDDkMK--w5DCtMORwoHDkMK6w5DCvsOQwrPDkMK--ICAgICDDkcKCw5DCuMOQwr_DkMKwIiwNCiAgICAgICJjb3VudHJ5SWQiOiAiUlVTIiwNCiAgICAgICJ6aXBDb2RlIjogIjM5NDAwMCIsDQogICAgICAicmVnaW9uIjogIsOQwprDkMK1w5DCvMOQwrXDkcKAw5DCvsOQwrLDkcKBw5DCusOQwrDDkcKPIMOQwp7DkMKxw5DCu8OQwrDDkcKBw5HCgsORwowiLA0KICAgICAgImFyZWEiOiAiw5DCosOQwrDDkcKIw5HCgsOQwrDDkMKzw5DCvsOQwrvDkcKMw5HCgcOQwrrDkMK4w5DCuSDDkMKgw5DCsMOQwrnDkMK--w5DCvSIsDQogICAgICAiY2l0eSI6ICLDkMKow5DCtcORwoDDkMK1w5DCs8OQwrXDkcKIIMOQwp_DkMK--w5HCgcOQwrXDkMK7w5DCvsOQwrogw5DCs8OQwr7DkcKAw5DCvsOQwrTDkcKBw5DCusOQwr7DkMKzw5DCviDDkcKCw5DCuMOQwr_DkMKwIiwNCiAgICAgICJkaXN0cmljdCI6ICLDkMK9w5DCtcORwoIiLA0KICAgICAgInNldHRsZW1lbnQiOiAiw5DCo8ORwoHDkcKCw5HCjC3DkMKQw5DCvcOQwrfDkMKww5HCgSDDkMKfw5DCvsORwoHDkMK1w5DCu8OQwr7DkMK6IiwNCiAgICAgICJzdHJlZXQiOiAiw5DCocOQwr7DkMKyw5DCtcORwoLDkcKBw5DCusOQwrDDkcKPIMOQwqPDkMK7w5DCuMORwobDkMKwIiwNCiAgICAgICJhZGRpdGlvbkFyZWEiOiAiw5DCoMOQwrXDkMKzw5DCuMOQwr7DkMK9IMOQwqHDkMKww5DCtMOQwr7DkMKyw5DCvsOQwrUgw5DCvcOQwrXDkMK6w5DCvsOQwrwtw5DCtSDDkcKCw5DCvsOQwrLDkMKww5HCgMOQwrjDkcKJw5DCtcORwoHDkcKCw5DCssOQwr4iLA0KICAgICAgImFkZGl0aW9uQXJlYVN0cmVldCI6ICLDkMKiw5DCtcORwoHDkcKCIiwNCiAgICAgICJob3VzZSI6ICI4Ni8xIiwNCiAgICAgICJidWlsZGluZyI6ICJlIiwNCiAgICAgICJmcmFtZSI6ICIyMDTDkcKDIiwNCiAgICAgICJmbGF0IjogIsOQwr_DkMK--w5DCvC40MTkiLA0KICAgICAgImZpYXNDb2RlIjogIjc3LTAtMDAwLTAwMC0wMDAtMDAwLTQyMzYtMDAwMC0wMDAiDQoNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIF0NCiAgfQ0KfQ

Cache--Control: no--cache

Content--Length: 1476

Host: esia-portal1.test.gosulsugi.ru 

Connection: Keep--Alive

User--Agent: Apache--HttpClient/4.1.1 (java 1.5)

 

{

  \"firstName\":\"Иванов\",

  \"lastName\":\"Иван\",

  \"middleName\":\"Иванович\",

  \"birthDate\":\"01.01.1999\",

  \"birthPlace\":\"Москва\",

  \"gender\":\"M\",

  \"snils\":\"000--000--000 07\",

  \"contacts\": {

    \"elements\": \[

      {

        \"type\": \"MBT\",

        \"value\": \"+7(999)9999999\"

      },

      {

        \"type\": \"EML\",

        \"value\": \"test@test.ts\"

      }

    \]

  },

  \"documents\": {

    \"elements\": \[

      {

        \"type\":\"RF_PASSPORT\",

        \"series\":\"2222\",

        \"number\":\"889999\",

        \"issueId\":\"111001\",

        \"issuedBy\":\"РУВД г.Москвы\",

        \"issueDate\":\"18.03.2016\"

      }

    \]

  },

  \"addresses\":{

    \"elements\": \[

      {\
      \"type\": \"PLV\",

       \"addressStr\":\" Кемеровская область, Таштагольский район,
Шерегеш поселок городского

        типа, Усть--Анзас поселок, Советская улица\",

       \"countryId\": \"RUS\",

       \"zipCode\": \"652975\",

       \"region\": \"Кемеровская Область\",

       \"area\": \"Таштагольский Район\",

       \"city\": \"Шерегеш Поселок городского типа\",

       \"settlement\": \"Усть--Анзас Поселок\",

       \"house\": \"Дом 19\",

       \"fiasCode\": \"5bf5ddff--6353--4a3d--80c4--6fb27f00c6c1\"

        }

    \]

  }

}

По полученным данным в ЕСИА выполняется поиск учетной записи.\
В зависимости от того, найдена в ЕСИА учетная запись, удовлетворяющая
полученным данным или нет, операция импорта может завершиться одним из
следующих результатов:

-   пользователь уже зарегистрирован в ЕСИА (подтвержденная учетная
    запись найдена по СНИЛС, данные паспорта и телефона совпадают);

-   некоторые атрибуты не совпадают (учетная запись найдена по СНИЛС,\
    но не все атрибуты совпадают);

-   пользователь ЕСИА успешно подтвержден (найдена стандартная или
    готовая\
    к подтверждению учетная запись по СНИЛС, данные паспорта и телефона
    совпадают, найденная учетная запись успешно подтверждена);

-   пользователь ЕСИА успешно переподтвержден (найдена УЗ,
    подтвержденная через Почту России, данные паспорта и телефона
    совпадают, найденная учетная запись успешно переподтверждена);

-   создана заявка на подтверждение упрощенной учетной записи (найдена
    упрощенная учетная запись по одному или нескольким контактам,
    создана заявка на запуск проверок данных в ведомствах и
    подтверждение, получен номер заявки на подтверждение);

-   создана заявка на регистрацию (не найдена учетная запись
    пользователя,\
    в том числе упрощенная, создана заявка на регистрацию, получен номер
    заявки на регистрацию).

В ответе передаются следующие параметры, приведенные в таблице 72.

Таблица 72 -- Передаваемые параметры

+---+-------------+-----------------------+---------------------------+
| * | **Н         | **Описание            | **Примечания**            |
| * | аименование | параметра**           |                           |
| № | параметра** |                       |                           |
| * |             |                       |                           |
| * |             |                       |                           |
+===+=============+=======================+===========================+
| 1 | requestId   | Код заявки на         | Возвращается в случае     |
| . |             | регистрацию           | создания заявки на        |
|   |             |                       | регистрацию               |
|   |             |                       |                           |
+---+-------------+-----------------------+---------------------------+
| 2 | code        | Код завершения        | Может быть возвращен в    |
| . |             | операции              | виде значений:            |
|   |             |                       |                           |
|   |             |                       | -   0 или 1 -- выполнен   |
|   |             |                       |     импорт УЗ;            |
|   |             |                       |                           |
|   |             |                       | -   2 -- создана заявка   |
|   |             |                       |     на импорт             |
|   |             |                       |     (регистрацию) учетной |
|   |             |                       |     записи;               |
|   |             |                       |                           |
|   |             |                       | -   3 -- создана заявка   |
|   |             |                       |     на подтверждение      |
|   |             |                       |     упрощенной учетной    |
|   |             |                       |     записи;               |
|   |             |                       |                           |
|   |             |                       | -   4 -- отправлен запрос |
|   |             |                       |     для получения         |
|   |             |                       |     паспортного           |
|   |             |                       |     досье[^49];           |
|   |             |                       |                           |
|   |             |                       | -   5 -- выполняется      |
|   |             |                       |     запрос паспортного    |
|   |             |                       |     досье (отправлен      |
|   |             |                       |     ранее);               |
|   |             |                       |                           |
|   |             |                       | -   код ошибки, варианты  |
|   |             |                       |     приведены\            |
|   |             |                       |     в таблице 73          |
+---+-------------+-----------------------+---------------------------+
| 3 | description | Текстовое описание    | Описание для кодов        |
| . |             | кода завершения       | успешного импорта учетной |
|   |             | операции              | записи в ЕСИА (code = 0   |
|   |             |                       | -- 3 или 4,5) и для code  |
|   |             |                       | = ESIA-03200              |
+---+-------------+-----------------------+---------------------------+
| 4 | message     | Текстовое описание    | Описание для кодов        |
| . |             | кода ошибки           | ошибок\                   |
|   |             | выполнения операции   | при импорте учетной       |
|   |             |                       | записи в ЕСИА (за         |
|   |             |                       | исключением кода          |
|   |             |                       | ESIA-03200).              |
|   |             |                       |                           |
|   |             |                       | Варианты ошибок приведены |
|   |             |                       | в таблице 73              |
+---+-------------+-----------------------+---------------------------+
| 5 | availableAt | Оставшееся количество | Данные атрибуты           |
| . | temptsCount | попыток ввода кода    | возвращаются\             |
|   |             | подтверждения         | в ответе при указании в   |
|   |             |                       | запросе параметра:        |
|   |             |                       | ?confirmWay=REST_API      |
+---+-------------+-----------------------+---------------------------+
| 6 | maxInputAt  | Максимальное          |                           |
| . | temptsCount | количество попыток    |                           |
|   |             | ввода кода            |                           |
|   |             | подтверждения         |                           |
+---+-------------+-----------------------+---------------------------+
| 7 | pe          | Интервал времени      |                           |
| . | riodsForNex | между переотправкой   |                           |
|   | tGeneration | СМС                   |                           |
|   |             |                       |                           |
+---+-------------+-----------------------+---------------------------+
| 8 | resendCount | Количество попыток\   |                           |
| . |             | по переотправке СМС с |                           |
|   |             | кодом подтверждения   |                           |
|   |             |                       |                           |
+---+-------------+-----------------------+---------------------------+
| 9 | timeToLive  | Срок жизни кода       |                           |
| . |             | подтверждения         |                           |
|   |             |                       |                           |
|   |             |                       |                           |
+---+-------------+-----------------------+---------------------------+
| 1 | max         | Максимальное          |                           |
| 0 | ResendCount | количество попыток на |                           |
| . |             | переотправку СМС      |                           |
|   |             |                       |                           |
+---+-------------+-----------------------+---------------------------+

Далее приводятся варианты ответов сервиса при завершении операции
импорта.

Пример ответа на запрос (пользователь уже зарегистрирован в ЕСИА,
учетная запись уже подтверждена ранее):

TTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"0\", \"description\":\"Person already has trusted account in
ESIA\"}

Пример ответа на запрос (учетная запись пользователя успешно
подтверждена\
в ЕСИА):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"1\", \"description\":\"Person successfully confirmed as
trusted in ESIA\"}

Пример ответа на запрос (учетная запись пользователя успешно
переподтверждена в ЕСИА):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"1\", \"description\":\"Person successfully reconfirmed as
trusted in ESIA\"}

Пример ответа на запрос (запрос на регистрацию успешно отправлен,
создана заявка на регистрацию):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"requestId\":\"AAAAF3A1379F965664CB56FCE55BD8CCA2F38368985607E75E23\",
\"code\":\"2\", \"description\":\"Request to register person as trusted
in ESIA has been accepted successfully.\"}

Пример ответа на запрос (найдена упрощенная учетная запись, создана
заявка\
на подтверждение):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"requestId\":\"AAAAF3A1379F965664CB56FCE55BD8CCA2F38368985607E75E23\",
\"code\":\"3\", \"description\":\"Request to conform simplified person
as trusted in ESIA has been accepted successfully.\"}

Пример ответа на запрос (запущен процесс запроса паспортного досье):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Fri, 15 Oct 2021 12:40:43 GMT--10d 2h

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

{\"requestId\":
\"AAAAAE51269F965664CBA0C0F83A682D648E59D9CD9AEC4C6708\",

\"code\": \"4\",

\"description\": \"Паспортные данные отправлены на проверку. Повторите
попытку позже (обычно это занимает час, в редких случаях до трех
дней).\"}

Пример ответа на запрос (ранее был запущен процесс запроса паспортного
досье):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Fri, 15 Oct 2021 12:42:21 GMT--10d 2h

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

{\"requestId\":
\"AAAAAE51269F965664CBA0C0F83A682D648E59D9CD9AEC4C6708\",

\"code\": \"5\",

\"description\": \"Паспортные данные на проверке. Повторите попытку
позже (обычно это занимает час, в редких случаях до трех дней).\"} 

Пример ответа на запрос параметр «?confirmWay=REST_API» (запрос\
на регистрацию успешно отправлен, создана заявка на регистрацию):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Tue, 23 Mar 2021 15:07:12 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

{

\"requestId\": \"AAAA0DB8359F965664CBDCF936F7B76622193A7C09C4A71AC226\",

\"code\": \"2\",

\"description\": \"Request to register person as trusted in ESIA has
been accepted successfully.\",

\"availableAttemptsCount\": 5,

\"maxInputAttemptsCount\": 5,

\"periodsForNextGeneration\":\[

60000,

60000,

60000

\],

\"resendCount\": 0,

\"maxResendCount\": 3,

\"timeToLive\": 86400000

}

Пример ответа на запрос (ошибка импорта, некоторые атрибуты запроса\
не совпадают с учетной записью в ЕСИА -- требуется корректировка
параметров запроса или учетной записи в ЕСИА):

HTTP/1.1 400 Bad Request

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"ESIA-03200\", \"description\":\"Import account error. Person
have to check entered data or fill in the data in his account in
ESIA.\"}

Пример ответа на запрос (ошибка импорта, в запросе отсуствует контакт с
типом EML -- адрес электронной почты, и система не является доверенной
-- требуется корректировка параметров запроса или учетной записи в
ЕСИА):

HTTP/1.1 400 Bad Request

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content-Type: application/json

Transfer-Encoding: chunked

Connection: keep-alive

X-Powered-By: Servlet/3.0 JSP/2.2

 

{\"code\":\"ESIA-032110\", \"message\":\" Не указан адрес электронной
почты\"}

В таблице 73 представлены коды ответов от сервиса импорта.

Таблица 73 -- Коды и описание ошибок от сервиса импорта

+---+------------+-----------------------+-----------------------------+
| * | **Код      | **Описание кода       | **Комментарии**             |
| * | возврата** | возврата**            |                             |
| № |            |                       |                             |
| * |            |                       |                             |
| * |            |                       |                             |
+===+============+=======================+=============================+
| 1 | E          | Внутренняя ошибка     | Данный код возврата         |
| . | SIA-000001 |                       | соответствует ситуации,     |
|   |            |                       | когда обнаружена            |
|   |            |                       | неизвестная ошибка          |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Scope is not allowed  | У системы, осуществляющей   |
| . | SIA-005029 |                       | запрос к сервису импорта,   |
|   |            |                       | отсутствует разрешение на   |
|   |            |                       | доступ к области доступа    |
|   |            |                       | (scope) ext_imp (например,  |
|   |            |                       | указанный в запросе маркер  |
|   |            |                       | доступа не дает право       |
|   |            |                       | доступа к scope ext_imp)    |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Ошибка при            |                             |
| . | SIA-020326 | подтверждении УЗ      |                             |
|   |            | пользователя          |                             |
|   |            |                       |                             |
|   |            | Во время              |                             |
|   |            | подтверждения УЗ      |                             |
|   |            | обнаружена еще одна   |                             |
|   |            | УЗ данного            |                             |
|   |            | пользователя,         |                             |
|   |            | находящаяся в         |                             |
|   |            | процессе              |                             |
|   |            | подтверждения.        |                             |
|   |            |                       |                             |
|   |            | Пользователю          |                             |
|   |            | необходимо в личном   |                             |
|   |            | кабинете Госуслуг     |                             |
|   |            | отменить проверку     |                             |
|   |            | документа,            |                             |
|   |            | удостоверяющего       |                             |
|   |            | личность, в ранее     |                             |
|   |            | созданной УЗ          |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Заполните поле        | Одно из полей «Фамилия»,    |
| . | SIA-030002 |                       | «Имя», «Отчество» пришло с  |
|   |            |                       | пустым значением            |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Неверно указаны       |                             |
| . | SIA-030003 | параметры запроса     |                             |
|   |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Недопустимые символы\ | Поля запроса содержат       |
| . | SIA-030007 | в полях запроса       | недопустимые символы «\<»,  |
|   |            |                       | «\>» или «&»                |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Сертификат            |                             |
| . | SIA-030504 | электронной подписи   |                             |
|   |            | имеет некорректную    |                             |
|   |            | структуру. Обратитесь |                             |
|   |            | в удостоверяющий      |                             |
|   |            | центр                 |                             |
+---+------------+-----------------------+-----------------------------+
| 8 | ESIA-03200 | Возможно, что         | Необходимо скорректировать  |
| . |            | пользователь          | данные пользователя в       |
|   |            | зарегистрирован,      | параметрах запроса (серию,  |
|   |            | необходимо проверить  | номер, дату выдачи) или     |
|   |            | введенные данные      | параметры УЗ в ЕСИА         |
|   |            | паспорта (серию,      |                             |
|   |            | номер, дату выдачи)   |                             |
|   |            | или заполнить их в    |                             |
|   |            | ЕСИА                  |                             |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Указан некорректный   |                             |
| . | SIA-032006 | тип контакта          |                             |
|   |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | У пользователя уже    | Данный код ошибки           |
| 0 | SIA-032010 | задан этот тип        | возвращается\               |
| . |            | контакта              | при повторной попытке       |
|   |            |                       | подтверждения уже           |
|   |            |                       | подтвержденного контакта    |
|   |            |                       | пользователя                |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Указан некорректный   |                             |
| 1 | SIA-032101 | адрес электронной     |                             |
| . |            | почты                 |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | В структуре адреса    |                             |
| 2 | SIA-032102 | электронной почты     |                             |
| . |            | (в имени и домене)    |                             |
|   |            | должны отсутствовать  |                             |
|   |            | точки                 |                             |
|   |            |                       |                             |
|   |            | в начале и конце.     |                             |
|   |            | Например,             |                             |
|   |            | myma                  |                             |
|   |            | il.mymail@example.com |                             |
|   |            | -- верно;             |                             |
|   |            | mymail.@.example.com  |                             |
|   |            | -- неверно            |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Указан некорректный   |                             |
| 3 | SIA-032103 | формат имени для      |                             |
| . |            | адреса электронной    |                             |
|   |            | почты. Доступные      |                             |
|   |            | символы: латинские    |                             |
|   |            | буквы a--z и A--Z,    |                             |
|   |            | цифры 0--9 и знаки    |                             |
|   |            | пунктуации            |                             |
|   |            | (#\$%                 |                             |
|   |            | \*+--=?\^\_\`{}\|\~.) |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Указан некорректный   |                             |
| 4 | SIA-032104 | формат домена для     |                             |
| . |            | адреса электронной    |                             |
|   |            | почты. Доступные      |                             |
|   |            | символы: латинские    |                             |
|   |            | буквы a -- z и A --   |                             |
|   |            | Z, цифры 0--9 и знаки |                             |
|   |            | пунктуации            |                             |
|   |            | (#\$%                 |                             |
|   |            | \*+--=?\^\_\`{}\|\~.) |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Недопустимо           |                             |
| 5 | SIA-032105 | использовать два\     |                             |
| . |            | и более раза подряд   |                             |
|   |            | следующие символы:    |                             |
|   |            | \".\", \"--\"         |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Не указан адрес       | Данный код возврата         |
| 6 | SIA-032110 | электронной почты при | соответствует ситуации,     |
| . |            | вызове метода импорта | когда в запросе передан     |
|   |            |                       | пустой параметр EML         |
|   |            | и указании пустого    |                             |
|   |            | значения в атрибуте   |                             |
|   |            | EML                   |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Не указан номер       |                             |
| 7 | SIA-032200 | мобильного телефона   |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Номер мобильного      |                             |
| 8 | SIA-032201 | телефона содержит     |                             |
| . |            | недопустимые символы  |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Номер мобильного      |                             |
| 9 | SIA-032202 | телефона указан       |                             |
| . |            | в неверном формате    |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Указан некорректный   |                             |
| 0 | SIA-032203 | номер мобильного      |                             |
| . |            | телефона              |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Указанный номер       | Данный код ошибки           |
| 1 | SIA-032205 | телефона уже          | возвращается\               |
| . |            | используется для      | при повторном импорте,\     |
|   |            | регистрации УЗ        | когда на указанный          |
|   |            |                       | в запросе номер телефона    |
|   |            |                       | уже есть заявка на          |
|   |            |                       | регистрацию новой УЗ, от    |
|   |            |                       | пользователя получено       |
|   |            |                       | подтверждение по СМС        |
|   |            |                       | и запущены проверки данных  |
|   |            |                       | в БГИР                      |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Не указан тип         |                             |
| 2 | SIA-033000 | документа             |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Введите серию         |                             |
| 3 | SIA-033001 | документа             |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Введите номер         |                             |
| 4 | SIA-033002 | документа             |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Не указана дата       |                             |
| 5 | SIA-033003 | выдачи документа      |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Не указано ведомство, |                             |
| 6 | SIA-033004 | выдавшее документ     |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Укажите дату выдачи   |                             |
| 7 | SIA-033005 | документа             |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Некорректная дата     |                             |
| 8 | SIA-033006 | выдачи документа      |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 2 | E          | Укажите дату          | Если загранпаспорт указан в |
| 9 | SIA-033007 | окончания срока       | качестве документа,         |
| . |            | действия документа    | удостоверяющего личность    |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Некорректная дата     | Если загранпаспорт указан в |
| 0 | SIA-033008 | окончания срока       | качестве документа,         |
| . |            | действия документа    | удостоверяющего личность    |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Дата окончания срока  | Если загранпаспорт указан в |
| 1 | SIA-033009 | действия документа    | качестве документа,         |
| . |            | должна быть меньше,   | удостоверяющего личность    |
|   |            | чем дата выдачи       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Document type is      | Указан неверный тип         |
| 2 | SIA-033010 | wrong                 | документа, удостоверяющего  |
| . |            |                       | личность                    |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Длина названия        |                             |
| 3 | SIA-033011 | ведомства, выдавшего  |                             |
| . |            | документ, должна быть |                             |
|   |            | меньше {количество}   |                             |
|   |            | символов              |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Серия паспорта должна |                             |
| 4 | SIA-033100 | состоять из           |                             |
| . |            | {количество} цифр     |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Серия паспорта может  |                             |
| 5 | SIA-033101 | содержать только      |                             |
| . |            | цифры                 |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Номер паспорта должен |                             |
| 6 | SIA-033102 | состоять из           |                             |
| . |            | {количество} цифр     |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Номер паспорта может  |                             |
| 7 | SIA-033103 | содержать только      |                             |
| . |            | цифры                 |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Введите код           |                             |
| 8 | SIA-033104 | подразделения         |                             |
| . |            | в паспорте            |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 3 | E          | Код подразделения     |                             |
| 9 | SIA-033105 | в паспорте должен     |                             |
| . |            | состоять из           |                             |
|   |            | {количество} цифр     |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Код подразделения     |                             |
| 0 | SIA-033106 | в паспорте может      |                             |
| . |            | содержать только      |                             |
|   |            | цифры                 |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | RF Passport issuer    | Неверная длина поля «Выдан» |
| 1 | SIA-033109 | element wrong length  | для паспорта РФ             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | RF Passport issuer    | В поле «Выдан» паспорта РФ  |
| 2 | SIA-033110 | element wrong         | указан недопустимый символ  |
| . |            | character             |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Серия документа может |                             |
| 3 | SIA-033201 | содержать только      |                             |
| . |            | цифры, тире, буквы    |                             |
|   |            | русского и латинского |                             |
|   |            | алфавита              |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Номер документа может |                             |
| 4 | SIA-033202 | содержать только      |                             |
| . |            | цифры, тире, буквы    |                             |
|   |            | русского и латинского |                             |
|   |            | алфавита              |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Серия документа       |                             |
| 5 | SIA-033300 | должна состоять из    |                             |
| . |            | {количество} символов |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Серия документа может |                             |
| 6 | SIA-033301 | содержать только      |                             |
| . |            | цифры                 |                             |
|   |            |                       |                             |
|   |            | и буквы русского      |                             |
|   |            | алфавита              |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Номер документа       |                             |
| 7 | SIA-033302 | должен состоять из    |                             |
| . |            | {количество} цифр     |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | Номер документа может |                             |
| 8 | SIA-033303 | содержать только      |                             |
| . |            | цифры                 |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 4 | E          | ZipCode element is    | Не указан индекс для адреса |
| 9 | SIA-034000 | empty                 | РФ. Поле «Индекс»           |
| . |            |                       | присутствует, но не         |
|   |            |                       | заполнено                   |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | ZipCode format is     | Неверный формат индекса     |
| 0 | SIA-034001 | wrong                 |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Address type is wrong | Неверный тип адреса         |
| 1 | SIA-034002 |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | AddressStr element is | Не указано значение поля    |
| 2 | SIA-034004 | empty                 | addressStr                  |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Address elements      | В адресе не указаны         |
| 3 | SIA-034005 | House, Building,      | значения                    |
| . |            | Frame are null        | дом/корпус/строение         |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Address element       | Указан неверный код страны  |
| 4 | SIA-034006 | countryId is wrong    |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Не указана фамилия    |                             |
| 5 | SIA-035100 |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Не указано имя        |                             |
| 6 | SIA-035101 |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Поле может содержать  |                             |
| 7 | SIA-035102 | только буквы русского |                             |
| . |            | или латинского        |                             |
|   |            | алфавитов, цифры,     |                             |
|   |            | дефис, пробел,        |                             |
|   |            | апостроф, точку,      |                             |
|   |            | запятую. Запятая      |                             |
|   |            | допустима только      |                             |
|   |            | в середине слова.     |                             |
|   |            | В поле недопустимо    |                             |
|   |            | одновременно          |                             |
|   |            | использовать русские  |                             |
|   |            | и латинские буквы     |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Не указан пол         |                             |
| 8 | SIA-035103 |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 5 | E          | Укажите дату рождения |                             |
| 9 | SIA-035104 |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Некорректная дата     |                             |
| 0 | SIA-035105 | рождения              |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Укажите гражданство   |                             |
| 1 | SIA-035106 |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Укажите               |                             |
| 2 | SIA-035107 | идентификационный     |                             |
| . |            | документ              |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Указанный документ не |                             |
| 3 | SIA-035108 | является              |                             |
| . |            | идентификационным     |                             |
|   |            | документом            |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Указанные             | Данный код ошибки           |
| 4 | SIA-035109 | идентификационный     | возвращается в том случае,  |
| . |            | документ и            | если при импорте            |
|   |            | гражданство\          | указывается гражданство РФ  |
|   |            | не соответствуют друг | и документ иностранного     |
|   |            | другу                 | гражданина                  |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Указаный пол          |                             |
| 5 | SIA-035110 | {наименование}        |                             |
| . |            | не соответствует      |                             |
|   |            | словарю               |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Указанное гражданство |                             |
| 6 | SIA-035111 | {наименование}        |                             |
| . |            | не соответствует      |                             |
|   |            | словарю               |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Укажите место         |                             |
| 7 | SIA-035112 | рождения              |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Укажите вид на        |                             |
| 8 | SIA-035113 | жительство или        |                             |
| . |            | разрешение на         |                             |
|   |            | временное проживание  |                             |
+---+------------+-----------------------+-----------------------------+
| 6 | E          | Указанная страна      |                             |
| 9 | SIA-035115 | рождения              |                             |
| . |            | {Наименование}        |                             |
|   |            | не соответствует      |                             |
|   |            | словарю               |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | В УЗ пользователя     |                             |
| 0 | SIA-035116 | не проверен в БГИР    |                             |
| . |            | документ,             |                             |
|   |            | удостоверяющий        |                             |
|   |            | личность              |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Количество символов   | Для поля «Кем выдан»        |
| 1 | SIA-035117 | не должно превышать   | (паспорт)                   |
| . |            | 700 символов          |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Поле может содержать  | Для поля «Имя»              |
| 2 | SIA-035118 | только буквы русского |                             |
| . |            | или латинского        |                             |
|   |            | алфавитов, цифры,     |                             |
|   |            | дефис, пробел,        |                             |
|   |            | апостроф, точку,      |                             |
|   |            | запятую. Запятая      |                             |
|   |            | допустима только      |                             |
|   |            | в середине слова.     |                             |
|   |            | В поле недопустимо    |                             |
|   |            | одновременно          |                             |
|   |            | использовать русские\ |                             |
|   |            | и латинские буквы     |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Количество символов   | Для поля «Месторождение»    |
| 3 | SIA-035119 | не должно превышать   |                             |
| . |            | 700 символов          |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Количество символов в | Для поля «Месторождение»,   |
| 4 | SIA-035120 | слове не должно       | если значение указано более |
| . |            | превышать 30 символов | одного слова, то отдельное  |
|   |            |                       | слово не должно превышать   |
|   |            |                       | 30 символов                 |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Введите СНИЛС         | Не указан СНИЛС             |
| 5 | SIA-036100 |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Некорректный формат   |                             |
| 6 | SIA-036101 | СНИЛС                 |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Введенный СНИЛС не    | Указанный СНИЛС некорректен |
| 7 | SIA-036102 | существует            | (неверная контрольная       |
| . |            |                       | сумма)                      |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | Найденная упрощенная  | Данный код возврата         |
| 8 | SIA-039601 | запись уже            | соответствует ситуации,     |
| . |            | подтверждается        | когда найдена упрощенная    |
|   |            |                       | УЗ\                         |
|   |            |                       | по контакту, но в ней уже   |
|   |            |                       | идут проверки данных в БГИР |
+---+------------+-----------------------+-----------------------------+
| 7 | E          | В найденной УЗ        |                             |
| 9 | SIA-039602 | отсутствует           |                             |
| . |            | подтвержденный номер  |                             |
|   |            | телефона              |                             |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Указанный в запросе   |                             |
| 0 | SIA-039603 | номер телефона не     |                             |
| . |            | совпадает             |                             |
|   |            | с подтвержденным      |                             |
|   |            | в найденной УЗ        |                             |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Паспортные данные\    | Запущена проверка паспорта  |
| 1 | SIA-039604 | на проверке.          | на Госуслугах               |
| . |            | Повторите попытку     |                             |
|   |            | позже (обычно это     | Проверка займет менее часа, |
|   |            | занимает час, в       | в редких случаях до 3 дней. |
|   |            | редких случаях до     | Повторите попытку позже     |
|   |            | трех дней)            |                             |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Обновите паспортные   | Паспортные данные в банке   |
| 2 | SIA-039605 | данные в банке и      | неактуальны.                |
| . |            | продолжите            |                             |
|   |            | регистрацию           | Учетная запись на           |
|   |            |                       | Госуслугах содержит более   |
|   |            |                       | новые паспортные данные.    |
|   |            |                       | Обновите паспортные данные  |
|   |            |                       | в офисе банка\              |
|   |            |                       | и повторите попытку на      |
|   |            |                       | следующий день              |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Паспортные данные     | Заявка уже обрабатывается.  |
| 3 | SIA-039606 | отправлены на         |                             |
| . |            | проверку. Повторите   | Идет проверка паспорта на   |
|   |            | попытку позже (обычно | Госуслугах. Она занимает до |
|   |            | это занимает час,\    | 3 дней. Повторите попытку   |
|   |            | в редких случаях до   | позже                       |
|   |            | трех дней)            |                             |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Обнаружена УЗ,\       | Паспортные данные из банка  |
| 4 | SIA-039607 | для которой не        | не найдены\                 |
| . |            | удалось сопоставить   | в МВД России.               |
|   |            | указанные\            |                             |
|   |            | в ИС данные           | Обратитесь в ближайший офис |
|   |            |                       | банка: мы проверим и при    |
|   |            |                       | необходимости обновим       |
|   |            |                       | данные паспорта (ФИО,       |
|   |            |                       | серия, номер)\              |
|   |            |                       | в вашем профиле             |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | По данным МВД России  | Паспортные данные           |
| 5 | SIA-039608 | паспорт из ИС         | неактуальны.                |
| . |            | числится\             |                             |
|   |            | как не актуальный     | Если вы меняли паспорт --   |
|   |            |                       | обратитесь\                 |
|   |            |                       | в ближайший офис банка: мы  |
|   |            |                       | обновим сведения в профиле. |
|   |            |                       | Если ваши данные верны --   |
|   |            |                       | воспользуйтесь              |
|   |            |                       | онлайн-сервисом МВД         |
|   |            |                       | России\*, или обратитесь в  |
|   |            |                       | ближайшее отделение МВД     |
|   |            |                       | России, чтобы сообщить\     |
|   |            |                       | о проблеме                  |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Email уже             | Указанный адрес электронной |
| 6 | SIA-039803 | используется\         | почты уже используется и    |
| . |            | в другой УЗ.          | успешно подтвержден         |
|   |            | Восстановите доступ к | в другой УЗ                 |
|   |            | УЗ или укажите другой |                             |
|   |            | email                 |                             |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | УЗ уже активна        | Данный код возвращается в   |
| 7 | SIA-039805 |                       | случае,\                    |
| . |            |                       | когда на момент запроса     |
|   |            |                       | статуса по импорту          |
|   |            |                       | пользователь                |
|   |            |                       | зарегистрировал             |
|   |            |                       | и подтвердил другую УЗ      |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Пользователь уже      | Данный код возвращается в   |
| 8 | SIA-039807 | подтвержден           | случае,\                    |
| . |            |                       | когда пользователь          |
|   |            |                       | подтверждает свою УЗ по     |
|   |            |                       | запросу импорта, но УЗ уже  |
|   |            |                       | подтверждена ранее          |
+---+------------+-----------------------+-----------------------------+
| 8 | E          | Номер мобильного      | Данный код возврата         |
| 9 | SIA-039810 | телефона уже          | соответствует ситуации,     |
| . |            | используется в другой | когда указанный номер       |
|   |            | УЗ.\                  | телефона используется в     |
|   |            | Если вы уже           | другой УЗ                   |
|   |            | регистрировались,     |                             |
|   |            | попробуйте войти      |                             |
|   |            | в свою УЗ. Если вы не |                             |
|   |            | регистрировались,     |                             |
|   |            | укажите другой номер  |                             |
|   |            | мобильного телефона\  |                             |
|   |            | или удалите номер     |                             |
|   |            | телефона\             |                             |
|   |            | из формы регистрации  |                             |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Номер мобильного      | Данный код возврата         |
| 0 | SIA-039812 | телефона уже          | соответствует ситуации,     |
| . |            | используется в другой | когда номер телефона        |
|   |            | УЗ. Вы сможете        | подтвержден в другой УЗ     |
|   |            | зарегистрировать УЗ\  | менее 30 суток назад и его  |
|   |            | на этот номер         | использование при           |
|   |            | телефона\             | регистрации новой учетной   |
|   |            | не ранее дд.мм.гггг.  | записи невозможно           |
|   |            | Восстановите доступ к |                             |
|   |            | УЗ или укажите другой |                             |
|   |            | номер мобильного      |                             |
|   |            | телефона              |                             |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Указанный номер       | Данный код возврата         |
| 1 | SIA-039815 | телефона уже          | соответствует ситуации,     |
| . |            | используется для      | когда существует заявка\    |
|   |            | регистрации учетной   | на регистрацию новой        |
|   |            | записи и ожидается    | учетной записи\             |
|   |            | подтверждение         | на указанный при повторном  |
|   |            | регистрации           | импорте телефон, но еще     |
|   |            |                       | ожидается СМС/REST API      |
|   |            |                       | подтверждение от            |
|   |            |                       | пользователя (прошло менее  |
|   |            |                       | 3 дней)                     |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Заявка с таким        | Данный код возврата         |
| 2 | SIA-039816 | номером\              | соответствует ситуации,     |
| . |            | не найдена.           | когда указанный             |
|   |            | Проверьте, правильно  | индентификатор заявки не    |
|   |            | ли введен номер, или  | найден в ЕСИА               |
|   |            | повторите операцию    |                             |
|   |            | заново                |                             |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Для подтверждения     | Данный код ошибки           |
| 3 | SIA-039841 | стандартной учетной   | возвращается в том случае,  |
| . |            | записи данный метод   | если пользователь не готов\ |
|   |            | недоступен            | к подтверждению (snils =    |
|   |            |                       | null, уз не PVD,\           |
|   |            |                       | и не PR)                    |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Пенсионный фонд       |                             |
| 4 | SIA-910001 | Российской Федерации  |                             |
| . |            | не подтвердил         |                             |
|   |            | существование СНИЛС\  |                             |
|   |            | с указанными          |                             |
|   |            | реквизитами           |                             |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Данные не прошли      |                             |
| 5 | SIA-910100 | проверку\             |                             |
| . |            | в МВД России          |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Данные не прошли      | МВД России сообщило\        |
| 6 | SIA-910111 | проверку\             | о недействительности        |
| . |            | в МВД России. Истек   | документа (причина          |
|   |            | срок действия         | недействительности -- истек |
|   |            | паспорта              | срок действия паспорта)     |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Данные не прошли      | МВД России сообщило\        |
| 7 | SIA-910112 | проверку\             | о недействительности        |
| . |            | в МВД России.         | документа (причина          |
|   |            | Документ заменен\     | недействительности --       |
|   |            | на новый              | документ заменен\           |
|   |            |                       | на новый)                   |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Данные не прошли      | МВД России сообщило\        |
| 8 | SIA-910113 | проверку\             | о недействительности        |
| . |            | в МВД России.         | документа (причина          |
|   |            | Документ выдан\       | недействительности --       |
|   |            | с нарушением          | документ выдан\             |
|   |            |                       | с нарушением)               |
+---+------------+-----------------------+-----------------------------+
| 9 | E          | Данные не прошли      | МВД России сообщило\        |
| 9 | SIA-910114 | проверку\             | о недействительности        |
| . |            | в МВД России.         | документа (причина          |
|   |            | Документ числится в   | недействительности --       |
|   |            | розыске               | документ числится\          |
|   |            |                       | в розыске)                  |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Данные не прошли      | МВД России сообщило\        |
| 0 | SIA-910115 | проверку\             | о недействительности        |
| 0 |            | в МВД России.         | документа (причина          |
| . |            | Документ изъят        | недействительности --       |
|   |            |                       | документ изъят)             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Данные не прошли      | МВД России сообщило\        |
| 0 | SIA-910116 | проверку\             | о недействительности        |
| 1 |            | в МВД России. Код 606 | документа (причина          |
| . |            | (в связи\             | недействительности -- в     |
|   |            | со смертью владельца) | связи\                      |
|   |            |                       | со смертью владельца)       |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Данные не прошли      | МВД России сообщило\        |
| 0 | SIA-910117 | проверку\             | о недействительности        |
| 2 |            | в МВД России.         | документа (причина          |
| . |            | Технический брак      | недействительности --       |
|   |            |                       | технический брак)           |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Данные не прошли      | МВД России сообщило\        |
| 0 | SIA-910118 | проверку\             | о недействительности        |
| 3 |            | в МВД России.         | документа (причина          |
| . |            | Неизвестный статус    | недействительности --       |
|   |            |                       | неизвестный статус)         |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Данные не прошли      | МВД России сообщило\        |
| 0 | SIA-910120 | проверку\             | о недействительности        |
| 4 |            | в МВД России. Паспорт | документа (причина          |
| . |            | не найден             | недействительности --       |
|   |            |                       | паспорт\                    |
|   |            |                       | не найден)                  |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Registration          | Истекло время ожидания      |
| 0 | SIA-910307 | Endorsement by SMS is | ответного СМС-сообщения с   |
| 5 |            | falied                | согласием на регистрацию\   |
| . |            |                       | или исчерпано количество    |
|   |            |                       | попыток отправки ответного  |
|   |            |                       | СМС--сообщения (время       |
|   |            |                       | ожидания -- 3 суток,        |
|   |            |                       | количество попыток -- 3     |
|   |            |                       | шт.).                       |
|   |            |                       |                             |
|   |            |                       | Примечание: относится к     |
|   |            |                       | случаю с СМС                |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Вид сведения СФР\     |                             |
| 0 | SIA-910313 | недоступен            |                             |
| 6 |            |                       |                             |
| . |            |                       |                             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+

Система, используя имеющийся идентификатор заявки на регистрацию
пользователя, может узнать статус заявки, а также причину ошибки (при ее
наличии).\
Для получения данных о ходе выполнения проверок система должна выполнить
запрос методом GET в https-адрес REST API системы ЕСИА[^50]. Запрос
также должен содержать маркер доступа системы на область доступа (scope)
ext_imp. Пример запроса (вызов сервиса в тестовой среде):

GET https://esia-portal1.test.gosuslugi.ru/rs/reqs/
AAAA5F79379F965664CB739F5BDC6FD8E24797A576A4F056322D

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6M

В качестве ответа ЕСИА возвращает JSON с параметрами, указанными\
в таблице 74.

Таблица 74 -- Параметры ответа на запрос о статусе проверки данных
пользователя

+---+--------------+---------------+-----------------------------------+
| * | **Параметр** | **Обя         | **Описание**                      |
| * |              | зательность** |                                   |
| № |              |               |                                   |
| * |              |               |                                   |
| * |              |               |                                   |
+===+==============+===============+===================================+
| 1 | status       | Y             | Статус заявки на регистрацию      |
| . |              |               | пользователя. Может принимать     |
|   |              |               | значения:                         |
|   |              |               |                                   |
|   |              |               | -   VALIDATING -- идет проверка   |
|   |              |               |     данных УЗ\                    |
|   |              |               |     в БГИР;                       |
|   |              |               |                                   |
|   |              |               | -   VALIDATION_FAILED -- ошибка   |
|   |              |               |     при проверке данных УЗ в      |
|   |              |               |     БГИР, детализация ошибки      |
|   |              |               |     содержится в параметре        |
|   |              |               |     errorStatusInfo;              |
|   |              |               |                                   |
|   |              |               | -   SUCCEEDED -- операция успешно |
|   |              |               |     выполнена                     |
+---+--------------+---------------+-----------------------------------+
| 2 | personOid    | N             | Идентификатор зарегистрированной  |
| . |              |               | УЗ (возвращается в случае успешно |
|   |              |               | выполненной операции импорта УЗ   |
|   |              |               | в ЕСИА)                           |
+---+--------------+---------------+-----------------------------------+
| 3 | flowDetails  | N             | Возвращает данные о задаче, ее    |
| . |              |               | статус,\                          |
|   |              |               | а при наличии -- об ошибке.       |
|   |              |               |                                   |
|   |              |               | Включает в себя следующие         |
|   |              |               | атрибуты:                         |
|   |              |               |                                   |
|   |              |               | -   имя (name), принимающее       |
|   |              |               |     следующие значения:           |
|   |              |               |                                   |
|   |              |               | -   до момента завершения         |
|   |              |               |     проверки СНИЛС:               |
|   |              |               |                                   |
|   |              |               | -   raRegistrationEndorsement --  |
|   |              |               |     подтверждение пользователем   |
|   |              |               |     регистрации по СМС;           |
|   |              |               |                                   |
|   |              |               | -   sendSMS -- отправка пароля    |
|   |              |               |     для первого входа;            |
|   |              |               |                                   |
|   |              |               | -   validateSnils -- проверка     |
|   |              |               |     ФИО, СНИЛС и даты рождения в  |
|   |              |               |     СФР;                          |
|   |              |               |                                   |
|   |              |               | -   после упешного завершения     |
|   |              |               |     проверки СНИЛС и создания     |
|   |              |               |     упрощенной УЗ:                |
|   |              |               |                                   |
|   |              |               | -   validateRfPassport --         |
|   |              |               |     проверка паспортных данных в  |
|   |              |               |     МВД России;                   |
|   |              |               |                                   |
|   |              |               | -   статус (status), принимающий  |
|   |              |               |     следующие значения:           |
|   |              |               |                                   |
|   |              |               | -   S -- успешно выполнена;       |
|   |              |               |                                   |
|   |              |               | -   P -- в работе;                |
|   |              |               |                                   |
|   |              |               | -   W -- ожидает реакции          |
|   |              |               |     пользователя\                 |
|   |              |               |     или предыдущего связанного    |
|   |              |               |     задания;                      |
|   |              |               |                                   |
|   |              |               | -   I -- инициализирована;        |
|   |              |               |                                   |
|   |              |               | -   C -- операция отменена;       |
|   |              |               |                                   |
|   |              |               | -   F -- ошибка выполнения;       |
|   |              |               |                                   |
|   |              |               | -   ошибка (error,                |
|   |              |               |     необязательно), включающая\   |
|   |              |               |     в себя код ошибки (code)      |
|   |              |               |     и текстовое описание          |
|   |              |               |     (message).                    |
|   |              |               |                                   |
|   |              |               | При запросе паспортного досье имя |
|   |              |               | (name), принимает значение        |
|   |              |               | loadRfPassport. Статусы обработки |
|   |              |               | (status) принимают значения,      |
|   |              |               | описанные выше                    |
+---+--------------+---------------+-----------------------------------+
| 4 | err          | N             | Детальная информация об ошибке    |
| . | orStatusInfo |               | (при наличии). Формат:            |
|   |              |               |                                   |
|   |              |               | -   code -- код ошибки;           |
|   |              |               |                                   |
|   |              |               | -   message -- текстовое описание |
|   |              |               |     ошибки.                       |
|   |              |               |                                   |
|   |              |               | В случае ошибки при проверке      |
|   |              |               | паспортных данных в МВД России    |
|   |              |               | параметр code принимает значение  |
|   |              |               | ESIA-910100.                      |
|   |              |               |                                   |
|   |              |               | В случае ошибки при проверке      |
|   |              |               | СНИЛС в СФР параметр code         |
|   |              |               | принимает значение ESIA-910001    |
+---+--------------+---------------+-----------------------------------+

Пример ответа на запрос о статусе выполнения заявки (успешная регистраци
УЗ при импорте в ЕСИА):

{\"stateFacts\":\[\"Identifiable\"\],\"status\":\"SUCCEEDED\",\"personOid\":1000352622}

Пример ответа на запрос о статусе выполнения заявки (регистрация учетной
записи при импорте в ЕСИА не выполнена -- ошибка при проверке ФИО, СНИЛС
и даты рождения в СФР):

{

\"stateFacts\":\[\"Identifiable\"\],

\"status\": \"VALIDATION_FAILED\",

\"flowDetails\":

\[

 {

  \"name\":\"raRegistrationEndorsement\",

  \"status\":\"S\"

  },

 

 {

  \"name\": \"validateSnils\",

  \"status\": \"F\",

  \"error\":{\"code\": \"ESIA-910001\",

           \"message\": \"Пенсионный фонд Российской Федерации не
подтвердил существование                           СНИЛС с указанными
реквизитами\"}

  },

 {

  \"name\": \"sendSMS\",

  \"status\": \"C\"

  }

\],

\"errorStatusInfo\":

{

 \"code\": \"ESIA-910001\",

 \"message\": \"Пенсионный фонд Российской Федерации не подтвердил
существование СНИЛС с 

             указанными реквизитами\"

 }

}

Пример ответа на запрос о статусе выполнения заявки (регистрация УЗ\
при импорте в ЕСИА выполнена с ошибкой -- ошибка при проверке паспортных
данных\
в МВД России):

{

\"stateFacts\":\[\"Identifiable\"\],

\"status\": \"VALIDATION_FAILED\",

\"flowDetails\":

\[

 {

  \"name\": \"validateRfPassport\",

  \"status\": \"F\",

  \"error\":{\"code\": \"ESIA-910100\",

           \"message\": \"В&nbsp;автоматическом режиме не&nbsp;удалось
произвести проверку 

                       вашего паспорта.\"}

  }

\],

\"errorStatusInfo\":

{

 \"code\": \"ESIA-910100\",

 \"message\": \"В&nbsp;автоматическом режиме не&nbsp;удалось произвести
проверку вашего 

             паспорта.\"

 }

}

В случае отправки запроса на импорт учетной записи с указанием в URL
запроса параметра «?confirmWay=REST_API» полученный пользователем
СМС-код подтверждения должен быть отправлен системой-потребителем в ЕСИА
путем выполнения запроса методом POST:
https://esia.gosuslugi.ru/esia-rs/api/public/v2/confirmation/compare
(для продуктивной среды).

В запросе на подтверждение кода (из СМС) должны быть переданы следующие
данные, указанные в таблице 75.

Таблица 75 -- Передаваемые данные

+---+------------+-----------------------------+-----------------------+
| * | **На       | **Описание параметра**      | **Примечания**        |
| * | именование |                             |                       |
| № | п          |                             |                       |
| * | араметра** |                             |                       |
| * |            |                             |                       |
+===+============+=============================+=======================+
| 1 | requestId  | Код заявки на регистрацию   | Возвращается в случае |
| . |            |                             | создания заявки на    |
|   |            |                             | регистрацию           |
|   |            |                             |                       |
+---+------------+-----------------------------+-----------------------+
| 2 | Code       | Код подтверждения,          | Направляется          |
| . |            | отправленный пользователю   | пользователю\         |
|   |            | на номер мобильного         | в случае создания     |
|   |            | телефона                    | заявки\               |
|   |            |                             | на регистрацию        |
+---+------------+-----------------------------+-----------------------+

Пример запроса (вызов сервиса в среде разработки):

{

    \"requestId\":
\"AAAA8DC2359F965664CB21FEFBDD922BA0BD8DAAEE6727EB980A\",

    \"code\": \"2783\"

}

По полученным данным в ЕСИА выполняется проверка кода подтверждения.\
В ответе на запрос метода ЕСИА возвращает следующие параметры,
указанные\
в таблице 76.

Таблица 76 -- Возвращаемые параметры

+---+------------------+-----------------------------------------------+
| * | **Наименование   | **Описание параметра**                        |
| * | параметра**      |                                               |
| № |                  |                                               |
| * |                  |                                               |
| * |                  |                                               |
+===+==================+===============================================+
| 1 | requestId        | Код заявки на регистрацию                     |
| . |                  |                                               |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 2 | createdTime      | Время создания запроса                        |
| . |                  |                                               |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 3 | mobile           | Номер мобильного телефона                     |
| . |                  |                                               |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 4 | status           | Статус выполнения операции                    |
| . |                  |                                               |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 5 | confirmationWay  | Признак подтверждения                         |
| . |                  |                                               |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 6 | availa           | Оставшееся количество попыток ввода кода      |
| . | bleAttemptsCount | подтверждения                                 |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 7 | maxIn            | Максимальное количество попыток ввода кода    |
| . | putAttemptsCount | подтверждения                                 |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 8 | periodsF         | Интервал времени между переотправкой СМС      |
| . | orNextGeneration |                                               |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 9 | resendCount      | Количество попыток по переотправке СМС с      |
| . |                  | кодом подтверждения                           |
|   |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 1 | timeToLive       | Срок жизни кода подтверждения                 |
| 0 |                  |                                               |
| . |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+
| 1 | maxResendCount   | Максимальное количество попыток на            |
| 1 |                  | переотправку СМС                              |
| . |                  |                                               |
|   |                  |                                               |
+---+------------------+-----------------------------------------------+

Пример ответа в случае, если код подтверждения указан правильно:

{ 

   \"requestId\":\"AAAA0EF8369F965664CB48D753590B7269A3CF453DD0554E4DBA\",

   \"createdTime\":1557766520905,

   \"mobile\":\"79000000000\",

   \"status\":\"ОК\",

   \"confirmationWay\":\"REST_API\",

   \"availableAttemptsCount\":5,

   \"maxInputAttemptsCount\":5,

   \"periodsForNextGeneration\":\[ 

      60000,

      60000,

      60000

   \],

   \"resendCount\":1,

\"maxResendCount\":5,

   \"timeToLive\":86400000

}

В таблице ниже перечислены возможные статусы (поле: status) выполнения
операции, указанные в таблице 77.

Таблица 77 -- Статусы выполнения операции

+---+---------------------+--------------------------------------------+
| * | **Наименование      | **Описание параметра**                     |
| * | параметра**         |                                            |
| № |                     |                                            |
| * |                     |                                            |
| * |                     |                                            |
+===+=====================+============================================+
| 1 | OK                  | Код подтверждения указан верно             |
| . |                     |                                            |
|   |                     |                                            |
|   |                     |                                            |
+---+---------------------+--------------------------------------------+
| 2 | WAIT                | Код подтверждения указан неверно           |
| . |                     |                                            |
|   |                     |                                            |
|   |                     |                                            |
+---+---------------------+--------------------------------------------+
| 3 | NOT_FOUND           | Информация о данном коде подтверждения не  |
| . |                     | найдена                                    |
|   |                     |                                            |
|   |                     |                                            |
+---+---------------------+--------------------------------------------+
| 4 | TOO_FAST_RESEND     | Невозможно выполнить переотправку СМС с    |
| . |                     | кодом подтверждения. С момента отправки    |
|   |                     | последнего СМС прошло слишком мало времени |
|   |                     | (параметр: periodsForNextGeneration)       |
+---+---------------------+--------------------------------------------+
| 5 | RESE                | Повторная переотправка СМС невозможна      |
| . | ND_LIMIT_IS_REACHED | (параметр: resendCount). При достижении    |
|   |                     | лимита попыток переотправки СМС требуется  |
|   |                     | выполнять повторный импорт УЗ              |
+---+---------------------+--------------------------------------------+
| 6 | EXPIRED             | Истек срок жизни кода подтверждения        |
| . |                     | (параметр: timeToLive)                     |
|   |                     |                                            |
|   |                     |                                            |
+---+---------------------+--------------------------------------------+
| 7 | FAILED              | Исчерпаны попытки ввода кода подтверждения |
| . |                     |                                            |
|   |                     |                                            |
|   |                     |                                            |
+---+---------------------+--------------------------------------------+

Для переотправки пользователю СМС-кода подтверждения необходимо
выполнить запрос методом POST:

https://esia.gosuslugi.ru/esia-rs/api/public/v2/confirmation/resend/requestId
(для продуктивной среды). В запросе необходимо указывать код заявки на
регистрацию (параметр: requestId).

### Модернизированный сервис импорта учетных записей пользователя из внешних ИС

Обновленный алгоритм, по которому производится импорт УЗ, представленный
в п. А.9, Приложение А, изображен на рисунке 4.

Данный алгоритм включается настройкой на стороне ЕСИА для конкретных ИС
по решению Минцифры России, согласованному с Центральным банком
Российской Федерации (Банком России). ИС, для которых данный механизм
включен, обязаны предупреждать пользователя о возможном сбросе пароля\
и замене телефона. Рекомендуемый текст:

"Если мы найдем учетную запись на Госуслугах и номер телефона в ней не
совпадет с выбранным, мы обновим номер и пришлем на него СМС с новым
паролем для входа."

Обновленный механизм проверки паспортных данных в импорте представлен
также на рисунке 4.

В таблице 78 приведены новые коды ответов от сервиса импорта.

Таблица 78 -- Коды и описание ошибок от сервиса импорта

+---+-----------+----------------------+-------------------------------+
| * | **Код     | **Описание кода      | **Комментарии**               |
| * | в         | возврата**           |                               |
| № | озврата** |                      |                               |
| * |           |                      |                               |
| * |           |                      |                               |
+===+===========+======================+===============================+
| 1 | ES        | Паспортные данные\   | **Запущена проверка паспорта  |
| . | IA-039604 | на проверке.         | на Госуслугах**               |
|   |           | Повторите попытку    |                               |
|   |           | позже (обычно это    | Проверка займет менее часа, в |
|   |           | занимает час, в      | редких случаях до 3 дней.     |
|   |           | редких случаях до    | Повторите попытку позже       |
|   |           | трех дней)           |                               |
+---+-----------+----------------------+-------------------------------+
| 1 | ES        | Обновите паспортные  | **Паспортные данные в банке   |
| 0 | IA-039605 | данные в банке       | неактуальны**                 |
| 7 |           | и продолжите         |                               |
| . |           | регистрацию          | УЗ на Госуслугах содержит     |
|   |           |                      | более новые паспортные        |
|   |           |                      | данные. Обновите паспортные   |
|   |           |                      | данные в офисе банка и        |
|   |           |                      | повторите попытку\            |
|   |           |                      | на следующий день             |
+---+-----------+----------------------+-------------------------------+
| 1 | ES        | Паспортные данные    | **Заявка уже обрабатывается** |
| 0 | IA-039606 | отправлены           |                               |
| 8 |           | на проверку.         | Идет проверка паспорта на     |
| . |           | Повторите попытку    | Госуслугах. Она занимает до 3 |
|   |           | позже (обычно это    | дней. Повторите попытку позже |
|   |           | занимает час, в      |                               |
|   |           | редких случаях до    |                               |
|   |           | трех дней)           |                               |
+---+-----------+----------------------+-------------------------------+
| 1 | ES        | Обнаружена УЗ, для   | **Паспортные данные из банка  |
| 0 | IA-039607 | которой\             | не найдены\                   |
| 9 |           | не удалось           | в МВД России**                |
| . |           | сопоставить          |                               |
|   |           | указанные в ИС       | Обратитесь в ближайший офис   |
|   |           | данные               | банка: мы проверим и при      |
|   |           |                      | необходимости обновим данные  |
|   |           |                      | паспорта (ФИО, серия, номер)  |
|   |           |                      | в вашем профиле               |
+---+-----------+----------------------+-------------------------------+
| 1 | ES        | По данным МВД России | **Паспортные данные           |
| 1 | IA-039608 | паспорт из ИС        | неактуальны**                 |
| 0 |           | числится как         |                               |
| . |           | неактуальный         | Если вы меняли паспорт --     |
|   |           |                      | обратитесь в ближайший офис   |
|   |           |                      | банка: мы обновим сведения в  |
|   |           |                      | профиле. Если ваши данные     |
|   |           |                      | верны -- воспользуйтесь       |
|   |           |                      | [онлайн-сервисом МВД          |
|   |           |                      | России\*]{.underline} или     |
|   |           |                      | обратитесь в ближайшее        |
|   |           |                      | отделение МВД России, чтобы   |
|   |           |                      | сообщить о проблеме           |
+---+-----------+----------------------+-------------------------------+

\*Рекомендуется ссылка на инструкцию:

+-----------------------------------------------------------------------+
| Для того, чтобы воспользоваться онлайн--сервисом МВД России,          |
| необходимо:                                                           |
|                                                                       |
| 1\) перейти по ссылке                                                 |
| <https://сервисы.гувм.мвд.рф/info–service.htm?sid=2000>;              |
|                                                                       |
| 2\) заполнить серию и номер паспорта, а также код с картинки и нажать |
| кнопку «Отправить запрос»;\                                           |
| 3) убедиться, что Ваш паспорт числится в базе недействительным;       |
|                                                                       |
| 4\) нажать кнопку «Сообщить об ошибке»;\                              |
| 5) в поле «Описание ошибки» сообщить о проблеме.                      |
|                                                                       |
| Пример:                                                               |
|                                                                       |
| При проверке паспортных данных сервисом МВД получена ошибка. Паспорт  |
| (указать -- серию паспорта, номер паспорта, дату выдачи и код         |
| подразделения) на имя (указать -- Фамилия Имя Отчество), дата         |
| рождения (указать дату рождения) признан недействительным (причина).  |
| Прошу провести корректировку в базе.                                  |
|                                                                       |
| 6\) заполнить адрес электронной̆ почты, ФИО и нажать кнопку            |
| «Отправить»;                                                          |
|                                                                       |
| 7\) ответ придет на указанную электронную почту в течение 30 дней.    |
+=======================================================================+
+-----------------------------------------------------------------------+

### Автоматический поиск СНИЛС при регистрации УЗ пользователя методом импорта

При регистрации УЗ ЕСИА методом импорта реализована возможность запроса\
на автоматический поиск СНИЛС по паспортным данным пользователя.

Для импорта учетных записей система-клиент должна направить в
https-адрес REST API системы ЕСИА запрос методом POST:
https://esia.gosuslugi.ru/esia-rs/api/public/v2/import/snils/search (для
продуктивной среды).

При возврате положительного ответа на запрос на поиск СНИЛС (статус
«ОК») доступно отправление запроса на регистрацию УЗ методом импорта (п.
А.9) без указания СНИЛС в теле запроса.

Так как поиск СНИЛС занимает определенное время, до получения ответа\
с положительным статусом («ОК») или с ошибкой («ERROR») необходимо
отправлять повторные запросы на поиск СНИЛС с теми же данными
пользователя. Рекомендуемая частота повторных запросов: 5 секунд.
Рекомендуемое время ожидания положительного или отрицательного ответа
при повторных вызовах метода: 60 -- 120 секунд.

В запросе на поиск СНИЛС должны быть переданы следующие данные
пользователя (таблица 79).

Таблица 79 -- Данные пользователя в запросе на поиск СНИЛС

+---+-------------+--------------+------------+------------------------+
| № | Н           | Описание     | Обяз       | Примечания             |
|   | аименование | параметра    | ательность |                        |
|   | параметра   |              | параметра  |                        |
+===+=============+==============+============+========================+
| 1 | firstName   | Имя          | Y          | Текстовая строка,      |
| . |             |              |            | содержащая не более    |
|   |             |              |            | 256 символов           |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 2 | lastName    | Фамилия      | Y          | Текстовая строка,      |
| . |             |              |            | содержащая не более    |
|   |             |              |            | 256 символов           |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 3 | middleName  | Отчество     | Y/N        | Текстовая строка,      |
| . |             |              |            | содержащая не более    |
|   |             |              |            | 256 символов.          |
|   |             |              |            | Необязательно в        |
|   |             |              |            | случае,\               |
|   |             |              |            | если отчество          |
|   |             |              |            | отсутствует\           |
|   |             |              |            | в паспорте             |
+---+-------------+--------------+------------+------------------------+
| 4 | gender      | Пол          | Y          | Перечень допустимых    |
| . |             |              |            | значений:              |
|   |             |              |            |                        |
|   |             |              |            | -   «M» -- мужской;    |
|   |             |              |            |                        |
|   |             |              |            | -   «F» -- женский     |
+---+-------------+--------------+------------+------------------------+
| 5 | birthDate   | Дата         | Y          | Формат: ДД.ММ.ГГГГ     |
| . |             | рождения     |            |                        |
|   |             |              |            |                        |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 6 | birthPlace  | Место        | N          | Текстовая строка,      |
| . |             | рождения     |            | содержащая не более    |
|   |             |              |            | 700 символов           |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 7 | trusted     | Подтверждена | N          | Перечень допустимых    |
| . |             | ли УЗ        |            | значений:              |
|   |             |              |            |                        |
|   |             |              |            | -   True (да);         |
|   |             |              |            |                        |
|   |             |              |            | -   False (нет)        |
+---+-------------+--------------+------------+------------------------+
| 8 | contacts    | Контакты     | N          |                        |
| . |             |              |            |                        |
|   |             |              |            |                        |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 1 | elements    | Элемент      | N          |                        |
| . |             |              |            |                        |
|   |             |              |            |                        |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 1 | type        | Тип контакта | N          | Перечень допустимых    |
| . |             |              |            | значений:              |
|   |             |              |            |                        |
|   |             |              |            | -   «MBT» -- мобильный |
|   |             |              |            |     телефон            |
|   |             |              |            |     (необязательный    |
|   |             |              |            |     параметр);         |
|   |             |              |            |                        |
|   |             |              |            | -   «EML» --           |
|   |             |              |            |     электронная почта  |
|   |             |              |            |     (необязательный    |
|   |             |              |            |     параметр)          |
+---+-------------+--------------+------------+------------------------+
| 1 | value       | Значение     | N          | Формат:                |
| . |             |              |            |                        |
|   |             |              |            | -   «+X(XXX)XXXXXXX»\  |
|   |             |              |            |     (для type =        |
|   |             |              |            |     «MBT»);            |
|   |             |              |            |                        |
|   |             |              |            | -   текстовая строка в |
|   |             |              |            |     формате адреса     |
|   |             |              |            |     электронной почты\ |
|   |             |              |            |     (для type = «EML») |
+---+-------------+--------------+------------+------------------------+
| 9 | documents   | Документы    | Y          |                        |
| . |             |              |            |                        |
|   |             |              |            |                        |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 1 | elements    | Элемент      | Y          |                        |
| . |             |              |            |                        |
|   |             |              |            |                        |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 1 | type        | Тип          | Y          | Перечень допустимых    |
| . |             | документа    |            | значений:              |
|   |             |              |            |                        |
|   |             |              |            | -   «RF_PASSPORT» --   |
|   |             |              |            |     паспорт гражданина |
|   |             |              |            |     РФ;                |
|   |             |              |            |                        |
|   |             |              |            | -   «FID_DOC» --       |
|   |             |              |            |     документ           |
|   |             |              |            |     иностранного       |
|   |             |              |            |     гражданина,        |
|   |             |              |            |     удостоверяющий     |
|   |             |              |            |     личность\          |
|   |             |              |            |     на территории РФ;  |
|   |             |              |            |                        |
|   |             |              |            | -   «FRGN_PASS» --     |
|   |             |              |            |     заграничный        |
|   |             |              |            |     паспорт гражданина |
|   |             |              |            |     РФ                 |
+---+-------------+--------------+------------+------------------------+
| 1 | series      | серия        | Y/N        | Для паспорта           |
| . |             |              |            | гражданина РФ          |
|   |             |              |            | в формате XXXX.        |
|   |             |              |            |                        |
|   |             |              |            | Для заграничного       |
|   |             |              |            | паспорта гражданина РФ |
|   |             |              |            | в формате XX.          |
|   |             |              |            |                        |
|   |             |              |            | Необязательный для     |
|   |             |              |            | документа иностранного |
|   |             |              |            | гражданина             |
+---+-------------+--------------+------------+------------------------+
| 2 | number      | номер        | Y          | Для паспорта           |
| . |             |              |            | гражданина РФ          |
|   |             |              |            | в формате XXXXXX.      |
|   |             |              |            |                        |
|   |             |              |            | Для заграничного       |
|   |             |              |            | паспорта гражданина РФ |
|   |             |              |            | в формате XXXXXXX      |
+---+-------------+--------------+------------+------------------------+
| 3 | la          | Фамилия      | Y/N        | Только для             |
| . | tinLastName | (латиницей)  |            | заграничного паспорта  |
|   |             |              |            | гражданина РФ          |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 4 | lat         | Имя          | Y/N        | Только для             |
| . | inFirstName | (латиницей)  |            | заграничного паспорта  |
|   |             |              |            | гражданина РФ          |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 5 | issueId     | Номер        | Y/N        | Только для паспорта    |
| . |             | по           |            | гражданина РФ.         |
|   |             | дразделения, |            |                        |
|   |             | выдавшего    |            | Необязательный для     |
|   |             | паспорт      |            | документа иностранного |
|   |             |              |            | гражданина\            |
|   |             |              |            | и заграничного         |
|   |             |              |            | паспорта гражданина РФ |
+---+-------------+--------------+------------+------------------------+
| 6 | issuedBy    | Наименование | Y/N        | Только для паспорта    |
| . |             | по           |            | гражданина РФ.         |
|   |             | дразделения, |            |                        |
|   |             | выдавшего    |            | Необязательно для      |
|   |             | паспорт      |            | документа иностранного |
|   |             |              |            | гражданина             |
|   |             |              |            | и заграничного         |
|   |             |              |            | паспорта гражданина РФ |
+---+-------------+--------------+------------+------------------------+
| 7 | issueDate   | Дата выдачи  | Y          | Формат: ДД.ММ.ГГГГ     |
| . |             | паспорта     |            |                        |
|   |             |              |            |                        |
|   |             |              |            |                        |
+---+-------------+--------------+------------+------------------------+
| 8 | expireDate  | Дата         | Y/N        | Только для             |
| . |             | окончания    |            | заграничного паспорта  |
|   |             | срока        |            | гражданина РФ.         |
|   |             | действия     |            |                        |
|   |             | документа    |            | Формат: ДД.ММ.ГГГГ     |
+---+-------------+--------------+------------+------------------------+

В запрос должен быть добавлен header (Authorization: Bearer) с ранее
полученным маркером доступа, выданным на специальную область доступа
(scope) <http://esia.gosuslugi.ru/ext_imp> (см. аналогичное описание
настроек запроса в п. А.9).

В теле запроса должны быть перечислены параметры в формате JSON. Пример
тела запроса:

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| \"firstName\": \"Третьяк\",                                           |
|                                                                       |
| \"lastName\": \"Ермолов\",                                            |
|                                                                       |
| \"birthDate\": \"10.10.1988\",                                        |
|                                                                       |
| \"birthPlace\": \"Москва\",                                           |
|                                                                       |
| \"gender\": \"M\",                                                    |
|                                                                       |
| \"trusted\": \"false\",                                               |
|                                                                       |
| \"documents\": {                                                      |
|                                                                       |
| \"elements\": \[                                                      |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"type\": \"RF_PASSPORT\",                                            |
|                                                                       |
| \"series\": \"6666\",                                                 |
|                                                                       |
| \"number\": \"777774\",                                               |
|                                                                       |
| \"issueId\": \"434343\",                                              |
|                                                                       |
| \"issuedBy\": \"УФМС\",                                               |
|                                                                       |
| \"issueDate\": \"10.10.2020\"                                         |
|                                                                       |
| }                                                                     |
|                                                                       |
| \]                                                                    |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

По полученным данным запроса в ЕСИА выполняется поиск СНИЛС с запросом\
в СФР. В зависимости от того, найден ли СНИЛС, запрос может завершиться
одним\
из следующих результатов:

-   Запрос отправлен;

-   СНИЛС найден;

-   Ошибка поиска СНИЛС.

В ответе метод должен возвращать в формате JSON следующие параметры
(таблица 80).

Таблица 80 -- Данные пользователя в запросе на поиск СНИЛС

+---+--------------+-------------+------------+------------------------+
| № | Наименование | Описание    | Обяз       | Примечания             |
|   | параметра    | параметра   | ательность |                        |
|   |              |             | параметра  |                        |
+===+==============+=============+============+========================+
| 1 | id           | id запроса  | Y/N        | Необязателен только в  |
| . |              |             |            | случае,\               |
|   |              |             |            | если возвращаются      |
|   |              |             |            | параметры code и       |
|   |              |             |            | message (ошибка        |
|   |              |             |            | выполнения запроса).   |
|   |              |             |            |                        |
|   |              |             |            | Формат: целое число    |
+---+--------------+-------------+------------+------------------------+
| 2 | status       | Статус      | Y/N        | Необязателен только в  |
| . |              | запроса     |            | случае,\               |
|   |              |             |            | если возвращаются      |
|   |              |             |            | параметры code и       |
|   |              |             |            | message (ошибка        |
|   |              |             |            | выполнения запроса).   |
|   |              |             |            |                        |
|   |              |             |            | Перечень допустимых    |
|   |              |             |            | значений:              |
|   |              |             |            |                        |
|   |              |             |            | -   SENT -- запрос     |
|   |              |             |            |     отправлен;         |
|   |              |             |            |                        |
|   |              |             |            | -   OK -- СНИЛС        |
|   |              |             |            |     найден;            |
|   |              |             |            |                        |
|   |              |             |            | -   ERROR -- ошибка    |
|   |              |             |            |     поиска СНИЛС       |
+---+--------------+-------------+------------+------------------------+
| 3 | snils        | Номер       | N/Y        | Обязателен только в    |
| . |              | СНИЛС\      |            | случае статуса «ОК».   |
|   |              | в           |            |                        |
|   |              | ма          |            | Формат:                |
|   |              | скированном |            | «\*\*\*-\*\*\*-ХХХ ХХ» |
|   |              | виде        |            | (первые шесть цифр --  |
|   |              |             |            | в виде звездочек)      |
+---+--------------+-------------+------------+------------------------+
| 4 | code         | Код         | N          | Код ошибки выполнения  |
| . |              | завершения  |            | запроса                |
|   |              | операции    |            |                        |
|   |              |             |            |                        |
+---+--------------+-------------+------------+------------------------+
| 5 | message      | Текстовое   | N          | Описание для кодов     |
| . |              | описание    |            | ошибок выполнения      |
|   |              | кода ошибки |            | запроса                |
|   |              | выполнения  |            |                        |
|   |              | операции    |            |                        |
+---+--------------+-------------+------------+------------------------+

Пример ответа на запрос с кодом и описанием ошибки (функция поиска СНИЛС
отключена):

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| \"code\": \"ESIA-036110\",                                            |
|                                                                       |
| \"message\": \"Функция поиска СНИЛС отключена\"                       |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

Пример отрицательного ответа на запрос («Ошибка поиска СНИЛС»):

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| \"id\": 137,                                                          |
|                                                                       |
| \"status\": \"ERROR\"                                                 |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

Пример положительного ответа на запрос («СНИЛС найден», возвращается
статус «ОК» и маскированный СНИЛС):

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| \"id\": 1222,                                                         |
|                                                                       |
| \"status\": \"OK\",                                                   |
|                                                                       |
| \"snils\": \"\*\*\*-\*\*\*-172 77\"                                   |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

После получения положительного ответа найденный СНИЛС сохраняется\
в ЕСИА, и его указание в теле последующего запроса метода импорта УЗ (п.
А.9)\
не требуется.

Пример запроса метода импорта УЗ после получения положительного ответа\
от метода автоматического поиска СНИЛС:

+-----------------------------------------------------------------------+
| POST https://esia.gosuslugi.ru/esia-rs/api/public/v2/prns/import      |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"firstName\":\"Иванов\",                                             |
|                                                                       |
| \"lastName\":\"Иван\",                                                |
|                                                                       |
| \"middleName\":\"Иванович\",                                          |
|                                                                       |
| \"birthDate\":\"01.01.1999\",                                         |
|                                                                       |
| \"birthPlace\":\"Москва\",                                            |
|                                                                       |
| \"gender\":\"M\",                                                     |
|                                                                       |
| \"contacts\": {                                                       |
|                                                                       |
| \"elements\": \[                                                      |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"type\": \"MBT\",                                                    |
|                                                                       |
| \"value\": \"+7(999)9999999\"                                         |
|                                                                       |
| },                                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"type\": \"EML\",                                                    |
|                                                                       |
| \"value\": \"test@test.ts\"                                           |
|                                                                       |
| }                                                                     |
|                                                                       |
| \]                                                                    |
|                                                                       |
| },                                                                    |
|                                                                       |
| \"documents\": {                                                      |
|                                                                       |
| \"elements\": \[                                                      |
|                                                                       |
| {                                                                     |
|                                                                       |
| \"type\":\"RF_PASSPORT\",                                             |
|                                                                       |
| \"series\":\"2222\",                                                  |
|                                                                       |
| \"number\":\"889999\",                                                |
|                                                                       |
| \"issueId\":\"111001\",                                               |
|                                                                       |
| \"issuedBy\":\"РУВД г.Москвы\",                                       |
|                                                                       |
| \"issueDate\":\"18.03.2016\"                                          |
|                                                                       |
| }                                                                     |
|                                                                       |
| \]                                                                    |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

### Операция по восстановлению доступа к подтвержденной УЗ в ЕСИА через импорт УЗ

Для восстановления доступа к подтвержденным УЗ ЕСИА через импорт УЗ,
система-клиент должна направить в https-адрес REST API системы ЕСИА
запрос методом POST:
https://esia.gosuslugi.ru/esia-rs/api/public/v1/prns/import/recovery
(для продуктивной среды). Алгоритм, по которому производится
восстановление доступа к учетной записи, приводится на рисунке 6.

![](media/image6.emf)

Рисунок 6 -- Обобщенный алгоритм восстановления доступа к подтвержденной
УЗ ЕСИА

В запросе должны быть переданы следующие данные пользователя,
приведенные в таблице 81.

Таблица 81 -- Передаваемые данные пользователя

+----+------------+-------------+------------+-------------------------+
| *  | **На       | **Описание  | **Обяз     | **Примечания**          |
| *№ | именование | параметра** | ательность |                         |
| ** | п          |             | п          |                         |
|    | араметра** |             | араметра** |                         |
+====+============+=============+============+=========================+
| 1. | firstName  | Имя         | Y          | Текстовая строка,       |
|    |            |             |            | содержащая не более 60  |
|    |            |             |            | символов                |
+----+------------+-------------+------------+-------------------------+
| 2. | lastName   | Фамилия     | Y          | Текстовая строка,       |
|    |            |             |            | содержащая не более 60  |
|    |            |             |            | символов                |
+----+------------+-------------+------------+-------------------------+
| 3. | middleName | Отчество    | Y/N        | Текстовая строка,       |
|    |            |             |            | содержащая не более 60  |
|    |            |             |            | символов.               |
|    |            |             |            | Необязательно, в        |
|    |            |             |            | случае,\                |
|    |            |             |            | если отчество           |
|    |            |             |            | отсутствует\            |
|    |            |             |            | в паспорте              |
+----+------------+-------------+------------+-------------------------+
| 4. | birthDate  | Дата        | Y          | Формат: ДД.ММ.ГГГГ      |
|    |            | рождения    |            |                         |
+----+------------+-------------+------------+-------------------------+
| 5. | birthPlace | Место       | Y          | Текстовая строка,       |
|    |            | рождения    |            | содержащая не более 700 |
|    |            |             |            | символов                |
+----+------------+-------------+------------+-------------------------+
| 6. | c          | Г           | N/Y        | Используется            |
|    | itizenship | ражданство\ |            | трехбуквенный код       |
|    |            | по          |            | страны, например, для   |
|    |            | кла         |            | России он должен        |
|    |            | ссификатору |            | принимать значение      |
|    |            | ОКСМ        |            | RUS.\                   |
|    |            |             |            | По умолчанию            |
|    |            |             |            | принимается значение    |
|    |            |             |            | «RUS».                  |
|    |            |             |            |                         |
|    |            |             |            | Обязателен в случае,\   |
|    |            |             |            | если указанный документ |
|    |            |             |            | отличен от паспорта РФ  |
+----+------------+-------------+------------+-------------------------+
| 7. | gender     | Пол         | Y          | Перечень допустимых     |
|    |            |             |            | значений:               |
|    |            |             |            |                         |
|    |            |             |            | -   «M» -- мужской;     |
|    |            |             |            |                         |
|    |            |             |            | -   «F» -- женский      |
+----+------------+-------------+------------+-------------------------+
| 8. | snils      | СНИЛС       | N/Y        | Не требуется, если      |
|    |            |             |            | перед запросом на       |
|    |            |             |            | импорт УЗ осуществлялся |
|    |            |             |            | запрос автоматического  |
|    |            |             |            | поиска СНИЛС\           |
|    |            |             |            | с получением успешного  |
|    |            |             |            | статуса ответа\         |
|    |            |             |            | (п. А.9.2               |
|    |            |             |            | «Автоматический поиск   |
|    |            |             |            | СНИЛС при регистрации   |
|    |            |             |            | УЗ пользователя методом |
|    |            |             |            | импорта»).              |
|    |            |             |            |                         |
|    |            |             |            | В остальных случаях     |
|    |            |             |            | обязательный, формат:   |
|    |            |             |            | «ХХХ-ХХХ-ХХХ ХХ».       |
+----+------------+-------------+------------+-------------------------+
| 9. | mode       | email или   | Y          | Способ доставки пароля\ |
|    |            | mobile      |            | для первого входа в     |
|    |            |             |            | систему.                |
|    |            |             |            |                         |
|    |            |             |            | Строка:                 |
|    |            |             |            |                         |
|    |            |             |            | -   «email» -- отправка |
|    |            |             |            |     на адрес            |
|    |            |             |            |     электронной почты\  |
|    |            |             |            |     (при условии, что   |
|    |            |             |            |     параметр \<email\>  |
|    |            |             |            |     задан);             |
|    |            |             |            |                         |
|    |            |             |            | -   «mobile» --         |
|    |            |             |            |     отправка\           |
|    |            |             |            |     на номер мобильного |
|    |            |             |            |     телефона            |
+----+------------+-------------+------------+-------------------------+
| 10 | контакт    |             | Y          |                         |
| .  |            |             |            |                         |
+----+------------+-------------+------------+-------------------------+
| 1. | type       | Тип         | Y          | Перечень допустимых     |
|    |            | контакта    |            | значений:               |
|    |            |             |            |                         |
|    |            |             |            | -   «MBT» -- мобильный  |
|    |            |             |            |     телефон             |
|    |            |             |            |     (обязательный       |
|    |            |             |            |     параметр);          |
|    |            |             |            |                         |
|    |            |             |            | -   «EML» --            |
|    |            |             |            |     электронная почта   |
|    |            |             |            |     (обязательный       |
|    |            |             |            |     параметр)           |
+----+------------+-------------+------------+-------------------------+
| 1. | value      | Значение    | Y          | Формат:                 |
|    |            |             |            |                         |
|    |            |             |            | «+X(XXX)XXXXXXX»\       |
|    |            |             |            | (для type = «MBT»)      |
|    |            |             |            | обязательный\           |
|    |            |             |            | к заполнению;           |
|    |            |             |            |                         |
|    |            |             |            | текстовая строка в      |
|    |            |             |            | формате адреса          |
|    |            |             |            | электронной почты\      |
|    |            |             |            | (для type = «EML»)      |
|    |            |             |            | обязательный\           |
|    |            |             |            | к заполнению,\          |
|    |            |             |            | в случае, если указан   |
|    |            |             |            | mode = email            |
+----+------------+-------------+------------+-------------------------+
| 11 | документ   |             | Y          |                         |
| .  |            |             |            |                         |
+----+------------+-------------+------------+-------------------------+
| 1. | type       | Тип         | Y          | Перечень допустимых     |
|    |            | документа   |            | значений:               |
|    |            |             |            |                         |
|    |            |             |            | -   «RF_PASSPORT» --    |
|    |            |             |            |     паспорт гражданина  |
|    |            |             |            |     РФ;                 |
|    |            |             |            |                         |
|    |            |             |            | -   «FID_DOC» --        |
|    |            |             |            |     документ            |
|    |            |             |            |     иностранного        |
|    |            |             |            |     гражданина,         |
|    |            |             |            |     удостоверяющий      |
|    |            |             |            |     личность\           |
|    |            |             |            |     на территории РФ;   |
|    |            |             |            |                         |
|    |            |             |            | -   «FRGN_PASS» --      |
|    |            |             |            |     заграничный паспорт |
|    |            |             |            |     гражданина РФ       |
+----+------------+-------------+------------+-------------------------+
| 1. | series     | серия       | Y/N        | Для паспорта гражданина |
|    |            |             |            | РФ в формате XXXX.      |
|    |            |             |            |                         |
|    |            |             |            | Для заграничного        |
|    |            |             |            | паспорта гражданина РФ  |
|    |            |             |            | в формате XX.           |
|    |            |             |            |                         |
|    |            |             |            | Необязательный для      |
|    |            |             |            | документа иностранного  |
|    |            |             |            | гражданина              |
+----+------------+-------------+------------+-------------------------+
| 2. | number     | номер       | Y          | Для паспорта гражданина |
|    |            |             |            | РФ в формате XXXXXX.    |
|    |            |             |            |                         |
|    |            |             |            | Для заграничного        |
|    |            |             |            | паспорта гражданина РФ  |
|    |            |             |            | в формате XXXXXXX       |
+----+------------+-------------+------------+-------------------------+
| 3. | lat        | Фамилия     | Y/N        | Только для заграничного |
|    | inLastName | (латиницей) |            | паспорта гражданина РФ  |
+----+------------+-------------+------------+-------------------------+
| 4. | lati       | Имя         | Y/N        | Только для заграничного |
|    | nFirstName | (латиницей) |            | паспорта гражданина РФ  |
+----+------------+-------------+------------+-------------------------+
| 5. | issueId    | Номер       | Y/N        | Только для паспорта     |
|    |            | под         |            | гражданина РФ.          |
|    |            | разделения, |            |                         |
|    |            | выдавшего   |            | Необязательный для      |
|    |            | паспорт     |            | документа иностранного  |
|    |            |             |            | гражданина              |
|    |            |             |            | и заграничного паспорта |
|    |            |             |            | гражданина РФ           |
+----+------------+-------------+------------+-------------------------+
| 6. | issuedBy   | Н           | Y/N        | Только для паспорта     |
|    |            | аименование |            | гражданина РФ.          |
|    |            | под         |            |                         |
|    |            | разделения, |            | Необязательно для       |
|    |            | выдавшего   |            | документа иностранного  |
|    |            | паспорт     |            | гражданина              |
|    |            |             |            | и заграничного паспорта |
|    |            |             |            | гражданина РФ           |
+----+------------+-------------+------------+-------------------------+
| 7. | issueDate  | Дата выдачи | Y          | Формат: ДД.ММ.ГГГГ      |
|    |            | паспорта    |            |                         |
+----+------------+-------------+------------+-------------------------+
| 8. | expireDate | Дата        | Y/N        | Только для заграничного |
|    |            | окончания   |            | паспорта гражданина РФ. |
|    |            | срока       |            |                         |
|    |            | действия    |            | Формат: ДД.ММ.ГГГГ      |
|    |            | документа   |            |                         |
+----+------------+-------------+------------+-------------------------+

В запрос должен быть добавлен header (Authorization: Bearer) с ранее
полученным маркером доступа, выданный на специальную область доступа
(scope) (http://esia.gosuslugi.ru/ext_imp), позволяющий осуществлять
автоматическое восстановление доступа к учетной записи пользователя.
Данный маркер выдается только доверенным системам, имеющим право импорта
пользователей таким образом; выдача маркера осуществляется в рамках
модели контроля доступа на основе полномочий системы-клиента (см. п.
Б.3, Приложение Б), т.е. право на запрос такого маркера доступа
устанавливается оператором эксплуатации ЕСИА. 

В заголовке (Header) запроса метода импорта, помимо параметра
Authorization (маркер доступа, Bearer\<пробел\>\<тело маркера\>),
необходимо передавать два параметра:

-   Request-Data -- тело параметров запроса (JSON), закодированное в
    base64 url safe;

-   Request-Data-Sign -- подпись запроса -- подписанное сертификатом
    ИС-потребителя (системы, направляющей запрос на импорт) тело (JSON)
    параметров запроса.

Request-Data-Sign -- подпись запроса в формате PKCS#7 detached
signature\
в кодировке UTF-8 от JSON с параметрами запроса. Request-Data-Sign
должен быть закодирован в формате base64 url safe. Используемый для
проверки подписи сертификат должен быть предварительно зарегистрирован в
ЕСИА и привязан к учетной записи системы-клиента в ЕСИА. ЕСИА использует
сертификаты в формате X.509\
и криптографические алгоритмы ГОСТ Р 34.10-2012 для формирования
электронной подписи и ГОСТ Р 34.11-2012 для хэширования.

Пример запроса (вызов сервиса в среде разработки):

POST
https://esia.gosuslugi.ru/esia-rs/api/public/v1/prns/import/recovery
HTTP/1.1

Accept--Encoding: gzip,deflate

Content--Type: application/json

Authorization: Bearer 

eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE1OTYwMjI3NDMsInNjb3BlIjoiaHR0cDpcL1wvZXNpYS5nb3N1c2x1Z2kucnVcL2V4dF9pbXAiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiY2NjYTExZWUwOGY1MDM4NzE2NzY2ODMyNDdjNzU3ODAwNTFmODRhNGExMWQxMDY5YTEwNmIzNjUyZjgxNjUxNSIsInVybjplc2lhOnNial9pZCI6MTA3NzExNDA1NCwiZXhwIjoxNTk2MDI0NTQzLCJpYXQiOjE1OTYwMjI3NDMsImNsaWVudF9pZCI6IlRFU1RfU1lTIn0.ZG4e0Hs_hHwubfYLc94ph1bPaof3opfeLjw8GczXfI--CKD683KFvPE_mqGo0WjgtarM4Cd1zRU_FitqXQl4DsmZW94aVHjfyS6ti4ERtEwby3ifQfY_8qefnzIpZ2EtlAbGNaj7jWpdJlhKQcigBKi_60eOinrUYwcEy1EdnRKIHDyrrydfh--MN3ZQSEx8aMYMm3IATPrktJPZ8LryD2wlkWq3PuxFAxFLEaLo0r--F8FRU1hPlNyUrTCRp6vNmlLO_TVe2l28gRdcxZJKAdHggXmRXVceT7cMGUOY4b2VnTID3G_w7FuVIjURQZy46HQ3X5tH9IiGfoqi2dhD5y3AQ

Request--Data--Sign:
 MIAGCSqGSIb3DQEHAqCAMIACAQExDzANBglghkgBZQMEAgEFADCABgkqhkiG9w0BBwEAAKCAMIIDJTCCAg0CBFhKg5UwDQYJKoZIhvcNAQELBQAwVzELMAkGA1UEBhMCUlUxDzANBgNVBAgMBk1vc2NvdzENMAsGA1UECgwEVGVzdDENMAsGA1UECwwEVGVzdDEZMBcGA1UEAwwQVGVzdCBSZXN0IFN5c3RlbTAeFw0xNjEyMDkxMDEyMzdaFw0xNzEyMDkxMDEyMzdaMFcxCzAJBgNVBAYTAlJVMQ8wDQYDVQQIDAZNb3Njb3cxDTALBgNVBAoMBFRlc3QxDTALBgNVBAsMBFRlc3QxGTAXBgNVBAMMEFRlc3QgUmVzdCBTeXN0ZW0wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCByEsM2_R1BrtltyJ15AwCW_tChh2euZC3FEqWDY6TFAlVyy9yO4qM_5P1WruplhA9dCCbft5JFsz4n_nE7lMMRaI34tqTyyo24xzX_VrhgTIi05mt1Y5dbldfEiPVNT3aUCjFlbFzDXoUbc8nfQizkPa_CHGO0MBhuVuQWOVzw3FufAlExDjNPUoRRvaYoBWOK_3SnyS7_88xJn--\_yQQVwu0TQkSuqpOsylfBM--Wq10U5x4bJ2NSeL71AzZjCL_mh1daQTQxEwBlVLuMlc5srMyw_QHQ1McsNrqrnx3zhFFNLS5Sk_LrSxqxOsC4sgBw1oudVayUUvGbqe_nxu7P3AgMBAAEwDQYJKoZIhvcNAQELBQADggEBABxK0C1NjQMyvtJvZNRyM21GwQOklaBZuqRErJmpLAR7auYLbZnwEdt1I8KEJBQW6pTb99rnQs--T--qZiChh0PYlbCxXGeVCXk5dJWSiGE_SdrjWvSOH83iUA2Lv8Pi3NlVW2GcNOlFySlzE9HvGYJTIr5I_X--dw64--2NYETLIYPQ7HWwAEwy09ucL9LMjGKYBe5FrwiulAyD20--lnIpYtXdLSpflKangPlPd1xmxEBXMQUmoKg7dTE--q2gYfZLNUKsAezrattHGHTPRnqwWQHmwly_rXXodlgcNxeilT_dvc0o_JfkNmqGCc09RXSx1BWSWGynLeBBjYMy9VN8XYQpQAADGCAfUwggHxAgEBMF8wVzELMAkGA1UEBhMCUlUxDzANBgNVBAgMBk1vc2NvdzENMAsGA1UECgwEVGVzdDENMAsGA1UECwwEVGVzdDEZMBcGA1UEAwwQVGVzdCBSZXN0IFN5c3RlbQIEWEqDlTANBglghkgBZQMEAgEFAKBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTE3MDYyMDE1NTA1NVowLwYJKoZIhvcNAQkEMSIEIOpwKJnoLommyNRoKDDlWVsWuBdYfowQ4byOiN--gSPe2MA0GCSqGSIb3DQEBAQUABIIBADlNWxdZeqGBq8_4WqRs9H4SLde_Sukc1AG6hNj1cbTqxzthzzm1n_JQEZOTYaP9bQdTEhOvKZXxFXC_JjPBMQauZPJc1eOR5DDB_7X4MAgGpMQbhpTQz3Sg7acJuJdWuYxL92BDk4qyzuwgJdQJplVJickBvC78XeJVo1w4_jx5CVEn3pUIPdKxib6da0evB6CsxD98JcsvWZ3u--H3LQ0_ApUOUHeF84r3AZ5mtILYj2w6o8rMAmsTDe7CAUXvDUAp9o5cTPk57rDNaW96d5J3SUtmZdx2nGBS41kJYWJNDiqyfHJ7X4nZVOS0glbT_JnaXtxrZTWp9BJo6NKJaagQAAAAAAAA

Request--Data:
 ew0KICAiZmlyc3ROYW1lIjoiw5DCmMOQwrLDkMKww5DCvcOQwr7DkMKyIiwNCiAgImxhc3ROYW1lIjoiw5DCmMOQwrLDkMKww5DCvSIsDQogICJtaWRkbGVOYW1lIjoiw5DCmMOQwrLDkMKww5DCvcOQwr7DkMKyw5DCuMORwociLA0KICAiYmlydGhEYXRlIjoiMDEuMDEuMTk5OSIsDQogICJiaXJ0aFBsYWNlIjoiw5DCnMOQwr7DkcKBw5DCusOQwrLDkMKwIiwNCiAgImdlbmRlciI6Ik0iLA0KICAic25pbHMiOiIwMDAtMDAwLTAwMCAwNyIsDQogICJjb250YWN0cyI6IHsNCiAgICAiZWxlbWVudHMiOiBbDQogICAgICB7DQogICAgICAgICJ0eXBlIjogIk1CVCIsDQogICAgICAgICJ2YWx1ZSI6ICIrNyg5OTkpOTk5OTk5OSINCiAgICAgIH0sDQogICAgICB7DQogICAgICAgICJ0eXBlIjogIkVNTCIsDQogICAgICAgICJ2YWx1ZSI6ICJ0ZXN0QHRlc3QudHMiDQogICAgICB9DQogICAgXQ0KICB9LA0KICAiZG9jdW1lbnRzIjogew0KICAgICJlbGVtZW50cyI6IFsNCiAgICAgIHsNCiAgICAgICAgInR5cGUiOiJSRl9QQVNTUE9SVCIsDQogICAgICAgICJzZXJpZXMiOiIyMjIyIiwNCiAgICAgICAgIm51bWJlciI6Ijg4OTk5OSIsDQogICAgICAgICJpc3N1ZUlkIjoiMTExMDAxIiwNCiAgICAgICAgImlzc3VlZEJ5Ijoiw5DCoMOQwqPDkMKSw5DClCDDkMKzLsOQwpzDkMK--w5HCgcOQwrrDkMKyw5HCiyIsDQogICAgICAgICJpc3N1ZURhdGUiOiIxOC4wMy4yMDE2Ig0KICAgICAgfQ0KICAgIF0NCiAgfSwNCiAgImFkZHJlc3NlcyI6ew0KICAgICJlbGVtZW50cyI6IFsNCiAgICAgIHsNCiAgICAgICJ0eXBlIjogIlBMViIsDQogICAgICAiYWRkcmVzc1N0ciI6IsOQwprDkMK1w5DCvMOQwrXDkcKAw5DCvsOQwrLDkcKBw5DCusOQwrDDkcKPIMOQwp7DkMKxw5DCu8OQwrDDkcKBw5HCgsORwowsIMOQwqLDkMKww5HCiMORwoLDkMKww5DCs8OQwr7DkMK7w5HCjMORwoHDkMK6w5DCuMOQwrkgw5DCoMOQwrDDkMK5w5DCvsOQwr0sIMOQwqjDkMK1w5HCgMOQwrXDkMKzw5DCtcORwoggw5DCn8OQwr7DkcKBw5DCtcOQwrvDkMK--w5DCuiDDkMKzw5DCvsORwoDDkMK--w5DCtMORwoHDkMK6w5DCvsOQwrPDkMK--ICAgICDDkcKCw5DCuMOQwr_DkMKwIiwNCiAgICAgICJjb3VudHJ5SWQiOiAiUlVTIiwNCiAgICAgICJ6aXBDb2RlIjogIjM5NDAwMCIsDQogICAgICAicmVnaW9uIjogIsOQwprDkMK1w5DCvMOQwrXDkcKAw5DCvsOQwrLDkcKBw5DCusOQwrDDkcKPIMOQwp7DkMKxw5DCu8OQwrDDkcKBw5HCgsORwowiLA0KICAgICAgImFyZWEiOiAiw5DCosOQwrDDkcKIw5HCgsOQwrDDkMKzw5DCvsOQwrvDkcKMw5HCgcOQwrrDkMK4w5DCuSDDkMKgw5DCsMOQwrnDkMK--w5DCvSIsDQogICAgICAiY2l0eSI6ICLDkMKow5DCtcORwoDDkMK1w5DCs8OQwrXDkcKIIMOQwp_DkMK--w5HCgcOQwrXDkMK7w5DCvsOQwrogw5DCs8OQwr7DkcKAw5DCvsOQwrTDkcKBw5DCusOQwr7DkMKzw5DCviDDkcKCw5DCuMOQwr_DkMKwIiwNCiAgICAgICJkaXN0cmljdCI6ICLDkMK9w5DCtcORwoIiLA0KICAgICAgInNldHRsZW1lbnQiOiAiw5DCo8ORwoHDkcKCw5HCjC3DkMKQw5DCvcOQwrfDkMKww5HCgSDDkMKfw5DCvsORwoHDkMK1w5DCu8OQwr7DkMK6IiwNCiAgICAgICJzdHJlZXQiOiAiw5DCocOQwr7DkMKyw5DCtcORwoLDkcKBw5DCusOQwrDDkcKPIMOQwqPDkMK7w5DCuMORwobDkMKwIiwNCiAgICAgICJhZGRpdGlvbkFyZWEiOiAiw5DCoMOQwrXDkMKzw5DCuMOQwr7DkMK9IMOQwqHDkMKww5DCtMOQwr7DkMKyw5DCvsOQwrUgw5DCvcOQwrXDkMK6w5DCvsOQwrwtw5DCtSDDkcKCw5DCvsOQwrLDkMKww5HCgMOQwrjDkcKJw5DCtcORwoHDkcKCw5DCssOQwr4iLA0KICAgICAgImFkZGl0aW9uQXJlYVN0cmVldCI6ICLDkMKiw5DCtcORwoHDkcKCIiwNCiAgICAgICJob3VzZSI6ICI4Ni8xIiwNCiAgICAgICJidWlsZGluZyI6ICJlIiwNCiAgICAgICJmcmFtZSI6ICIyMDTDkcKDIiwNCiAgICAgICJmbGF0IjogIsOQwr_DkMK--w5DCvC40MTkiLA0KICAgICAgImZpYXNDb2RlIjogIjc3LTAtMDAwLTAwMC0wMDAtMDAwLTQyMzYtMDAwMC0wMDAiDQoNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIF0NCiAgfQ0KfQ

Cache--Control: no--cache

Content--Length: 1476

Host: esia-portal1.test.gosulsugi.ru 

Connection: Keep--Alive

User--Agent: Apache--HttpClient/4.1.1 (java 1.5)

{

\"lastName\": \"Тестов\",

\"firstName\": \"Тест\",

\"middleName\": \"Тестович\",

\"birthDate\": \"01.01.2000\",

\"birthPlace\": \"Тест\",

\"gender\": \"M\",

\"mode\": \"email\",

\"snils\": \"000-000-000 01\",

\"contacts\": \[{

\"type\": \"EML\",

\"value\": \"test@test.ru\"

},

{

\"type\": \"MBT\",

\"value\": \"+7(999)9999999\"

}

\],

\"document\": {

\"type\": \"RF_PASSPORT\",

\"series\": \"0000\",

\"number\": \"000000\",

\"issueId\": \"000000\",

\"issuedBy\": \"Тест\",

\"issueDate\": \"01.01.2014\"

}

}

По полученным данным в ЕСИА выполняется поиск подтвержденной УЗ.\
В зависимости от того, найдена в ЕСИА учетная запись, удовлетворяющая
полученным данным или нет, операция может завершиться одним из следующих
результатов:

-   запущен поиск СНИЛС в СФР, в случае если в запросе не был передан
    СНИЛС;

-   УЗ не найдена или другая ошибка;

-   восстановлен доступ к УЗ ЕСИА.

> В ответе передаются следующие параметры, приведенные в таблице 82.

Таблица 82 -- Передаваемые параметры

+---+-------------+-----------------------+---------------------------+
| * | **Н         | **Описание            | **Примечания**            |
| * | аименование | параметра**           |                           |
| № | параметра** |                       |                           |
| * |             |                       |                           |
| * |             |                       |                           |
+===+=============+=======================+===========================+
| 1 | status      | Статус выполнения     | -   OK -- восстановление  |
| . |             | операции              |     выполнено;            |
|   |             |                       |                           |
|   |             |                       | -   SENT -- запущен поиск |
|   |             |                       |     СНИЛС\                |
|   |             |                       |     в СФР                 |
+---+-------------+-----------------------+---------------------------+
| 2 | code        | Код завершения        | Код ошибки, варианты      |
| . |             | операции              | приведены\                |
|   |             |                       | в таблице 73 и 83         |
|   |             |                       |                           |
+---+-------------+-----------------------+---------------------------+
| 3 | message     | Текстовое описание    | Описание для кодов        |
| . |             | кода ошибки           | ошибок\                   |
|   |             | выполнения операции   | при импорте учетной       |
|   |             |                       | записи в ЕСИА (за         |
|   |             |                       | исключением кода          |
|   |             |                       | ESIA-03200).              |
|   |             |                       |                           |
|   |             |                       | Варианты ошибок           |
|   |             |                       | приведены\                |
|   |             |                       | в таблицах 73 и 83        |
+---+-------------+-----------------------+---------------------------+

> Далее приводятся варианты ответов сервиса при завершении операции.

Пример ответа на запрос (успешное восстановление доступа):

200 OK

{

\"status\": \"OK\"

}

Пример ответа на запрос (учетная запись не найдена в БД ЕСИА):

400 Bad Request

{

\"code\": \"ESIA-020002\",

\"message\": \"Пользователь не найден\"

}

Пример ответа на запрос (запущен поиск СНИЛС в СФР):

200 OK

{

\"status\": \"SENT\"

}

Таблица 83 -- Коды и описание ошибок

+---+------------+-----------------------+-----------------------------+
| * | **Код      | **Описание кода       | **Комментарии**             |
| * | возврата** | возврата**            |                             |
| № |            |                       |                             |
| * |            |                       |                             |
| * |            |                       |                             |
+===+============+=======================+=============================+
| 1 | E          | Функция               | Данный код возврата         |
| . | SIA-005604 | восстановления        | соответствует ситуации,     |
|   |            | доступа к УЗ через    | когда восстановление        |
|   |            | импорт отключена      | доступа через импорт        |
|   |            |                       | недоступно.                 |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Пользователь не       | Данный код возврата         |
| 1 | SIA-020002 | найден                | соответствует ситуации,     |
| 1 |            |                       | когда по полученным данным\ |
| . |            |                       | не удалось найти УЗ в ЕСИА  |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Пользователь не       | Данный код возврата         |
| 1 | SIA-020013 | подтвержден           | соответствует ситуации,     |
| 2 |            |                       | когда найденная УЗ\         |
| . |            |                       | не подтверждена             |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Выбранный способ      | Данный код возврата         |
| 1 | SIA-039827 | доставки пароля не    | соответствует ситуации,     |
| 3 |            | доступен              | когда функция               |
| . |            |                       | восстановления доступа      |
|   |            |                       | через Email отключена       |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Не указан адрес       | Данный код возврата         |
| 1 | SIA-032110 | электронной почты     | соответствует ситуации,     |
| 4 |            |                       | когда в запросе не указан   |
| . |            |                       | Email                       |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Указанный в запросе   | Данный код возврата         |
| 1 | SIA-032017 | email отличается от   | соответствует ситуации,     |
| 5 |            | указанного в УЗ       | когда данные в запросе\     |
| . |            |                       | и в найденной УЗ отличаются |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Не указан номер       | Данный код возврата         |
| 1 | SIA-032200 | мобильного телефона   | соответствует ситуации,     |
| 6 |            |                       | когда в запросе не указан   |
| . |            |                       | номер мобильного телефона   |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+
| 1 | E          | Указанный в запросе   | Данный код возврата         |
| 1 | SIA-032016 | номер мобильного      | соответствует ситуации,     |
| 7 |            | телефона отличается   | когда данные в запросе\     |
| . |            | от указанного в УЗ    | и в найденной УЗ отличаются |
|   |            |                       |                             |
+---+------------+-----------------------+-----------------------------+

На рисунке 7 представлена схема последовательности вызовов методов REST
API, в случае если запрос отправляется без указания СНИЛС пользователя.

![C:\\Users\\dmitry.mezin\\Desktop\\Импорт_RECAVERY\\ТЗ\\Import_Recavery_sequence
\_diagram.jpg](media/image7.jpeg){width="6.496527777777778in"
height="9.309947506561679in"}

Рисунок 7 -- Диаграмма последовательности вызова REST API без указания
СНИЛС

## Управление изображением (аватаром) в профиле пользователя

Программные интерфейсы на основе REST обеспечивают возможность
управления изображением (аватаром) пользователя в части::

-   получения изображения (аватара) пользователя по OID;

-   получения исходного изображения (аватар) пользователя по OID.

Для осуществления данных операций система организации должна направить\
в https-адрес программного интерфейса ЕСИА запрос методом GET.

### Получение сжатого изображения (аватара) пользователя по OID

Для получения сжатого круглого изображения (аватара) должен быть
выполнен запрос методом GET на https-адрес программного интерфейса
ЕСИА[^51]. Заголовок данного запроса должен включать в себя маркер
доступа, выданный системе для работы с аватаром пользователя
(usr_avt?oid={p.prn_oid}). Выдача маркера осуществляется в рамках модели
контроля доступа на основе полномочий системы-клиента (Приложение Б.3),
т.е. право\
на запрос такого маркера доступа устанавливается оператором эксплуатации
ЕСИА.\
При авторизации необходимо указать в заголовке -- Authorization с
полученным токеном.

В качестве ответа ЕСИА возвращает маленькое круглое изображение,
использующееся на странице авторизации и в профиле ЕСИА, или, при
отсутствии изображения, ошибку.

Пример запроса (вызов сервиса в тестовой среде):

GET
<https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/pso/1000299282/avt/circle>

Authorization: Bearer
eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE1MjgyMDg1MzEsInNjb3BlIjoib3BlbmlkIHVzcl9hdnQ_b2lkPTEwMDAyOTkyODIiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiMDI4Zjk0NWI5MjEwN2ZiMjc5MTE4YTM1OGM2M2ZiNDRhMzdjOGZiOTAyMjA1OGQxZjlhMjdiNjIzMDg5ZjQ3YSIsInVybjplc2lhOnNial9pZCI6MTAwMDI5OTI4MiwiZXhwIjoxNTI4MjEyMTMxLCJpYXQiOjE1MjgyMDg1MzEsImNsaWVudF9pZCI6IlRFU1RfU1lTIn0.Lqv8Zm9J8sGEHJmGppY_zWXGn_KaQcWeERxk53C--BkXAVxsMboEXwVcnmva5hRuSuo\_\_wcVwf3rY_DQ_9OHgd3vZ3o--iEFciDJxVVAMz2sV9HQXvUz0HfT--VAMIwfsWUMurKeV7uCPYgr1rjaqsRivzIgMc0eo0jlZMrM2ohUJTWVKZZqzT--IxCBjyVoUwcPafBmkAmy0vtlRVj1LjgBZg5BNeXvUCv819cc4S0e9q1--e6AEjZIHTNyEVo1nq_la8iem--UVVPRmjszyffrlJSzSkDvds3809wYbfzk8ckA2b--95acNDtsN8esDdGbBg6c--xMpfmyNpALSlc1uPkmkg

Пример успешного ответа:

{

\"url\":
\"/0/0/0/0/0/113/33/424e0939--3055--4945--b510--0650ea2c97aa.png\"

}

Полученное изображение располагается по ссылке:

[https://esia-portal1.test.gosuslugi.ru/useravatar/{ссылка](https://esia-portal1.test.gosuslugi.ru/useravatar/%7bссылка)
[на изображение}]{.underline}, например:

[https://esia-portal1.test.gosuslugi.ru/useravatar/0/0/0/0/0/113/33/424e0939--3055--4945--b510--0650ea2c97aa.png](https://esia-portal1.test.gosuslugi.ru/useravatar/0/0/0/0/0/113/33/424e0939-3055-4945-b510-0650ea2c97aa.png).

Пример ответа в случае, если аватар не найден:

{

\"code\": \"ESIA-040404\",

\"message\": \"ValidationCommonErrorEnum.avatar.notfound\"

}

### Получение исходного изображения (аватара) пользователя по OID

Для получения исходного квадратного изображения (аватара) должен быть
выполнен запрос методом GET на https-адрес программного интерфейса
ЕСИА[^52]. Заголовок данного запроса должен включать в себя маркер
доступа, выданный системе для работы с аватаром пользователя
(usr_avt?oid={p.prn_oid}). Выдача маркера осуществляется в рамках модели
контроля доступа на основе полномочий системы-клиента (см. п. Б.3,
Приложение Б), т.е. право на запрос такого маркера доступа
устанавливается оператором эксплуатации ЕСИА. При авторизации необходимо
указать в заголовке -- Authorization\
с полученным токеном.

В качестве ответа ЕСИА возвращает исходное квадратное изображение
пользователя или, при отсутствии изображения, ошибку.

Пример запроса (вызов сервиса в тестовой среде):

GET
https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/pso/1000299282/avt/square

Authorization: Bearer
eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE1MjgyMDg1MzEsInNjb3BlIjoib3BlbmlkIHVzcl9hdnQ_b2lkPTEwMDAyOTkyODIiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiMDI4Zjk0NWI5MjEwN2ZiMjc5MTE4YTM1OGM2M2ZiNDRhMzdjOGZiOTAyMjA1OGQxZjlhMjdiNjIzMDg5ZjQ3YSIsInVybjplc2lhOnNial9pZCI6MTAwMDI5OTI4MiwiZXhwIjoxNTI4MjEyMTMxLCJpYXQiOjE1MjgyMDg1MzEsImNsaWVudF9pZCI6IlRFU1RfU1lTIn0.Lqv8Zm9J8sGEHJmGppY_zWXGn_KaQcWeERxk53C--BkXAVxsMboEXwVcnmva5hRuSuo\_\_wcVwf3rY_DQ_9OHgd3vZ3o--iEFciDJxVVAMz2sV9HQXvUz0HfT--VAMIwfsWUMurKeV7uCPYgr1rjaqsRivzIgMc0eo0jlZMrM2ohUJTWVKZZqzT--IxCBjyVoUwcPafBmkAmy0vtlRVj1LjgBZg5BNeXvUCv819cc4S0e9q1--e6AEjZIHTNyEVo1nq_la8iem--UVVPRmjszyffrlJSzSkDvds3809wYbfzk8ckA2b--95acNDtsN8esDdGbBg6c--xMpfmyNpALSlc1uPkmkg

Пример успешного ответа:

{

\"url\":
\"/0/0/0/0/0/113/33/424e0939--3055--4945--b510--0650ea2c97aa.png\"

}

Полученное изображение располагается по ссылке:

[https://esia-portal1.test.gosuslugi.ru/useravatar/{ссылка](https://esia-portal1.test.gosuslugi.ru/useravatar/%7bссылка)
[на изображение}]{.underline}, например:

<https://esia-portal1.test.gosuslugi.ru/useravatar/0/0/0/0/0/113/33/424e0939-3055-4945-b510-0650ea2c97aa.png>.

Пример ответа в случае, если исходный аватар не найден:

{

\"code\": \"ESIA-040404\",

\"message\": \"ValidationCommonErrorEnum.avatar.notfound\"

}

## Сервис управления внешними ИС ЦО организаций

### Сервис REST API управления ЦО

Методы для работы с ЦО организации:

-   Создание ЦО.

-   Изменение данных ЦО.

-   Удаление ЦО.

**Создание ЦО**

Адрес метода: URL: esia-rs/api/public/v1/orgs/{org_oid}/rcs

Входные параметры:

На вход сервис должен получать объект, описывающий ЦО, который
необходимо добавить к организации.

Параметры из URL:

-   org_oid -- идентификатор организации, в которой добавляется ЦО.

Параметры тела запроса:

-   address -- структурированный адрес места расположения ЦО в составе:

-   type -- тип адреса -- для ЦО всегда равен «RA»;

-   addressStr -- адрес, строковое представление -- адрес без указания
    номера дома, корпуса, строения и квартиры;

-   countryId -- 3-х символьный код страны по справочнику ОКСМ;

-   zipCode -- почтовый индекс;

-   fiasCode -- ФИАС код (уровень 7\...9) адреса места расположения ЦО;

-   vrfDdt -- результат верификации адреса в сервисе DaData
    (необязательный параметр: строка, содержащая коды качества
    адреса)[^53];

-   region -- название субъекта РФ согласно справочнику ССРФ;

-   area -- район;

-   city -- город;

-   district -- внутригородской район;

-   settlement -- населенный пункт;

-   street -- название улицы;

-   additionArea -- дополнительная территория;

-   additionAreaStreet -- название улицы на дополнительной территории;

-   house -- номер дома;

-   building -- строение;

-   frame -- корпус;

-   lat -- широта (геокоордината);

-   lng -- долгота (геокоордината);

-   contact -- контактная информация ЦО -- номер(а) телефона(ов) и/или
    адрес(а) электронной почты;

-   name -- наименование ЦО;

-   features -- возможности ЦО, перечисление «rcr», «reg», «del», «cfm»,
    «rbi»;

-   pdos -- разрешения на отображение операций, перечисление «rcr»,
    «reg», «del», «cfm», «rbi»;

-   information -- дополнительная информация;

-   opnModes -- режим работы ЦО, перечисление: «WEEKENDS», «EARLY»,
    «LATE»:

-   WEEKENDS -- работает по выходным;

-   EARLY -- открыто с 8:00 утра;

-   LATE -- Закрывается позже 19:00 вечера;

-   WEEKENDS, EARLY -- работает по выходным (открыто с 8:00 утра);

-   WEEKENDS, LATE -- работает по выходным, закрывается позже 19:00
    вечера;

-   EARLY, LATE -- работает с 8:00 утра и закрывается позже 19:00
    вечера;

-   WEEKENDS, EARLY, LATE -- работает по выходным (работает с 8:00 утра
    и закрывается позже 19:00 вечера);

-   operationTime -- время работы ЦО.

HTTP метод: POST

Тело запроса: application/json;charset=UTF-8.

Пример запроса (вызов сервиса в тестовой среде):

POST esia-rs/api/public/v1/orgs/1000000001/rcs HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

{

  \"name\" : \"Клиентский центр в  ОПС 143960\",

  \"operationTime\" : \"пн. 11.00--20.00, вт. -- пт. 09.00--20.00, сб.
09.00--18.00, вс. -- вых.\",

  \"information\" : \"Необходим паспорт и номер СНИЛС\",

  \"features\" : \[ \"rcr\", \"reg\", \"del\" \],

  \"address\" : {

    \"type\" : \"RA\",

    \"addressStr\" : \"Кемеровская Область, Таштагольский Район, Шерегеш
Поселок городского типа\",

    \"countryId\" : \"RUS\",

    \"zipCode\" : \"123104\",

    \"region\" : \"Кемеровская Область\",

    \"area\" : \"Регион Садовое неком--е товарищество\",

    \"city\" : \"Шерегеш Поселок городского типа\",

    \"district\" : \"нет\",

    \"settlement\" : \"Усть--Анзас Поселок\",

    \"street\" : \"Советская Улица\",

    \"additionAreaStreet\" : \"ект\",

    \"house\" : \"86/1\",

    \"building\" : \"е\",

    \"frame\" : \"204у\",

    \"flat\" : \"пом.419\",

    \"fiasCode\" : \"2604e353--b9dd--4542--a8bf--020c8f982797\",

    \"vrfDdt\" : \"0,5,0\"

    \"lat\": 55.757911,

    \"lng\": 37.600681

  },

  \"contact\" : {

    \"type\" : \"RAC\",

    \"value\" : \"8--800--550--07--70\"

  },

  \"opnModes\" : \[ \"LATE\", \"WEEKENDS\", \"EARLY\" \],

  \"raTypeId\" : 8

}

Значения типа ЦО (raTypeId) приведены в таблице 84.

Таблица 84 -- Значения типа ЦО (raTypeId)

+---------+------------------------------------------------------------+
| **Код** | **Название**                                               |
+=========+============================================================+
| 1.      | МФЦ                                                        |
+---------+------------------------------------------------------------+
| 2.      | Территориальное управление социальной защиты населения     |
+---------+------------------------------------------------------------+
| 3.      | Центр занятости населения                                  |
+---------+------------------------------------------------------------+
| 4.      | Территориальное отделение ЗАГС                             |
+---------+------------------------------------------------------------+
| 5.      | Удостоверяющий центр                                       |
+---------+------------------------------------------------------------+
| 6.      | Государственное казенное учреждение                        |
+---------+------------------------------------------------------------+
| 7.      | Администрация муниципального образования                   |
+---------+------------------------------------------------------------+
| 8.      | Банковская организация                                     |
+---------+------------------------------------------------------------+
| 9.      | Отделение Почты России                                     |
+---------+------------------------------------------------------------+
| 10.     | Территориальное отделение Ростелеком                       |
+---------+------------------------------------------------------------+
| 11.     | Территориальное управление СФР                             |
+---------+------------------------------------------------------------+
| 12.     | Территориальное управление МВД России                      |
+---------+------------------------------------------------------------+
| 13.     | Территориальное отделение Фонда социального страхования    |
+---------+------------------------------------------------------------+
| 14.     | РОИВ                                                       |
+---------+------------------------------------------------------------+
| 15.     | ФОИВ                                                       |
+---------+------------------------------------------------------------+

Пример успешного ответа:

{

\"oid\": \"1000000234\", // идентификатор созданного ЦО

\"message\": \"Success\|Fail\"

}

Пример ответа с ошибкой:

{

 \"code\": \"ESIA-038000\",

 \"message\": \"организация не найдена\"

}

Перечень возможных возвращаемых ошибок приведен в таблице 85.

Таблица 85 -- Перечень возможных возвращаемых ошибок

  ------------------------------------------------------------------------
  **Код**       **Описание**
  ------------- ----------------------------------------------------------
  ESIA-038903   Отсутствует название ЦО

  ESIA-038904   Не указано время работы ЦО (operationTime)

  ESIA-038905   Не указан тип ЦО (raTypeId)

  ESIA-038906   У ЦО отсутствуют контакты

  ESIA-034008   Не указан адрес

  ESIA-034004   Адресная строка пустая

  ESIA-034003   Отсутствует индекс в адресе ЦО

  ESIA-038000   Организация не найдена

  ESIA-038902   Отсутствует фича fts ЦО (в запросе не указаны разрешенные
                ЦО операции)

  ESIA-005043   Организация не имеет фичи ra (организация не имеет
                разрешения на операции создания, изменения, удаления
                центров обслуживания)

  ESIA-005040   У организации нет группы «TECH_CONSOLE» (у организации нет
                группы доступа (сотрудников) для работы с Технологическим
                порталом ЕСИА (использования Rest API))
  ------------------------------------------------------------------------

Требуемая область доступа (scope):

org_ra?org_oid={p.org_oid}&mode=w

**Изменение данных центра обслуживания**

Адрес метода: URL: esia-rs/api/public/v1/orgs/{org_oid}/rcs/{ra_oid}

Входные параметры:

На вход сервис должен получать объект, описывающий центр обслуживания,
данные которого необходимо изменить.

Параметры из URL:

-   org_oid -- идентификатор организации;

-   ra_oid -- идентификатор ЦО.

Параметры тела запроса:

-   address -- структурированный адрес места расположения ЦО в составе:

-   type -- тип адреса -- для ЦО всегда равен «RA»;

-   addressStr -- адрес, строковое представление -- адрес без указания
    номера дома, корпуса, строения и квартиры;

-   countryId -- 3-х символьный код страны по справочнику ОКСМ;

-   zipCode -- почтовый индекс;

-   fiasCode -- код ФИАС (уровень 7\...9) адреса места расположения ЦО;

-   vrfDdt -- результат верификации адреса в сервисе DaData
    (необязательный параметр: строка, содержащая коды качества
    адреса)[^54];

-   region -- название субъекта РФ согласно справочнику ССРФ;

-   area -- район;

-   city -- город;

-   district -- внутригородской район;

-   settlement -- населенный пункт;

-   street -- название улицы;

-   additionArea -- дополнительная территория;

-   additionAreaStreet -- название улицы на дополнительной территории;

-   house -- номер дома;

-   building -- строение;

-   frame -- корпус;

-   lat -- широта (геокоордината);

-   lng -- долгота (геокоордината).

-   contact -- контактная информация ЦО -- номер(а) телефона(ов) и/или
    адрес(а) электронной почты;

-   name -- наименование ЦО;

-   features -- услуги ЦО, перечисление «rcr», «reg», «del», «cfm»,
    «rbi»;

-   pdos -- разрешения на отображение операций, перечисление «rcr»,
    «reg», «del», «cfm», «rbi»;

-   information -- дополнительная информация;

-   opnModes -- режим работы ЦО, перечисление «WEEKENDS», «EARLY»,
    «LATE»;

-   operationTime -- время работы ЦО.

HTTP метод: PUT

Пример запроса (вызов сервиса в тестовой среде):

PUT esia-rs/api/public/v1/orgs/1000000001/rcs/1000000234 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

{

\"name\" : \"Клиентский центр в ОПС 143960\",

\"operationTime\" : \"пн. 11.00--20.00, вт. -- пт. 09.00--20.00, сб.
09.00--18.00, вс. -- вых.\",

\"information\" : \"Необходим паспорт и номер СНИЛС\",

\"features\" : \[ \"rcr\", \"reg\", \"del\" \],

\"address\" : {

\"type\" : \"RA\",

\"addressStr\" : \"Кемеровская Область, Таштагольский Район, Шерегеш
Поселок городского типа\",

\"countryId\" : \"RUS\",

\"zipCode\" : \"123104\",

\"region\" : \"Кемеровская Область\",

\"area\" : \"Регион Садовое неком--е товарищество\",

\"city\" : \"Шерегеш Поселок городского типа\",

\"district\" : \"нет\",

\"settlement\" : \"Усть--Анзас Поселок\",

\"street\" : \"Советская Улица\",

\"additionAreaStreet\" : \"ект\",

\"house\" : \"86/1\",

\"building\" : \"е\",

\"frame\" : \"204у\",

\"flat\" : \"пом.419\",

\"fiasCode\" : \"2604e353--b9dd--4542--a8bf--020c8f982797\",

\"vrfDdt\" : \"0,10,0\"

\"lat\": 55.757911,

\"lng\": 37.600681

},

\"contact\" : {

\"type\" : \"RAC\",

\"value\" : \"8--800--550--07--70\"

},

\"opnModes\" : \[ \"LATE\", \"WEEKENDS\", \"EARLY\" \],

\"raTypeId\" : 8

}

Пример успешного ответа:

{

\"oid\": \"1000000234\", // идентификатор измененного ЦО

\"message\": \"Success\|Fail\" //Fail в случае какой--то непредвиденной
ошибки

}

Пример ответа с ошибкой:

{

 \"code\": \"ESIA-038000\",

 \"message\": \"организация не найдена\"

}

Перечень возможных возвращаемых ошибок приведен в таблице 86.

Таблица 86 -- Перечень возможных возвращаемых ошибок

  ------------------------------------------------------------------------
  **Код**       **Описание**
  ------------- ----------------------------------------------------------
  ESIA-038903   Отсутствует название ЦО

  ESIA-038904   Не указано время работы ЦО (operationTime)

  ESIA-038905   Не указан тип ЦО (raTypeId)

  ESIA-038906   У ЦО отсутствуют контакты

  ESIA-034008   Не указан адрес

  ESIA-034004   Адресная строка пустая

  ESIA-034003   Отсутствует индекс в адресе ЦО

  ESIA-038000   Организация не найдена

  ESIA-038900   Центр обслуживания не найден

  ESIA-039813   Центр обслуживания заблокирован

  ESIA-038902   Отсутствует фича fts ЦО (в запросе не указаны разрешенные
                ЦО операции)

  ESIA-005034   Некорректный идентификатор центра обслуживания (например,
                ЦО не принадлежит указанной в запросе организации)

  ESIA-005043   Организация не имеет фичи ra (организация не имеет
                разрешения на операции создания, изменения, удаления
                центров обслуживания)

  ESIA-005040   У организации нет группы «TECH_CONSOLE» (у организации нет
                группы доступа (сотрудников) для работы с Технологическим
                порталом ЕСИА (использования Rest API))
  ------------------------------------------------------------------------

Требуемая область доступа (scope):

org_ra?org_oid={p.org_oid}&mode=w

**Удаление ЦО**

Адрес метода: URL: esia-rs/api/public/v1/orgs/{org_oid}/rcs/{ra_oid}

Входные параметры:

На вход сервис должен получать объект, описывающий центр обслуживания,
который необходимо удалить из организации.

Параметры из URL:

-   org_oid -- идентификатор организации, из которой нужно удалить ЦО;

-   ra_oid -- идентификатор ЦО.

HTTP метод: DELETE

Пример запроса (вызов сервиса в тестовой среде):

DELETE esia-rs/api/public/v1/orgs/1000000001/rcs/1000000234 HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

Пример успешного ответа:

{

\"oid\": \"1000000234\", // идентификатор удаленного ЦО

\"message\": \"Success\|Fail\" // Fail в случае какой--то непредвиденной
ошибки

}

Структура ответа с ошибкой:

{

 \"code\": \"ESIA-038000\",

 \"message\": \"организация не найдена\"

}

Перечень возможных возвращаемых ошибок приведен в таблице 87.

Таблица 87 -- Перечень возможных возвращаемых ошибок

  ------------------------------------------------------------------------
  **Код**       **Описание**
  ------------- ----------------------------------------------------------
  ESIA-038000   Организация не найдена

  ESIA-038900   ЦО не найден

  ESIA-039813   ЦО заблокирован

  ESIA-005034   Некорректный идентификатор ЦО (например, ЦО не принадлежит
                указанной в запросе организации)

  ESIA-005043   Организация не имеет фичи ra (организация не имеет
                разрешения на операции создания, изменения, удаления
                центров обслуживания)

  ESIA-005040   У организации нет группы «TECH_CONSOLE» (у организации нет
                группы доступа (сотрудников) для работы с Технологическим
                порталом ЕСИА (использования Rest API))
  ------------------------------------------------------------------------

Требуемая область доступа (scope):

org_ra?org_oid={p.org_oid}&mode=w

### Сервис REST API безусловного добавления сотрудников в организацию

Возможно присоединение к организации только подтвержденных УЗ
сотрудников.

Осуществляется поиск присоединяемого сотрудника по СНИЛС (из перечня в
теле запроса) с последующей проверкой на совпадение ФИО (из тела запроса
и найденной УЗ).

Адрес метода: URL: esia-rs/api/public/v1/orgs/{org_oid}/invts/force

Входные параметры:

На вход сервис должен получать коллекцию объектов, описывающих УЗ
пользователей, которых необходимо добавить в организацию без отправки
приглашения на email.

Параметры из URL:

-   org_oid -- идентификатор организации, в которую нужно добавлять УЗ
    пользователей;

Параметры тела запроса:

-   firstName -- имя;

-   lastName -- фамилия;

-   middleName -- отчество;

-   snils -- СНИЛС.

По умолчанию, максимальное количество пользователей в одном запросе ‒
100.

HTTP метод: POST

Пример запроса (вызов сервиса в тестовой среде):

POST esia-rs/api/public/v1/orgs/1000000001/invts/force HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

\[

{

\"snils\": \"000--000--000 01\",

\"firstName\": \"Михаил\",

\"lastName\": \"Иванов\",

\"middleName\": \"Иванович\"

},

{

\"snils\": \"000--000--000 01\",

\"firstName\": \"Петр\",

\"lastName\": \"Петров\",

\"middleName\": \"Петрович\"

},

{

\"snils\": \"000--000--0 01\",

\"firstName\": \"Вадим\",

\"lastName\": \"Вадимов\",

\"middleName\": \"Вадимович\"

},

{

\"snils\": \"000--000--000 99\",

\"firstName\": \"Николай\",

\"lastName\": \"Николаев\",

\"middleName\": \"Николаевич\"

}

\]

Данные в ответе с результатом будут отсортированы в том же порядке,\
как и при запросе.

Пример ответа:

{

\"message\": \"Success\|Partial success\|Fail\",

\"results\": \[

{ \"snils\":\"000--000--000 01\", \"message\": \"Success\"},

{ \"snils\":\"000--000--000 02\", \"message\": \"Success\"},

{ \"snils\":\"000--000--0 01\", \"message\": \"ESIA-036101\"},

// \... ответ будет отсортирован в том же порядке, как и при запросе

{ \"snils\":\"000--000--000 99\", \"message\": \"Success\"}

\]

}

Перечень возможных возвращаемых ошибок приведен в таблице 88.

Таблица 88 -- Перечень возможных возвращаемых ошибок

  --------------------------------------------------------------------------
  **Код**       **Описание**
  ------------- ------------------------------------------------------------
  ESIA-038000   Организация не найдена

  ESIA-036101   Некорректный формат СНИЛС

  ESIA-036102   Неверная контрольная сумма СНИЛС

  ESIA-020002   Пользователь не найден

  ESIA-039951   Пользователь уже присоединен к организации

  ESIA-039961   Пользователь, УЗ которого найдена по указанному в запросе
                СНИЛС, не является сотрудником организации, org_oid которой
                указан в запросе
  --------------------------------------------------------------------------

Требуемая область доступа (scope):

org_invts_force?org_oid={p.org_oid}&mode=w 

### Сервис REST API получения списка ЦО организации

Методы для работы с ЦО организации:

-   Получение списка ЦО.

-   Поиск ЦО организации.

**Получение списка ЦО**

Просмотр перечня ЦО организации с параметрами.

Адрес метода:

URL:
esia-rs/api/public/v1/orgs/{org_oid}/rcs?embed=(elements.address,elements.contact)&wpdo=true

Входные параметры:

Список должен выводиться постранично.

Параметры из URL:

-   org_oid -- идентификатор организации;

-   pageIndex -- номер текущей страницы списка;

-   wpdo -- параметр, добавляющий в ответ значение pdos -- разрешения\
    на отображение операций.

HTTP метод: GET

Пример запроса (вызов сервиса в тестовой среде):

GET
esia-rs/api/public/v1/orgs/1000000001/rcs?embed=(elements.address,elements.contact)&pageSize=3&wpdo
HTTP/1.1

Content--Type: application/json

Authorization: Bearer
eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0

Content--Type: application/json

Cache--Control: no--cache

Пример ответа:

{

\"stateFacts\": \[

\"FirstPage\",

\"Paginated\"

\],

\"pageSize\": 3,

\"pageIndex\": 1,

\"totalSize\": 5,

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"oid\": 1000327280,

\"name\": \"Москва город, Тверской бульвар 20\",

\"active\": true,

\"blocked\": false,

\"operationTime\": \"10:00 -- 20:00\",

\"information\": \"{}\",

\"features\": \[

\"del\"

\],

\"address\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 18442,

\"type\": \"RA\",

\"addressStr\": \"Москва город, Тверской бульвар\",

\"fiasCode\": \"0c5b2444--70a0--4932--980c--b4dc0d3f02b5\",

\"countryId\": \"RUS\",

\"house\": \"20\",

\"zipCode\": \"125009\",

\"building\": \"1\",

\"street\": \"Тверской Бульвар\",

\"lat\": 55.761045,

\"lng\": 37.602344,

\"vrfDdt\": \"0,10,0\"

\"region\": \"Москва Город\",

\"fiasCode2\": \"0c5b2444--70a0--4932--980c--b4dc0d3f02b5\",

\"eTag\": \"10AA54C325DE25D0FAB7FDE1250DEB843148D007\"

},

\"contact\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 14244862,

\"type\": \"RAC\",

\"vrfStu\": \"false\",

\"value\": \"899999999\",

\"eTag\": \"67EE505F77FDEB8DD8E7E82558CC34C61651FA62\"

},

\"pdos\": \[

\"del\"

\],

\"eTag\": \"03227235143A38A08D9969348FB7AACEDBACB9C9\"

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"oid\": 1000327281,

\"name\": \"Москва город, Тверской бульвар 27 с6\",

\"active\": true,

\"blocked\": false,

\"operationTime\": \"8:00 -- 18:00\",

\"information\": \"{}\",

\"features\": \[

\"rcr\"

\],

\"address\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 18443,

\"type\": \"RA\",

\"addressStr\": \"Москва город, Тверской бульвар\",

\"fiasCode\": \"0c5b2444--70a0--4932--980c--b4dc0d3f02b5\",

\"countryId\": \"RUS\",

\"house\": \"27\",

\"zipCode\": \"123104\",

\"building\": \"6\",

\"street\": \"Тверской Бульвар\",

\"lat\": 55.763404,

\"lng\": 37.60273,

\"region\": \"Москва Город\",

\"fiasCode2\": \"2604e353--b9dd--4542--a8bf--020c8f982797\",

\"eTag\": \"3EBD14C4F4682AEF8A57655E56696C7DCB464CDD\"

},

\"contact\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 14244861,

\"type\": \"RAC\",

\"vrfStu\": \"false\",

\"value\": \"894565655\",

\"eTag\": \"616657BADBCBB1E3750AA1B12DE3B2D35D80F2DE\"

},

\"pdos\": \[

\"rcr\"

\],

\"eTag\": \"596525D1667B9AD2EDCA1A5714E359EA266ED0B2\"

},

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"oid\": 1000327282,

\"name\": \"Леонтьевский Переулок 2/26\",

\"active\": true,

\"blocked\": false,

\"operationTime\": \"8:00 -- 20:00\",

\"information\": \"{}\",

\"features\": \[

\"cfm\"

\],

\"address\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 18444,

\"type\": \"RA\",

\"addressStr\": \"Москва город, Леонтьевский переулок\",

\"fiasCode\": \"0c5b2444--70a0--4932--980c--b4dc0d3f02b5\",

\"countryId\": \"RUS\",

\"house\": \"2/26\",

\"zipCode\": \"125009\",

\"building\": \"2\",

\"street\": \"Леонтьевский Переулок\",

\"lat\": 55.757911,

\"lng\": 37.600681,

\"region\": \"Москва Город\",

\"fiasCode2\": \"6d703385--d883--488f--9c39--fca4cc82abb8\",

\"eTag\": \"1955CFFD980B039E0842E0163E977F248662963C\"

},

\"contact\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 14244860,

\"type\": \"RAC\",

\"vrfStu\": \"false\",

\"value\": \"8965461556\",

\"eTag\": \"E4D0DFDA96194E9DE0F34C3428F4B9070A51F2F5\"

},

\"pdos\": \[

\"cfm\"

\],

\"eTag\": \"7B701FD975C5466BDA0F92E3C2BEF0C5D5FDB178\"

}

\]

}

Перечень возможных возвращаемых ошибок приведен в таблице 89.

Таблица 89 -- Перечень возможных возвращаемых ошибок

  -----------------------------------------------------------------------
  **Код**                              **Описание**
  ------------------------------------ ----------------------------------
  ESIA-038000                          Организация не найдена

  -----------------------------------------------------------------------

Требуемая область доступа (scope):

org_ra?org_oid={p.org_oid}

**Поиск ЦО организации**

Адрес REST:

URL: esia-rs/api/public/v1/orgs/{org_oid}/rcs/find

Входные параметры:

Список должен выводиться постранично.

Параметры из URL:

-   org_oid -- идентификатор организации;

-   pageIndex -- номер текущей страницы списка (по умолчанию
    принимается\
    как = 1);

-   pageSize -- количество элементов (ЦО) списка на странице (по
    умолчанию принимается как = 100);

-   embed -- необязательный параметр, но для того, чтобы получить в
    ответе данные о найденном ЦО, необходимо, чтобы он был =
    (elements.address, elements.contact);

-   wpdo -- параметр, добавляющий в ответ значение pdos -- разрешения\
    на отображение операций.

Параметры тела запроса:

-   features -- услуги ЦО, перечисление «rcr», «reg», «del», «cfm»,
    «rbi»;\
    opnModes -- режим работы ЦО, перечисление «WEEKENDS», «EARLY»,
    «LATE»;

-   WEEKENDS -- работает по выходным;

-   EARLY -- открыто с 8:00 утра;

-   LATE -- закрывается позже 19:00 вечера;

-   WEEKENDS, EARLY -- работает по выходным (открыто с 8:00 утра);

-   WEEKENDS, LATE -- работает по выходным, закрывается позже 19:00
    вечера;

-   EARLY, LATE -- работает с 8:00 утра и закрывается позже 19:00
    вечера;

-   WEEKENDS, EARLY, LATE -- работает по выходным (работает с 8:00 утра
    и закрывается позже 19:00 вечера);

-   name -- название ЦО, возможно указание неполного названия (поиск\
    по совпадению части имени).

**Поиск по условию «И»**

HTTP метод: POST

Пример запроса (вызов сервиса в тестовой среде):

POST
esia-rs/api/public/v1/orgs/1000000001/rсs/find?embed=(elements.address,elements.contact)&wpdo=true
HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

{

\"features\": \[\"del\"\],

\"opnModes\": \[\"LATE\", \"WEEKENDS\"\],

\"name\": \"Тверской бульвар 20\"

}

Пример ответа:

{

\"stateFacts\": \[

\"FirstPage\",

\"Paginated\",

\"LastPage\"

\],

\"size\": 1,

\"pageSize\": 100,

\"pageIndex\": 1,

\"elements\": \[

{

\"stateFacts\": \[

\"Identifiable\"

\],

\"oid\": 1000327280,

\"name\": \"Москва город, Тверской бульвар 20\",

\"active\": true,

\"blocked\": false,

\"operationTime\": \"10:00 -- 20:00\",

\"information\": \"{}\",

\"features\": \[

\"del\"

\],

\"address\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 18442,

\"type\": \"RA\",

\"addressStr\": \"Москва город, Тверской бульвар\",

\"fiasCode\": \"0c5b2444--70a0--4932--980c--b4dc0d3f02b5\",

\"countryId\": \"RUS\",

\"house\": \"20\",

\"zipCode\": \"125009\",

\"building\": \"1\",

\"street\": \"Тверской Бульвар\",

\"lat\": 55.761045,

\"lng\": 37.602344,

\"region\": \"Москва Город\",

\"fiasCode2\": \"2604e353--b9dd--4542--a8bf--020c8f982797\",

\"eTag\": \"10AA54C325DE25D0FAB7FDE1250DEB843148D007\"

},

\"contact\": {

\"stateFacts\": \[

\"Identifiable\"

\],

\"id\": 14244862,

\"type\": \"RAC\",

\"vrfStu\": \"false\",

\"value\": \"899999999\",

\"eTag\": \"67EE505F77FDEB8DD8E7E82558CC34C61651FA62\"

},

\"pdos\": \[

\"del\"

\],

\"opnModes\": \[

\"LATE\",

\"WEEKENDS\",

\"EARLY\"

\],

\"eTag\": \"A52ABED7388EB183F11E3DF9B8535234964AD9B8\"

}

\]

}

Перечень возможных возвращаемых ошибок приведен в таблице 90.

Таблица 90 -- Перечень возможных возвращаемых ошибок

  ------------------------------------------------------------------------
  **Код**       **Описание**
  ------------- ----------------------------------------------------------
  ESIA-038000   Организация не найдена

  ------------------------------------------------------------------------

Требуемая область доступа (scope):

org_ra?org_oid={p.org_oid})

### Сервис REST API прикрепления сотрудников к ЦО

Возможно присоединение к ЦО только подтвержденных УЗ сотрудников
организации.

Поиск УЗ осуществляется по СНИЛС только в подтвержденных УЗ.

Адрес метода:

URL: esia-rs/api/public/v1/orgs/{org_oid}/rcs/{rc_oid}/invts/force

Входные параметры:

На вход сервис должен получать коллекцию объектов, описывающих УЗ
пользователей, которых необходимо прикрепить к ЦО.

По умолчанию максимальное количество пользователей в одном запросе ‒
100.

-   org_oid -- идентификатор организации, к ЦО которой прикрепляется
    пользователь;

-   rc_oid -- идентификатор ЦО, к которому нужно прикрепить УЗ
    пользователя.

Параметры тела запроса:

-   firstName -- имя;

-   lastName -- фамилия;

-   middleName -- отчество;

-   snils -- СНИЛС.

HTTP метод: POST

Пример запроса (вызов сервиса в тестовой среде):

POST esia-rs/api/public/v1/orgs/1000000001/rcs/1000000234/invts/force
HTTP/1.1

Host: esia-portal1.test.gosuslugi.ru

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0eyJleHAiOjE0NDYyMTU2ND

Content--Type: application/json

Cache--Control: no--cache

\[

{

\"snils\": \"000--000--000 01\",

\"firstName\": \"Михаил\",

\"lastName\": \"Иванов\",

\"middleName\": \"Иванович\"

},

{

\"snils\": \"000--000--000 01\",

\"firstName\": \"Петр\",

\"lastName\": \"Петров\",

\"middleName\": \"Петрович\"

},

{

\"snils\": \"000--000--0 01\",

\"firstName\": \"Вадим\",

\"lastName\": \"Вадимов\",

\"middleName\": \"Вадимович\"

},

{

\"snils\": \"000--000--000 99\",

\"firstName\": \"Николай\",

\"lastName\": \"Николаев\",

\"middleName\": \"Николаевич\"

}

\]

Ответ с результатом будет отсортирован в том же порядке, как и при
запросе.

Пример ответа:

{

\"oid \": \"1000000234\", // идентификатор ЦО в который добавлялись
пользователи

\"message\": \"Success\|Partial success\|Fail\",

\"results\": \[

{ \"snils\":\"000--000--000 01\", \"message\": \"Success\"},

{ \"snils\":\"000--000--000 02\", \"message\": \"Success\"},

{ \"snils\":\"000--000--0 01\", \"message\": \"ESIA-036101\"},

// \... ответ будет отсортирован в том же порядке, как и при запросе

{ \"snils\":\"000--000--000 99\", \"message\": \"Success\"}

\]

}

Перечень возможных возвращаемых ошибок приведен в таблице 91.

Таблица 91 -- Перечень возможных возвращаемых ошибок

  -------------------------------------------------------------------------
  **Код**       **Описание**
  ------------- -----------------------------------------------------------
  ESIA-038000   Организация не найдена

  ESIA-038900   ЦО не найден

  ESIA-038901   ЦО не принадлежит организации

  ESIA-036101   Некорректный формат СНИЛС

  ESIA-020002   Пользователь не найден

  ESIA-039961   Пользователь, УЗ которого найдена по указанному в запросе
                СНИЛС, не является сотрудником организации, org_oid которой
                указан в запросе
  -------------------------------------------------------------------------

Требуемая область доступа (scope):

org_invts_force?org_oid={p.org_oid}&mode=w.

## Сервис получения маркера доступа по идентификационному ключу

Для получения внешней ИС или приложением маркера доступа к API услуг
ЕПГУ в обмен на выданный идентификационный ключ (api-key) используется
метод REST API ЕСИА GET \>/esia-rs/api/public/v1/orgs/ext-app/{UUID}/tkn

Примечания:

-   идентификационный ключ -- уникальный идентификатор формата UUID,
    сформированный соответствующим сервисом ЕСИА в привязке к сотруднику
    организации и ИС вендора, зарегистрированной в ЕСИА;

-   маркер доступа -- маркер доступа, формируемый OAuth2.0 ЕСИА
    (описание структуры -- согласно п. Б.5, Приложение Б) и выдаваемый
    на область доступа (scope), необходимые и достаточные для доступа к
    API услуг ЕПГУ (перечень требуемых областей доступа (scope)
    указывается службой эксплутации ЕСИА в соответствующей
    конфигурационной настройке ЕСИА).

Описание метода:

-   метод HTTP запроса: GET;

-   URL запроса метода: https://\<базовый адрес среды
    ЕСИА\>/esia-rs/api/public/v1/orgs/ext--app/{UUID}/tkn;

-   входные параметры метода:

-   UUID -- идентификационный ключ (указывается как in-url);

-   signature -- подпись запроса в формате PKCS#7 detached signature в
    формате urlSafeBase64 в кодировке UTF-8 -- подписанный не ранее, чем
    за 24 часа (86400 с) параметр UUID сертификатом организации, на
    сотрудника которой был выдан (сформирован) идентификационный ключ.

-   выходные параметры метода -- JSON с параметром «accessTkn» -- маркер
    доступа к API услуг ЕПГУ.

Пример запроса метода:

GET
/esia-rs/api/public/v1/orgs/ext--app/73535141--e8ae--4abb--ae03--e5d7cd3fbef1/tkn?signature=MIIKeQYJKoZIhvcNAQcCoIIKajCCCmYCAQExDjAMBggqhQMHAQECAgUAMDMGCSqGSIb3DQEHAaAmBCQ3MzUzNTE0MS1lOGFlLTRhYmItYWUwMy1lNWQ3Y2QzZmJlZjGgggftMIIH6TCCB5agAwIBAgIQYD6SAA2r3oZOyLA4syCgLjAKBggqhQMHAQEDAjCCAT8xGDAWBgUqhQNkARINMTAyNzcwMDE5ODc2NzEaMBgGCCqFAwOBAwEBEgwwMDc3MDcwNDkzODgxCzAJBgNVBAYTAlJVMSkwJwYDVQQIDCA3OCDQodCw0L3QutGCLdCf0LXRgtC10YDQsdGD0YDQszEmMCQGA1UEBwwd0KHQsNC90LrRgi3Qn9C10YLQtdGA0LHRg9GA0LMxWDBWBgNVBAkMTzE5MTAwMiwg0LMuINCh0LDQvdC60YIt0J%2FQtdGC0LXRgNCx0YPRgNCzLCDRg9C7LiDQlNC%2B0YHRgtC%2B0LXQstGB0LrQvtCz0L4g0LQuMTUxJjAkBgNVBAoMHdCf0JDQniAi0KDQvtGB0YLQtdC70LXQutC%2B0LwiMSUwIwYDVQQDDBzQotC10YHRgtC%2B0LLRi9C5INCj0KYg0KDQotCaMB4XDTE5MTEyMjA4NDIyOFoXDTIwMTEyMjA4NTIyOFowggGHMTQwMgYJKoZIhvcNAQkBFiV0ZXN0QHRlc3QudGVzdDxtYWlsdG86dGVzdEB0ZXN0LnRlc3Q%2BMRowGAYIKoUDA4EDAQESDDAwNzcyODEzMTU4NzEWMBQGBSqFA2QDEgs3NjYyNDU2NjAzMzEYMBYGBSqFA2QBEg0xMTE3Nzk5MDA0MzMzMSEwHwYDVQQMDBjQoNGD0LrQvtCy0L7QtNC40YLQtdC70YwxIDAeBgNVBAoMF9Ce0JDQniA80KDQvtGB0L3QsNC90L4%2BMRUwEwYDVQQJDAzQnNC%2B0YHQutCy0LAxFTATBgNVBAcMDNCc0L7RgdC60LLQsDEcMBoGA1UECAwTNzcg0LMuINCc0L7RgdC60LLQsDELMAkGA1UEBhMCUlUxKjAoBgNVBCoMIdCi0LDRgtGM0Y%2FQvdCwINCQ0L3QtNGA0LXQtdCy0L3QsDEVMBMGA1UEBAwM0KDQvtCz0L7QstCwMSAwHgYDVQQDDBfQntCQ0J4gPNCg0L7RgdC90LDQvdC%2BPjBmMB8GCCqFAwcBAQEBMBMGByqFAwICJAAGCCqFAwcBAQICA0MABEA7R9s0yPHwRXySk0v0qFZ6NMrPsgIPBzhAIP1ujjZupVYpI3UaCGOa6uiy7Scj6DJgiiKI2sHmA7SEFSOvgstqo4IEGTCCBBUwDgYDVR0PAQH%2FBAQDAgTwMB0GA1UdDgQWBBQiFrhcRjqGP7obev%2FofLFuK85JnzAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwQwUwYIKwYBBQUHAQEERzBFMEMGCCsGAQUFBzAChjdodHRwOi8vY2VydGVucm9sbC50ZXN0Lmdvc3VzbHVnaS5ydS9jZHAvdGVzdF9jYV9ydGsuY2VyMB0GA1UdIAQWMBQwCAYGKoUDZHEBMAgGBiqFA2RxAjArBgNVHRAEJDAigA8yMDE5MTEyMjA4NDIyN1qBDzIwMjAxMTIyMDg0MjI3WjCCARAGBSqFA2RwBIIBBTCCAQEMGtCa0YDQuNC%2F0YLQvtCf0YDQviBDU1AgNC4wDB3QmtGA0LjQv9GC0L7Qn9GA0L4g0KPQpiB2LjIuMAxh0KHQtdGA0YLQuNGE0LjQutCw0YLRiyDRgdC%2B0L7RgtCy0LXRgtGB0YLQstC40Y8g0KTQodCRINCg0L7RgdGB0LjQuCDQodCkLzEyNC0zMzgwINC%2B0YIgMTEuMDUuMjAxOAxh0KHQtdGA0YLQuNGE0LjQutCw0YLRiyDRgdC%2B0L7RgtCy0LXRgtGB0YLQstC40Y8g0KTQodCRINCg0L7RgdGB0LjQuCDQodCkLzEyOC0yOTgzINC%2B0YIgMTguMTEuMjAxNjAlBgUqhQNkbwQcDBrQmtGA0LjQv9GC0L7Qn9GA0L4gQ1NQIDQuMDBlBgNVHR8EXjBcMFqgWKBWhlRodHRwOi8vY2VydGVucm9sbC50ZXN0Lmdvc3VzbHVnaS5ydS9jZHAvNDgxMGFmMGY1ZGRjOTkyNDc2ZjdiZjBkZGE0YjdkMGRkOTRjZTFmNy5jcmwwggGABgNVHSMEggF3MIIBc4AUSBCvD13cmSR2978N2kt9DdlM4fehggFHpIIBQzCCAT8xGDAWBgUqhQNkARINMTAyNzcwMDE5ODc2NzEaMBgGCCqFAwOBAwEBEgwwMDc3MDcwNDkzODgxCzAJBgNVBAYTAlJVMSkwJwYDVQQIDCA3OCDQodCw0L3QutGCLdCf0LXRgtC10YDQsdGD0YDQszEmMCQGA1UEBwwd0KHQsNC90LrRgi3Qn9C10YLQtdGA0LHRg9GA0LMxWDBWBgNVBAkMTzE5MTAwMiwg0LMuINCh0LDQvdC60YIt0J%2FQtdGC0LXRgNCx0YPRgNCzLCDRg9C7LiDQlNC%2B0YHRgtC%2B0LXQstGB0LrQvtCz0L4g0LQuMTUxJjAkBgNVBAoMHdCf0JDQniAi0KDQvtGB0YLQtdC70LXQutC%2B0LwiMSUwIwYDVQQDDBzQotC10YHRgtC%2B0LLRi9C5INCj0KYg0KDQotCaghByCwFWUAAQs%2BgRpGhL66%2F7MAoGCCqFAwcBAQMCA0EAVTneiC0PfzpcScCjesYiqPF%2FBHrdR2KxZVF8rsbKuEfAzUyA5RZH%2F%2BHnOCaZ618ggut77IFu26wif0RffraxazGCAikwggIlAgEBMIIBVTCCAT8xGDAWBgUqhQNkARINMTAyNzcwMDE5ODc2NzEaMBgGCCqFAwOBAwEBEgwwMDc3MDcwNDkzODgxCzAJBgNVBAYTAlJVMSkwJwYDVQQIDCA3OCDQodCw0L3QutGCLdCf0LXRgtC10YDQsdGD0YDQszEmMCQGA1UEBwwd0KHQsNC90LrRgi3Qn9C10YLQtdGA0LHRg9GA0LMxWDBWBgNVBAkMTzE5MTAwMiwg0LMuINCh0LDQvdC60YIt0J%2FQtdGC0LXRgNCx0YPRgNCzLCDRg9C7LiDQlNC%2B0YHRgtC%2B0LXQstGB0LrQvtCz0L4g0LQuMTUxJjAkBgNVBAoMHdCf0JDQniAi0KDQvtGB0YLQtdC70LXQutC%2B0LwiMSUwIwYDVQQDDBzQotC10YHRgtC%2B0LLRi9C5INCj0KYg0KDQotCaAhBgPpIADavehk7IsDizIKAuMAwGCCqFAwcBAQICBQCgaTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0yMDA3MTQxMzE5MjRaMC8GCSqGSIb3DQEJBDEiBCCHyDksc05aocKt9TfPMAkfINvAAcuRqCqJvS1MVUU1hTAMBggqhQMHAQEBAQUABEBYnLGLx04Y2ot7pxFrGBNEyrO9XFiUyTLesheld8BHUEzm8VTTW7kuSFMRGmZjz%2B%2FVe86VakA1sY3BSiMe3sHS

Пример ответа на запрос метода:

HTTP/1.1 200 OK

{

\"accessTkn\":
\"eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJzY29wZSI6Imh0dHA6XC9cL2VzaWEuZ29zdXNsdWdpLnJ1XC9vcmdfZnVsP29yZ19vaWQ9MTA3NzEwMTI2NSBodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvb3JnX2luZj9vcmdfb2lkPTEwNzcxMDEyNjUiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiNDQ1N2FmNjktZmRhNS00Y2MyLTllYzMtNTE3NzhkYjEyMTA3IiwidXJuOmVzaWE6c2JqX2lkIjoxMDc3MTE4Mzk2LCJleHAiOjE1OTQ3NDc2NDEsImlhdCI6MTU5NDczNjg0MSwiY2xpZW50X2lkIjoiMTIzNDU2NyJ9.kFQk89VpX0A3qA6BZu7qqUJf5KnLtmeKaVvt8sn2v73peuIVnYpWL2kmAIKpZAE0vtrvcDSagEBVgXoExdtAkNCAUiGA41HJCJHBbn--3fFDS3FNHB--9PaC3XclFx8Z04GPX5yt2CnBS_IsTcdvZxOOPuBz4IJYrsMi9R9cFad8Seff0h9OBPt--kauTpe8gkHvmCVpLkNf5slEeK4rxCMUnBhXSA5RbWbC4yudO9rkhWcPQc--3WwMHrvkVZFRj9YlUe6sf--fMf3QHn_pk2jcxZFaaMx--EEMPxOoJHy0sOOKzvIElpcWbwkgPCAg4fb5olMg6PUKhE3GThTXbZsJBFng\"

}

Перечень возможных возвращаемых ошибок приведен в таблице 92.

Таблица 92 -- Перечень возможных возвращаемых ошибок

  -----------------------------------------------------------------------
  **Код**       **Описание**
  ------------- ---------------------------------------------------------
  ESIA-005002   Некорректная подпись запроса (параметр signature
                некорректного формата или подписанный UUID не
                соответствует указанному в URL метода параметру UUID)

  ESIA-037218   Не найден указанный в запросе идентификационный ключ
                (UUID)

  ESIA-037219   Не найден сотрудник организации, на которого выдан
                (сформирован) идентификационный ключ (UUID)

  ESIA-038000   Не найдена организация, привязанная к идентификационному
                ключу (UUID)

  ESIA-037214   Указанный в запросе идентификационный ключ (UUID)
                заблокирован

  ESIA-037213   У указанного в запросе идентификационного ключа (UUID)
                истек срок действия

  ESIA-037215   Сотрудник организации, выдавший (сформировавший)
                идентификационный ключ (UUID), заблокирован

  ESIA-037216   Сотрудник организации, на которого выдан (сформирован)
                идентификционный ключ (UUID), заблокирован

  ESIA-037217   У сотрудника организации, формирующего идентификационный
                ключ, отсутствует\
                или не действует доверенность на право формирования
                идентификационных ключей\
                на ИС вендора

  ESIA-005027   В конфигурационной настройке ЕСИА для API услуг ЕПГУ
                указаны неизвестные области доступа (scope)

  ESIA-020000   Некорректно указаны параметры запроса метода
  -----------------------------------------------------------------------

# Сервисы ЕСИА, основанные на протоколе OAuth2.0 и OpenID Connect 1.0

## Общие сведения

Сервисы, рекомендованные к выводу из эксплуатации, не допускаются
к использованию при подключении новых-систем клиентов.

OAuth 2.0 определяет протокол взаимодействия следующих сторон:

-   владелец ресурса (resource owner) -- сущность, которая может
    предоставить доступ к защищаемому ресурсу (например, конечный
    пользователь);

-   система-клиент (client) -- приложение, которое запрашивает доступ\
    к защищаемому ресурсу от имени владельца ресурса;

-   сервис авторизации (authorization server) -- сервис, который
    выпускает\
    для клиента маркеры доступа с разрешения владельца ресурса;

-   поставщик ресурса (resource server) -- сервис, на котором размещены
    защищаемые ресурсы, и который может принимать запросы на доступ\
    к защищаемым ресурсам и отвечать на эти запросы.

Модель контроля доступа, реализуемая сервисом авторизации ЕСИА, основана
на использовании *маркера доступа* (security access token). Этот маркер
несет информацию о подмножестве полномочий системы-клиента, о самой
системе-клиенте, а также ряд служебных параметров. С точки зрения
системы-клиента маркер доступа представляет собой набор символов.
Системе--клиенту для получения доступа к защищенным ресурсам (т.е.
делать успешные вызовы программного интерфейса), как правило, не
требуется получать данные из маркера доступа, достаточно лишь получать
сам маркер доступа по определенным правилам и корректно использовать. В
то же время маркеры доступа\
в ЕСИА содержат электронную подпись, которая может быть проверена без
обращения\
к ЕСИА.

В ЕСИА используются два способа получения маркера доступа:

1)  Система-клиент получает маркер доступа в результате делегированного
    принятия решения сервисом авторизации на основании согласия
    владельца ресурса. В этом случае сервис авторизации выдает маркер
    доступа, если явным образом получает разрешение со стороны владельца
    ресурса. Например, система-клиент обратилась к сервису авторизации
    за маркером, позволяющим получить контактные данные пользователя.
    В этом случае сервис авторизации запрашивает у пользователя,
    согласен ли он предоставить данные системе-клиенту, и при позитивном
    решении выдает маркер доступа.

2)  Система-клиент получает маркер доступа в результате решения сервиса
    авторизации на основании наличия у системы-клиента соответствующих
    полномочий. В этом случае система-клиент не должна получать явного
    разрешения от владельца ресурса -- это разрешение было дано
    заранее,\
    на стадии регистрации системы-клиента в сервисе авторизации. Такая
    модель контроля доступа реализуется, например, при взаимодействии
    ИС, если одна система запрашивает доступ к сведениям о другой
    системе, для чего ей необходимо получить соответствующий маркер
    доступа.

Аутентификация пользователя, реализуемая с помощью модели OAuth 2.0\
и расширения OpenID Connect, основана на использовании маркера
идентификации (ID token). Этот маркер содержит информацию об
идентификационных данных пользователя, а также ряд служебных параметров.

## Модель контроля на основе делегированного принятия решения

### Общие принципы

Данная модель контроля доступа используется в случаях, когда
система-клиент при доступе к ресурсу должна получить разрешение на это
действие со стороны владельца ресурса.

В общем виде схема взаимодействия выглядит следующим образом:

-   система-клиент запрашивает у владельца ресурса разрешение на доступ
    к соответствующим ресурсам. Обычно этот запрос осуществляется\
    не напрямую к владельцу ресурса, а опосредованно через сервис
    авторизации (который, в свою очередь, запрашивает разрешение у
    владельца ресурса), поскольку сам владелец ресурса не может выдать
    ни маркер доступа,\
    ни авторизационный код;

-   система-клиент получает разрешение на доступ (authorization grant) в
    виде авторизационного кода;

-   система-клиент запрашивает маркер доступа, предъявив авторизационный
    код сервису авторизации;

-   сервис авторизации аутентифицирует систему-клиента, проверяет
    авторизационный код и выдает маркер доступа и маркер
    обновления[^55];

-   система-клиент запрашивает у поставщика защищенный ресурс,
    предъявляя маркер доступа;

-   поставщик ресурса проверяет маркер доступа, если он валиден, то
    разрешает доступ к защищенному ресурсу;

-   система-клиент вновь запрашивает с помощью выданного ранее маркера
    доступ к защищенному ресурсу;

-   поставщик ресурса проверяет маркер, обнаруживает, что срок его
    действия истек, возвращает сообщение об ошибке;

-   система-клиент обращается к сервису авторизации за получением нового
    маркера доступа, предъявляя маркер обновления[^56];

-   сервис авторизации проверяет валидность маркера обновления и
    возвращает два новых маркера: доступа и обновления.

Схема взаимодействия представлена на рисунке 8.

После того, как система-клиент получила маркер доступа, она может
неоднократно обращаться за получением соответствующего защищенного
ресурса, пока не истечет срок действия этого маркера. Когда это
произойдет, системе-клиенту потребуется получить новый маркер доступа.

Ключевая особенность этой модели в том, что сам владелец ресурса
никогда\
не получает маркер доступа, его получает сама система-клиент в
результате прямой связи\
с сервисом авторизации (server-side flow).

![](media/image8.emf){width="4.9375in" height="5.018003062117235in"}

Рисунок 8 -- Общая схема взаимодействия при получении маркера доступа с
помощью авторизационного кода

Для оптимизации повторного получения маркера доступа используется
механизм *маркера обновления*[^57] (refresh token): в этом случае
первоначально в обмен\
на авторизационный код системе-клиенту выдается не только маркер
доступа, но и маркер обновления. Когда маркер доступа перестает
действовать, система-клиент обращается\
к сервису авторизации за получением нового маркера доступа, предъявляя
последний полученный ранее маркер обновления. Сервис авторизации
проверяет валидность маркера обновления (что он является актуальным, не
был отозван и что срок его действия не истек) и выдает новый маркер
доступа и маркер обновления.

Особенности маркера обновления:

-   имеет более длительный срок действия, чем у маркера доступа. Срок
    действия маркера обновления различен для каждой ИС и настраивается
    Администратором ИС в Технологическом портале ЕСИА;

-   предъявляется исключительно при необходимости получить новый маркер
    доступа (таким образом, минимизируется риск перехвата);

-   выдается сервисом авторизации одновременно с маркером доступа;

-   может быть отозван владельцем ресурса.

Таким образом, наличие маркера обновления позволяет системе-клиенту
получать новый маркер доступа даже тогда, когда пользователь (владелец
ресурса) недоступен,\
при условии, что владелец ресурса явным образом не запретил доступ.

### Получение авторизационного кода (рекомендован к выводу из эксплуатации и не допускается к использованию при подключении новых систем-клиентов)

Данный раздел описывает порядок получения авторизационнго кода\
с использованием endpoint \".../ac\". Данный метод не рекомендован к
использованию.\
В п. Б.2.3, Приложение Б описывается процесс получения авторизационнго
кода\
с использованием endpoint \".../v2/ac\".

Чтобы получить авторизационный код, система-клиент должна получить
разрешение на доступ к защищенному ресурсу со стороны его владельца. В
случае,\
когда владельцем является пользователь ЕСИА, система-клиент должна
направить пользователя на страницу предоставления прав доступа в
ЕСИА[^58] (пользователь должен быть предварительно аутентифицирован в
ЕСИА или система ЕСИА попросит его пройти идентификацию
и аутентификацию).

Эта ссылка должна содержать следующие обязательные параметры:

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА указанная прописными буквами);

-   \<client_secret\> -- подпись запроса в формате PKCS#7 detached
    signature\
    в кодировке UTF-8 от значений четырех параметров HTTP-запроса:
    scope, timestamp, clientId, state (без разделителей).
    \<client_secret\> должен быть закодирован в формате base64 url safe.
    Используемый для проверки подписи сертификат должен быть
    предварительно зарегистрирован в ЕСИА и привязан к УЗ
    системы-клиента в ЕСИА. ЕСИА использует сертификаты в формате X.509
    и взаимодействует с алгоритмами формирования электронной подписи
    ГОСТ Р 34.10-2012 и криптографического хэширования ГОСТ Р
    34.11-2012;

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после того, как даст разрешение на доступ к ресурсу;

-   \<scope\> -- область доступа, т.е. запрашиваемые права; например,
    если система-клиент запрашивает доступ к сведениям о сотрудниках
    организации,\
    то область доступа (scope) должна иметь значение
    http://esia.gosuslugi.ru/org_emps (с необходимыми параметрами);\
    если запрашивается область доступа (scope) id_doc[^59] (данные о
    пользователе), то не нужно в качестве параметра указывать oid этого
    пользователя;

-   \<response_type\> -- это тип ответа, который ожидается от ЕСИА,
    имеет значение code, если система-клиент должна получить
    авторизационный код;

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID;

-   \<timestamp\> -- время запроса авторизационного кода в формате
    yyyy.MM.dd HH:mm:ss Z (например, 2013.01.25 14:36:11 +0400),
    необходимое для фиксации начала временного промежутка, в течение
    которого будет валиден запрос\
    с данным идентификатором (\<state\>);

-   \<access_type\> -- принимает значение «offline», если требуется
    иметь доступ\
    к ресурсам и тогда, когда владелец не может быть вызван (в этом
    случае выпускается маркер обновления[^60]); значение «online» --
    доступ требуется только при наличии владельца;

-   \<person_filter\> -- необязательный параметр, позволяющий
    производить авторизацию только для определенных групп лиц. Допустимо
    использование одного из следуюших фильтров:

-   для авторизации только подтвержденных учетных записей в параметре
    необходимо передать conf_acc в кодировке base64 (т.е. Y29uZl9hY2M=);

-   для авторизации только учетных записей детей в параметре необходимо
    передать acc_kid в кодировке base64 (т.е. YWNjX2tpZA==);

-   для авторизации всех учетных записей, кроме учетных записей детей,
    в параметре необходимо передать acc_not_kid в кодировке base64
    (т.е. YWNjX25vdF9raWQ=);

-   для авторизации только подтвержденных учетных записей или учетных
    записей детей в параметре необходимо передать комбинацию из conf_acc
    и acc_kid в кодировке base64 (т.е. Y29uZl9hY2MgYWNjX2tpZA==).

Если в ходе авторизации не возникло ошибок, то ЕСИА осуществляет
перенаправление пользователя по ссылке, указанной в redirect_uri, а
также возвращает два обязательных параметра:

-   \<code\> -- значение авторизационного кода;

-   \<state\> -- значение параметра state, который был получен в
    запросе\
    на авторизацию; система-клиент должна провести сравнение
    отправленного\
    и полученного параметра state.

В случае ошибки сервис авторизации вернет в параметре *error* код ошибки
(например, «access_denied») и перенаправит пользователя по адресу,
указанному\
в *redirect_uri*. Перечень возможных ошибок приведен в таблице 93.

Авторизационный код не требуется валидировать на стороне информационных
систем. Состав полей и их значение в коде может изменяться без
уведомлений. Валидация осуществляется на стороне ЕСИА.

Таблица 93 -- Список ошибок при получении маркеров доступа

+---+------------------------+----------------------------------------+
| * | **Код параметра**      | **Описание параметра**                 |
| * |                        |                                        |
| № |                        |                                        |
| * |                        |                                        |
| * |                        |                                        |
+===+========================+========================================+
| 1 | invalid_request        | ESIA-007002: Несоответствие            |
| . |                        | сертификата и мнемоники информационной |
|   |                        | системы или отсутствие сертификата\    |
|   |                        | для данной системы в ЕСИА              |
+---+------------------------+----------------------------------------+
| 2 | invalid_request        | ESIA-007003: В запросе отсутствует     |
| . |                        | обязательный параметр, запрос включает |
|   |                        | в себя неверное значение параметра\    |
|   |                        | или включает параметр несколько раз    |
+---+------------------------+----------------------------------------+
| 3 | access_denied          | ESIA-007004: Владелец ресурса или      |
| . |                        | сервис авторизации отклонил запрос     |
|   |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 4 | unauthorized_client    | ESIA-007005: Система-клиент не имеет   |
| . |                        | права запрашивать получение маркера    |
|   |                        | доступа таким методом                  |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 5 | invalid_scope          | ESIA-007006: Запрошенная область       |
| . |                        | доступа (scope) указана неверно,       |
|   |                        | неизвестно или сформирована            |
|   |                        | некорректно                            |
+---+------------------------+----------------------------------------+
| 6 | server_error           | ESIA-007007: Возникла неожиданная      |
| . |                        | ошибка в работе сервиса авторизации,   |
|   |                        | которая привела к невозможности        |
|   |                        | выполнить запрос                       |
+---+------------------------+----------------------------------------+
| 7 | t                      | ESIA-007008: Сервис авторизации в      |
| . | emporarily_unavailable | настоящее время не может выполнить     |
|   |                        | запрос из-за большой нагрузки\         |
|   |                        | или технических работ на сервере       |
+---+------------------------+----------------------------------------+
| 8 | uns                    | ESIA-007009: Сервис авторизации не     |
| . | upported_response_type | поддерживает получение маркера доступа |
|   |                        | этим методом                           |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 9 | invalid_client         | ESIA-008010: Не удалось произвести     |
| . |                        | аутентификацию системы-клиента         |
|   |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | invalid_grant          | ESIA-007011: Авторизационный код или   |
| 0 |                        | маркер обновления недействителен,      |
| . |                        | просрочен, отозван или не              |
|   |                        | соответствует адресу ресурса,          |
|   |                        | указанному в запросе на авторизацию,\  |
|   |                        | или был выдан другой системе-клиенту   |
+---+------------------------+----------------------------------------+
| 1 | unsupported_grant_type | ESIA-007012: Тип авторизационного кода |
| 1 |                        | не поддерживается сервисом авторизации |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | invalid_scope          | ESIA-007013: Запрос не содержит        |
| 2 |                        | указания на область доступа (scope)    |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | invalid_request        | ESIA-007014: Запрос не содержит        |
| 3 |                        | обязательного параметра \[\]           |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | invalid_request        | ESIA-007015: Неверное время запроса    |
| 4 |                        |                                        |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | no_grants              | ESIA-007019: Отсутствует разрешение на |
| 5 |                        | доступ                                 |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | invalid_request        | ESIA-007023: Указанный в запросе       |
| 6 |                        | \<redirect_uri\> отсутствует среди     |
| . |                        | разрешенных для ИС                     |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | invalid_request        | ESIA-007036: Учетная запись            |
| 7 |                        | заблокирована                          |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 1 | author                 | ESIA-007046: Запрос otp невозможен, а  |
| 8 | ization2faNotAvailable | в области доступа (scope) указано      |
| . |                        | обязательное прохождение пользователем |
|   |                        | двухфакторной авторизации, недоступный |
|   |                        | пользователю                           |
+---+------------------------+----------------------------------------+
| 1 | clientSecretWrong      | ESIA-007053: Client_secret сформирован |
| 9 |                        | некорректно. Client_secret не          |
| . |                        | соответствует строке-сертификату,      |
|   |                        | информационной системе или             |
|   |                        | используемый сертификат\               |
|   |                        | не активен                             |
+---+------------------------+----------------------------------------+
| 2 | invalid_request        | ESIA-007055: Вход в систему            |
| 0 |                        | осуществляется с неподтвержденной      |
| . |                        | учетной записью                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 2 | invalid_request        | ESIA-007060: Значение параметра        |
| 1 |                        | \<roles\> в запросе указано неверно    |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 2 | invalid_request        | ESIA-007061: Значение параметра        |
| 2 |                        | \<obj_type\> в запросе указано неверно |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 2 | invalid_request        | ESIA-007062: Тип или роль пользователя |
| 3 |                        | в запросе указана неверно              |
| . |                        |                                        |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 2 | scopes_not_al          | ESIA-007194: Запрос области доступа    |
| 4 | lowed_to_person_of_org | для организации, сотрудником которой   |
| . |                        | пользователь не является               |
|   |                        |                                        |
+---+------------------------+----------------------------------------+
| 2 | au                     | ESIA-007071: Запрос персональных       |
| 5 | thCanOnlyByPermissions | данных по физическим лицам может быть  |
| . |                        | выполнен только с указанием согласий   |
|   |                        |                                        |
+---+------------------------+----------------------------------------+

### Получение авторизационного кода (v2/ac)

В данном разделе описан процесс получения авторизационнго кода
с использованием нового технического решения endpoints \".../v2/ac\".

Чтобы получить авторизационный код, система-клиент должна получить
разрешение на доступ к защищенному ресурсу со стороны его владельца. В
случае,\
когда владельцем является пользователь ЕСИА, система-клиент должна
направить пользователя на страницу предоставления прав доступа в
ЕСИА[^61] (пользователь должен быть предварительно аутентифицирован в
ЕСИА или система ЕСИА попросит его пройти идентификацию
и аутентификацию).

Эта ссылка должна содержать следующие обязательные параметры:

-   \<client_secret\> -- подпись значений шести параметров в кодировке
    UTF-8:

    -   client_id;

    -   scope;

    -   scope_org;

    -   timestamp;

    -   state;

    -   redirect_uri.

Порядок формирования \<client_secret\>:

1)  конкретизировать вышеуказанные параметры (порядок важен!). Пример
    строки:

TESTAPPLICATIONopenidorg_inf2021.11.10 12:28:46
+0300bbf0aef5--5237--41bc--8cba--291e29a3ade8https://test.application.ru/auth/api/v1/esia/return

2)  подписать полученную строку по алгоритму ГОСТ Р 34.10-2012
    с использованием сертифицированного средства криптографической
    защиты информации;

3)  с использованием механизмов сертифицированных Российских
    криптографических средств защиты информации и сертификата
    информационной системы[^62];

4)  закодировать полученное значение в base64 url safe.

Используемый для проверки подписи сертификат должен быть предварительно
зарегистрирован в ЕСИА[^63] и привязан к УЗ системы-клиента в ЕСИА. ЕСИА
использует сертификаты в формате X.509 и криптографические алгоритмы
ГОСТ Р 34.10-2012 для формирования электронной подписи и ГОСТ Р
34.11-2012 для хэширования;

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА указанная прописными буквами);

-   \<scope\> -- область доступа, т.е. запрашиваемые права; например,
    если система-клиент запрашивает доступ к сведениям о сотрудниках
    организации, то область доступа (scope) должна иметь значение
    «http://esia.gosuslugi.ru/org_emps» (с необходимыми параметрами);
    если запрашивается область доступа (scope) id_doc[^64] (данные о
    пользователе),\
    то не нужно в качестве параметра указывать oid этого пользователя, в
    случае указания параметра scope_org указывается область доступа
    openid;

-   \<scope_org\> -- область доступа, т.е. запрашиваемые права для
    юридических лиц; например, если система-клиент запрашивает доступ к
    сведениям\
    об организации (hhtp://esia.gosuslugi.ru/org_inf), то не нужно в
    качестве параметра указывать oid организации этого пользователя;

-   \<timestamp\> -- время запроса авторизационного кода в формате
    yyyy.MM.dd HH:mm:ss Z (например, 2013.01.25 14:36:11 +0400),
    необходимое для фиксации начала временного промежутка, в течение
    которого будет валиден запрос\
    с данным идентификатором (\<state\>);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID;

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после того, как даст разрешение на доступ к ресурсу. Значение
    \<redirect_uri\> должно быть предварительно указано в параметрах
    внешней ИС в ЕСИА --\
    на стороне ЕСИА выполняется верификация соответствия redirect_uri в
    запросе и в настройках системы;

-   \<client_certificate_hash\> -- параметр, содержащий хэш сертификата
    (fingerprint сертификата) системы-клиента в hex--формате.
    Используемый для проверки подписи сертификат должен быть
    предварительно зарегистрирован в ЕСИА^63^\
    и привязан к УЗ системы-клиента в ЕСИА. ЕСИА использует сертификаты\
    в формате X.509 и взаимодействует с алгоритмами формирования
    электронной подписи ГОСТ Р 34.10-2012 и криптографического
    хэширования\
    ГОСТ Р 34.11-2012. Для вычисления значения используется
    специализированная утилита, доступная по адресу:
    <http://esia.gosuslugi.ru/public/calc_cert_hash_unix.zip>;

-   \<response_type\> -- это тип ответа, который ожидается от ЕСИА,
    имеет значение code, если система-клиент должна получить
    авторизационный код;

-   \<access_type\> -- принимает значение «offline», если требуется
    иметь доступ\
    к ресурсам и тогда, когда владелец не может быть вызван (в этом
    случае выпускается маркер обновления[^65]); значение «online» --
    доступ требуется только при наличии владельца;

-   \<person_filter\> -- необязательный параметр, позволяющий
    производить авторизацию только для определенных групп лиц. Допустимо
    использование одного из следуюших фильтров:

-   для авторизации только подтвержденных учетных записей в параметре
    необходимо передать conf_acc в кодировке base64 (т.е. Y29uZl9hY2M=);

-   для авторизации только учетных записей детей в параметре необходимо
    передать acc_kid в кодировке base64 (т.е. YWNjX2tpZA==);

-   для авторизации всех учетных записей, кроме учетных записей детей,
    в параметре необходимо передать acc_not_kid в кодировке base64
    (т.е. YWNjX25vdF9raWQ=);

-   для авторизации только подтвержденных учетных записей или учетных
    записей детей в параметре необходимо передать комбинацию из conf_acc
    и acc_kid в кодировке base64 (т.е. Y29uZl9hY2MgYWNjX2tpZA==).

В рамках разработки механизма проверки соответствия запроса кода
авторизации и последующего обмена кода (PKCE), для /v2/ac добавлены
четыре опциональных параметра:

-   \<code_challenge_method\> -- содержит значение «GOST3411»;

-   \<code_challenge\> -- результат работы функции. Порядок формирования
    \<code_challenge\>:

1)  сформировать случайную, уникальную строку длиной 43 символа,
    содержащую только следующие символы:
    \[A--Z\]/\[a--z\]/\[0--9\]/\"--\"/\".\"/\"\_\"/\"\~\" (каждый новый
    запрос должен формировать новое значение);

2)  применить преобразование code_challenge_method;

3)  кодировать значение в base64 url withoutPadding.

-   \<obj_type\> -- тип пользователя, может содержать одно или несколько
    возможных значений (через пробел):

    -   P -- физическое лицо (physical person);

    -   B -- индивидуальный предприниматель (Businessman);

    -   L -- юридическое лицо (Legal entity);

    -   F -- филиал, представительство иностранного юридического лица
        (Foreign);

    -   A -- орган исполнительной власти (Agency).

-   \<roles\> -- тип роли пользователя, может содержать одно или
    несколько возможных значений (через пробел):

    -   E -- сотрудник (employee);

    -   C -- руководитель (chief).

Если в ходе авторизации не возникло ошибок, то ЕСИА осуществляет
перенаправление пользователя по ссылке, указанной в redirect_uri, а
также возвращает два обязательных параметра:

-   \<code\> -- значение авторизационного кода;

-   \<state\> -- значение параметра state, который был получен в
    запросе\
    на авторизацию; система-клиент должна провести сравнение
    отправленного\
    и полученного параметра state.

В случае ошибки сервис авторизации вернет в параметре error код ошибки
(например, «access_denied») и перенаправит пользователя по адресу,
указанному\
в redirect_uri. Перечень возможных ошибок приведен в таблице 93.

Авторизационный код не требуется валидировать на стороне информационных
систем. Состав полей и их значение в коде может изменяться без
уведомлений. Валидация осуществляется на стороне ЕСИА.

### Получение маркера доступа в обмен на авторизационный код (рекомендован к выводу из эксплуатации и не допускается к использованию при подключении новых систем-клиентов)

В данном разделе описан порядок получения маркера доступа с
использованием endpoint \".../te\". Данный метод не рекомендован к
использованию. В п. Б.2.6,\
Приложение Б описывается процесс получения маркера доступа в обмен на
авторизационный код\
с использованием endpoint \".../v3/te\".

Когда авторизационный код получен, система-клиент может сформировать
запрос методом POST на https-адрес ЕСИА для получения маркера
доступа[^66]. Один авторизационный код можно обменять на один маркер
доступа. В тело запроса должны быть включены следующие сведения:

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА указанная прописными буквами);

-   \<code\> -- значение авторизационного кода, который был ранее
    получен\
    от ЕСИА и который необходимо обменять на маркер доступа;

-   \<grant_type\> -- принимает значение «authorization_code»,\
    если авторизационный код обменивается на маркер доступа;

-   \<client_secret\> -- подпись запроса в формате PKCS#7 detached
    signature\
    в кодировке UTF-8 от значений четырех параметров HTTP-запроса:
    scope, timestamp, clientId, state (без разделителей).
    \<client_secret\> должен быть закодирован в формате base64 url safe.
    Используемый\
    для проверки подписи сертификат должен быть предварительно
    зарегистрирован в ЕСИА^63^ и привязан к УЗ системы-клиента в ЕСИА.
    ЕСИА использует сертификаты в формате X.509 и взаимодействует с
    алгоритмами формирования электронной подписи ГОСТ Р 34.10-2012\
    и криптографического хэширования ГОСТ Р 34.11-2012;

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID; этот набор символов должен
    отличаться от того, который использовался при получении
    авторизационного кода;

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после того, как даст разрешение на доступ (то же самое значение,
    которое было указано в запросе на получение авторизационного кода);

-   \<scope\>[^67] -- область доступа, т.е. запрашиваемые права (то же
    самое значение, которое было указано в запросе на получение
    авторизационного кода);

-   \<scope_org\> -- область доступа, т.е. запрашиваемые права для
    юридических лиц (то же самое значение, которое было указано в
    запросе на получение авторизационного кода);

-   \<timestamp\> -- время запроса маркера в формате yyyy.MM.dd HH:mm:ss
    Z (например, 2013.01.25 14:36:11 +0400), необходимое для фиксации
    начала временного промежутка, в течение которого будет валиден
    запрос с данным идентификатором (\<state\>);

-   \<token_type\> -- тип запрашиваемого маркера, в настоящее время ЕСИА
    поддерживает только значение «Bearer». Параметр необязательный.

Если запрос успешно прошел проверку, то ЕСИА возвращает ответ в формате
JSON:

-   \<access_token\> -- маркер доступа для данного ресурса;

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer»;

-   \<refresh_token\> -- маркер обновления для данного ресурса[^68].

Пример ответа:

{

"access_token" :
"eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0.eyJleHAiOjEzNTk1NDAxODcsInNjb3BlIjoiaHR0cDpcL1wvZXNpYS5nb3N1c2x1Z2kucnVcL2VtcF9pbmY_b3JnX29pZD0xMDAwMDAwMzU3IiwiaXNzIjoiaHR0cDpcL1wvZXNpYS5nb3N1c2x1Z2kucnUiLCJuYmYiOjEzNTk1MzY1ODcsInVybjplc2lhOnNpZCI6IjE2ZDdmOTNkLTZjZTgtNDE3OS04ZmFmLTdmZDQ2ZDMyMDhhNiIsInVybjplc2lhOnNial9pZCI6MTAwMDAwMDM4NSwiY2xpZW50X2lkIjoiRVNJQSIsImlhdCI6MTM1OTUzNjU4N30",

"expires_in" : 3600,

"state" : "9be638a9--0e05--42e1--b4f8--a3e30457fbdd",

"token_type" : "Bearer",

"refresh_token" : "54039d1f--9917--43cd--961a--2729c891ef8c"

}

При невозможности выдачи маркера доступа возвращается код ошибки\
(см. таблицу 93).

### Получение маркера доступа в обмен на авторизационный код (v3/te)

В данном разделе описывается процесс получения маркера доступа в обмен
на авторизационный код с использованием нового технического решения
endpoint \".../v3/te\".

Когда авторизационный код получен, система-клиент может сформировать
запрос методом POST на https-адрес ЕСИА для получения маркера
доступа[^69]. Один авторизационный код можно обменять на один маркер
доступа. В тело запроса должны быть включены следующие сведения:

-   \<client_secret\> -- подпись значений семи параметров в кодировке
    UTF-8:

    -   client_id;

    -   scope;

    -   scope_org;

    -   timestamp;

    -   state;

    -   redirect_uri;

    -   code.

Порядок формирования \<client_secret\>:

1)  выполнить конкатенацию значений указанных выше параметров (порядок
    важен!). Пример строки:

TESTAPPLICATIONopenidorg_inn2021.11.10 12:28:46
+0300bbf0aef5--5237--41bc--8cba--291e29a3ade8https://test.application.ru/auth/api/v1/esia/returneyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImF1dGhvcml6YXRpb25fY29kZSIsImFsZyI6IlJTMjU2In0.\<...\>.jGdT4nTEsUPBsnDOx3xx9EunRlSV8jmX6N4fCCnsbfABYAGB7aamTbcxBzFjIrEgh_Ywopt250ICW8LZ55NWhbCiMWX4naySxypyMd3cwzdz_FP4VjUOj7US1SH9aGjxnYYENBOluCbPX7OPO3OBKOQbxdXony--t1bWOi4mbGbMYTLsOxicoWzn2y1xDVpYrdoP--Rsry1ZOz1o4f8I9DV7i7_V08IuIti9OfXf5--UlWPNdHNy2SllfyUthe6in9wbPuGaw_r92oC4BROVQkq7MpNX4hm--PsUMRO6J4qM4hl3s_igPgh5TkC_NBNB0ySexgLhYEa_lifQCXPh--GkVbw

2)  подписать полученную строку по алгоритму ГОСТ Р 34.10-2012
    с использованием сертифицированного средства криптографической
    защиты информации[^70];

3)  закодировать полученное значение в base64 url safe.

Используемый для проверки электронной подписи сертификат системы-клиента
должен быть предварительно зарегистрирован в ЕСИА^63^ и привязан к УЗ
системы-клиента в ЕСИА. В ЕСИА используются сертификаты в формате X.509
и криптографические алгоритмы ГОСТ Р 34.10-2012 для формирования
электронной подписи и ГОСТ Р 34.11-2012 для хэширования.

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА указанная прописными буквами);

-   \<scope\>[^71] -- область доступа, т.е. запрашиваемые права (то же
    самое значение, которое было указано в запросе на получение
    авторизационного кода);

-   \<scope_org\> -- область доступа, т.е. запрашиваемые права для
    юридических лиц (то же самое значение, которое было указано в
    запросе на получение авторизационного кода);

-   \<timestamp\> -- время запроса маркера в формате yyyy.MM.dd HH:mm:ss
    Z (например, 2013.01.25 14:36:11 +0400), необходимое для фиксации
    начала временного промежутка, в течение которого будет валиден
    запрос с данным идентификатором (\<state\>);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID; этот набор символов должен
    отличаться от того,\
    который использовался при получении авторизационного кода;

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после того, как даст разрешение на доступ (то же самое значение,
    которое было указано в запросе на получение авторизационного кода).
    Значение \<redirect_uri\> должно быть предварительно указано в
    параметрах внешней ИС в ЕСИА -- на стороне ЕСИА выполняется
    верификация соответствия redirect_uri в запросе и в настройках
    системы;

-   \<client_certificate_hash\> -- параметр, содержащий хэш сертификата
    (fingerprint сертификата) системы-клиента в hex--формате.
    Используемый для проверки подписи сертификат должен быть
    предварительно зарегистрирован в ЕСИА^63^\
    и привязан к УЗ системы-клиента в ЕСИА. ЕСИА использует сертификаты\
    в формате X.509 и криптографические алгоритмы ГОСТ Р 34.10-2012
    для формирования электронной подписи и ГОСТ Р 34.11-2012
    для хэширования;

-   \<code\> -- значение авторизационного кода, который был ранее
    получен\
    от ЕСИА и который необходимо обменять на маркер доступа;

-   \<grant_type\> -- принимает значение «authorization_code»,\
    если авторизационный код обменивается на маркер доступа;

-   \<token_type\> -- тип запрашиваемого маркера, в настоящее время ЕСИА
    поддерживает только значение «Bearer». Параметр необязательный.

В рамках разработки механизма проверки соответствия запроса кода
авторизации и последующего обмена кода (PKCE), для /v3/te добавлен
опциональный параметр:

-   \<code_verifier\> -- строка длиной 43 символа, содержащая в себе
    только следующие символы
    (\[A--Z\]/\[a--z\]/\[0--9\]/\"--\"/\".\"/\"\_\"/\"\~\");

В ЕСИА должен быть передан параметр \<code_verifier\>. Для метода
«GOST3411» в ЕСИА производится расчет, при котором берется полученное
значение и для него вычисляется хэш функция, а затем кодируется с
помощью base64 url withoutPadding. Полученный результат сравнивается со
значением \<code_challenge\>, полученного в рамках запроса v2/ac. Если
они не совпадают, ЕСИА возвращает соответствующую ошибку.

Если запрос успешно прошел проверку, то ЕСИА возвращает ответ в формате
JSON:

-   \<access_token\> -- маркер доступа для данного ресурса;

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer»;

-   \<refresh_token\> -- маркер обновления для данного ресурса[^72].

При невозможности выдачи маркера доступа возвращается код ошибки,
приведенный в таблице 94.

Таблица 94 -- Список ошибок при получении маркеров доступа (/v3/te)

+---+------------------+----------------------------------------------+
| * | **Код            | **Описание параметра**                       |
| * | параметра**      |                                              |
| № |                  |                                              |
| * |                  |                                              |
| * |                  |                                              |
+===+==================+==============================================+
| 1 | invalid_request  | ESIA-007003: В запросе отсутствует           |
| . |                  | обязательный параметр, запрос включает в     |
|   |                  | себя неверное значение параметра или         |
|   |                  | включает параметр несколько раз              |
+---+------------------+----------------------------------------------+
| 2 | access_denied    | ESIA-007004: Владелец ресурса или сервис     |
| . |                  | авторизации отклонил запрос                  |
|   |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 3 | una              | ESIA-007005: Система-клиент не имеет права   |
| . | uthorized_client | запрашивать получение маркера доступа таким  |
|   |                  | методом                                      |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 4 | invalid_scope    | ESIA-007006: Запрошенная область доступа     |
| . |                  | (scope) указана неверно, неизвестно или      |
|   |                  | сформирована некорректно                     |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 5 | server_error     | ESIA-007007: Возникла неожиданная ошибка в   |
| . |                  | работе сервиса авторизации, которая привела  |
|   |                  | к невозможности выполнить запрос             |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 6 | tempora          | ESIA-007008: Сервис авторизации в настоящее  |
| . | rily_unavailable | время не может выполнить запрос из-за        |
|   |                  | большой нагрузки или технических работ       |
|   |                  |                                              |
|   |                  | на сервере                                   |
+---+------------------+----------------------------------------------+
| 7 | unsupport        | ESIA-007009: Сервис авторизации не           |
| . | ed_response_type | поддерживает получение маркера доступа этим  |
|   |                  | методом                                      |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 8 | invalid_client   | ESIA-008010: Не удалось произвести           |
| . |                  | аутентификацию системы-клиента               |
|   |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 9 | invalid_grant    | ESIA-007011: Авторизационный код или маркер  |
| . |                  | обновления недействителен, просрочен,        |
|   |                  | отозван или не соответствует адресу ресурса, |
|   |                  | указанному в запросе на авторизацию, или был |
|   |                  | выдан другой системе-клиенту                 |
+---+------------------+----------------------------------------------+
| 1 | unsupp           | ESIA-007012: Тип авторизационного кода не    |
| 0 | orted_grant_type | поддерживается сервисом авторизации          |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | invalid_scope    | ESIA-007013: Запрос не содержит указания на  |
| 1 |                  | область доступа (scope)                      |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | invalid_request  | ESIA-007014: Запрос не содержит              |
| 2 |                  | обязательного параметра \[\]                 |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | invalid_request  | ESIA-007015: Неверное время запроса          |
| 3 |                  |                                              |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | no_grants        | ESIA-007019: Отсутствует разрешение на       |
| 4 |                  | доступ                                       |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | invalid_request  | ESIA-007023: Указанный в запросе             |
| 5 |                  | \<redirect_uri\> отсутствует среди           |
| . |                  | разрешенных для ИС                           |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | invalid_request  | ESIA-007036: Учетная запись заблокирована    |
| 6 |                  |                                              |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | pkce_para        | ESIA-007038: Ошибка получения параметров из  |
| 7 | meters_incorrect | запроса                                      |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | pkce_c           | ESIA-007039: В изначальном запросе на        |
| 8 | hallenge_missing | /v2/ac, параметр \<code_challenge\> не был   |
| . |                  | указан                                       |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 1 | pkce_ve          | ESIA-007040: Ошибка сравнения исходного и    |
| 9 | rification_error | контрольного значений                        |
| . |                  |                                              |
|   |                  |                                              |
+---+------------------+----------------------------------------------+
| 2 | authorizatio     | ESIA-007046: Запрос otp невозможен, а в      |
| 0 | n2faNotAvailable | области доступа (scope) указано обязательное |
| . |                  | прохождение пользователем двухфакторной      |
|   |                  | авторизации, недоступный пользователю        |
+---+------------------+----------------------------------------------+
| 2 | c                | ESIA-007053: Client_secret сформирован       |
| 1 | lientSecretWrong | некорректно. Client_secret\                  |
| . |                  | не соответствует строке-сертификату,         |
|   |                  | информационной системе\                      |
|   |                  | или используемый сертификат не активен       |
+---+------------------+----------------------------------------------+
| 2 | authCanO         | ESIA-007071: Запрос персональных данных по   |
| 2 | nlyByPermissions | физическим лицам может быть выполнен только  |
| . |                  | с указанием согласий                         |
|   |                  |                                              |
+---+------------------+----------------------------------------------+

### Получение нового маркера доступа в обмен на маркер обновления[^73]

Перед использованием маркера доступа в системах-клиентах рекомендуется
выполнить проверку срока его действия. Если маркер доступа просрочен, то
для успешного доступа к защищенному ресурсу потребуется предварительно
получить новый маркер доступа с использованием маркера обновления. Для
этого в системе-клиенте следует сформировать и направить запрос методом
POST в адрес ЕСИА, имеющий структуру, аналогичную первичному запросу
на получение маркера. Особенности значений параметров запроса:

-   \<refresh_token\> -- значение ранее полученного системой-клиентом
    маркера обновления, который следует обменять на новый маркер доступа
    (указывается вместо \<code\>);

-   \<grant_type\> -- должно иметь значение «refresh_token», поскольку
    маркер обновления обменивается на маркер доступа;

Ответ на запрос имеет формат JSON и ту же структуру, как и при первичном
получении маркера доступа. В этом ответе содержится новый маркер
обновления, который система-клиент должна сохранить вместо уже
использованного маркера обновления.

Перечень возможных ошибок приведен в таблице 95.

Таблица 95 -- Список ошибок при получении маркера доступа в обмен на
маркер обновления

+---+-----------------------+-----------------------------------------+
| № | Код параметра         | Описание параметра                      |
+===+=======================+=========================================+
| 1 | expired_token         | ESIA-007027: Срок действия маркера      |
| . |                       | обновления истек                        |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 2 | access_denied         | ESIA-007028: Маркер обновления          |
| . |                       | скомпрометирован и отозван              |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 3 | invalid_request       | ESIA-007036: Учетная запись             |
| . |                       | заблокирована                           |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+

## Модель контроля доступа на основе полномочий системы-клиента

### Общие принципы

Эта модель контроля предполагает, что система-клиент самостоятельно
обращается к сервису авторизации и получает маркер доступа на основании
имеющихся (и зафиксированных в сервисе авторизации) полномочий
системы-клиента. Данная модель контроля доступа предполагает, что
система-клиент при доступе\
к защищенному ресурсу непосредственно получает разрешение (в форме
маркера доступа) со стороны сервиса авторизации. В общем виде схема
взаимодействия выглядит следующим образом:

-   система-клиент обращается к сервису авторизации для получения
    маркера доступа;

-   сервис авторизации аутентифицирует систему-клиента и выдает маркер
    доступа;

-   система-клиент запрашивает у поставщика защищенный ресурс,
    предъявляя маркер доступа;

-   поставщик ресурса проверяет маркер доступа, если он валиден, то
    разрешает доступ к защищенному ресурсу.

Данная модель контроля доступа проиллюстрирована на рисунке 9*.*

Поскольку получение маркера доступа при использовании данной модели
контроля не предполагает обращения к владельцу ресурса, то маркер
обновления\
не применяется. Система-клиент после истечения срока действия маркера
доступа может обратиться к сервису авторизации и получить новый маркер
доступа.

![](media/image9.emf){width="4.666666666666667in"
height="3.3680555555555554in"}

Рисунок 9 -- Схема взаимодействия при реализации модели контроля доступа
на основе полномочий системы-клиента

### Получение маркера доступа

Для получения маркера доступа система-клиент должна направить на адрес
сервиса авторизации ЕСИА запрос методом POST. Запрос должен содержать
следующие сведения:

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА, указанная прописными буквами);

-   \<response_type\> -- используемая модель контроля доступа, принимает
    значение «token», если происходит безусловное наделения
    системы-клиента полномочиями;

-   \<grant_type\> -- принимает значение «client_credentials», если
    используется модель контроля доступа на основе полномочий
    системы-клиента. В данной модели невозможно указывать
    пользовательские области доступа (scope), необходимо указывать
    только область доступа (scope) организаций\
    или системную область доступа (scope) без указания идентификатора;

-   \<scope\> -- область доступа, т.е. запрашиваемые права, например,
    если система-клиент запрашивает доступ к данным ИНН организации, то
    область доступа (scope) должно иметь значение
    «http://esia.gosuslugi.ru/org_inn» с параметрами;

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID; этот набор символов должен
    отличаться от того,\
    который использовался при получении авторизационного кода;

-   \<timestamp\> -- время запроса маркера в формате yyyy.MM.dd HH:mm:ss
    Z (например, 2013.01.25 14:36:11 +0400), необходимое для фиксации
    начала временного промежутка, в течение которого будет валиден
    запрос с данным идентификатором (\<state\>);

-   \<token_type\> -- тип запрашиваемого маркера, в настоящее время ЕСИА
    поддерживает только значение «Bearer»;

-   \<client_secret\> -- подпись запроса в формате PKCS#7 detached
    signature\
    в кодировке UTF-8 от конкатенации значений четырех параметров
    HTTP-запроса: scope, timestamp, clientId, state (без разделителей).
    \<client_secret\> должен быть закодирован в формате base64 url safe.
    Используемый\
    для формирования подписи сертификат должен быть зарегистрирован
    в ЕСИА и привязан к УЗ системы-клиента в ЕСИА. ЕСИА использует
    сертификаты\
    в формате X.509 и криптографические алгоритмы ГОСТ Р 34.10-2012\
    для формирования электронной подписи и ГОСТ Р 34.11-2012 для
    хэшировани.

Если запрос успешно прошел проверку, то ЕСИА возвращает ответ в формате
JSON:

-   \<access_token\> -- маркер доступа для данного ресурса;

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer».

При невозможности выдачи маркера доступа возвращается код ошибки\
(см. таблицу 92).

## Особенности указания области доступа (scope)

В запросе на получение маркера доступа должна быть указана требуемая
*область доступа (scope)*, т.е. область доступа (тип данных, к которым
система-клиент намерена получить доступ).

В ЕСИА используются следующие типы *областей доступа (scope).*

Область доступа (scope), позволяющие получить данные о пользователе,
приведенные в таблице 96.

Таблица 96 -- Предоставляемые ЕСИА наборы данных о пользователе[^74]

+---+--------------+------------------+-------------------------------+
| * | **Название   | **Название       | **Состав набора данных**      |
| * | области      | набора данных**  |                               |
| № | доступа      |                  |                               |
| * | (scope)**    |                  |                               |
| * |              |                  |                               |
+===+==============+==================+===============================+
| 1 | fullname     | Просмотр         | -   фамилия;                  |
| . |              | фамилии, имени и |                               |
|   |              | отчества         | -   имя;                      |
|   |              |                  |                               |
|   |              |                  | -   отчество                  |
+---+--------------+------------------+-------------------------------+
| 2 | birthdate    | Просмотр даты    | дата рождения, указанная в УЗ |
| . |              | рождения         |                               |
|   |              |                  |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 3 | gender       | Просмотр пола    | пол, указанный в УЗ           |
| . |              |                  |                               |
|   |              |                  |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 4 | citizenship  | Просмотр         | гражданство, указанное в УЗ   |
| . |              | гражданства      |                               |
|   |              |                  |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 5 | snils        | Просмотр СНИЛС   | СНИЛС, указанный в УЗ         |
| . |              |                  |                               |
|   |              |                  |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 6 | inn          | Просмотр ИНН     | ИНН, указанный в УЗ           |
| . |              |                  |                               |
|   |              |                  |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 7 | id_doc       | Просмотр данных  | -   серия и номер документа,  |
| . |              |                  |     удостоверяющего личность; |
|   |              | о документе,     |                               |
|   |              | удостоверяющем   | -   дата выдачи;              |
|   |              | личность         |                               |
|   |              |                  | -   кем выдан;                |
|   |              |                  |                               |
|   |              |                  | -   код подразделения;        |
|   |              |                  |                               |
|   |              |                  | -   гражданство               |
+---+--------------+------------------+-------------------------------+
| 8 | birthplace   | Просмотр места   | место рождения                |
| . |              | рождения         |                               |
|   |              |                  |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 9 | medical_doc  | Просмотр данных  | -   номер полиса ОМС;         |
| . |              | полиса           |                               |
|   |              | обязательного    | -   срок действия             |
|   |              | медицинского     |                               |
|   |              | страхования      |                               |
|   |              | (ОМС)            |                               |
+---+--------------+------------------+-------------------------------+
| 1 | military_doc | Просмотр данных  | -   серия и номер военного    |
| 0 |              | военного билета  |     билета;                   |
| . |              |                  |                               |
|   |              |                  | -   дата выдачи;              |
|   |              |                  |                               |
|   |              |                  | -   орган, выдавший документ  |
+---+--------------+------------------+-------------------------------+
| 1 | foreign_     | Просмотр данных  | -   фамилия, имя, отчество    |
| 1 | passport_doc | заграничного     |     буквами латинского        |
| . |              | паспорта         |     алфавита;                 |
|   |              |                  |                               |
|   |              |                  | -   серия и номер             |
|   |              |                  |     заграничного паспорта;    |
|   |              |                  |                               |
|   |              |                  | -   дата выдачи;              |
|   |              |                  |                               |
|   |              |                  | -   срок действия;            |
|   |              |                  |                               |
|   |              |                  | -   орган, выдавший документ; |
|   |              |                  |                               |
|   |              |                  | -   гражданство               |
+---+--------------+------------------+-------------------------------+
| 1 | drivers      | Просмотр данных  | -   серия и номер             |
| 2 | _licence_doc | водительского    |     водительского             |
| . |              | удостоверения    |     удостоверения;            |
|   |              |                  |                               |
|   |              |                  | -   дата выдачи;              |
|   |              |                  |                               |
|   |              |                  | -   срок действия             |
+---+--------------+------------------+-------------------------------+
| 1 | bi           | Просмотр данных  | -   серия и номер             |
| 3 | rth_cert_doc | свидетельства о  |     свидетельства;            |
| . |              | рождении         |                               |
|   |              |                  | -   дата выдачи;              |
|   |              |                  |                               |
|   |              |                  | -   место государственной     |
|   |              |                  |     регистрации               |
+---+--------------+------------------+-------------------------------+
| 1 | r            | Просмотр данных  | -   серия и номер вида на     |
| 4 | esidence_doc | вида             |     жительство;               |
| . |              |                  |                               |
|   |              | на жительство    | -   дата выдачи               |
+---+--------------+------------------+-------------------------------+
| 1 | temporary_r  | Просмотр данных  | -   серия и номер разрешения  |
| 5 | esidence_doc | разрешения на    |     на временное проживание;  |
| . |              | временное        |                               |
|   |              | проживание       | -   дата выдачи               |
+---+--------------+------------------+-------------------------------+
| 1 | email        | Просмотр адреса  | адрес электронной почты,      |
| 6 |              | электронной      | указанный в УЗ                |
| . |              | почты            |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 1 | mobile       | Просмотр номера  | номер мобильного телефона     |
| 7 |              | мобильного       |                               |
| . |              | телефона         |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 1 | addresses    | Просмотр данных  | -   адрес постоянной          |
| 8 |              |                  |     регистрации;              |
| . |              | об адресах       |                               |
|   |              |                  | -   адрес временной           |
|   |              |                  |     регистрации;              |
|   |              |                  |                               |
|   |              |                  | -   адрес места проживания    |
+---+--------------+------------------+-------------------------------+
| 1 | usr_org      | Просмотр списка  | список организаций            |
| 9 |              | организаций      | пользователя                  |
| . |              | пользователя     |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 2 | usr_avt      | Просмотр         | -   получение изображения     |
| 0 |              | изображения      |     (аватара);                |
| . |              | (аватара)        |                               |
|   |              | пользователя     | -   создание и обновление     |
|   |              |                  |     изображения (аватара);    |
|   |              |                  |                               |
|   |              |                  | -   получение исходного       |
|   |              |                  |     изображения (аватара)     |
+---+--------------+------------------+-------------------------------+
| 2 | s            | Просмотр данных  | -   признак самозанятого;     |
| 1 | elf_employed | о самозанятых    |                               |
| . |              |                  | -   категория (вид            |
|   |              |                  |     деятельности)             |
+---+--------------+------------------+-------------------------------+
| 2 | usr_reg_cxt  | Просмотр статуса | статус валидации УЗ           |
| 2 |              | валидации УЗ     |                               |
| . |              |                  |                               |
|   |              |                  |                               |
+---+--------------+------------------+-------------------------------+
| 2 | r            | Просмотр данных\ | Список активизированных в     |
| 3 | ead_bio_type | об описании      | данный момент биометрий       |
| . |              | биометрий        | пользователя: текстовое       |
|   |              | пользователя     | описание биометрии            |
+---+--------------+------------------+-------------------------------+
| 2 | read_        | Просмотр данных\ | Список активизированных в     |
| 4 | bio_type_exp | об описании и    | данный момент биометрий       |
| . |              | сроке действия   | пользователя:                 |
|   |              | биометрий        |                               |
|   |              | пользователя     | -   текстовое описание        |
|   |              |                  |     биометрии;                |
|   |              |                  |                               |
|   |              |                  | -   срок окончания действия   |
|   |              |                  |     биометрии.                |
+---+--------------+------------------+-------------------------------+

Области доступа (scope), позволяющие получить данные о детях
пользователя, приведенные в таблице 97.

Таблица 97 -- Предоставляемые ЕСИА наборы данных о детях
пользователя[^75]

+---+----------------+------------------------+-----------------------+
| * | **Название     | **Название набора      | **Состав набора       |
| * | область        | данных**               | данных**              |
| № | доступа        |                        |                       |
| * | (scope)**      |                        |                       |
| * |                |                        |                       |
+---+----------------+------------------------+-----------------------+
| 1 | kid_fullname   | Просмотр фамилии,      | -   фамилия;          |
| . |                | имени и отчества       |                       |
|   |                |                        | -   имя;              |
|   |                |                        |                       |
|   |                |                        | -   отчество          |
+---+----------------+------------------------+-----------------------+
| 2 | kid_birthdate  | Просмотр даты рождения | дата рождения ребенка |
| . |                |                        |                       |
|   |                |                        |                       |
|   |                |                        |                       |
+---+----------------+------------------------+-----------------------+
| 3 | kid_gender     | Просмотр пола ребенка  | пол ребенка           |
| . |                |                        |                       |
|   |                |                        |                       |
|   |                |                        |                       |
+---+----------------+------------------------+-----------------------+
| 4 | kid_snils      | Просмотр номера СНИЛС  | СНИЛС ребенка         |
| . |                | ребенка                |                       |
|   |                |                        |                       |
|   |                |                        |                       |
+---+----------------+------------------------+-----------------------+
| 5 | kid_inn        | Просмотр ИНН ребенка   | ИНН ребенка           |
| . |                |                        |                       |
|   |                |                        |                       |
|   |                |                        |                       |
+---+----------------+------------------------+-----------------------+
| 6 | kid_           | Просмотр данных        | -   серия             |
| . | birth_cert_doc | свидетельства\         |     свидетельства;    |
|   |                | о рождении             |                       |
|   |                |                        | -   номер             |
|   |                |                        |     свидетельства;    |
|   |                |                        |                       |
|   |                |                        | -   дата выдачи       |
|   |                |                        |     свидетельства;    |
|   |                |                        |                       |
|   |                |                        | -   кем выдано        |
|   |                |                        |     свидетельство     |
+---+----------------+------------------------+-----------------------+
| 7 | k              | Просмотр данных полиса | -   номер полиса ОМС; |
| . | id_medical_doc | обязательного          |                       |
|   |                | медицинского           | -   действителен до   |
|   |                | страхования (ОМС)      |     ОМС               |
+---+----------------+------------------------+-----------------------+
| 8 | kid_email      | Просмотр электронной   | электронная почта     |
| . |                | почты ребенка          | ребенка               |
|   |                |                        |                       |
|   |                |                        |                       |
+---+----------------+------------------------+-----------------------+
| 9 | kid_mobile     | Просмотр номера        | номер телефона        |
| . |                | телефона ребенка       | ребенка               |
|   |                |                        |                       |
|   |                |                        |                       |
+---+----------------+------------------------+-----------------------+
| 1 | kid_id_doc     | Просмотр данных        | -   серия и номер     |
| 0 |                |                        |     документа,        |
| . |                | о документе,           |     удостоверяющего   |
|   |                | удостоверяющем         |     личность;         |
|   |                | личность ребенка       |                       |
|   |                |                        | -   дата выдачи;      |
|   |                |                        |                       |
|   |                |                        | -   кем выдан;        |
|   |                |                        |                       |
|   |                |                        | -   код подразделения |
+---+----------------+------------------------+-----------------------+

*Примечание:*

Все указанные в таблице области доступа (scope) также позволяют получить
данные о признаке подтвержденности УЗ пользователя (атрибут \<trusted\>
персональных данных физического лица).

Приведенные выше *области доступа (scope)* указываются в формате:

/scope?param1=value1&param2=value2,

где \<param1\> -- название, а *value1* -- значение параметра. Может
использоваться параметр:

\<oid\> -- внутренний идентификатор пользователя в ЕСИА (обязательный
параметр).

Пример *области доступа (scope)*:

scope="id_doc?oid=1111111"

При запросе у сервиса авторизации ЕСИА маркера доступа на область
доступа (scope) «id_doc»или любого другого scope на получение данных о
пользователе не нужно в качестве параметра указывать OID этого
пользователя.

Принять решение о предоставлении данных о пользователе (т.е. о выдаче
соответствующего маркера) может исключительно сам пользователь.

Области доступа (scope) «id_doc» и «foreign_passport_doc» позволяют
получить гражданство пользователя.

Для получения информации об организациях, в которые включен пользователь
(область доступа (scope) «usr_org»), система должна выполнить запрос
методом GET в https-адрес REST API системы ЕСИА:
https://esia.gosuslugi.ru/rs/prns/{prn_oid}/roles. Запрос также должен
содержать маркер доступа системы, выданный на область доступа (scope)
«usr_org»:

GET https://esia.gosuslugi.ru/rs/prns/{prn_oid}/roles

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6M

Информация возвращается в развернутом виде, т.е. к данному REST API уже
применен механизм встраивания (embedding) связанных данных:

-   \<oid\> -- идентификатор организации;

-   \<fullName\> -- полное наименование организации;

-   \<shortName\> -- краткое наименование организации;

-   \<ogrn\> -- ОГРН организации;

-   \<type\> -- тип организации («BUSINESS» -- ИП, «LEGAL» -- ЮЛ,
    «AGENCY» -- ОГВ);

-   \<branсhName\> -- наименование филиала;

-   \<branсhOid\> -- уникальный идентификатор филиала;

-   \<chief\> -- сведения о том, является ли сотрудник руководителем
    организации (в этом случае имеет значение «true») или нет («false»);

-   \<admin\> -- проверка наличия сотрудника в группе доступа
    «Администраторы профиля организации», мнемоника группы: ORG_ADMIN
    («true» -- сотрудник имеет доступ или «false» -- сотрудник не имеет
    доступа);

-   \<email\> -- служебная электронная почта сотрудника;

-   \<phone\> -- служебный номер телефона сотрудника;

-   \<active\> -- признак блокировки сотрудника («true» -- сотрудник\
    не заблокирован или «false» -- сотрудник заблокирован).

Пример ответа:

{

\"stateFacts\":\[

\"hasSize\"

\],

\"size\": 5,

\"elements\":\[

{\"oid\": 1077129933, \"prnOid\": 1000366587, \"fullName\":
\"Индивидуальный Предприниматель Юки Асуна Юи\", \"shortName\": \"ИП Юки
А. Ю.\",...},

{

\"oid\": 1000364913,

\"prnOid\": 1000366587,

\"fullName\": \"Центр Госуслуг Района Раменки\",

\"shortName\": \"Центр госуслуг района Раменки\",

\"ogrn\": \"1023601587965\",

\"type\": \"AGENCY\",

\"chief\": true,

\"admin\": true,

\"active\": true,

\"hasRightOfSubstitution\": true,

\"hasApprovalTabAccess\": true,

\"isLiquidated\": false

},

{\"oid\": 1077121212, \"prnOid\": 1000366587, \"fullName\":
\"Организация --1758361669\", \"shortName\": \"ОРГАНИЗАЦИЯ
--1758361669\",...},

{\"oid\": 1000322321, \"prnOid\": 1000366587, \"fullName\": \"Пао
\\\"Ростелеком\\\"\", \"shortName\": \"ПАО \\\"Ростелеком\\\"\",...},

{\"oid\": 1000000001, \"prnOid\": 1000366587, \"fullName\":
\"Организация --783988581\", \"shortName\": \"ОРГАНИЗАЦИЯ
--783988581\",...}

\]

}

Области доступа (scope), позволяющие получить данные об организации,
приведенные в таблице 98.

Таблица 98 -- Предоставляемые ЕСИА наборы данных об организации

+---+----------------+----------------------+-------------------------+
| * | **Название     | **Название набора    | **Состав набора         |
| * | области        | данных**             | данных**                |
| № | доступа        |                      |                         |
| * | (scope)**      |                      |                         |
| * |                |                      |                         |
+===+================+======================+=========================+
| 1 | org_shortname  | Сокращенное          | Сокращенное             |
| . |                | наименование         | наименование            |
|   |                | организации          | организации             |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 2 | org_fullname   | Полное наименование  | Полное наименование     |
| . |                | организации          | организации             |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 3 | org_type       | Тип организации      | Тип организации         |
| . |                |                      |                         |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 4 | org_ogrn       | ОГРН организации     | ОГРН организации        |
| . |                |                      |                         |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 5 | org_inn        | ИНН организации      | ИНН организации         |
| . |                |                      |                         |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 6 | org_leg        | ОПФ организации      | ОПФ организации         |
| . |                |                      |                         |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 7 | org_kpp        | КПП организации      | КПП организации         |
| . |                |                      |                         |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 8 | org_           | Территориальная      | Территориальная         |
| . | agencyterrange | принадлежность ОГВ   | принадлежность ОГВ      |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 9 | org_agencytype | Тип ОГВ              | Тип ОГВ                 |
| . |                |                      |                         |
|   |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_oktmo      | ОКТМО организации    | ОКТМО организации       |
| 0 |                |                      |                         |
| . |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_ctts       | Контакты             | Контакты организации:   |
| 1 |                | организации: номер   | номер телефона, номер   |
| . |                | телефона, номер      | факса, адрес            |
|   |                | факса, адрес         | электронной почты       |
|   |                | электронной почты    |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_addrs      | Адреса организации   | Адреса организации      |
| 2 |                | (почтовый адрес,     | (почтовый адрес,        |
| . |                | юридический адрес):  | юридический адрес):     |
|   |                | индекс,              | индекс, идентификатор   |
|   |                | идентификатор        | страны, адрес в виде    |
|   |                | страны, адрес в виде | строки (не включая дом, |
|   |                | строки (не включая   | строение, корпус, номер |
|   |                | дом, строение,       | квартиры), строение,    |
|   |                | корпус, номер        | корпус, дом, квартира,  |
|   |                | квартиры), строение, | код ФИАС, регион,       |
|   |                | корпус, дом,         | город, внутригородской  |
|   |                | квартира, код ФИАС,  | район, район,           |
|   |                | регион, город,       | поселение, доп.         |
|   |                | внутригородской      | территория, улица на    |
|   |                | район, район,        | доп. территории, улица  |
|   |                | поселение, доп.      |                         |
|   |                | территория, улица на |                         |
|   |                | доп. территории,     |                         |
|   |                | улица                |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_vhls       | Транспортные         | Транспортные средства   |
| 3 |                | средства             | организации: название,  |
| . |                | организации:         | государственный         |
|   |                | название,            | регистрационный знак,   |
|   |                | государственный      | серия и номер           |
|   |                | регистрационный      | свидетельства           |
|   |                | знак, серия          | о регистрации           |
|   |                |                      |                         |
|   |                | и номер              |                         |
|   |                | свидетельства        |                         |
|   |                | о регистрации        |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_grps       | Группы, владельцем   | Группы, владельцем      |
| 4 |                | которых является     | которых является        |
| . |                | организация          | организация             |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_emps       | Данные о сотрудниках | Данные о сотрудниках    |
| 5 |                | организации          | организации             |
| . |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_brhs       | Данные о филиалах    | Данные о филиалах       |
| 6 |                | организации          | организации (название,  |
| . |                | (название, КПП, ОПФ, | КПП, ОПФ, контакты,     |
|   |                | контакты, адреса)    | адреса)                 |
+---+----------------+----------------------+-------------------------+
| 1 | org_brhs_ctts  | Контакты филиалов    | Контакты филиалов       |
| 7 |                | организации          | организации             |
| . |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_brhs_addrs | Адреса филиалов      | Адреса филиалов         |
| 8 |                | организации          | организации             |
| . |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 1 | org_rcs        | Центры регистрации   | Центры регистрации      |
| 9 |                | организации          | организации             |
| . |                |                      |                         |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 2 | org_stms       | Системы, владельцем  | Системы, владельцем     |
| 0 |                | которых является     | которых является        |
| . |                | организация          | организация             |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 2 | org_invts      | Приглашения,         | Приглашения,            |
| 1 |                | направленные         | направленные            |
| . |                | организацией         | организацией            |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 2 | categories     | Данные присвоенных   | Данные присвоенных      |
| 2 |                | организации видов    | организации видов       |
| . |                | деятельности         | деятельности            |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+
| 2 | org_ra         | Данные центров       | Данные центров          |
| 3 |                | обслуживания         | обслуживания            |
| . |                | организации          | организации             |
|   |                |                      |                         |
+---+----------------+----------------------+-------------------------+

Данная *область доступа (scope)* указываются в формате:

/scope?param1=value1&param2=value2,

где \<param1\> -- название, а value1 -- значение параметра. Должен
использоваться параметр:

\<org_oid\> -- внутренний идентификатор организации в ЕСИА.

Пример *области доступа (scope)*:

scope="http://esia.gosuslugi.ru/org_emps?org_oid=1000000357"

Наличие маркера с такой *областью доступа (scope)* позволяет получить
информацию о сотрудниках.

1)  Данные для идентификации и аутентификации пользователя (*openid*).
    Эта *область доступа (scope)* используется в целях проведения
    аутентификации пользователя и получения маркера идентификации (см.
    п. Б.6 и Б.7, Приложение Б). Он не параметризуется,
    т.к. до аутентификации у системы-клиента отсутствует информация об
    идентификаторе пользователя. Также для усиленной биометрической
    аутентификации дополнительно используется область доступа (scope)
    «bio» совместно с областью доступа (scope) «openid». Подробно о
    процессе удаленной биометрической аутентификации указано\
    в п. Б.8, Приложение Б.

2)  Комплексные данные о пользователе (*ext_auth_result)*, доступные в
    результате усиленной биометрической аутентификации (см. п. Б.8). По
    данной *области доступа (scope)* доступен следующий набор личных
    данных пользователя:

    -   ФИО;

    -   пол;

    -   гражданство;

    -   дата рождения;

    -   место рождения;

    -   реквизиты документа, удостоверяющего личность;

    -   адрес регистрации;

    -   адрес проживания;

    -   ИНН;

    -   СНИЛС;

    -   мобильный телефон;

    -   адрес электронной почты.

3)  Технологическая информация (http://esia.gosuslugi.ru/tech_inf), в
    том числе\
    о перечне удаленных пользователей. Для получения данных об удаленных
    пользователях эта область доступа (scope) должен иметь вид:
    http://esia.gosuslugi.ru/tech_inf?stu=DELETED. Получение маркера
    доступа\
    на эту область доступа (scope) должно происходить посредством модели
    контроля доступа на основе полномочий системы-клиента (см. п. Б.3).

4)  Доступ к сервису ЕПГУ для ИС ГОСБАР (gosbar/gosbar_org). Для
    получения данных о пользователе, сторонний ресурс (на котором
    размещена поисково-навигационная система «Госбар») при вызове
    Gosbar.init должен получать пользовательский access token, с
    областью доступа (scope) «gosbar»\
    (для пользователей ЕСИА -- физических лиц) или gosbar_org?org_oid
    (для пользователей ЕСИА -- юридических лиц).

5)  Перечень областей доступа (scope) для предоставления доступа к API
    ЕПГУ:

    -   <http://sf.gosuslugi.ru/europrotocol> -- оформление извещения о
        ДТП в форме электронного документа. Эта область доступа (scope)
        позволяет создавать, редактировать, просматривать, подписывать и
        регистрировать извещение о ДТП в форме электронного документа;

    -   <https://lk.gosuslugi.ru/api-order> -- подача заявлений с
        использованием программного интерфейса портала Госуслуг;

    -   <https://lk.gosuslugi.ru/api-geps> -- получение писем
        (госпочта)\
        с использованием программного интерфейса портала Госуслуг.

Области доступа (scope), позволяющие ИС, зарегистрированным в ЕСИА,
передавать сведения о машиночитаемых доверенностях (МЧД) и сведения
о заявлении об их отмене в Реестр сведений о доверенностях ЕСИА (Реестр
ЕСИА), а также запрашивать сведения о МЧД и ее статусе из Реестра ЕСИА,
приведены в таблице 99. Описание REST API Реестра ЕСИА доступно по
ссылке: https://partners.gosuslugi.ru/catalog/attorney.

Пример *области доступа (scope)*:

-   scope="pow_reg";

-   scope="pow_reg_search";

-   scope="pow_reg_inf".

Таблица 99 -- Области доступа и данные Реестра ЕСИА

+---+-------------+------------------------+--------------------------+
| * | **Название  | **Название области     | **Состав набора данных** |
| * | области     | доступа (scope)**      |                          |
| № | доступа     |                        |                          |
| * | (scope)**   |                        |                          |
| * |             |                        |                          |
+===+=============+========================+==========================+
| 1 | pow_reg     | Добавление сведений\   | Сведения о МЧД и         |
| . |             | о МЧД или заявления об | информации\              |
|   |             | ее отмене в Реестр     | о прекращении ее         |
|   |             | сведений\              | действия, передаваемые   |
|   |             | о доверенностях ЕСИА   | ИС в Реестр ЕСИА         |
+---+-------------+------------------------+--------------------------+
| 2 | pow         | Поиск сведений о МЧД\  | Сведения о МЧД,          |
| . | _reg_search | в Реестре сведений\    | предоставляемые\         |
|   |             | о доверенностях ЕСИА\  | из Реестра сведений о    |
|   |             | по параметрам          | доверенностях ЕСИА ИС по |
|   |             |                        | запросу по параметрам    |
+---+-------------+------------------------+--------------------------+
| 3 | pow_reg_inf | Поиск сведений о МЧД\  | Сведения о МЧД,          |
| . |             | в Реестре сведений\    | предоставляемые\         |
|   |             | о доверенностях ЕСИА\  | из Реестра сведений о    |
|   |             | по единому             | доверенностях ЕСИА ИС по |
|   |             | регистрационному       | запросу по единому       |
|   |             | номеру доверенности    | регистрационному номеру  |
|   |             | (UUID)                 | доверенности (UUID)      |
+---+-------------+------------------------+--------------------------+

## Сведения о структуре и проверке маркера доступа

Используемый ЕСИА маркер доступа состоит из трех частей:

1)  Заголовок (header), в котором содержится общая информация о типе
    маркера, в том числе об использованных в ходе его формирования
    криптографических алгоритмах.

2)  Набор утверждений (payload / claim set) с содержательными
    сведениями\
    о маркере.

3)  Подпись (signature), наличие которой обеспечивает возможность
    проверки целостности и аутентифичности данных маркера доступа,
    сформированного ЕСИА.

Части маркера разделены точкой, так что он имеет вид:

HEADER.PAYLOAD.SIGNATURE

Маркер передается в виде строки в формате base64 url safe[^76].

Каждая часть маркера содержит набор утверждений (claims) трех типов.

Заголовок (header) содержит описание свойств используемого маркера:

1)  Алгоритм электронной подписи («alg», стандартное обозначение); в
    настоящее время в ЕСИА для подписи маркера доступа используется
    алгоритм электронной подписи на основе ГОСТ Р 34.10-2012 и ГОСТ Р
    34.11-2012\
    со значением длины хэш-кода 256 бит (соответствующего значению
    «GOST3410_2012_256»), возможно также использование алгоритма
    электронной подписи на основе ГОСТ Р 34.10-2012 и ГОСТ Р 34.11-2012\
    со значением длины хэш-кода 512 бит (соответствующего значению
    «GOST3410_2012_512»);[^77]

2)  Глобальный тип маркера («typ», стандартное обозначение), который в
    ЕСИА всегда имеет значение «JWT» (JSON Web Token);

3)  ЕСИА-специфический тип маркера и его версия («sbt» и «ver»
    соответственно, приватное обозначение), что необходимо для
    использования в ЕСИА нескольких типов маркера; для маркера доступа
    -- «access».

Например, заголовок маркера доступа в ЕСИА будет иметь следующий вид:

{\"alg\":\"GOST3410_2012_256\",\"typ\":\"JWT\",\"ver\":0,\"sbt\":\"access\"}

Сообщение (payload) включает в себя содержательные утверждения о
субъекте.\
Если требуется извлечь информацию из сообщения маркера (payload),
необходимо предварительно проверить подпись ЕСИА.

Сообщение включает в себя содержательные утверждения о маркере доступа\
и субъекте:

1)  Данные о маркере доступа:

-   время прекращения действия («exp») -- в секундах с 1 января 1970 г.
    00:00:00 GMT;

-   время начала действия («nbf») -- в секундах с 1 января 1970 г.
    00:00:00 GMT, т.е. маркер нельзя обрабатывать до наступления
    указанного времени;

-   время выдачи («iat») -- в секундах с 1 января 1970 г. 00:00:00 GMT;

-   организация, выпустившая маркер («iss»), для маркеров ЕСИА всегда
    имеет определенное значение;

-   адресат маркера («client_id») -- утверждение, ограничивающее
    системы/приложения («аудитория»), которые могут использовать этот
    маркер. Для обозначения адресата в ЕСИА используется мнемоника
    данной ИС, зарегистрированной в ЕСИА. Соответственно, использовать
    маркер могут только системы с этой мнемоникой;

-   идентификатор маркера («urn:esia:sid») -- набор случайных символов,
    имеющий вид 128-битного идентификатора, сгенерированного\
    по стандарту UUID.

2)  Данные о субъекте:

-   идентификатор субъекта («urn:esia:sbj_id»), в качестве значения
    указывается OID, этот идентификатор уникален для каждого субъекта,
    зарегистрированного в ЕСИА;

-   область доступа («scope»), в качестве значения -- название области,\
    к которой предоставляется доступ (например, «id_doc»).

3)  Данные о наличии делегирования полномочий («urn: esia:authority»):

-   дата истечения срока действия доверенности («expired»);

-   идентификатор доверенности в ЕСИА («id»).

Пример сообщения (payload) маркера доступа в ЕСИА:

{

\"nbf\": 1537889904,

\"urn:esia:authority\": {

\"expired\": \"16.09.2018\",

\"id\": \"1020\"

},

\"scope\": \"http://esia.gosuslugi.ru/usr_sec?mode=w&oid=1000299526
http://esia.gosuslugi.ru/usr_inf?mode=w&oid=1000299526 openid
http://esia.gosuslugi.ru/org_inf?org_oid=1000000001\",

\"iss\": \"http://esia.gosuslugi.ru/\",

\"urn:esia:sid\":
\"dfa8dfe4e2cbad40fcfc974a9bcd445b570c2c90c22612047a940c56afa2c463\",

\"urn:esia:sbj_id\": 1000299526,

\"exp\": 1537893504,

\"iat\": 1537889904,

\"client_id\": \"PROFILE\"

}

Подпись (signature) маркера осуществляется по тому алгоритму,\
который указывается в параметре «alg» маркера. Подписываемыми данными
является строка в кодировке ASCII, полученная путем конкатенации
заголовка (header) и набора утверждений (payload) в кодировке base64 url
safe, разделенных символом «.» (точка) (header.payload).

Для проверки маркера доступа необходимо выполнить следующие действия:

1)  Декодировать заголовок (header) маркера доступа, который
    закодирован\
    в base64 url safe.

2)  Проверить формат заголовка, а именно:

-   заголовок после декодирования из base64 url safe должен иметь
    кодировку UTF-8;

-   значение поля «typ» должно быть «JWT»;

-   значение поля «sbt» для маркера доступа должно быть «aссess»;

-   значение поля «ver» должно быть одним из поддерживаемых в системе,
    осуществляющей проверку;

-   значение поля «alg» должно быть «GOST3410_2012_256»\
    или «GOST3410_2012_512».

3)  С использованием сертифицированного средства криптографической
    защиты информации выполнить проверку электронной подписи маркера
    доступа\
    с использованием сертификата ключа проверки электронной подписи
    ЕСИА. Алгоритм электронной подписи должен соответствовать значению
    поля alg\
    из заголовка маркера доступа.

4)  Декодировать сообщение (payload) и проверить, что формат сообщения
    JSON.

5)  Проверить, что издатель токена, указанный в поле «iss» имеет
    соответствующее значение, принятое в ЕСИА.

6)  Проверить, что текущее время находится в диапазоне больше времени
    начала срока действия маркера доступа, указанного в поле «iat», и
    меньше либо равно времени окончания срока действия маркера доступа,
    указанного в поле «exp».

7)  Проверить, что значение поля «client_id» соответствует
    системе-клиенту, запросившей маркер доступа, если проверка маркера
    доступа осуществляется системой-клиентом.

## Использование OpenID Connect 1.0 для аутентификации пользователя

### Общие принципы

В общем виде схема аутентификация с использованием OpenID Connect 1.0
выглядит следующим образом:

-   система-клиент формирует запрос на аутентификацию пользователя\
    с необходимыми параметрами;

-   система-клиент отправляет запрос на аутентификацию в адрес сервиса
    авторизации ЕСИА;

-   сервис авторизации аутентифицирует пользователя;

-   сервис авторизации получает согласие пользователя на проведение
    аутентификации в данной системе;

-   сервис авторизации перенаправляет пользователя обратно в
    систему-клиент\
    и передает авторизационный код;

-   система-клиент формирует запрос с использованием авторизационного
    кода\
    на получения маркера идентификации;

-   система-клиент получает ответ, содержащий необходимый маркер
    идентификации;

-   система-клиент проводит валидацию маркера идентификации и извлекает\
    из маркера идентификатор пользователя.

Описание запросов, формируемых системой клиентом, а также ответов ЕСИА
приведены ниже.

### Получение авторизационного кода

#### Стандартный режим запроса авторизационного кода (рекомендован к выводу из эксплуатации и не допускается к использованию при подключении новых систем-клиентов)

В данном разделе описан порядок получения авторизационнго кода
с использованием endpoint \".../ac\". Данный метод не рекомендован к
использованию.\
В п. Б.6.2.2, Приложение Б описывается процесс получения авторизационнго
кода с использованием endpoint \".../v2/ac\".

Чтобы получить авторизационный код, система-клиент должна получить
разрешение на проведение аутентификации пользователя[^78]. Для этого
система-клиент должна направить пользователя на страницу предоставления
прав доступа в ЕСИА.

Эта ссылка должна содержать следующие обязательные параметры:

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА, указанная прописными буквами);

-   \<client_secret\> -- подпись запроса в формате PKCS#7 detached
    signature\
    в кодировке UTF-8 от конкатенации значений следующих параметров
    HTTP-запроса: scope, timestamp, client_id, state (без разделителей).
    \<client_secret\> должен быть закодирован в формате base64 url safe.
    Используемый для проверки подписи сертификат должен быть
    предварительно зарегистрирован в ЕСИА^63^ и привязан к УЗ
    системы-клиента в ЕСИА. ЕСИА использует сертификаты в формате X.509
    и криптографические алгоритмы ГОСТ Р 34.10-2012 для формирования
    электронной подписи и ГОСТ Р 34.11-2012 для хэширования;

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после того, как даст разрешение на проведение аутентификации;

-   \<scope\> -- область доступа, т.е. запрашиваемые права; для
    проведения аутентификации пользователя область доступа (scope)
    должна иметь значение «openid».\
    Если системе-клиенту потребуется получение дополнительных данных
    о пользователе (например, детальная информация о пользователе), то
    могут быть указаны дополнительные области доступа (scope) через
    пробел[^79];

-   \<response_type\> -- это тип ответа, который ожидается от ЕСИА,
    имеет значение code, поскольку система-клиент должна получить
    авторизационный код;

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID;

-   \<timestamp\> -- время запроса авторизационного кода в формате
    yyyy.MM.dd HH:mm:ss Z (например, 2013.01.25 14:36:11 +0400),
    необходимое для фиксации начала временного промежутка, в течение
    которого будет валиден запрос\
    с данным идентификатором (\<state\>);

-   \<person_filter\> -- необязательный параметр, позволяющий
    производить авторизацию только для определенных групп лиц. Допустимо
    использование одного из следуюших фильтров:

-   для авторизации только подтвержденных учетных записей в параметре
    необходимо передать conf_acc в кодировке base64 (т.е. Y29uZl9hY2M=);

-   для авторизации только учетных записей детей в параметре необходимо
    передать acc_kid в кодировке base64 (т.е. YWNjX2tpZA==);

-   для авторизации всех учетных записей, кроме учетных записей детей,
    в параметре необходимо передать acc_not_kid в кодировке base64
    (т.е. YWNjX25vdF9raWQ=);

-   для авторизации только подтвержденных учетных записей или учетных
    записей детей в параметре необходимо передать комбинацию из conf_acc
    и acc_kid в кодировке base64 (т.е. Y29uZl9hY2MgYWNjX2tpZA==).

Если в ходе аутентификации не возникло ошибок, то ЕСИА осуществляет
перенаправление пользователя по ссылке, указанной в redirect_uri, а
также возвращает два обязательных параметра:

-   \<code\> -- значение авторизационного кода;

-   \<state\> -- значение параметра state, которое было получено в
    запросе\
    на аутентификацию; система-клиент должна выполнить проверку,\
    что значение state в ответе равно значению state в запросе.

#### Стандартный режим запроса авторизационного кода (v2/ac)

Данный раздел описывает процесс получения авторизационнго кода\
с использованием нового технического решения endpoint \".../v2/ac\".

Чтобы получить авторизационный код, система-клиент должна получить
разрешение на проведение аутентификации пользователя[^80]. Для этого
система-клиент должна направить пользователя на страницу предоставления
прав доступа в ЕСИА.

Эта ссылка должна содержать следующие обязательные параметры:

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА, указанная прописными буквами);

-   \<client_secret\> -- подпись значений пяти параметров в кодировке
    UTF-8:

    -   client_id;

    -   scope;

    -   timestamp;

    -   state;

    -   redirect_uri.

Порядок формирования \<client_secret\>:

1)  выполнить конкатенацию значений указанных выше параметров (порядок
    важен!). Пример строки:

TESTAPPLICATIONopenid2021.11.10 12:28:46
+0300bbf0aef5--5237--41bc--8cba--291e29a3ade8https://test.application.ru/auth/api/v1/esia/return

2)  подписать полученную строку по алгоритму ГОСТ Р 34.10-2012
    с использованием сертифицированного средства криптографической
    защиты информации[^81];

3)  закодировать полученное значение в base64 url safe

Используемый для проверки подписи сертификат должен быть предварительно
зарегистрирован в ЕСИА^63^ и привязан к УЗ системы-клиента в ЕСИА. ЕСИА
использует сертификаты в формате X.509 и криптографические алгоритмы
ГОСТ Р 34.10-2012 для формирования электронной подписи и ГОСТ Р
34.11-2012 для хэширования.

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после того, как даст разрешение на проведение аутентификации.
    Значение \<redirect_uri\> должно быть предварительно указано в
    параметрах внешней ИС в ЕСИА -- на стороне ЕСИА выполняется
    верификация соответствия redirect_uri в запросе и в настройках
    системы;

-   \<scope\> -- область доступа, т.е. запрашиваемые права; для
    проведения аутентификации пользователя область доступа (scope)
    должна иметь значение «openid».\
    Если системе потребуется получение дополнительных данных\
    о пользователе (например, детальная информация о пользователе),\
    то могут быть указаны дополнительные области доступа (scope) через
    пробел[^82];

-   \<response_type\> -- это тип ответа, который ожидается от ЕСИА,
    имеет значение code, поскольку система-клиент должна получить
    авторизационный код;

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID;

-   \<timestamp\> -- время запроса авторизационного кода в формате
    yyyy.MM.dd HH:mm:ss Z (например, 2013.01.25 14:36:11 +0400),
    необходимое для фиксации начала временного промежутка, в течение
    которого будет валиден запрос\
    с данным идентификатором (\<state\>);

-   \<client_certificate_hash\> -- параметр, содержащий хэш сертификата
    (fingerprint сертификата) системы-клиента в HEX-формате.
    Используемый для проверки подписи сертификат должен быть
    предварительно зарегистрирован в ЕСИА^63^\
    и привязан к УЗ системы-клиента в ЕСИА. ЕСИА использует сертификаты\
    в формате X.509 и криптографические алгоритмы ГОСТ Р 34.10-2012
    для формирования электронной подписи и ГОСТ Р 34.11-2012
    для хэширования;

-   \<person_filter\> -- необязательный параметр, позволяющий
    производить авторизацию только для определенных групп лиц. Допустимо
    использование одного из следуюших фильтров:

-   для авторизации только подтвержденных учетных записей в параметре
    необходимо передать conf_acc в кодировке base64 (т.е. Y29uZl9hY2M=);

-   для авторизации только учетных записей детей в параметре необходимо
    передать acc_kid в кодировке base64 (т.е. YWNjX2tpZA==);

-   для авторизации всех учетных записей, кроме учетных записей детей,
    в параметре необходимо передать acc_not_kid в кодировке base64
    (т.е. YWNjX25vdF9raWQ=);

-   для авторизации только подтвержденных учетных записей или учетных
    записей детей в параметре необходимо передать комбинацию из conf_acc
    и acc_kid в кодировке base64 (т.е. Y29uZl9hY2MgYWNjX2tpZA==).

В рамках разработки механизма проверки соответствия запроса кода
авторизации и последующего обмена кода (PKCE), для /v2/ac добавлены два
опциональных параметра:

-   \<code_challenge_method\> -- содержит значение«GOST3411»;

-   \<code_challenge\> -- результат работы функции. Порядок формирования
    \<code_challenge\>:

1)  сформировать случайную, уникальную строку длиной 43 символа,
    содержащую только следующие символы:
    \[A--Z\]/\[a--z\]/\[0--9\]/\"--\"/\".\"/\"\_\"/\"\~\" (каждый новый
    запрос должен формировать новое значение);

2)  применить преобразование code_challenge_method;

3)  кодировать значение в base64 url withoutPadding.

Если в ходе авторизации не возникло ошибок, то ЕСИА осуществляет
перенаправление пользователя по ссылке, указанной в redirect_uri, а
также возвращает два обязательных параметра:

-   \<code\> -- значение авторизационного кода;

-   \<state\> -- значение параметра state, который был получен в
    запросе\
    на авторизацию; система-клиент должна провести сравнение
    отправленного\
    и полученного параметра state.

#### Вызов страницы аутентификации пользователя ЕСИА в новом всплывающем окне браузера

Механизм аутентификации, основанный на OpenID Connect 1.0, обеспечивает
возможность вызова интегрированной системой страницы аутентификации
пользователя\
в новом всплывающем окне браузера (в виде popup).

Для реализации этой возможности вызывающая ЕСИА система должна
использовать параметр «display» запроса на проведение аутентификации со
значением «popup».

Пример запроса:

https://esia-portal1.test.gosuslugi.ru/aas/oauth2/ac?timestamp=2015.11.27+13%3A03%3A52+%2B0300&scope=
&client_secret=MIIFpgYJKoZIhvcNAQcCoIIFlzCCBZMCAQExDzANBglghkgBZQMEAgEFADALBgkqhkiG9w0BBwGgggNpMIIDZTCCAk2gAwIBAgIECgPdVzANBgkqhkiG9w0BAQsFADBjMQswCQYDVQQGEwJSVTEPMA0GA1UECBMGTW9zY293MQ8wDQYDVQQHEwZNb3Njb3cxEDAOBgNVBAoTB0NvbXBhbnkxDzANBgNVBAsTBlN5c3RlbTEPMA0GA1UEAxMGU3lzdGVtMB4XDTE1MTAyOTE0MTUxMFoXDTE2MDEyNzE0MTUxMFowYzELMAkGA1UEBhMCUlUxDzANBgNVBAgTBk1vc2NvdzEPMA0GA1UEBxMGTW9zY293MRAwDgYDVQQKEwdDb21wYW55MQ8wDQYDVQQLEwZTeXN0ZW0xDzANBgNVBAMTBlN5c3RlbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKhCeBbYRs89aPLf0TIytSufxmZsrgWVy2a0uOi8dyp--vw6h3cqNh219WNNlyv0gYpiM8hNs6y7vKrQ2k83aur1b9a2RQ1LX0w1xAW55PHBsTS6I3FNLfLzPl0WIjiFEaqJl98----L4BkR2Bk_CHroffMvUU5fqVPEfP4PFYD2oflBOoMBmXeemn0--xyZcnZ00WAvvRSfAYOaFp189EUV9QmVgvrKkc81Pqkx49dHH0KHFH--s1uvZIkCcgnmdXBco5eeDg7EP9XbJuVp4uge9jDLBMw4SqzWQVUNmDJ0Vu5dWJUF8m5Z_TKEQ0nPVY9f7aqSJpiF--N98TMgurGQzRJCECAwEAAaMhMB8wHQYDVR0OBBYEFMdZZfnOLJt2NkqTsqQq8biljqhRMA0GCSqGSIb3DQEBCwUAA4IBAQBMznNVeP4E3fgWU4ZK9D2f78ONF330mE9xCLCDByDTMTMyCP6TEuMkDUYZ8UHQbohftwI6SP--0wjvYUe0qfjPu6IzID3n--YM9642GHpzR0aR1ZXp8FM2p2GG5bQ3bGIE8Aa98SLXQzz6fOcYh3IvE--YKHXEAGOgrx0Uh6xcTW7hZySEC74o9kn0atqp_L2p7dHnsjA--coKerKgbN5jJCwz6y0O_LBUKCAaffZ89BU--5qrV_v1XnniF756h2Szk4KczSDex3IFXEUrntEpTWH1YhKNtwzvaMC92xSOgunpNo8lx4s9oNIobOKJEvKr1pR_caBgioy8SLLWecpSocb9BMYICATCCAf0CAQEwazBjMQswCQYDVQQGEwJSVTEPMA0GA1UECBMGTW9zY293MQ8wDQYDVQQHEwZNb3Njb3cxEDAOBgNVBAoTB0NvbXBhbnkxDzANBgNVBAsTBlN5c3RlbTEPMA0GA1UEAxMGU3lzdGVtAgQKA91XMA0GCWCGSAFlAwQCAQUAoGkwGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTUxMTI3MTAwMzUyWjAvBgkqhkiG9w0BCQQxIgQgu--JPaWt--aHVLaF13Qudx5znqCAwpTPfdsv7scyfLMwYwDQYJKoZIhvcNAQEBBQAEggEAMQL3Uso76eQQPQ3DzewTUZujGwOi25WZyAYuQCxYlI--liFOIQ74U2s5EPS--rK2EFVkgRPOjHIJ4lEcR8O1ObSowevI63a--4Tk4KF70--h0kLano93sixH0WmeAJpFoj8--JpsMhJ_EJJwLtOpUvlbrWTQtk3d9F--3vXdh6sXo91QtPzol_o3DkpS93mk5bYWBP92nHPvSfbadtBrtjWahq7UA3WUrQHCaLuIrsS0TRitya--Jv--0GJds--hgEST2xlhbFz7eMgZmlTHsVrBCZngdO--6jSIQVt4p99vD6uMhLKmIFrvNsOE1myaZL2AweumcyAZmS8Tb3tX953un_5CvVdw&response_type=code&redirect_uri=https%3A%2F%2Fesia-portal1.test.gosuslugi.ru%2Faas%2Foauth2%2Ftest%2FoauthCallback.xhtml&state=f21125b6--60e2--4edc--a0ab--e7da2d31708f&display=popup&client_id=TESTSYS

Кроме того, система должна обеспечить открытие страницы аутентификации
во всплывающем окне, рекомендуемый размер -- 800х600. Пример фрагмента
javascript для открытия страницы во всплывающем окне:

var w = 800;

var h = 600;

var left = (\$(window).width()/2)--(w/2);

var top = (\$(window).height()/2)--(h/2);

var popup = window.open(\"request_url\", \"Request popup\", \"width=\" +
w + \",height=\" + h + \",top=\" + top + \",left=\" + left +
\",location=1,status=0,menubar=0,resizable=0,scrollbars=0\");

В данном скрипте request_url должен быть заменен на URL, вызывающий
аутентификацию пользователя в ЕСИА. Иными словами, этот request_url
должен обеспечивать перенаправление пользователя на страницу
предоставления прав доступа\
в ЕСИА, т.е. выполнение запроса на проведение аутентификации со
значением «popup», указанного выше.

После успешной аутентификации ЕСИА возвращает результат аутентификации
в открытое окно браузера. Системе, в свою очередь, нужно обеспечить
исполнение собственной логики для закрытия всплывающего окна и передачи
результатов аутентификации в основную веб-страницу системы (из которой
было первоначально открыто всплывающее окно).

### Получение маркера идентификации в обмен на авторизационный код (рекомендован к выводу из эксплуатации и не допускается к использованию при подключении новых систем-клиентов)

Данный раздел описывает порядок получения маркера доступа с
использованием endpoint \".../te\". В п. Б.6.4, Приложение Б описывается
процесс получения маркера доступа в обмен на авторизационный код с
использованием нового технического решения endpoint \".../v3/te.

Когда авторизационный код получен, система-клиент может сформировать
запрос методом POST в адрес ЕСИА для получения маркера
идентификации[^83]. Один авторизационный код можно обменять на один
маркер идентификации. В тело запроса должны быть включены следующие
сведения:

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА, указанная прописными буквами);

-   \<code\> -- значение авторизационного кода, который был ранее
    получен\
    от ЕСИА и который необходимо обменять на маркер идентификации;

-   \<grant_type\> -- принимает значение «authorization_code»,\
    если авторизационный код обменивается на маркер идентификации;

-   \<client_secret\> -- подпись запроса в формате PKCS#7 detached
    signature\
    в кодировке UTF-8 от значений четырех параметров HTTP-запроса:
    scope, timestamp, clientId, state (без разделителей).
    \<client_secret\> должен быть закодирован в формате base64 url safe.
    Используемый для проверки подписи сертификат должен быть
    предварительно зарегистрирован в ЕСИА^63^\
    и привязан к УЗ системы-клиента в ЕСИА. ЕСИА использует сертификаты\
    в формате X.509и криптографические алгоритмы ГОСТ Р 34.10-2012 для
    формирования электронной подписи и ГОСТ Р 34.11-2012 для
    хэширования;

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID; этот набор символов должен
    отличаться от того,\
    который использовался при получении авторизационного кода;

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после аутентификации (то же самое значение, которое было указано в
    запросе на получение авторизационного кода);

-   \<scope\> -- область доступа, т.е. запрашиваемые права (то же самое
    значение, которое было указано в запросе на получение
    авторизационного кода) [^84];

-   \<timestamp\> -- время запроса маркера в формате yyyy.MM.dd HH:mm:ss
    Z (например, 2013.01.25 14:36:11 +0400), необходимое для фиксации
    начала временного промежутка, в течение которого будет валиден
    запрос с данным идентификатором (\<state\>);

-   \<token_type\> -- тип запрашиваемого маркера, в настоящее время ЕСИА
    поддерживает только значение «Bearer».

Если запрос успешно прошел проверку, то ЕСИА возвращает ответ в формате\
JSON:

-   \<id_token\> -- маркер идентификации;

-   \<access_token\> -- маркер доступа для данного ресурса (если он
    запрашивался);

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer».

Пример ответа:

{

"id_token":
"eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzcyI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5zYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZfV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5NzfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6qp6IcmD3HP99Obi1PRs--cwh3LO--p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJNqeGpe--gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7TpdQyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoSK5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4XUVrWOLrLl0nx7RkKU8NXNHq--rvKMzqg",

"expires_in" : 3600,

"state" : "9be638a9--0e05--42e1--b4f8--a3e30457fbdd",

"token_type" : "Bearer",

}

При невозможности выдачи маркера доступа возвращается код ошибки.

### Взаимодействие с API Gateway c использованием «authorization code flow»

Получение авторизационного кода (разрешение на доступ к ресурсу от его
владельца) предполагает направление пользователя на страницу
предоставления прав доступа в адрес API Gateway. Система-клиент может
сформировать запрос, основываясь на параметрах запроса \".../ac\" (см.
п. Б.2.2, Приложение Б) или \"...v2/ac\" (см. п. Б.2.3, Приложение Б).

После прохождения проверок API Gateway дополняет запрос системы-клиента
параметрами для внутреннего взаимодействия (см. таблицу 100) и
отправляет его в адрес сервиса авторизации ЕСИА.

Таблица 100 -- Дополнительные параметры API Gateway

+---+-----------------------+-----------------------------------------+
| № | Название параметра    | Описание                                |
+===+=======================+=========================================+
| 1 | gw_id                 | Идентификатор, соответствующий API      |
| . |                       | Gateway (значение: \"API_GW\")          |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 2 | gw_secret             | Значение подписи ИС API Gateway под     |
| . |                       | параметрами запроса                     |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 3 | gw_certificate_hash   | Хэш сертификата (fingerprint            |
| . |                       | сертификата) ИС API Gateway\            |
|   |                       | в hex--формате (только для методов      |
|   |                       | \"...v2/ac\" и \".../v3/te\")           |
+---+-----------------------+-----------------------------------------+

Если в ходе авторизации не возникло ошибок, то осуществляется
перенаправление пользователя по ссылке, указанной в redirect_uri, и
возврат обязательных параметров:

-   \<code\> -- значение авторизационного кода;

-   \<state\> -- значение параметра state, который был получен в запросе
    на авторизацию, система-клиент должна провести сравнение
    отправленного и полученного параметра state.

В случае ошибки сервис авторизации вернет в параметре *error* код ошибки
(например, «access_denied») и перенаправит пользователя по адресу,
указанному в *redirect_uri*. Перечень возможных ошибок приведен в
таблице 93.

Когда авторизационный код получен система-клиент может сформировать
запрос методом POST на https-адрес API Gateway для получения внешнего
маркера доступа. В тело запроса должны быть включены параметры метода
«.../te» (см. п. Б.2.4, Приложение Б) или «.../v3/te» (см. п. Б.2.5,
Приложение Б) в зависимости от способа интеграции системы-клиента.

После прохождения проверок API Gateway дополняет запрос системы-клиента
параметрами для внутреннего взаимодействия (см. таблицу 100) и
отправляет его в адрес сервиса авторизации ЕСИА.

После успешной верификации запроса ЕСИА возвращает в API Gateway ответ
в формате JSON со следующим набором параметров:

-   \<access_token\> -- маркер доступа для данного ресурса;

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer»;

-   \<refresh_token\> -- маркер обновления для данного ресурса[^85].

При невозможности выдачи маркера доступа возвращается код ошибки\
(см. таблицы 93, 94).

API Gateway выполняет процедуру обмена внешнего маркера доступа
на внутренний, после чего передает ответ от ЕСИА в адрес внешней ИС.

Модель контроль доступа на основе делегированного принятия решения
поддерживает использование маркеров обновления в процессе авторизации
пользователей. При наличии соответствующего доступа система-клиент может
получать новый маркер доступа с использованием маркера обновления при
условии истекшего срока действия прошлого маркера. Для этого
системе-клиенту следует сформировать запрос методом POST в адрес API
Gateway согласно п. Б.2.6, Приложение Б.

Ответ на этот запрос возвращается в формате JSON и имеет структуру,
аналогично первичному предоставлению маркера доступа. Ответ содержит
новый маркер обновления, который системе-клиенту необходимо хранить
вместо уже использованного маркера обновления.

Перечень возможных ошибок приведен в таблице 95.

### Получение маркера идентификации в обмен на авторизационный код (v3/te)

Данный раздел описывает процесс получения маркера доступа в обмен\
на авторизационный код с использованием нового технического решения
endpoint \".../v3/te\".

Когда авторизационный код получен, система-клиент может сформировать
запрос методом POST в адрес ЕСИА для получения маркера
идентификации[^86]. Один авторизационный код можно обменять на один
маркер идентификации. В тело запроса должны быть включены следующие
сведения:

-   \<client_id\> -- идентификатор системы-клиента (мнемоника системы в
    ЕСИА, указанная прописными буквами);

-   \<code\> -- значение авторизационного кода, который был ранее
    получен\
    от ЕСИА и который необходимо обменять на маркер идентификации;

-   \<grant_type\> -- принимает значение «authorization_code»,\
    если авторизационный код обменивается на маркер идентификации;

-   \<client_secret\> -- подпись значений шести параметров в кодировке
    UTF-8:

    -   client_id;

    -   scope;

    -   timestamp;

    -   state;

    -   redirect_uri;

    -   code.

Порядок формирования \<client_secret\>:

1)  конкретизировать вышеуказанные параметры (порядок важен!). Пример
    строки:

TESTAPPLICATIONopenid2021.11.10 12:28:46
+0300bbf0aef5--5237--41bc--8cba--291e29a3ade8https://test.application.ru/auth/api/v1/esia/returneyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImF1dGhvcml6YXRpb25fY29kZSIsImFsZyI6IlJTMjU2In0.\<...\>.jGdT4nTEsUPBsnDOx3xx9EunRlSV8jmX6N4fCCnsbfABYAGB7aamTbcxBzFjIrEgh_Ywopt250ICW8LZ55NWhbCiMWX4naySxypyMd3cwzdz_FP4VjUOj7US1SH9aGjxnYYENBOluCbPX7OPO3OBKOQbxdXony--t1bWOi4mbGbMYTLsOxicoWzn2y1xDVpYrdoP--Rsry1ZOz1o4f8I9DV7i7_V08IuIti9OfXf5--UlWPNdHNy2SllfyUthe6in9wbPuGaw_r92oC4BROVQkq7MpNX4hm--PsUMRO6J4qM4hl3s_igPgh5TkC_NBNB0ySexgLhYEa_lifQCXPh--GkVbw

2)  подписать полученную строку по алгоритму ГОСТ Р 34.10-2012
    с использованием сертифицированного средства криптографической
    защиты информации;

3)  закодировать полученное значение в base64 url safe.

Используемый для проверки подписи сертификат должен быть предварительно
зарегистрирован в ЕСИА^63^ и привязан к УЗ системы-клиента в ЕСИА. ЕСИА
использует сертификаты в формате X.509 и криптографические алгоритмы
ГОСТ Р 34.10-2012 для формирования электронной подписи и ГОСТ Р
34.11-2012 для хэширования;

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса (необходимо для защиты от перехвата),
    генерируется по стандарту UUID; этот набор символов должен
    отличаться от того,\
    который использовался при получении авторизационного кода;

-   \<redirect_uri\> -- ссылка, по которой должен быть направлен
    пользователь\
    после аутентификации (то же самое значение, которое было указано в
    запросе на получение авторизационного кода). Значение
    \<redirect_uri\> должно быть предварительно указано в параметрах
    внешней ИС в ЕСИА -- на стороне ЕСИА выполняется верификация
    соответствия redirect_uri в запросе и в настройках системы;

-   \<scope\> -- область доступа, т.е. запрашиваемые права (то же самое
    значение, которое было указано в запросе на получение
    авторизационного кода) [^87];

-   \<timestamp\> -- время запроса маркера в формате yyyy.MM.dd HH:mm:ss
    Z (например, 2013.01.25 14:36:11 +0400), необходимое для фиксации
    начала временного промежутка, в течение которого будет валиден
    запрос с данным идентификатором (\<state\>);

-   \<token_type\> -- тип запрашиваемого маркера, в настоящее время ЕСИА
    поддерживает только значение «Bearer»;

-   \<client_certificate_hash\> -- параметр, содержащий хэш сертификата
    (fingerprint сертификата) системы-клиента в HEX-формате.
    Используемый для проверки подписи сертификат должен быть
    предварительно зарегистрирован в ЕСИА^63^\
    и привязан к УЗ системы-клиента в ЕСИА. ЕСИА использует сертификаты\
    в формате X.509 и криптографические алгоритмы ГОСТ Р 34.10-2012
    для формирования электронной подписи и ГОСТ Р 34.11-2012
    для хэширования.

В рамках разработки механизма проверки соответствия запроса кода
авторизации и последующего обмена кода (PKCE), для /v3/te добавлен
опциональный параметр:

-   \<code_verifier\> -- строка длиной 43 символа, содержащая в себе
    только следующие символы
    (\[A--Z\]/\[a--z\]/\[0--9\]/\"--\"/\".\"/\"\_\"/\"\~\");

В ЕСИА должен быть передан параметр \<code_verifier\>. Для метода
«GOST3411» в ЕСИА производится расчет, при котором берется полученное
значение\
и для него вычисляется хэш функция, а затем кодируется с помощью base64
url withoutPadding. Полученный результат сравнивается со значением
\<code_challenge\>, полученного в рамках запроса v2/ac. Если они не
совпадают, ЕСИА возвращает соответствующую ошибку.

Если запрос успешно прошел проверку, то ЕСИА возвращает ответ в формате
JSON:

-   \<id_token\> -- маркер идентификации;

-   \<access_token\> -- маркер доступа для данного ресурса (если он
    запрашивался);

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer».

При невозможности выдачи маркера доступа возвращается код ошибки\
(см. таблицу 93).

### Проверка маркера идентификации

После получения маркера идентификации система-клиент должна произвести
валидацию маркера идентификации, которая включает в себя следующие
проверки:

1)  Проверка идентификатора (мнемоники) ЕСИА, содержащейся в маркере
    идентификации.

2)  Проверка идентификатора (мнемоники) системы-клиента, т.е. именно
    система-клиент должна быть указана в качестве адресата маркера
    идентификации.

3)  Проверка подписи маркера идентификации (с использованием указанного\
    в маркере алгоритма).

4)  Текущее время должно быть не позднее, чем время прекращения срока
    действия маркера идентификации.

После валидации маркера идентификации система-клиент считает
пользователя аутентифицированным. Для получения дополнительных данных о
пользователе следует использовать идентификатор пользователя,
извлеченный из маркера идентификации, и соответствующие программные
интерфейсы ЕСИА (требующие, в свою очередь, маркера доступа).

Детальные сведения о маркере идентификации представлены\
в п. Б.7, Приложение Б.

### Выход из системы (Logout)

Для осуществления выхода из системы пользователь должен быть
перенаправлен по специальной ссылке с соблюдением следующих требований:

-   протокол запроса должен быть https;

-   путь в HTTP-запросе должен быть равен /idp/ext/Logout (При
    завершении сессии требуется обязательно выполнять оправку запроса
    Logout);

-   запрос должен иметь параметр (query param) с именем client_id,
    содержащий мнемонику обращающейся системы, зарегистрированной в
    ЕСИА;

-   запрос может иметь параметр (query param) с именем redirect_url,
    содержащий адрес, на который пользователь будет перенаправлен после
    успешного Logout.

Пример запроса:

https://esia.gosuslugi.ru/idp/ext/Logout?client_id=ESIA&redirect_url=https://esia.gosuslugi.ru/registration/

В ЕСИА для интегрированной системы может быть определен параметр
«system.siteUrl», содержащий URL-адрес системы, на который будет
возвращен пользователь после Logout. Redirect_url должен быть подстрокой
«system.siteUrl».

При обработке запроса производятся следующие проверки:

1)  Проверка, что передан обязательный параметр «client_id». Если он не
    передан, то возвращается HTTP-код «400 Bad Request».

2)  Проверка, что система с мнемоникой, указанной в параметре
    «client_id», зарегистрирована в ЕСИА. Если система не
    зарегистрирована, то возвращается HTTP-код «403 Forbidden».

После успешного выполнения этих проверок ЕСИА определяет URL
переадресации после успешного Logout:

-   Если для системы в настройках ЕСИА не задан параметр
    «system.siteUrl»,\
    то запрос после Logout будет направлен на сайт ЕСИА.

-   Если в запросе не задан параметр «redirect_url», то запрос после
    Logout будет направлен по адресу, заданному в «system.siteUrl».

-   Если параметры «redirect_url» и «system.siteUrl» не соответствуют
    друг другу («redirect_url» должен быть подстрокой «system.siteUrl»),
    то запрос\
    после Logout будет направлен на сайт ЕСИА.

## Сведения о структуре маркера идентификации

Структура маркера идентификации аналогична структуре маркера доступа\
(см. п. Б.5, Приложение Б) и состоит из тех же трех частей: заголовок,
набор утверждений\
и подпись.

Особенность заголовка маркера идентификации состоит в том, что значение
атрибута «sbt» равно «id».

Пример заголовка маркера идентификации в ЕСИА:

{\"alg\":\"GOST3410_2012_512\",\"sbt\":\"id\",\"typ\":\"JWT\",\"ver\":0}

Сообщение, включающее в себя содержательные утверждения о маркере
идентификации и пользователе, включает следующие атрибуты:

-   признак прохождения пользователем усиленной (двухфакторной)
    аутентификации («2fa»: «otp») -- присутствие параметра означает,\
    что пользователь в процессе аутентифкации вводил второй фактор;

-   время аутентификации («auth_time») -- время, когда произошла
    аутентификация пользователя, указывается в секундах с 1 января 1970
    г. 00:00:00 GMT;

-   время прекращения действия («exp»), указывается в секундах\
    с 1 января 1970 г. 00:00:00 GMT;

-   идентификатор субъекта («sub»), в качестве значения указывается OID.
    Этот идентификатор уникален для каждого субъекта,
    зарегистрированного в ЕСИА, и остается неизменным при последующих
    аутентификациях; адресат маркера («aud»), указывается client_id
    системы, направившей запрос\
    на аутентификацию;

-   организация, выпустившая маркер («iss»), указывается URL ЕСИА;

-   время начала действия («nbf») -- в секундах с 1 января 1970 г.
    00:00:00 GMT, т.е. маркер нельзя обрабатывать до наступления
    указанного времени;

-   внутренний идентификатор сессии ЕСИА («urn:esia:sid»);

-   начало блока описания субъекта вызова сессии («urn:esia:sbj»);

-   псевдоним субъекта («urn:esia:sbj:nam») -- внутренний для ЕСИА
    псевдоним пользователя;

-   OID субъекта («urn:esia:sbj:oid») -- OID УЗ пользователя;

-   тип субъекта («urn:esia:sbj:typ»), может принимать различные
    значения, например: «P» -- физическое лицо;

-   статус учетной записи («urn:esia:sbj:lvl»), может принимать одно из
    трех значений: «KD» -- УЗ ребенка, «PR» -- подтвержденная УЗ, «P» --
    УЗ с одним из статусов: «упрощенная», «стандартная» и «упрощенная,
    готовая к подтверждению»;

-   признак подтвержденности субъекта («urn:esia:sbj:is_tru») -- «is
    trusted» -- УЗ пользователя подтверждена. Параметр отсутствует, если
    УЗ не подтверждена;

-   способ авторизации («urn:esia:amd»), может принимать одно из
    значений:

    -   «DS» (электронная подпись);

    -   «PWD» (пароль);

    -   «QR» (QR-код);

    -   «EBS» (биометрия);

    -   «DLG» (делегирование);

    -   «MP» (мобильное приложение «Госуслуги» по логину);

    -   «MPRFN» (мобильное приложение «Госуслуги» по пин-коду);

-   время выдачи («iat»), указывается в секундах с 1 января 1970 г.
    00:00:00 GMT;

-   метод аутентификации («amr», приватное обозначение), может принимать
    одно из значений:

    -   «DS» (электронная подпись);

    -   «PWD» (пароль);

    -   «QR» (QR-код);

    -   «EBS» (биометрия);

    -   «DLG» (делегирование);

    -   «MP» (мобильное приложение «Госуслуги» по логину);

    -   «MPRFN» (мобильное приложение «Госуслуги» по ПИН-коду).

Пример сообщения маркера идентификации в ЕСИА:

{

\"claims\": {

\"acr\": {

\"2fa\": \"otp\"

},

\"nbf\": 1665657285,

\"amr\": \"PWD\",

\"urn:esia:amd\": \"PWD\",

\"auth_time\": 1665657284,

\"iss\": \"https://esia-dev-k8s.test.gosuslugi.ru/\",

\"urn:esia:sid\": \"742ed289-b88e-4ec4-80dd-7eb514e83d93\",

\"urn:esia:sbj\": {

\"urn:esia:sbj:typ\": \"P\",

\"urn:esia:sbj:lvl\": \"PR\",

\"urn:esia:sbj:is_tru\": true,

\"urn:esia:sbj:oid\": 1077340006,

\"urn:esia:sbj:nam\": \"OID.1077340006\"

},

\"exp\": 1665668085,

\"iat\": 1665657285

}

}

Подпись (signature) маркера осуществляется по алгоритму, который
указывается в параметре «alg» маркера. Подпись вычисляется от двух
предыдущих частей маркера (HEADER.PAYLOAD).

## Удаленная идентификация с использованием биометрической идентификации

Процедура удаленной идентификации включает последовательное прохождение
аутентификации в ЕСИА по логину/паролю и верификации в биометрической
системе\
по степени схожести биометрического образца.

Система, в которой на данный момент доступна биометрическая
идентификация: Единая биометрическая система.

Реализация взаимодействия ИС с биометрической системой при инициации
удаленной идентификации производится согласно актуальной версии
Методических рекомендаций биометрической системы. В рамках этого
процесса должно быть выстроено стандартное взаимодействие с ЕСИА на
следующих этапах:

-   получение специального маркера доступа для взаимодействия\
    с биометрической системой;

-   завершение удаленной идентификации пользователя, получение
    пользовательского маркера доступа.

Указания по интеграции с Единой биометрической системой, в том числе --
в части использования защищенных сетей передачи данных (VPN) при доступе
к методам REST API Биометрической верификации, представлены в приложени
Б «Описание интеграции внешних систем с Единой биометрической системой в
процессе биометрической верификации» документа «Методические
рекомендации по работе с Единой биометрической системой», доступного
на ресурсе: <https://bio.rt.ru/documents/basic/>.

Общая схема взаимодействия участников усиленной аутентификации
представлена на рисунке 10.

![C:\\Users\\darya.prigarina\\Documents\\Документация по проекту\\Схема
биометрии.png](media/image10.png){width="8.084904855643044in"
height="5.977376421697288in"}

Рисунок 10 -- Схема взаимодействия участников усиленной аутентификации

**1. Получение специального маркера доступа для взаимодействия\
с биометрической системой**

ИС реализует аутентификацию клиента и получение специального маркера
доступа для взаимодействия с биометрической системой, разрешающего
клиенту биометрическую верификацию в биометрической системе.

Для этого ИС реализует взаимодействие с сервисом авторизации и получения
маркера доступа ЕСИА, согласно п. Б.2, Приложение Б.

В запросе на авторизацию ИС должна указать область доступа (scope)
«openid» и специальный область доступа (scope) Единой биометрической
системы -- «bio», подробнее о котором указано в актуальных методических
рекомендациях Единой биометрической системы.

Пользователь авторизуется в ЕСИА по логину и паролю и дает согласие\
на проведение усиленной аутентификации с использованием его
биометрических данных\
в биометрической системе (в случаях, если согласие пользователя из
данной ИС еще\
не получено).

В результате завершения этапа, ИС получит специальный маркер доступа
(access_token), обладающий следующими отличиями от стандартного маркера
доступа ЕСИА:

-   Короткое время жизни (TTL);

-   Наличие в составе маркера доступа URL REST-сервиса ЕСИА для передачи
    расширенного результата биометрической верификации из ЕБС (параметр
    «ext_vrf_url»).

В данном случае ИС не получает маркер обновления (refresh_token), то
есть\
для каждого случая усиленной аутентификации ИС необходимо запрашивать
маркер доступа заново.

Пример полученного расширенного маркера идентификации в ЕСИА:

{

\"access_token\":\"eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE1MjgyMTI4NTUsInNjb3BlIjoib3BlbmlkIGJpbyIsImV4dF92cmZfdXJsIjoiaHR0cHM6XC9cL2VzaWEtZGV2LnRlc3QuZ29zdXNsdWdpLnJ1XC9lc2lhLXJzXC9hcGlcL3B1YmxpY1wvdjFcL2V4dFwvdnJmXC9yZXN1bHQiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiMDI4Zjk0NWI5MjEwN2ZiMjc5MTE4YTM1OGM2M2ZiNDRhMzdjOGZiOTAyMjA1OGQxZjlhMjdiNjIzMDg5ZjQ3YSIsInVybjplc2lhOnNial9pZCI6MTAwMDI5OTI4MiwiZXhwIjoxNTI4MjEzNDU1LCJpYXQiOjE1MjgyMTI4NTUsImNsaWVudF9pZCI6IlRFU1RfU1lTIn0.FqmQrXLPQBAP8Sl8u6l2XyjtGWK3uNRA8IU7hH6nNHCSVffijYtFqmHOv4can_zXrzEKqG6Y_E21I16XcRuG_YoTnpBlBnH3FcCL9MqoiYQNETNC5AysumpTkmMXYPQqmJ4oPOVNyqJYye8TUtQmy9bI4Z3duvwZ3z11PZSlGZH9eETrWoRUqyb316t4kKku9p6oM4gAgdu1_5gLeq3HcIPZV8XTQc625AOXg6qJPI52CchIRXJV--MMZytX2ezKCs3OCyllXzq9mgk9OEfgdT7oHGQCDOLWjfhNm232yRikmhl--u7M4QyCi0eChelQXFtjx38iaDDUgstHwMQsK7UQ\",\"id_token\":\"eyJ2ZXIiOjAsInR5cCI6IkpXVCIsInNidCI6ImlkIiwiYWxnIjoiUlMyNTYifQ.eyJhdWQiOiJURVNUX1NZUyIsInN1YiI6MTAwMDI5OTI4MiwibmJmIjoxNTI4MjEyODU1LCJhbXIiOiJQV0QiLCJ1cm46ZXNpYTphbWQiOiJQV0QiLCJhdXRoX3RpbWUiOjE1MjgyMTI2OTQsImlzcyI6Imh0dHA6XC9cL2VzaWEuZ29zdXNsdWdpLnJ1XC8iLCJ1cm46ZXNpYTpzaWQiOiIwMjhmOTQ1YjkyMTA3ZmIyNzkxMThhMzU4YzYzZmI0NGEzN2M4ZmI5MDIyMDU4ZDFmOWEyN2I2MjMwODlmNDdhIiwidXJuOmVzaWE6c2JqIjp7InVybjplc2lhOnNiajp0eXAiOiJQIiwidXJuOmVzaWE6c2JqOmlzX3RydSI6dHJ1ZSwidXJuOmVzaWE6c2JqOm9pZCI6MTAwMDI5OTI4MiwidXJuOmVzaWE6c2JqOm5hbSI6Ik9JRC4xMDAwMjk5MjgyIn0sImV4cCI6MTUyODIyMzY1NSwiaWF0IjoxNTI4MjEyODU1fQ.P--5adtNRIECAgrJ7SCbXN6hHXxSAaP2olryXlHswvye_jyObow--7SBN28ez1SG3C3Gxt8dZOq3JrKVa92Fr2PVNc9ACNnqHJDEY_4sSVTCKUjiTTXTW4nJNYmTTrczoAwuqir7PvNRYUtZuFAE8CwFrAl_PPKExT0XaAP4Fc5BL_XOUPEw7XVYEjasBXzhoEMO0cVoGpztolATyxqYhkiR9AgXtd_sjye4svl5vEBxpGJOm8qSO_eM_orfC2_REyF0XQtbblFW4qLe9zsko6vtm1QDW28Un101pXwAVhJN1oO0lATiT0uYWq0gxrt2U2B9kZPCak8nbgJizZx4NtNg\",

\"state\":\"21335561--1ee3--f501--79b3--bb10c06fd0f3\",

\"token_type\":\"Bearer\",

\"expires_in\":600

}

Пример состава расширенного маркера доступа (PAYLOAD-часть):

{

\"nbf\": 1528212764,

\"scope\": \"openid bio\",

\"ext_vrf_url\":
\"https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/ext/vrf/result\",

\"iss\": \"http://esia.gosuslugi.ru/\",

\"urn:esia:sid\":
\"028f945b92107fb279118a358c63fb44a37c8fb9022058d1f9a27b623089f47a\",

\"urn:esia:sbj_id\": 1000299282,

\"exp\": 1528213364,

\"iat\": 1528212764,

\"client_id\": \"TEST_SYS\"

}

**2. Завершение удаленной идентификации пользователя, получение
пользовательского маркера доступа**

ИС реализует аутентификацию клиента и получение специального маркера
доступа для завершения процесса удаленной идентификации пользователя\
в ЕСИА/биометрической системе.

Для этого ИС реализует взаимодействие с сервисом авторизации и получения
маркера доступа ЕСИА (аналогично предыдущему этапу).

В запросе на авторизацию[^88] ИС должна указать область доступа (scope)
«openid» и специальную область доступа (scope) («ext_auth_result»[^89]),
параметр «verify_token» (получен в результате верификации биометрических
данных в биометрической системе).

В результате завершения этапа ИС Потребителя БД получит специальный
пользовательский расширенный маркер доступа, который будет содержать
результат биометрической верификации.

ЕСИА выдаст данный маркер доступа только в случае:

-   наличия в ЕСИА успешного результата биометрической верификации
    пользователя;

-   успешного сравнения полученных параметров «verify_token»\
    от биометрической системы и ИС;

-   наличия согласия пользователя на предоставление персональных данных.

В данном случае ИС не получает маркер обновления (refresh_token), то
есть\
для каждого случая усиленной аутентификации ИС и получения доступа к
данным пользователя необходимо запрашивать пользовательский маркер
доступа заново.

Пользователь автоматически аутентифицируется в ЕСИА.

Пример полученного расширенного маркера идентификации в ЕСИА:

{\"access_token\":\"eyJ2ZXIiOjEsInR5cCI6IkpXVCIsInNidCI6ImFjY2VzcyIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE1MjgyNzgyNDgsInNjb3BlIjoiZXh0X2F1dGhfcmVzdWx0P29pZD0xMDAwMjk5MjgyIG9wZW5pZCIsImlzcyI6Imh0dHA6XC9cL2VzaWEuZ29zdXNsdWdpLnJ1XC8iLCJ1cm46ZXNpYTpzaWQiOiI0MWM5ODUzMjc5ZjJkOTJhZDMwYWI5Yjk0MjMwMzU5YTM5MjUwZWY3ZTVhNzZlMDgzODgyZDYwZjhkZGYxZjhjIiwibWF0Y2giOnsidm9pY2UiOiIwLjk1IiwiZmFjZSI6IjAuOCIsIm92ZXJhbGwiOiIwLjkifSwidXJuOmVzaWE6c2JqX2lkIjoxMDAwMjk5MjgyLCJleHAiOjE1MjgyODkwNDgsImlhdCI6MTUyODI3ODI0OCwiY2xpZW50X2lkIjoiVEVTVF9TWVMifQ.Ica41\_--BWPq6W0O--mYfA8OzvhPuvousw9Q51YdgDw9gcpF3CwekIUjNTnnehJHQiBwVIm2--EucjzK8ZXOyvmFPHcc0R_Yx6xV6hfL0ehidOrphx--w9--pRuw9vAfsMrAsfvTRzgv6Ek13HpiSr57BLOTUcRqKDsacjVayemQOvzA4CLYmTJbam8wVs93itlz1kv1_G3J--jUV29sMpz--6yc0F_yU0mwXdx90qTkVvZrefGD0q04ISys_d1--9j7z3iytzZ0viJj1EbrVxZXj3vNX6Ov2YekJ0JTk88DPCT8TcHpK_3wWNhQpLATp1iWYtq690UVYtJTLpTFv8uVTbCkpA\",

\"state\":\"c5edcf06--6993--bd32--fc28--12d707388622\",

\"token_type\":\"Bearer\",

\"expires_in\":10800}

Пример состава расширенного маркера доступа (PAYLOAD-часть):

{

\"nbf\": 1528278248,

\"scope\": \"ext_auth_result?oid=1000299282 openid\",

\"iss\": \"http://esia.gosuslugi.ru/\",

\"urn:esia:sid\":
\"41c9853279f2d92ad30ab9b94230359a39250ef7e5a76e083882d60f8ddf1f8c\",

\"urn:esia:sbj_id\": 1000299282,

\"exp\": 1528289048,

\"iat\": 1528278248,

\"client_id\": \"TEST_SYS\"

}

## Использование API Gateway для получения маркера доступа

### Общие принципы

Взаимодействие ИС и сервисов ИЭП может осуществляться через шлюзовой
модуль (API Gateway)[^90], позволяющий выстроить обособленный процесс
интеграции коммерческих организаций с ЕСИА. Для прохождения процедуры
аутентификации и авторизации, а также для вызова методов ИЭП, ИС
коммерческой организации использует шлюз API Gateway, который имеет
полномочия работать от ее имени.

Сценарий аутентификации и авторизации с использованием API Gateway
включает следующие шаги:

-   Система-клиент формирует и отправляет в API Gateway запросы
    на аутентификацию и авторизацию согласно требованиям МР ЕСИА.

-   API Gateway проверяет корректность запросов, полученных на
    предыдущем шаге, и передает их в ЕСИА.

-   ЕСИА идентифицирует запросы от шлюзового модуля и выполняет штатный
    алгоритм проверок, после чего выдает внешний маркер доступа
    системы-клиента с возможностью его использования только в API
    Gateway.

-   API Gateway обменивает внешний маркер доступа на внутренний, который
    дает возможность шлюзовому модулю взаимодействовать с сервисами ИЭП
    от имени системы-клиента, после чего передает внешний маркер
    доступа.

-   Система-клиент с полученным внешним маркером доступа вызывает методы
    прикладного API, зарегистрированного в API Gateway, для дальнейшего
    получения данных.

API Gateway поддерживает обе модели получения маркера доступа ЕСИА:

1)  Контроль доступа на основе делегированного принятия решения
    (authorization code flow)[^91].

2)  Контроль доступа на основе полномочий системы-клиента (client
    credentials flow)[^92].

### Взаимодействие с API Gateway с использованием «client credentials flow»

Для получения маркера доступа система-клиент должна направить по
https-адресу

сервиса API Gateway запрос методом POST. Запрос должен содержать
сведения, указанные в п. Б.3.2, Приложение Б.

После прохождения проверок API Gateway дополняет запрос системы-клиента
параметрами для внутреннего взаимодействия (см. таблицу 100) и
отправляет его в адрес сервиса авторизации ЕСИА.

Если запрос успешно прошел проверку, то ЕСИА возвращает ответ в формате
JSON:

-   \<access_token\> -- маркер доступа для данного ресурса;

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer».

При невозможности выдачи маркера доступа возвращается код ошибки\
(таблица 101).

Таблица 101 -- Список ошибок API Gateway при получении маркера

+---+-----------------------+-----------------------------------------+
| № | Код параметра         | Описание параметра                      |
+===+=======================+=========================================+
| 1 | invalid_request       | ESIA-005002: Некорректная подпись       |
| . |                       | запроса                                 |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 2 | unauthorized_client   | ESIA-007028: Маркер обновления          |
| . |                       | скомпрометирован и отозван              |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 3 | invalid_request       | ESIA-007003: Запрос включает в себя     |
| . |                       | неверное значение параметра \[указать   |
|   |                       | параметр\]                              |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 4 | invalid_request       | ESIA-007014: Запрос не содержит         |
| . |                       | обязательного параметра \[указать       |
|   |                       | параметр\]                              |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 5 | invalid_request       | ESIA-020000: Некорректно указаны        |
| . |                       | параметры запроса                       |
|   |                       |                                         |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 6 | tem                   | ESIA-007008: Сервис авторизации ЕСИА в  |
| . | porarily_unavailable  | настоящее время\                        |
|   |                       | не может выполнить запрос               |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+
| 7 | tem                   | ESIA-007008: Шлюзовой модуль в          |
| . | porarily_unavailable  | настоящее время не может выполнить      |
|   |                       | запрос                                  |
|   |                       |                                         |
+---+-----------------------+-----------------------------------------+

API Gateway выполняет процедуру обмена внешнего маркера доступа
на внутренний, после чего передает ответ от ЕСИА в адрес внешней ИС.

### Взаимодействие с API Gateway с использованием OpenID Connect 1.0

Для аутентификации пользователя система-клиент должна получить
соответствующее разрешение, сформировав запрос в адрес API Gateway,
основываясь на параметрах стандартного режима получения авторизационного
кода (см. п. Б.6.2.1, Б.6.2.2, Приложение Б).

После прохождения проверок API Gateway дополняет запрос системы-клиента
параметрами для внутреннего взаимодействия (см. таблицу 100) и
отправляет его в адрес сервиса авторизации ЕСИА.

Если в ходе аутентификации не возникло ошибок, то ЕСИА осуществляет
перенаправление пользователя по ссылке, указанной в redirect_uri, а
также возвращает два обязательных параметра:

-   \<code\> -- значение авторизационного кода;

-   \<state\> -- значение параметра state, который был получен в
    запросе\
    на аутентификацию; система-клиент должна провести сравнение
    отправленного и полученного параметра state.

В случае ошибки сервис авторизации вернет в параметре *error* код ошибки
(например, «access_denied») и перенаправит пользователя по адресу,
указанному в *redirect_uri*. Перечень возможных ошибок приведен в
таблице 93.

Когда авторизационный код получен система-клиент может сформировать
запрос методом POST на https-адрес API Gateway для получения внешнего
маркера идентификации. В тело запроса должны быть включены параметры
метода «.../te»\
(см. п. Б.6.3, Приложение Б) или «.../v3/te» (см. п. Б.6.4, Приложение
Б) в зависимости от способа интеграции системы-клиента.

После прохождения проверок API Gateway дополняет запрос системы-клиента
параметрами для внутреннего взаимодействия (см. таблицу 100) и
отправляет его в адрес сервиса авторизации ЕСИА.

Если запрос успешно прошел проверку, то ЕСИА возвращает ответ в формате
JSON:

-   \<id_token\> -- маркер идентификации;

-   \<access_token\> -- маркер доступа для данного ресурса (если он
    запрашивался);

-   \<expires_in\> -- время, в течение которого истекает срок действия
    маркера\
    (в секундах);

-   \<state\> -- набор случайных символов, имеющий вид 128-битного
    идентификатора запроса, генерируется по стандарту UUID (совпадает\
    с идентификатором запроса);

-   \<token_type\> -- тип предоставленного маркера, в настоящее время
    ЕСИА поддерживает только значение «Bearer».

При невозможности выдачи маркера идентификации возвращается код ошибки
(см. таблицы 93, 94).

API Gateway выполняет процедуру обмена внешнего маркера доступа
на внутренний, после чего передает ответ от ЕСИА в адрес внешней ИС.

## Использование механизма делегированной авторизации для получения маркера доступа

## Общие принципы

Делегированная авторизация при взаимодействии с ЕСИА представляет собой
идентификацию и аутентификацию пользователя в стороннем приложении без
ввода дополнительных идентификаторов (логина/пароля) посредством
перехвата и делегированного вызова получения авторизационного кода через
мобильное приложение «Госуслуги» или мобильный браузер для
информационных систем, получивших соответсвующее разрешение[^93].

Механизм делегированной авторизации обеспечивает:

-   проверку наличия установленного мобильного приложения «Госуслуги»;

-   формирование запроса на прохождение аутентификации и авторизации;

-   взаимодействие стороннего приложения с платформой выдачи согласий
    и мобильным приложением «Госуслуги».

В общем виде схема взаимодействия выглядит следующим образом:

-   система-клиент запрашивает у владельца ресурса разрешение/согласие
    на доступ к соответствующим ресурсам, формируя запрос делегированной
    авторизации;

-   сервис авторизации осуществляет проверку параметров запроса, а также
    наличие выданных владельцем ресурса разрешений/согласий;

-   владелец ресурса принимает решение о предоставлении системе-клиенту
    доступа к данным, используя интерфейсы мобильного приложения
    «Гослуслуги»;

-   система-клиент получает разрешение на доступ в виде авторизационного
    кода;

-   система-клиент запрашивает маркер доступа, предъявив авторизационный
    код сервису авторизации;

-   сервис авторизации аутентифицирует систему-клиента, проверяет
    авторизационный код и выдает маркер доступа и маркер обновления.

## Получение и обработка делегированного запроса на аутентификацию

Для получения авторизационного кода (разрешение на доступ к ресурсу от
его владельца) система-клиент должна направить запрос аутентификации с
использованием endpoint «.../ac» (см. п. Б.2.2, Приложение Б).
Посредством перехвата мобильным приложением «Госуслуги» выполняется
делегированный вызов внутреннего метода, запускающего цепочку запросов
на предоставление авторизацонного кода системе-клиенту. При отсутствии
установленного на устройстве мобильного приложения «Госуслуги» запрос
аутентификации от системы-клиента будет обработан в мобильном браузере.

Если в ходе аутентификации не возникло ошибок и получены запрашиваемые
разрешения/согласия для доступа к ресурсам, то ЕСИА осуществляет
перенаправление пользователя по ссылке, указанной в redirect_uri, а
также возвращает два обязательных параметров:

-   \<code\> -- значение авторизационного кода;

-   \<state\> -- значение параметра state, который был получен в
    запросе\
    на авторизацию; система-клиент должна провести сравнение
    отправленного\
    и полученного параметра state.

В случае ошибки сервис авторизации вернет в параметре *error* код ошибки
(например, «access_denied») и перенаправит пользователя по адресу,
указанному\
в *redirect_uri*. Перечень возможных ошибок приведен в таблице 93.

Авторизационный код не требуется валидировать на стороне информационных
систем. Состав полей и их значение в коде может изменяться без
уведомлений. Валидация осуществляется на стороне ЕСИА.

Когда авторизационный код получен система-клиент может сформировать
запрос методом POST «.../te» для получения маркера доступа (см. п.
Б.2.4, Приложение Б).

# Виды сведений СМЭВ для работы с учетной записью и данными профиля пользователя ЕСИА

Для управления учетной записью ЕСИА, а также данными, содержащимися\
в профиле пользователя ЕСИА, в СМЭВ реализованы следующие виды сведений:

-   Подтверждение личности гражданина РФ или иностранного гражданина\
    в ЕСИА (ссылка на описание ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/63754af6-ff80-11eb-ba23-33408f10c8dc);

-   Удаление учетной записи в ЕСИА (ссылка на описание ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/63754af7-ff80-11eb-ba23-33408f10c8dc);

-   Поиск учетной записи в ЕСИА (ссылка на описание ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/63754af8-ff80-11eb-ba23-33408f10c8dc);

-   Поиск страхового номера индивидуального лицевого счёта (СНИЛС)\
    по данным, удостоверяющим личность (ссылка на описание ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/85c8c097-048e-4d97-90b2-d301cf33036b);

-   Восстановление доступа к подтвержденной учетной записи в ЕСИА с
    выдачей пароля для входа (ссылка на описание ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/63754af9-ff80-11eb-ba23-33408f10c8dc);

-   Регистрация подтвержденной учетной записи в ЕСИА с отправкой пароля\
    для первого входа в систему на контактные данные (ссылка на описание
    ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/63754afa-ff80-11eb-ba23-33408f10c8dc);

-   Подтверждение учетной записи в ЕСИА, созданной на основе
    существующей упрощенной (ссылка на описание ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/63754afb-ff80-11eb-ba23-33408f10c8dc);

-   Регистрация информации о ребенке в ЕСИА (ссылка на описание ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/63754afd-ff80-11eb-ba23-33408f10c8dc);

-   Изменение паспортных данных пользователя в ЕСИА (ссылка на описание
    ВС:
    https://lkuv.gosuslugi.ru/paip-portal/#/inquiries/card/636e6cf2-ff80-11eb-ba23-33408f10c8dc).

Детальная информация по каждому вышеперечисленному виду сведений,
критерии доступа и актуальная версия вида сведений для тестовой и
продуктовой сред размещены\
на портале ЕСКС по соответствующему URL-адресу.

## Рекомендации по взаимодействию с видами сведений в СМЭВ 3.X

Пользователи (клиенты ЦО), которые обращаются за государственными
услугами или за услугой регистрации на портале госуслуг, могут не
помнить о наличии у них УЗ и ее статус. Одной из причин может являться
редкое использование портала. Для правильного использования вида
сведений ЕСИА операторами выдачи простой электронной подписи\
и уменьшения путаницы со стороны пользователя рекомендуется использовать
алгоритм, представленный на рисунке 11. Кроме рекомендуемого алгоритма
необходимо придерживаться следующих правил работы с видом сведений:

-   Для начала обслуживания пользователя в ЦО необходимо запросить\
    и проверить его паспорт (и при необходимости СНИЛС). Данные\
    при регистрации в ЕСИА необходимо передавать в соответствии с
    оригиналом документа, полученного от пользователя, для минимизации
    ошибок\
    при прохождении проверок данных пользователя в БГИР.

-   Перед применением ВС[^94] Register, RegisterBySimplified, Confirm,
    Recover, DeleteAccount необходимо применять ВС FindAccount для того,
    чтобы найти все УЗ, удовлетворяющие входным параметрам, и выбрать
    конкретную УЗ\
    для продолжения работы с ней.

-   После выбора конкретной УЗ из списка найденных необходимо запросить
    подтверждение у пользователя, нужная ли УЗ была выбрана, в
    соответствии\
    с типом УЗ, данными, по которым она была найдена, и датой ее
    регистрации. Это необходимо, потому что на основании данных
    пользователя может быть создано несколько УЗ, например:

-   На данные пользователя создано несколько УЗ (включая
    подтвержденную), при этом пользователь пользуется одной из них.\
    В данном случае необходимо уточнить у пользователя, какой УЗ он
    хотел бы продолжать пользоваться (сравнив данные, по которым они
    найдены). Если была выбрана подтвержденная УЗ, то необходимо
    применить ВС Recover. В случае, если была выбрана упрощенная УЗ, то
    необходимо применить ВС DeleteAccount для подтвержденной УЗ\
    и RegisterBySimplyfied -- для выбранной упрощенной УЗ.

-   На данные пользователя создано несколько УЗ, при этом пользователь
    обратился для создания новой УЗ. В данном случае необходимо уточнить
    у пользователя, принадлежат ли ему найденные УЗ (сравнив данные,\
    по которым они найдены). Если была выбрана одна из найденных УЗ,
    то необходимо применить к ней ВС RegisterBySimplified, Recover,
    Confirm (в зависимости от типа выбранной УЗ). Если пользователь\
    не регистрировал ранее УЗ, то необходимо вместо регистрации новой УЗ
    восстановить пароль к уже существующей УЗ, используя данные
    пользователя.

В том случае, если потребности операторов ЦО выходят за рамки данного
алгоритма, разработчикам ПО для ЦО необходимо будет самостоятельно
скомбинировать ВС требуемым образом.

![](media/image11.png){width="6.404769247594051in"
height="2.9121981627296587in"}

Рисунок 11 -- Рекомендуемый алгоритм использования видов сведений

# Нерекомендуемые к дальнейшему использованию функциональные возможности ЕСИА

## Общие сведения

В результате развития некоторые функциональные возможности ЕСИА
сохраняются исключительно в целях обеспечения обратной совместимости.

Разработчикам ранее интегрированных ИС с ЕСИА рекомендуется отказаться\
от их использования.

Разработчикам вновь интегрируемых ИС с ЕСИА рекомендуется использовать
актуальные функциональные возможности ЕСИА.

## Устаревшие утверждения SAML

Таблица 102 -- Перечень атрибутов, поддержка которых в будущем будет
прекращена

+---+-----------+---------------------------+-------------------------+
| * | **        | **Описание**              | **Примечание**          |
| * | Атрибут** |                           |                         |
| № |           |                           |                         |
| * |           |                           |                         |
| * |           |                           |                         |
+===+===========+===========================+=========================+
| 1 | assur     | Уровень достоверности     | Рекомендуется           |
| . | anceLevel | идентификации             | использовать атрибуты:  |
|   |           | пользователя. Возможны    |                         |
|   |           | следующие значения:       | -   personTrusted --    |
|   |           |                           |     для определения     |
|   |           | -   AL10 -- упрощенная    |     подтвержденных УЗ;  |
|   |           |     (непроверенная) УЗ;   |                         |
|   |           |                           | -   authnMethod -- для  |
|   |           | -   AL15 -- стандартная   |     определения метода  |
|   |           |     (проверенная) УЗ;     |     аутентификации      |
|   |           |                           |                         |
|   |           | -   AL20 --               |                         |
|   |           |     подтвержденная УЗ;    |                         |
|   |           |                           |                         |
|   |           | -   AL30 --               |                         |
|   |           |     подтвержденная УЗ     |                         |
|   |           |     (аутентификация по    |                         |
|   |           |     КЭП)                  |                         |
+---+-----------+---------------------------+-------------------------+
| 2 | atta      | Признак включенности      | Необходимо использовать |
| . | chedToOrg | (присоединения) к         | globalRole              |
|   |           | организации               |                         |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+
| 3 | inn       | ИНН пользователя          | Необходимо использовать |
| . |           |                           | personINN               |
|   |           |                           |                         |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+
| 4 | name      | Имя пользователя          | Необходимо использовать |
| . |           |                           | lastName / firstName /  |
|   |           |                           | middleName              |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+
| 5 | nsiId     | Мнемоника ОГВ             | Необходимо использовать |
| . |           |                           | orgOGRN и orgType       |
|   |           |                           |                         |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+
| 6 | p         | Категория пользователя.   | Необходимо использовать |
| . | ersonType |                           | personCitizenship       |
|   |           | Принимает следующие       |                         |
|   |           | возможные значения:       |                         |
|   |           |                           |                         |
|   |           | -   R -- гражданин РФ     |                         |
|   |           |     (Russian);            |                         |
|   |           |                           |                         |
|   |           | -   F -- иностранный      |                         |
|   |           |     гражданин             |                         |
|   |           |     (Foreigner).          |                         |
+---+-----------+---------------------------+-------------------------+
| 7 | snils     | СНИЛС пользователя        | Необходимо использовать |
| . |           |                           | personSNILS             |
|   |           |                           |                         |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+
| 8 | userType  | Тип пользователя          | Необходимо использовать |
| . |           |                           | globalRole              |
|   |           |                           |                         |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+
| 9 | userName  | Логин пользователя        | Необходимо использовать |
| . |           |                           | userId, personSNILS     |
|   |           |                           |                         |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+

## Устаревшие параметры сервиса регистрации

Таблица 103 -- Перечень атрибутов, поддержка которых в будущем будет
прекращена

+---+-----------+---------------------------+-------------------------+
| * | **        | **Описание**              | **Примечание**          |
| * | Атрибут** |                           |                         |
| № |           |                           |                         |
| * |           |                           |                         |
| * |           |                           |                         |
+===+===========+===========================+=========================+
| 1 | mode      | Способ доставки пароля    | Значение параметра      |
| . |           | для первого входа в       | direct выведено из      |
|   |           | систему                   | эксплуатации 30.10.16   |
|   |           |                           |                         |
+---+-----------+---------------------------+-------------------------+

## Устаревшие области доступа (scope)

Таблица 104 -- Перечень областей доступа (scope), поддержка которых в
будущем будет прекращена

+---+------------+------------------------------+---------------------+
| * | **Название | **Название набора данных**   | **Примечание**      |
| * | области    |                              |                     |
| № | доступа    |                              |                     |
| * | (scope)**  |                              |                     |
| * |            |                              |                     |
+===+============+==============================+=====================+
| 1 | usr_inf    | Просмотр всех персональных   | Выведено из         |
| . |            | данных                       | эксплуатации        |
|   |            |                              | 14.07.17            |
|   |            | о пользователе               |                     |
+---+------------+------------------------------+---------------------+
| 2 | org_inf    | Просмотр всех данных         | Выведено из         |
| . |            | об организации «{Название}»  | эксплуатации        |
|   |            | и ее сотрудниках.            | 14.07.17            |
|   |            |                              |                     |
+---+------------+------------------------------+---------------------+
| 3 | usr_brf    | Просмотр данных              | Выведено из         |
| . |            | о пользователе.              | эксплуатации        |
|   |            |                              | 14.07.17            |
|   |            |                              |                     |
+---+------------+------------------------------+---------------------+
| 4 | org_ful    | Полный доступ ко всем данным | Выведено из         |
| . |            | организации «{Название}»     | эксплуатации        |
|   |            | и ее сотрудников             | 14.07.17            |
|   |            |                              |                     |
+---+------------+------------------------------+---------------------+
| 5 | sbj_inf    | Просмотр данных о субъекте.  | Выведено из         |
| . |            |                              | эксплуатации        |
|   |            |                              | 14.07.17            |
|   |            |                              |                     |
+---+------------+------------------------------+---------------------+
| 6 | contacts   | Просмотр данных о контактах  |                     |
| . |            | и адресах                    |                     |
|   |            |                              |                     |
|   |            |                              |                     |
+---+------------+------------------------------+---------------------+

## Устаревший импорт УЗ

Версия импорта УЗ, описанная в данном разделе, существует для обратной
совместимости интегрированных ИС и не включает в себя функцию
подтверждения упрощенных УЗ. Данная версия не будет дорабатываться в
целях реализации новых функциональных возможностей.

Актуальная версия метода импорта учетных записей пользователей описана\
в п. А.9, Приложение А.

Программный интерфейс, основанный на архитектурном стиле REST, в целях
обеспечения импорта в ЕСИА учетных записей других ИС, обеспечивает
возможность проверки наличия учетной записи пользователя, а в случае ее
отсутствия, регистрации пользователя в ЕСИА. Алгоритм, по которому
производится импорт учетной записи, приводится на рисунке ниже (см.
рисунок 12).

![](media/image12.tiff){width="3.629166666666667in"
height="8.681010498687664in"}

Рисунок 12 -- Алгоритм устаревшего импорта УЗ в ЕСИА

Для импорта УЗ система-клиент должна направить в https-адрес REST API
системы ЕСИА запрос методом POST. В запросе должен быть указан ресурс
/import.

В запросе на импорт УЗ передаются следующие данные пользователя,
приведенные в таблице 105.

Таблица 105 -- Передаваемые данные пользователя

+-----+---------------+------------+-------------+--------------------+
| **  | *             | **Описание | **Обя       | **Примечания**     |
| №** | *Наименование | п          | зательность |                    |
|     | параметра**   | араметра** | параметра** |                    |
+=====+===============+============+=============+====================+
| 1   | firstName     | Имя        | Y           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 2   | lastName      | Фамилия    | Y           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 3   | middleName    | Отчество   | Y           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов.          |
|     |               |            |             | Необязательно в    |
|     |               |            |             | случае,\           |
|     |               |            |             | если отчество      |
|     |               |            |             | отсутствует\       |
|     |               |            |             | в паспорте         |
+-----+---------------+------------+-------------+--------------------+
| 4   | birthDate     | Дата       | Y           | Формат: ДД.ММ.ГГГГ |
| .   |               | рождения   |             |                    |
+-----+---------------+------------+-------------+--------------------+
| 5   | birthPlace    | Место      | N           | Текстовая строка,  |
| .   |               | рождения   |             | содержащая         |
|     |               |            |             | не более 700       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 6   | citizenship   | Г          | N/Y         | Используется       |
| .   |               | ражданство |             | трехбуквенный код  |
|     |               | по         |             | страны, например,\ |
|     |               | клас       |             | для России он      |
|     |               | сификатору |             | должен принимать   |
|     |               | ОКСМ       |             | значение RUS.      |
|     |               |            |             |                    |
|     |               |            |             | По умолчанию       |
|     |               |            |             | принимается        |
|     |               |            |             | значение «RUS».    |
|     |               |            |             |                    |
|     |               |            |             | Обязателен в       |
|     |               |            |             | случае,\           |
|     |               |            |             | если указанный     |
|     |               |            |             | документ отличен   |
|     |               |            |             | от паспорта РФ     |
+-----+---------------+------------+-------------+--------------------+
| 7   | gender        | Пол        | Y           | Перечень           |
| .   |               |            |             | допустимых         |
|     |               |            |             | значений:          |
|     |               |            |             |                    |
|     |               |            |             | -   «M» --         |
|     |               |            |             |     мужской;       |
|     |               |            |             |                    |
|     |               |            |             | -   «F» -- женский |
+-----+---------------+------------+-------------+--------------------+
| 8   | snils         | СНИЛС      | Y           | Формат:            |
| .   |               |            |             | «ХХХ--ХХХ--ХХХ ХХ» |
+-----+---------------+------------+-------------+--------------------+
| 9   | контакт       |            | Y           |                    |
| .   |               |            |             |                    |
+-----+---------------+------------+-------------+--------------------+
| 1   | type          | Тип        | Y           | Перечень           |
| .   |               | контакта   |             | допустимых         |
|     |               |            |             | значений:          |
|     |               |            |             |                    |
|     |               |            |             | -   «MBT» --       |
|     |               |            |             |     мобильный      |
|     |               |            |             |     телефон        |
|     |               |            |             |     (обязательный  |
|     |               |            |             |     параметр);     |
|     |               |            |             |                    |
|     |               |            |             | -   «EML» --       |
|     |               |            |             |     электронная    |
|     |               |            |             |     почта          |
|     |               |            |             |                    |
|     |               |            |             |    (необязательный |
|     |               |            |             |     параметр)      |
+-----+---------------+------------+-------------+--------------------+
| 1   | value         | Значение   | Y           | Формат:            |
| .   |               |            |             |                    |
|     |               |            |             | «+X(XXX)XXXXXXX»\  |
|     |               |            |             | (для type =        |
|     |               |            |             | «MBT»);            |
|     |               |            |             |                    |
|     |               |            |             | текстовая строка в |
|     |               |            |             | формате адреса     |
|     |               |            |             | электронной почты  |
|     |               |            |             | (для type = «EML») |
+-----+---------------+------------+-------------+--------------------+
| 1   | документ      |            | Y           |                    |
| 0.  |               |            |             |                    |
+-----+---------------+------------+-------------+--------------------+
| 1   | type          | Тип        | Y           | Перечень           |
| .   |               | документа  |             | допустимых         |
|     |               |            |             | значений:          |
|     |               |            |             |                    |
|     |               |            |             | -   «RF_PASSPORT»  |
|     |               |            |             |     -- паспорт     |
|     |               |            |             |     гражданина РФ; |
|     |               |            |             |                    |
|     |               |            |             | -   «FID_DOC» --   |
|     |               |            |             |     документ       |
|     |               |            |             |     иностранного   |
|     |               |            |             |     гражданина,    |
|     |               |            |             |     удостоверяющий |
|     |               |            |             |     личность на    |
|     |               |            |             |     территории РФ; |
|     |               |            |             |                    |
|     |               |            |             | -   «FRGN_PASS» -- |
|     |               |            |             |     заграничный    |
|     |               |            |             |     паспорт        |
|     |               |            |             |     гражданина РФ  |
+-----+---------------+------------+-------------+--------------------+
| 1   | series        | серия      | Y/N         | Для паспорта       |
| .   |               |            |             | гражданина РФ      |
|     |               |            |             | в формате XXXX.    |
|     |               |            |             |                    |
|     |               |            |             | Для заграничного   |
|     |               |            |             | паспорта           |
|     |               |            |             | гражданина РФ в    |
|     |               |            |             | формате XX.        |
|     |               |            |             |                    |
|     |               |            |             | Необязательный для |
|     |               |            |             | документа          |
|     |               |            |             | иностранного       |
|     |               |            |             | гражданина         |
+-----+---------------+------------+-------------+--------------------+
| 2   | number        | номер      | Y           | Для паспорта       |
| .   |               |            |             | гражданина РФ      |
|     |               |            |             | в формате XXXXXX.  |
|     |               |            |             |                    |
|     |               |            |             | Для заграничного   |
|     |               |            |             | паспорта           |
|     |               |            |             | гражданина РФ в    |
|     |               |            |             | формате XXXXXXX    |
+-----+---------------+------------+-------------+--------------------+
| 3   | latinLastName | Фамилия    | Y/N         | Только для         |
| .   |               | (          |             | заграничного       |
|     |               | латиницей) |             | паспорта           |
|     |               |            |             | гражданина РФ      |
+-----+---------------+------------+-------------+--------------------+
| 4   | l             | Имя        | Y/N         | Только для         |
| .   | atinFirstName | (          |             | заграничного       |
|     |               | латиницей) |             | паспорта           |
|     |               |            |             | гражданина РФ      |
+-----+---------------+------------+-------------+--------------------+
| 5   | issueId       | Номер      | Y/N         | Только для         |
| .   |               | подр       |             | паспорта           |
|     |               | азделения, |             | гражданина РФ.     |
|     |               | выдавшего  |             |                    |
|     |               | паспорт    |             | Необязательный\    |
|     |               |            |             | для документа      |
|     |               |            |             | иностранного       |
|     |               |            |             | гражданина         |
|     |               |            |             | и заграничного     |
|     |               |            |             | паспорта           |
|     |               |            |             | гражданина РФ      |
+-----+---------------+------------+-------------+--------------------+
| 6   | issuedBy      | На         | Y/N         | Только для         |
| .   |               | именование |             | паспорта           |
|     |               | подр       |             | гражданина РФ.     |
|     |               | азделения, |             |                    |
|     |               | выдавшего  |             | Необязательно для  |
|     |               | паспорт    |             | документа          |
|     |               |            |             | иностранного       |
|     |               |            |             | гражданина         |
|     |               |            |             | и заграничного     |
|     |               |            |             | паспорта           |
|     |               |            |             | гражданина РФ      |
+-----+---------------+------------+-------------+--------------------+
| 7   | issueDate     | Дата       | Y           | Формат: ДД.ММ.ГГГГ |
| .   |               | выдачи     |             |                    |
|     |               | паспорта   |             |                    |
+-----+---------------+------------+-------------+--------------------+
| 8   | expireDate    | Дата       | Y/N         | Только для         |
| .   |               | окончания  |             | заграничного       |
|     |               | срока      |             | паспорта           |
|     |               | действия   |             | гражданина РФ.     |
|     |               | документа  |             |                    |
|     |               |            |             | Формат: ДД.ММ.ГГГГ |
+-----+---------------+------------+-------------+--------------------+
| 1   | адрес         |            | N           |                    |
| 1.  |               |            |             |                    |
+-----+---------------+------------+-------------+--------------------+
| 1   | type          | Тип адреса | Y           | Перечень           |
| .   |               |            |             | допустимых         |
|     |               |            |             | значений:          |
|     |               |            |             |                    |
|     |               |            |             | -   «PLV» -- адрес |
|     |               |            |             |     проживания;    |
|     |               |            |             |                    |
|     |               |            |             | -   «PRG» -- адрес |
|     |               |            |             |     регистрации    |
+-----+---------------+------------+-------------+--------------------+
| 1   | addressStr    | Адресная   | Y           | Текстовая строка,  |
| .   |               | строка     |             | содержащая         |
|     |               |            |             | элементы адреса    |
|     |               |            |             | (перечисляются\    |
|     |               |            |             | через разделитель  |
|     |               |            |             | «,», не более 2000 |
|     |               |            |             | символов)          |
+-----+---------------+------------+-------------+--------------------+
| 2   | countryId     | Тре        | N           | В формате XXX      |
| .   |               | хбуквенный |             |                    |
|     |               | код страны |             |                    |
+-----+---------------+------------+-------------+--------------------+
| 3   | zipCode       | Индекс     | N           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 4   | region        | Область    | N           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 5   | area          | Район      | N           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 6   | city          | Город      | N           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 7   | district      | Округ      | N           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 8   | settlement    | Населенный | N           | Текстовая строка,  |
| .   |               | пункт      |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 9   | street        | Улица      | N           | Текстовая строка,  |
| .   |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 1   | additionArea  | Уточнение\ | N           | Текстовая строка,  |
| 0.  |               | по региону |             | содержащая         |
|     |               | проживания |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 1   | addit         | Уточнение\ | N           | Текстовая строка,  |
| 1.  | ionAreaStreet | по улице   |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 1   | house         | Дом        | N           | Текстовая строка,  |
| 2.  |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 1   | building      | Строение   | N           | Текстовая строка,  |
| 3.  |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 1   | frame         | Корпус     | N           | Текстовая строка,  |
| 4.  |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 1   | flat          | Квартира   | N           | Текстовая строка,  |
| 5.  |               |            |             | содержащая         |
|     |               |            |             | не более 256       |
|     |               |            |             | символов           |
+-----+---------------+------------+-------------+--------------------+
| 1   | fiasCode      | Код ФИАС   | N           | Формат:            |
| 6.  |               |            |             | «ХХХХХ             |
|     |               |            |             | ХХХ--ХХХХ--ХХХХ--Х |
|     |               |            |             | ХХХ--ХХХХХХХХХХХХ» |
+-----+---------------+------------+-------------+--------------------+

В запрос должен быть добавлен header (Authorization: Bearer) с ранее
полученным маркером доступа, выданный на специальную область доступа
(scope) -- (http://esia.gosuslugi.ru/ext_imp), позволяющий осуществлять
автоматический импорт УЗ пользователя. Данный маркер выдается только
доверенным системам, имеющим право импорта пользователей таким образом;
выдача маркера осуществляется в рамках модели контроля доступа на основе
полномочий системы-клиента (см. п. Б.3, Приложение Б), т.е. право на
запрос такого маркера доступа устанавливается оператором эксплуатации
ЕСИА.

Так же запрос должен быть подписан электронной подписью системы, которая
импортирует УЗ в ЕСИА (Request-Data-Sign), и содержать тело запроса,
закодированное в формате base64 url safe (Request-Data).

Пример запроса (вызов сервиса в среде разработки):

POST https://esia.gosuslugi.ru/rs/prns/import HTTP/1.1

Accept--Encoding: gzip,deflate

Content--Type: application/json

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6MX0.eyJleHAiOjE0NjEyMzI0MDUsInNjb3BlIjoiaHR0cDpcL1wvZXNpYS5nb3N1c2x1Z2kucnVcL2V4dF9pbXAiLCJpc3MiOiJodHRwOlwvXC9lc2lhLmdvc3VzbHVnaS5ydVwvIiwidXJuOmVzaWE6c2lkIjoiZDdkNGYzZWYtZjNlOS00MWVhLTliODUtY2MyODA3MTQzOWUyIiwidXJuOmVzaWE6c2JqX2lkIjoxMDAwMDAwMDAyLCJjbGllbnRfaWQiOiJURVNUX1NZU1RFTV9JTVBPUlQiLCJpYXQiOjE0NjExNDYwMDV9.Kw--Kxh7ckYU_5xWTiUGdVn3rkFSp6TtfopivPfXnvgyPcqRmmPDsqjR_tJyhLED8w8iV6hjk2euchvi4aXxY1m_r716EXSDiAae2WUd0rrGEb--SKIH5hXEBRwBIOTPlq--xA--Q3Lc--717yt6SAZAJtvUKKzaryYWDi--r9wYZuR5kN2XQ8i75n85HhP1KcnERWQjT8DfQXEoaHP6rBqc9YECxtIiUFjZADk1jN1u6Ojq9kGEffRoGyPF7VGNMfUjR469E0d1I3MLdlmSh8MdHW_mePoR19EguQPUtHwrtEALpyFLiiqvBwlnX4UQvZ7DWO1wfbwT16pNHfoY2FdUA5Jw

Request--Data--Sign:
MIAGCSqGSIb3DQEHAqCAMIACAQExDzANBglghkgBZQMEAgEFADCABgkqhkiG9w0BBwEAAKCAMIIDJTCCAg0CBFhKg5UwDQYJKoZIhvcNAQELBQAwVzELMAkGA1UEBhMCUlUxDzANBgNVBAgMBk1vc2NvdzENMAsGA1UECgwEVGVzdDENMAsGA1UECwwEVGVzdDEZMBcGA1UEAwwQVGVzdCBSZXN0IFN5c3RlbTAeFw0xNjEyMDkxMDEyMzdaFw0xNzEyMDkxMDEyMzdaMFcxCzAJBgNVBAYTAlJVMQ8wDQYDVQQIDAZNb3Njb3cxDTALBgNVBAoMBFRlc3QxDTALBgNVBAsMBFRlc3QxGTAXBgNVBAMMEFRlc3QgUmVzdCBTeXN0ZW0wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCByEsM2_R1BrtltyJ15AwCW_tChh2euZC3FEqWDY6TFAlVyy9yO4qM_5P1WruplhA9dCCbft5JFsz4n_nE7lMMRaI34tqTyyo24xzX_VrhgTIi05mt1Y5dbldfEiPVNT3aUCjFlbFzDXoUbc8nfQizkPa_CHGO0MBhuVuQWOVzw3FufAlExDjNPUoRRvaYoBWOK_3SnyS7_88xJn--\_yQQVwu0TQkSuqpOsylfBM--Wq10U5x4bJ2NSeL71AzZjCL_mh1daQTQxEwBlVLuMlc5srMyw_QHQ1McsNrqrnx3zhFFNLS5Sk_LrSxqxOsC4sgBw1oudVayUUvGbqe_nxu7P3AgMBAAEwDQYJKoZIhvcNAQELBQADggEBABxK0C1NjQMyvtJvZNRyM21GwQOklaBZuqRErJmpLAR7auYLbZnwEdt1I8KEJBQW6pTb99rnQs--T--qZiChh0PYlbCxXGeVCXk5dJWSiGE_SdrjWvSOH83iUA2Lv8Pi3NlVW2GcNOlFySlzE9HvGYJTIr5I_X--dw64--2NYETLIYPQ7HWwAEwy09ucL9LMjGKYBe5FrwiulAyD20--lnIpYtXdLSpflKangPlPd1xmxEBXMQUmoKg7dTE--q2gYfZLNUKsAezrattHGHTPRnqwWQHmwly_rXXodlgcNxeilT_dvc0o_JfkNmqGCc09RXSx1BWSWGynLeBBjYMy9VN8XYQpQAADGCAfUwggHxAgEBMF8wVzELMAkGA1UEBhMCUlUxDzANBgNVBAgMBk1vc2NvdzENMAsGA1UECgwEVGVzdDENMAsGA1UECwwEVGVzdDEZMBcGA1UEAwwQVGVzdCBSZXN0IFN5c3RlbQIEWEqDlTANBglghkgBZQMEAgEFAKBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTE3MDYyMDE1NTA1NVowLwYJKoZIhvcNAQkEMSIEIOpwKJnoLommyNRoKDDlWVsWuBdYfowQ4byOiN--gSPe2MA0GCSqGSIb3DQEBAQUABIIBADlNWxdZeqGBq8_4WqRs9H4SLde_Sukc1AG6hNj1cbTqxzthzzm1n_JQEZOTYaP9bQdTEhOvKZXxFXC_JjPBMQauZPJc1eOR5DDB_7X4MAgGpMQbhpTQz3Sg7acJuJdWuYxL92BDk4qyzuwgJdQJplVJickBvC78XeJVo1w4_jx5CVEn3pUIPdKxib6da0evB6CsxD98JcsvWZ3u--H3LQ0_ApUOUHeF84r3AZ5mtILYj2w6o8rMAmsTDe7CAUXvDUAp9o5cTPk57rDNaW96d5J3SUtmZdx2nGBS41kJYWJNDiqyfHJ7X4nZVOS0glbT_JnaXtxrZTWp9BJo6NKJaagQAAAAAAAA

Request--Data:
ew0KICAiZmlyc3ROYW1lIjoiw5DCmMOQwrLDkMKww5DCvcOQwr7DkMKyIiwNCiAgImxhc3ROYW1lIjoiw5DCmMOQwrLDkMKww5DCvSIsDQogICJtaWRkbGVOYW1lIjoiw5DCmMOQwrLDkMKww5DCvcOQwr7DkMKyw5DCuMORwociLA0KICAiYmlydGhEYXRlIjoiMDEuMDEuMTk5OSIsDQogICJiaXJ0aFBsYWNlIjoiw5DCnMOQwr7DkcKBw5DCusOQwrLDkMKwIiwNCiAgImdlbmRlciI6Ik0iLA0KICAic25pbHMiOiIwMDAtMDAwLTAwMCAwNyIsDQogICJjb250YWN0cyI6IHsNCiAgICAiZWxlbWVudHMiOiBbDQogICAgICB7DQogICAgICAgICJ0eXBlIjogIk1CVCIsDQogICAgICAgICJ2YWx1ZSI6ICIrNyg5OTkpOTk5OTk5OSINCiAgICAgIH0sDQogICAgICB7DQogICAgICAgICJ0eXBlIjogIkVNTCIsDQogICAgICAgICJ2YWx1ZSI6ICJ0ZXN0QHRlc3QudHMiDQogICAgICB9DQogICAgXQ0KICB9LA0KICAiZG9jdW1lbnRzIjogew0KICAgICJlbGVtZW50cyI6IFsNCiAgICAgIHsNCiAgICAgICAgInR5cGUiOiJSRl9QQVNTUE9SVCIsDQogICAgICAgICJzZXJpZXMiOiIyMjIyIiwNCiAgICAgICAgIm51bWJlciI6Ijg4OTk5OSIsDQogICAgICAgICJpc3N1ZUlkIjoiMTExMDAxIiwNCiAgICAgICAgImlzc3VlZEJ5Ijoiw5DCoMOQwqPDkMKSw5DClCDDkMKzLsOQwpzDkMK--w5HCgcOQwrrDkMKyw5HCiyIsDQogICAgICAgICJpc3N1ZURhdGUiOiIxOC4wMy4yMDE2Ig0KICAgICAgfQ0KICAgIF0NCiAgfSwNCiAgImFkZHJlc3NlcyI6ew0KICAgICJlbGVtZW50cyI6IFsNCiAgICAgIHsNCiAgICAgICJ0eXBlIjogIlBMViIsDQogICAgICAiYWRkcmVzc1N0ciI6IsOQwprDkMK1w5DCvMOQwrXDkcKAw5DCvsOQwrLDkcKBw5DCusOQwrDDkcKPIMOQwp7DkMKxw5DCu8OQwrDDkcKBw5HCgsORwowsIMOQwqLDkMKww5HCiMORwoLDkMKww5DCs8OQwr7DkMK7w5HCjMORwoHDkMK6w5DCuMOQwrkgw5DCoMOQwrDDkMK5w5DCvsOQwr0sIMOQwqjDkMK1w5HCgMOQwrXDkMKzw5DCtcORwoggw5DCn8OQwr7DkcKBw5DCtcOQwrvDkMK--w5DCuiDDkMKzw5DCvsORwoDDkMK--w5DCtMORwoHDkMK6w5DCvsOQwrPDkMK--ICAgICDDkcKCw5DCuMOQwr_DkMKwIiwNCiAgICAgICJjb3VudHJ5SWQiOiAiUlVTIiwNCiAgICAgICJ6aXBDb2RlIjogIjM5NDAwMCIsDQogICAgICAicmVnaW9uIjogIsOQwprDkMK1w5DCvMOQwrXDkcKAw5DCvsOQwrLDkcKBw5DCusOQwrDDkcKPIMOQwp7DkMKxw5DCu8OQwrDDkcKBw5HCgsORwowiLA0KICAgICAgImFyZWEiOiAiw5DCosOQwrDDkcKIw5HCgsOQwrDDkMKzw5DCvsOQwrvDkcKMw5HCgcOQwrrDkMK4w5DCuSDDkMKgw5DCsMOQwrnDkMK--w5DCvSIsDQogICAgICAiY2l0eSI6ICLDkMKow5DCtcORwoDDkMK1w5DCs8OQwrXDkcKIIMOQwp_DkMK--w5HCgcOQwrXDkMK7w5DCvsOQwrogw5DCs8OQwr7DkcKAw5DCvsOQwrTDkcKBw5DCusOQwr7DkMKzw5DCviDDkcKCw5DCuMOQwr_DkMKwIiwNCiAgICAgICJkaXN0cmljdCI6ICLDkMK9w5DCtcORwoIiLA0KICAgICAgInNldHRsZW1lbnQiOiAiw5DCo8ORwoHDkcKCw5HCjC3DkMKQw5DCvcOQwrfDkMKww5HCgSDDkMKfw5DCvsORwoHDkMK1w5DCu8OQwr7DkMK6IiwNCiAgICAgICJzdHJlZXQiOiAiw5DCocOQwr7DkMKyw5DCtcORwoLDkcKBw5DCusOQwrDDkcKPIMOQwqPDkMK7w5DCuMORwobDkMKwIiwNCiAgICAgICJhZGRpdGlvbkFyZWEiOiAiw5DCoMOQwrXDkMKzw5DCuMOQwr7DkMK9IMOQwqHDkMKww5DCtMOQwr7DkMKyw5DCvsOQwrUgw5DCvcOQwrXDkMK6w5DCvsOQwrwtw5DCtSDDkcKCw5DCvsOQwrLDkMKww5HCgMOQwrjDkcKJw5DCtcORwoHDkcKCw5DCssOQwr4iLA0KICAgICAgImFkZGl0aW9uQXJlYVN0cmVldCI6ICLDkMKiw5DCtcORwoHDkcKCIiwNCiAgICAgICJob3VzZSI6ICI4Ni8xIiwNCiAgICAgICJidWlsZGluZyI6ICJlIiwNCiAgICAgICJmcmFtZSI6ICIyMDTDkcKDIiwNCiAgICAgICJmbGF0IjogIsOQwr_DkMK--w5DCvC40MTkiLA0KICAgICAgImZpYXNDb2RlIjogIjc3LTAtMDAwLTAwMC0wMDAtMDAwLTQyMzYtMDAwMC0wMDAiDQoNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIF0NCiAgfQ0KfQ

Cache--Control: no--cache

Content--Length: 1476

Host: esia-portal1.test.gosulsugi.ru

Connection: Keep--Alive

User--Agent: Apache--HttpClient/4.1.1 (java 1.5)

 

{

  \"firstName\":\"Иванов\",

  \"lastName\":\"Иван\",

  \"middleName\":\"Иванович\",

  \"birthDate\":\"01.01.1999\",

\"birthPlace\":\"Москва\",

 \"gender\":\"M\",

  \"snils\":\"000--000--000 07\",

  \"contacts\": {

    \"elements\": \[

      {

        \"type\": \"MBT\",

        \"value\": \"+7(999)9999999\"

      },

      {

        \"type\": \"EML\",

        \"value\": \"test@test.ts\"

      }

    \]

  },

  \"documents\": {

    \"elements\": \[

      {

        \"type\":\"RF_PASSPORT\",

        \"series\":\"2222\",

        \"number\":\"889999\",

        \"issueId\":\"111001\",

        \"issuedBy\":\"РУВД г.Москвы\",

        \"issueDate\":\"18.03.2016\"

      }

    \]

  },

  \"addresses\":{

    \"elements\": \[

      {\
      \"type\": \"PLV\",

       \"addressStr\":\" Кемеровская область, Таштагольский район,
Шерегеш поселок городского

типа, Усть--Анзас поселок, Советская улица\",

       \"countryId\": \"RUS\",

       \"zipCode\": \"652975\",

       \"region\": \"Кемеровская Область\",

       \"area\": \"Таштагольский Район\",

       \"city\": \"Шерегеш Поселок городского типа\",

      \"settlement\": \"Усть--Анзас Поселок\",

       \"house\": \"Дом 19\",

       \"fiasCode\": \"b6fbb398--97ee--4e12--a1d3--450184d23f27\"

        }

    \]

  }

}

По полученным данным в ЕСИА выполняется поиск УЗ. В зависимости от того,
найдена в ЕСИА УЗ, удовлетворяющая полученным данным или нет, операция
импорта может завершиться одним из следующих результатов:

-   пользователь уже зарегистрирован в ЕСИА (подтвержденная УЗ найдена
    по СНИЛС, данные паспорта и телефона совпадают);

-   некоторые атрибуты не совпадают (УЗ найдена по СНИЛС, но не все
    атрибуты совпадают, либо найдена упрощенная УЗ по мобильному
    телефону);

-   пользователь ЕСИА успешно подтвержден (найдена стандартная или
    готовая к подтверждению УЗ по СНИЛС, данные паспорта и телефона
    совпадают, найденная УЗ успешно подтверждена);

-   пользователь ЕСИА успешно переподтвержден (найдена УЗ,
    подтвержденная через Почту России, данные паспорта и телефона
    совпадают, найденная УЗ успешно переподтверждена);

-   создана заявка на регистрацию (не найдена УЗ пользователя, в том
    числе упрощенная, создана заявка на регистрацию, получен номер
    заявки на регистрацию).

В ответе передаются следующие параметры, приведенные в таблице 106.

Таблица 106 -- Передаваемые параметры

+---+----------------+-------------------------+---------------------+
| * | **Наименование | **Описание параметра**  | **Примечания**      |
| * | параметра**    |                         |                     |
| № |                |                         |                     |
| * |                |                         |                     |
| * |                |                         |                     |
+===+================+=========================+=====================+
| 1 | requestId      | Код заявки на           | Возвращается в      |
| . |                | регистрацию             | случае создания     |
|   |                |                         | заявки\             |
|   |                |                         | на регистрацию      |
+---+----------------+-------------------------+---------------------+
| 2 | code           | Код завершения операции | Может быть возращен |
| . |                |                         | в виде значений:    |
|   |                |                         |                     |
|   |                |                         | -   0 или 1 --      |
|   |                |                         |     выполнен импорт |
|   |                |                         |     УЗ;             |
|   |                |                         |                     |
|   |                |                         | -   2 -- создана    |
|   |                |                         |     заявка\         |
|   |                |                         |     на импорт       |
|   |                |                         |     (регистрацию)   |
|   |                |                         |     УЗ;             |
|   |                |                         |                     |
|   |                |                         | -   код ошибки,     |
|   |                |                         |     варианты        |
|   |                |                         |     приведены в     |
|   |                |                         |     таблице 73      |
+---+----------------+-------------------------+---------------------+
| 3 | description    | Текстовое описание кода | Описание для кодов  |
| . |                | завершения операции     | успешного импорта   |
|   |                |                         | УЗ\                 |
|   |                |                         | в ЕСИА (code = 0, 1 |
|   |                |                         | или 2)\             |
|   |                |                         | и для code =        |
|   |                |                         | ESIA-03200          |
+---+----------------+-------------------------+---------------------+
| 4 | message        | Текстовое описание кода | Описание для кодов  |
| . |                | ошибки выполнения       | ошибок при импорте  |
|   |                | операции                | УЗ в ЕСИА\          |
|   |                |                         | (за исключением     |
|   |                |                         | кода ESIA-03200).   |
|   |                |                         |                     |
|   |                |                         | Варианты ошибок     |
|   |                |                         | приведены в таблице |
|   |                |                         | 73                  |
+---+----------------+-------------------------+---------------------+

Далее приводятся варианты ответов сервиса, при завершении операции
импорта.

Пример ответа на запрос (пользователь уже зарегистрирован в ЕСИА, УЗ уже
подтверждена ранее):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"0\", \"description\":\"Person already has trusted account in
ESIA\"}

Пример ответа на запрос (УЗ пользователя успешно подтверждена в ЕСИА):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"1\", \"description\":\"Person successfully confirmed as
trusted in ESIA\"}

Пример ответа на запрос (УЗ пользователя успешно переподтверждена в
ЕСИА):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"1\", \"description\":\"Person successfully reconfirmed as
trusted in ESIA\"}

Пример ответа на запрос (запрос на регистрацию успешно отправлен,
создана заявка на регистрацию):

HTTP/1.1 200 OK

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"requestId\":\"AAAAF3A1379F965664CB56FCE55BD8CCA2F38368985607E75E23\",
\"code\":\"2\", \"description\":\"Request to register person as trusted
in ESIA has been accepted successfully.\"}

Пример ответа на запрос (ошибка импорта, некоторые атрибуты запроса\
не совпадают с УЗ в ЕСИА -- требуется корректировка параметров запроса
или УЗ в ЕСИА):

HTTP/1.1 400 Bad Request

Server: nginx/1.4.6 (Ubuntu)

Date: Thu, 21 Apr 2016 13:43:37 GMT

Content--Type: application/json

Transfer--Encoding: chunked

Connection: keep--alive

X--Powered--By: Servlet/3.0 JSP/2.2

 

{\"code\":\"ESIA-03200\", \"description\":\"Import account error. Person
have to check entered data or fill in the data in his account in
ESIA.\"}

В таблице 107 представлены коды ответов от сервиса импорта.

Таблица 107 -- Коды и описание ошибок от сервиса импорта

+---+----------+------------------------+-----------------------------+
| * | **Код    | **Описание кода        | **Комментарии**             |
| * | во       | возврата**             |                             |
| № | зврата** |                        |                             |
| * |          |                        |                             |
| * |          |                        |                             |
+===+==========+========================+=============================+
| 1 | ESI      | Внутренняя ошибка      | Данный код возврата         |
| . | A-000001 |                        | соответствует ситуации,     |
|   |          |                        | когда обнаружена            |
|   |          |                        | неизвестная ошибка          |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Scope is not allowed   | У системы, осуществляющей   |
| 1 | A-005029 |                        | запрос к сервису импорта,   |
| 8 |          |                        | отсутвует разрешение на     |
| . |          |                        | доступ к области доступа    |
|   |          |                        | (scope) ext_imp (например,  |
|   |          |                        | указанный в запросе маркер  |
|   |          |                        | доступа не дает право       |
|   |          |                        | доступа к области доступа   |
|   |          |                        | (scope) ext_imp)            |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Заполните поле         | Одно из полей «Фамилия»,    |
| 1 | A-030002 |                        | «Имя», «Отчество» пришло с  |
| 9 |          |                        | пустым значением            |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Неверно указаны        |                             |
| 2 | A-030003 | параметры запроса      |                             |
| 0 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Недопустимые символы в | Поля запроса содержат       |
| 2 | A-030007 | полях запроса          | недопустимые символы «\<»,  |
| 1 |          |                        | «\>» или «&»                |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Сертификат электронной |                             |
| 2 | A-030504 | подписи имеет          |                             |
| 2 |          | некорректную           |                             |
| . |          | структуру. Обратитесь  |                             |
|   |          | в удостоверяющий центр |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ES       | Ошибка импорта УЗ      | Необходимо скорректировать  |
| 2 | IA-03200 |                        | данные пользователя в       |
| 3 |          |                        | параметрах запроса          |
| . |          |                        |                             |
|   |          |                        | или параметры УЗ в ЕСИА     |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указан некорректный    |                             |
| 2 | A-032006 | тип контакта           |                             |
| 4 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указан некорректный    |                             |
| 2 | A-032101 | адрес электронной      |                             |
| 5 |          | почты                  |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | В структуре адреса     |                             |
| 2 | A-032102 | электронной почты      |                             |
| 6 |          | (в имени и домене)     |                             |
| . |          | должны отсутствовать   |                             |
|   |          | точки\                 |                             |
|   |          | в начале и конце.      |                             |
|   |          | Например,              |                             |
|   |          | mym                    |                             |
|   |          | ail.mymail@example.com |                             |
|   |          | -- верно;              |                             |
|   |          | mymail.@.example.com   |                             |
|   |          | -- неверно             |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указан некорректный    |                             |
| 2 | A-032103 | формат имени для       |                             |
| 7 |          | адреса электронной     |                             |
| . |          | почты. Доступные       |                             |
|   |          | символы: латинские     |                             |
|   |          | буквы a--z и A--Z,     |                             |
|   |          | цифры 0--9 и знаки     |                             |
|   |          | пунктуации             |                             |
|   |          | (#\$                   |                             |
|   |          | %\*+--=?\^\_\`{}\|\~.) |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указан некорректный    |                             |
| 2 | A-032104 | формат домена для      |                             |
| 8 |          | адреса электронной     |                             |
| . |          | почты. Доступные       |                             |
|   |          | символы: латинские     |                             |
|   |          | буквы a--z и A--Z,     |                             |
|   |          | цифры 0--9 и знаки     |                             |
|   |          | пунктуации             |                             |
|   |          | (#\$                   |                             |
|   |          | %\*+--=?\^\_\`{}\|\~.) |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Недопустимо            |                             |
| 2 | A-032105 | использовать два       |                             |
| 9 |          | и более раза подряд    |                             |
| . |          | следующие символы:     |                             |
|   |          | \".\", \"--\"          |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указан адрес        | Данный код возврата         |
| 3 | A-032110 | электронной почты при  | соответствует ситуации,     |
| 0 |          | вызове метода импорта\ | когда в запросе передан     |
| . |          | и указании пустого     | пустой параметр EML         |
|   |          | значения в атрибуте    |                             |
|   |          | EML                    |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указан номер        |                             |
| 3 | A-032200 | мобильного телефона    |                             |
| 1 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер мобильного       |                             |
| 3 | A-032201 | телефона содержит      |                             |
| 2 |          | недопустимые символы   |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер мобильного       |                             |
| 3 | A-032202 | телефона указан\       |                             |
| 3 |          | в неверном формате     |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указан некорректный    |                             |
| 3 | A-032203 | номер мобильного       |                             |
| 4 |          | телефона               |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указанный номер        | Данный код ошибки           |
| 3 | A-032205 | телефона уже           | возвращается\               |
| 5 |          | используется для       | при повторном импорте,      |
| . |          | регистрации УЗ         | если:                       |
|   |          |                        |                             |
|   |          |                        | -- номер мобильного         |
|   |          |                        | телефона уже используется   |
|   |          |                        | при регистрации,\           |
|   |          |                        | и с момента прошлого        |
|   |          |                        | запроса\                    |
|   |          |                        | не прошло 3 суток, а также  |
|   |          |                        | ожидается подтверждение     |
|   |          |                        | регистрации по СМС\         |
|   |          |                        | от пользователя;            |
|   |          |                        |                             |
|   |          |                        | -   или номер мобильного    |
|   |          |                        |     телефона уже            |
|   |          |                        |     используется при        |
|   |          |                        |     регистрации, получено   |
|   |          |                        |     подтверждение           |
|   |          |                        |     пользователя по СМС     |
|   |          |                        |     и запущены проверки его |
|   |          |                        |     данных                  |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указан тип          |                             |
| 3 | A-033000 | документа              |                             |
| 6 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Введите серию          |                             |
| 3 | A-033001 | документа              |                             |
| 7 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Введите номер          |                             |
| 3 | A-033002 | документа              |                             |
| 8 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указана дата выдачи |                             |
| 3 | A-033003 | документа              |                             |
| 9 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указано ведомство,  |                             |
| 4 | A-033004 | выдавшее документ      |                             |
| 0 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Укажите дату выдачи    |                             |
| 4 | A-033005 | документа              |                             |
| 1 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Некорректная дата      |                             |
| 4 | A-033006 | выдачи документа       |                             |
| 2 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Укажите дату окончания | Если загранпаспорт указан в |
| 4 | A-033007 | срока действия         | качестве документа,         |
| 3 |          | документа              | удостоверяющего личность    |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Некорректная дата      | Если загранпаспорт указан в |
| 4 | A-033008 | окончания срока        | качестве документа,         |
| 4 |          | действия документа     | удостоверяющего личность    |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Дата окончания срока   | Если загранпаспорт указан в |
| 4 | A-033009 | действия документа     | качестве документа,         |
| 5 |          | должна быть меньше чем | удостоверяющего личность    |
| . |          | дата выдачи            |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Document type is wrong | Указан неверный тип         |
| 4 | A-033010 |                        | документа, удостоверяющего  |
| 6 |          |                        | личность                    |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Длина названия         |                             |
| 4 | A-033011 | ведомства, выдавшего   |                             |
| 7 |          | документ, должна быть  |                             |
| . |          | меньше {количество}    |                             |
|   |          | символов               |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Серия паспорта должна  |                             |
| 4 | A-033100 | состоять               |                             |
| 8 |          | из {количество} цифр   |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Серия паспорта может   |                             |
| 4 | A-033101 | содержать только цифры |                             |
| 9 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер паспорта должен  |                             |
| 5 | A-033102 | состоять\              |                             |
| 0 |          | из {количество} цифр   |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер паспорта может   |                             |
| 5 | A-033103 | содержать только цифры |                             |
| 1 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Введите код            |                             |
| 5 | A-033104 | подразделения          |                             |
| 2 |          | в паспорте             |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Код подразделения в    |                             |
| 5 | A-033105 | паспорте должен        |                             |
| 3 |          | состоять из            |                             |
| . |          | {количество} цифр      |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Код подразделения      |                             |
| 5 | A-033106 | в паспорте может       |                             |
| 4 |          | содержать только цифры |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | RF Passport issuer     | Неверная длина поля «Выдан» |
| 5 | A-033109 | element wrong length   | для паспорта РФ             |
| 5 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | RF Passport issuer     | В поле «Выдан» паспорта РФ  |
| 5 | A-033110 | element wrong          | указан недопустимый символ  |
| 6 |          | character              |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Серия документа может  |                             |
| 5 | A-033201 | содержать только       |                             |
| 7 |          | цифры, тире, буквы     |                             |
| . |          | русского и латинского  |                             |
|   |          | алфавита               |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер документа может  |                             |
| 5 | A-033202 | содержать только       |                             |
| 8 |          | цифры, тире, буквы     |                             |
| . |          | русского и латинского  |                             |
|   |          | алфавита               |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Серия документа должна |                             |
| 5 | A-033300 | состоять               |                             |
| 9 |          | из {количество}        |                             |
| . |          | символов               |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Серия документа может  |                             |
| 6 | A-033301 | содержать только цифры |                             |
| 0 |          | и буквы русского       |                             |
| . |          | алфавита               |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер документа должен |                             |
| 6 | A-033302 | состоять\              |                             |
| 1 |          | из {количество} цифр   |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер документа может  |                             |
| 6 | A-033303 | содержать только цифры |                             |
| 2 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | ZipCode element is     | Не указан индекс для адреса |
| 6 | A-034000 | empty                  | РФ. Поле «Индекс»           |
| 3 |          |                        | присутствует, но не         |
| . |          |                        | заполнено                   |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | ZipCode format is      | Неверный формат индекса     |
| 6 | A-034001 | wrong                  |                             |
| 4 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Address type is wrong  | Неверный тип адреса         |
| 6 | A-034002 |                        |                             |
| 5 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | AddressStr element is  | Не указано значение поля    |
| 6 | A-034004 | empty                  | addressStr                  |
| 6 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Address elements       | В адресе не указаны         |
| 6 | A-034005 | House, Building, Frame | значения                    |
| 7 |          | are null               | дом/корпус/строение         |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Address element        | Указан неверный код страны  |
| 6 | A-034006 | countryId is wrong     |                             |
| 8 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указана фамилия     |                             |
| 6 | A-035100 |                        |                             |
| 9 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указано имя         |                             |
| 7 | A-035101 |                        |                             |
| 0 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Поле может содержать   |                             |
| 7 | A-035102 | только буквы русского  |                             |
| 1 |          | или латинского         |                             |
| . |          | алфавитов, цифры,      |                             |
|   |          | дефис, пробел,         |                             |
|   |          | апостроф, точку,       |                             |
|   |          | запятую. Запятая       |                             |
|   |          | допустима только       |                             |
|   |          | в середине слова.      |                             |
|   |          | В поле недопустимо     |                             |
|   |          | одновременно           |                             |
|   |          | использовать русские и |                             |
|   |          | латинские буквы        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Не указан пол          |                             |
| 7 | A-035103 |                        |                             |
| 2 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Укажите дату рождения  |                             |
| 7 | A-035104 |                        |                             |
| 3 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Некорректная дата      |                             |
| 7 | A-035105 | рождения               |                             |
| 4 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Укажите гражданство    |                             |
| 7 | A-035106 |                        |                             |
| 5 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Укажите                |                             |
| 7 | A-035107 | идентификационный      |                             |
| 6 |          | документ               |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указанный документ не  |                             |
| 7 | A-035108 | является               |                             |
| 7 |          | идентификационным      |                             |
| . |          | документом             |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указанные              |                             |
| 7 | A-035109 | идентификационный      |                             |
| 8 |          | документ и гражданство |                             |
| . |          | не соответствуют друг  |                             |
|   |          | другу                  |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указаный пол           |                             |
| 7 | A-035110 | {наименование}         |                             |
| 9 |          | не соответствует       |                             |
| . |          | словарю                |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указанное гражданство  |                             |
| 8 | A-035111 | {наименование}         |                             |
| 0 |          | не соответствует       |                             |
| . |          | словарю                |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Укажите место рождения |                             |
| 8 | A-035112 |                        |                             |
| 1 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Укажите вид            |                             |
| 8 | A-035113 | на жительство или      |                             |
| 2 |          | разрешение на          |                             |
| . |          | временное проживание   |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указанная страна       |                             |
| 8 | A-035115 | рождения               |                             |
| 3 |          | {Наименование}         |                             |
| . |          | не соответствует       |                             |
|   |          | словарю                |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Количество символов не | Для поля «Кем выдан»        |
| 8 | A-035117 | должно превышать 700   | (паспорт)                   |
| 4 |          | символов               |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Поле может содержать   | Для поля «Имя»              |
| 8 | A-035118 | только буквы русского  |                             |
| 5 |          | или латинского         |                             |
| . |          | алфавитов, цифры,      |                             |
|   |          | дефис, пробел,         |                             |
|   |          | апостроф, точку,       |                             |
|   |          | запятую. Запятая       |                             |
|   |          | допустима только       |                             |
|   |          | в середине слова.      |                             |
|   |          | В поле недопустимо     |                             |
|   |          | одновременно           |                             |
|   |          | использовать русские и |                             |
|   |          | латинские буквы        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Количество символов не | Для поля «Месторождение»    |
| 8 | A-035119 | должно превышать 700   |                             |
| 6 |          | символов               |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Количество символов в  | Для поля «Месторождение»,   |
| 8 | A-035120 | слове\                 | если значение указано более |
| 7 |          | не должно превышать 30 | одного слова, то отдельное  |
| . |          | символов               | слово не должно превышать   |
|   |          |                        | 30 символов                 |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Введите СНИЛС          | Не указан СНИЛС             |
| 8 | A-036100 |                        |                             |
| 8 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Некорректный формат    |                             |
| 8 | A-036101 | СНИЛС                  |                             |
| 9 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Введенный СНИЛС не     | Указанный СНИЛС некорректен |
| 9 | A-036102 | существует             | (неверная контрольная       |
| 0 |          |                        | сумма)                      |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Указанный номер        | Данный код возврата         |
| 9 | A-039600 | телефона используется  | соответствует ситуации,     |
| 1 |          | в другой упрощенной УЗ | когда найдена упрощенная    |
| . |          |                        | УЗ\                         |
|   |          |                        | по указанному в запросе     |
|   |          |                        | номеру мобильного телефона  |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Номер мобильного       | Данный код возврата         |
| 9 | A-039812 | телефона уже           | соответствует ситуации,     |
| 2 |          | используется в другой  | когда номер телефона        |
| . |          | УЗ. Вы сможете         | подтвержден в другой УЗ     |
|   |          | зарегистрировать УЗ на | менее 30 суток назад и его  |
|   |          | этот номер телефона не | использование при           |
|   |          | ранее дд.мм.гггг.      | регистрации новой УЗ        |
|   |          | Восстановите доступ к  | невозможно                  |
|   |          | УЗ\                    |                             |
|   |          | или укажите другой     |                             |
|   |          | номер мобильного       |                             |
|   |          | телефона               |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Данные не прошли       |                             |
| 9 | A-910100 | проверку в МВД России  |                             |
| 3 |          |                        |                             |
| . |          |                        |                             |
|   |          |                        |                             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 9 | A-910111 | проверку в МВД России. | о недействительности        |
| 4 |          | Истек срок действия    | документа (причина          |
| . |          | паспорта               | недействительности -- истек |
|   |          |                        | срок действия паспорта)     |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 9 | A-910112 | проверку в МВД России. | о недействительности        |
| 5 |          | Документ заменен на    | документа (причина          |
| . |          | новый                  | недействительности --       |
|   |          |                        | документ заменен на новый)  |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 9 | A-910113 | проверку в МВД России. | о недействительности        |
| 6 |          | Документ выдан\        | документа (причина          |
| . |          | с нарушением           | недействительности --       |
|   |          |                        | документ выдан\             |
|   |          |                        | с нарушением)               |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 9 | A-910114 | проверку в МВД России. | о недействительности        |
| 7 |          | Документ числится\     | документа (причина          |
| . |          | в розыске              | недействительности --       |
|   |          |                        | документ числится\          |
|   |          |                        | в розыске)                  |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 9 | A-910115 | проверку в МВД России. | о недействительности        |
| 8 |          | Документ изъят         | документа (причина          |
| . |          |                        | недействительности --       |
|   |          |                        | документ изъят)             |
+---+----------+------------------------+-----------------------------+
| 1 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 9 | A-910116 | проверку в МВД России. | о недействительности        |
| 9 |          | Код 606 (в связи со    | документа (причина          |
| . |          | смертью владельца)     | недействительности -- в     |
|   |          |                        | связи\                      |
|   |          |                        | со смертью владельца)       |
+---+----------+------------------------+-----------------------------+
| 2 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 0 | A-910117 | проверку в МВД России. | о недействительности        |
| 0 |          | Технический брак       | документа (причина          |
| . |          |                        | недействительности --       |
|   |          |                        | технический брак)           |
+---+----------+------------------------+-----------------------------+
| 2 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 0 | A-910118 | проверку в МВД России. | о недействительности        |
| 1 |          | Неизвестный статус     | документа (причина          |
| . |          |                        | недействительности --       |
|   |          |                        | неизвестный статус)         |
+---+----------+------------------------+-----------------------------+
| 2 | ESI      | Данные не прошли       | МВД России сообщило\        |
| 0 | A-910120 | проверку в МВД России. | о недействительности        |
| 2 |          | Паспорт не найден      | документа (причина          |
| . |          |                        | недействительности --       |
|   |          |                        | паспорт\                    |
|   |          |                        | не найден)                  |
+---+----------+------------------------+-----------------------------+

Система, используя имеющийся идентификатор заявки на регистрацию
пользователя, может узнать статус заявки, а также причину ошибки (при ее
наличии).\
Для получения данных о ходе выполнения проверок система должна выполнить
запрос методом GET в https-адрес REST API системы ЕСИА[^95]. Запрос
также должен содержать маркер доступа системы на scope ext_imp. Пример
запроса (вызов сервиса в тестовой среде):

GET https://esia-portal1.test.gosuslugi.ru/rs/reqs/
AAAA5F79379F965664CB739F5BDC6FD8E24797A576A4F056322D

Authorization: Bearer
eyJhbGciOiJSUzI1NiIsInNidCI6ImFjY2VzcyIsInR5cCI6IkpXVCIsInZlciI6M

В качестве ответа ЕСИА возвращает JSON с параметрами, указанными\
в таблице 108.

Таблица 108 -- Параметры ответа на запрос о статусе проверки данных
пользователя

+---+--------------+---------------+-----------------------------------+
| * | **Параметр** | **Обя         | **Описание**                      |
| * |              | зательность** |                                   |
| № |              |               |                                   |
| * |              |               |                                   |
| * |              |               |                                   |
+===+==============+===============+===================================+
| 1 | status       | Y             | Статус заявки на регистрацию      |
| . |              |               | пользователя. Может принимать     |
|   |              |               | значения:                         |
|   |              |               |                                   |
|   |              |               | -   VALIDATING -- идет проверка   |
|   |              |               |     данных УЗ в БГИР;             |
|   |              |               |                                   |
|   |              |               | -   VALIDATION_FAILED -- ошибка   |
|   |              |               |     при проверке данных УЗ в      |
|   |              |               |     БГИР, детализация ошибки      |
|   |              |               |     содержится в параметре        |
|   |              |               |     errorStatusInfo;              |
|   |              |               |                                   |
|   |              |               | -   SUCCEEDED -- операция успешно |
|   |              |               |     выполнена                     |
+---+--------------+---------------+-----------------------------------+
| 2 | personOid    | N             | Идентификатор зарегистрированной  |
| . |              |               | УЗ (возвращается в случае успешно |
|   |              |               | выполненной операции импорта УЗ   |
|   |              |               | в ЕСИА)                           |
+---+--------------+---------------+-----------------------------------+
| 3 | flowDetails  | N             | Возвращает данные о задаче, ее    |
| . |              |               | статус и при наличии -- об        |
|   |              |               | ошибке.                           |
|   |              |               |                                   |
|   |              |               | Включает в себя следующие         |
|   |              |               | атрибуты:                         |
|   |              |               |                                   |
|   |              |               | -   имя (name), принимающее       |
|   |              |               |     следующие значения:           |
|   |              |               |                                   |
|   |              |               | -   до момента завершения         |
|   |              |               |     проверки СНИЛС:               |
|   |              |               |                                   |
|   |              |               | -   raRegistrationEndorsement --  |
|   |              |               |     подтверждение пользователем   |
|   |              |               |     регистрации по СМС;           |
|   |              |               |                                   |
|   |              |               | -   sendSMS -- отправка пароля    |
|   |              |               |     для первого входа;            |
|   |              |               |                                   |
|   |              |               | -   validateSnils -- проверка     |
|   |              |               |     ФИО, СНИЛС\                   |
|   |              |               |     и даты рождения в СФР;        |
|   |              |               |                                   |
|   |              |               | -   после упешного завершения     |
|   |              |               |     проверки СНИЛС и создания     |
|   |              |               |     упрощенной УЗ:                |
|   |              |               |                                   |
|   |              |               | -   validateRfPassport --         |
|   |              |               |     проверка паспортных данных в  |
|   |              |               |     МВД России;                   |
|   |              |               |                                   |
|   |              |               | -   статус (status), принимающий  |
|   |              |               |     следующие значения:           |
|   |              |               |                                   |
|   |              |               | -   S -- успешно выполнена;       |
|   |              |               |                                   |
|   |              |               | -   P -- в работе;                |
|   |              |               |                                   |
|   |              |               | -   W -- ожидает реакции          |
|   |              |               |     пользователя\                 |
|   |              |               |     или предыдущего связанного    |
|   |              |               |     задания;                      |
|   |              |               |                                   |
|   |              |               | -   I -- инициализирована;        |
|   |              |               |                                   |
|   |              |               | -   C -- операция отменена;       |
|   |              |               |                                   |
|   |              |               | -   F -- ошибка выполнения;       |
|   |              |               |                                   |
|   |              |               | -   ошибка (error,                |
|   |              |               |     необязательно), включающая в  |
|   |              |               |     себя код ошибки (code)        |
|   |              |               |     и текстовое описание          |
|   |              |               |     (message).                    |
+---+--------------+---------------+-----------------------------------+
| 4 | err          | N             | Детальная информация об ошибке    |
| . | orStatusInfo |               | (при наличии). Формат:            |
|   |              |               |                                   |
|   |              |               | -   code -- код ошибки;           |
|   |              |               |                                   |
|   |              |               | -   message -- текстовое описание |
|   |              |               |     ошибки                        |
+---+--------------+---------------+-----------------------------------+

Пример ответа на запрос о статусе выполнения заявки (успешная регистраци
УЗ при импорте в ЕСИА):

{\"stateFacts\":\[\"Identifiable\"\],\"status\":\"SUCCEEDED\",\"personOid\":1000352622}

Пример ответа на запрос о статусе выполнения заявки (регистрация УЗ
при импорте в ЕСИА не выполнена -- ошибка при проверке ФИО, СНИЛС и даты
рождения в СФР):

{

\"stateFacts\":\[\"Identifiable\"\],

\"status\": \"VALIDATION_FAILED\",

\"flowDetails\":

\[

{

\"name\":\"raRegistrationEndorsement\",

\"status\":\"S\"

},

{

\"name\": \"validateSnils\",

\"status\": \"F\",

\"error\":{\"code\": \"ESIA-910001\",

\"message\": \"Пенсионный фонд Российской Федерации не подтвердил
существование СНИЛС с указанными реквизитами\"}

},

{

\"name\": \"sendSMS\",

\"status\": \"C\"

}

\],

\"errorStatusInfo\":

{

\"code\": \"ESIA-910001\",

\"message\": \" \"

}

}

Пример ответа на запрос о статусе выполнения заявки (регистрация УЗ\
при импорте в ЕСИА не выполнена -- ошибка при проверке паспортных данных
в МВД России):

{

\"stateFacts\":\[\"Identifiable\"\],

\"status\": \"VALIDATION_FAILED\",

\"flowDetails\":

\[

{

\"name\": \"validateRfPassport\",

\"status\": \"F\",

\"error\":{\"code\": \"ESIA-910100\",

\"message\": \"В&nbsp;автоматическом режиме не&nbsp;удалось произвести
проверку

вашего паспорта.\"}

}

\],

\"errorStatusInfo\":

{

\"code\": \"ESIA-910100\",

\"message\": \"В&nbsp;автоматическом режиме не&nbsp;удалось произвести
проверку вашего

паспорта.\"

}

}

## Устаревший сервис получения кода авторизации

Адрес устаревшего сервиса получения кода авторизации в тестовой среде:

<https://esia-portal1.test.gosuslugi.ru/aas/oauth2/ac>.

Адрес нового сервиса получения кода авторизации в тестовой среде:

<https://esia-portal1.test.gosuslugi.ru/aas/oauth2/v2/ac>.

Изменения в новом сервисе получения кода авторизации:

-   Параметр запроса «client_secret» теперь содержит подпись от пяти
    параметров HTTP-запроса: scope, timestamp, clientId, state (без
    разделителей), redirect_uri.

-   Добавлен параметр запроса «client_certificate_hash», содержащий хэш
    сертификата системы-клиента ЕСИА.

## Устаревший сервис получения маркера доступа

Адрес устаревшего сервиса получения маркера доступа в тестовой среде:

https://esia-portal1.test.gosuslugi.ru/aas/oauth2/v2/te.

Адрес нового сервиса получения маркера доступа в тестовой среде:

https://esia-portal1.test.gosuslugi.ru/aas/oauth2/v3/te.

Изменения в новом сервисе получения маркера доступа:

-   Параметр запроса «client_secret» теперь содержит подпись от шести
    параметров HTTP-запроса: scope, timestamp, clientId, state (без
    разделителей), redirect_uri, code.

-   Добавлен параметр запроса «client_certificate_hash», содержащий хэш
    сертификата системы-клиента ЕСИА.

В версии v3 поддерживается более высокий уровень безопасности,\
так как к параметру запроса client_secret добавлен аргумент code,
полученный\
от aas/oauth2/v2/ac.

# Требования по безопасности сервисов ЕСИА, основанных на протоколах Oauth2.0 и OpenId Connect 1.0

## Требования к безопасности серверной части ИС

### Выбор типового решения

Взаимодействие системы-клиента с Федеральной государственной
информационной системой «Единая система идентификации и аутентификации
в инфраструктуре, обеспечивающей информационно-технологическое
взаимодействие информационных систем, используемых для предоставления
государственных и муниципальных услуг в электронной форме» в части
подсистемы идентификации, аутентификации и авторизации при доступе к
защищаемым ресурсам реализуется любым из следующих способов:

-   с использованием технического решения, разработанного в рамках
    создания и развития подключаемой информационной системы (далее
    --собственного решения);

-   с использованием ранее разработанных готовых типовых компонентов
    (далее -- типового технического решения).

### Требования к реализации собственного решения

В случае создания подсистемы идентификации и аутентификации
системы-клиента с использованием собственного технического решения,
следует разработать реализацию на базе протоколов OAuth2.0 и OpenID
Connect 1.0, описанных в настоящих методических рекомендациях, с
использованием встраивания средства электронной подписи (далее ‒ СЭП),
сертифицированного ФСБ России по классу не ниже КC3. Допускается
применение средства ЭП, сертифицрованных по требованиям ФСБ России, по
классу не ниже KC1 при взаимодействии ИС с ЕСИА строго через API Gateway
и в случае отсутствия необходимости получения каких-либо персональных
данных пользователя ЕСИА, проходящего аутентификацию, за исключением
идентификатора ЕСИА.

Реализуемый в собственном техническом решении протокол на базе OpenID
Connect 1.0 и OAuth2.0, должен соответствовать описанию и схемам,
приведенным в Приложение Б (за исключением разделов, рекомендованных
к выводу из эксплуатации). Безопасность реализации протокола должна быть
подтверждена в установленном порядке в соответствии с действующими
нормативно-правовыми актами.

При проведении аутентификации с использованием мобильного приложения
Госуслуги используется механизм встраивания браузерного компонента в
состав мобильного приложения (web view), в связи с этим, схема
применения мобильного приложения для аутентификации пользователя с точки
зрения взаимодействия с системой-клиентом должна быть аналогична схеме с
браузером на стороне пользователя.

При реализации протокола необходимо выполнить следующие требования:

1)  При взаимодействии с ЕСИА система-клиента должна передавать в
    запросах только задокументированные параметры и их значения.

2)  При генерации каждого запроса на аутентификацию через ЕСИА
    система-клиент должна генерировать уникальное и случайное значения
    для параметра state.

3)  При получении ответов от ЕСИА система-клиента должна проверять
    соответствие возвращенного значения параметра state с отправленным.

4)  После возврата пользователя из ЕСИА система-клиент должна проверять
    соответствие сессии пользователя и возвращенного значения параметра
    state,\
    с теми, которые использовались при отправке запроса на авторизацию.
    Например, при первом запросе генерировать случайные cookie и
    связывать\
    с параметром state. После возврата пользователя из ЕСИА
    система-клиента должна проверить соответствие предъявленных cookie и
    state. Также допускаются иные способы, прошедшие оценку корректности
    регулятором.

5)  Аутентификация пользователя в ЕСИА по запросу системы-клиента должна
    производиться исключительно путём непосредственного взаимодействия
    пользователя и ЕСИА с использованием пользовательского интерфейса,
    реализация которого входит в состав ЕСИА или мобильного приложения
    «Госуслуги», при взаимодействии с которым пользователю отображается
    информация об инфрормаицонной системе, запросившей аутентификацию.

6)  Система-клиент при взаимодействии непосредственно с ЕСИА должна
    сохранять на своей стороне состояние сессии пользователя и
    контролировать правильность и порядок поступления запросов
    (перенаправлений) согласно методическим рекомендациям ЕСИА. В случае
    нарушения порядка запросов система-клиента должна прерывать процесс
    аутентификации пользователя\
    и предлагать повторить операцию с начала.

Во всех аспектах и технологических особенностях взаимодействия с ЕСИА,\
в которых участвуют биометрические данные, необходимо следовать
Методическим рекомендациям по работе с Единой биометрической системой
для разработчиков (версии 1.23 и позднее).

### Требования по безопасности собственного решения

Безопасность реализации протокола на базе OpenID Connect 1.0 и OAuth2.0
(собственного технического решения) должна обеспечиваться выполнением
следующих требований.

1)  Должны применяться средства электронной подписи, сертифицированные
    ФСБ России по классу не ниже KC3. Допускается применение средства
    ЭП, сертифицрованных по требованиям ФСБ России, по классу не ниже
    KC1\
    при взаимодействии ИС с ЕСИА строго через API Gateway и в случае
    отсутствия необходимости получения каких-либо персональных данных
    пользователя ЕСИА, проходящего аутентификацию, за исключением
    идентификатора ЕСИА.

2)  Применение средств ЭП и СКЗИ, используемых в техническом решении,
    должно осуществляться с соблюдением требований, указанных\
    в эксплуатационной документации на СЭП и СКЗИ.

3)  Разработчик технического решения должен обеспечить проведение
    процедуры оценки влияния на применяемые СКЗИ, включая средства ЭП,
    компонентов технического решения, включая реализацию OpenID Connect
    1.0\
    в соответствии с требованиями ФСБ России в порядке, установленном
    законодательством Российской Федерации. В техническом решении должны
    применяться средства межсетевого экранирования, прошедшие процедуру
    оценки соответствия требованиям по информационной безопасности\
    в порядке, установленном законодательством Российской Федерации\
    по требованиям ФСТЭК России или ФСБ России.

4)  В техническом решении должны применяться средства антивирусной
    защиты прошедшие процедуру оценки соответствия требованиям по
    информационной безопасности в порядке установленном
    законодательством Российской Федерации по требованиям ФСТЭК России
    или ФСБ России с учетом уточнений изложенных в эксплуатационной
    документации на СКЗИ и СЭП.

5)  Получение сертификата ключа проверки электронной подписи, созданного
    аккредитованным Минцифры России удостоверяющим центром\
    с применением средств удостоверяющего центра класса не ниже, чем
    класс применяемых средств ЭП.

### Требования к применению типового решения

В случае реализации взаимодействия с использованием типового решения
информационной системы участника взаимодействия (внешняя ИС, ВИС) с ЕСИА
для выполнения идентификации, аутентификации и авторизации, необходимо
обеспечить:

1)  Применение типового решения, прошедшего процедуру оценки влияния
    на СКЗИ в соответствии с требованиями ФСБ России по информационной
    безопасности в установленном порядке и реализующего безопасную
    реализацию протокола OpenID Connect 1.0.

2)  Взаимодействие между информационной системой участника
    взаимодействия и типовым решением по прикладным программным
    интерфейсам (API), в соответствии с документацией на типовое
    решение.

3)  Эксплуатацию в соответствии с документацией на типовое решение.

### Общая безопасность ИС

В целях обеспечения информационной безопасности при идентификации,
аутентификации и авторизации конечного пользователя владельцам ИС
необходимо обеспечить меры по защите информации в соответствии с
действующими нормативно-правовыми актами, а также документацией на
применяемые технические средства и средства защиты информации.

В целях обеспечения информационной безопасности при идентификации,
аутентификации и авторизации конечного пользователя владельцам ИС
рекомендуется обеспечить состав мер по защите информации, реализуемых
для внутренних пользователей и программно-аппаратных средств ИС:

1)  Применение средств защиты от несанкционированного доступа,
    сертифицированных ФСТЭК России не ниже 5 класса.

2)  Идентификация и аутентификация пользователей, являющихся работниками
    оператора, обеспечение правил разграничения их доступа.

3)  Управление (заведение, активация, блокирование и уничтожение)
    учетными записями пользователей, в том числе внешних пользователей,
    разграничение ролей.

4)  Ограничение неуспешных попыток входа в информационную систему.

5)  Блокирование сеанса доступа в информационную систему после
    установленного времени бездействия (неактивности) пользователя или
    по его запросу.

6)  Фильтрация и контроль соединений информационных потоков между
    устройствами, сегментами информационной системы, а также между
    информационными системами с использованием сертифицированных ФСТЭК
    России межсетевых экранов не ниже 5 класса.

7)  Обеспечение доверенной загрузки средств вычислительной техники.

8)  Мониторинг (просмотр, анализ) событий безопасности и реагирование на
    них.

9)  Реализация антивирусной защиты.

10) Обнаружение вторжений.

11) Выявление, анализ уязвимостей информационной системы и оперативное
    устранение вновь выявленных уязвимостей.

12) Контроль установки обновлений программного обеспечения, включая
    обновление программного обеспечения средств защиты информации.

13) Контроль работоспособности, параметров настройки и правильности
    функционирования программного обеспечения и средств защиты
    информации.

14) Контроль целостности программного обеспечения, включая программное
    обеспечение средств защиты информации.

15) Защита среды виртуализации.

Все[^96] используемые средства защиты информации должны быть
сертифицированы ФСТЭК России и соответствовать уровню доверия не ниже 5\
или должны быть сертифицированы ФСБ России.

В целях обеспечения информационной безопасности размещение серверных
СВТ, осуществляющих взаимодействие с ЕСИА, допустимо только на
территории Российской Федерации.

### Требования по защите каналов при подключении пользователей к ИС Участников взаимодействия, а также пользователей к ЕСИА

1.  Общие требования.

    1.  Система-клиент, сеть передачи данных, используемые программные и
        аппаратные средства должны отвечать требованиям безопасности,
        изложенным в нормативно-технических (нормативно-методических)
        документах и соответствовать требованиям по защите информации,
        установленными действующим законодательством Российской
        Федерации, в том числе в области персональных данных.

    2.  Должна быть обеспечена конфиденциальность каналов на всех
        участках взаимодействия. Канал связи на участке система-клиент
        (далее -- ВИС)-ЕСИА должен быть аутентифицированным.

2.  Участок взаимодействия ЕСИА-ВИС.

Все каналы связи на участке взаимодействия «ЕСИА-ВИС», выходящие за
пределы контролируемых зон участников взаимодействия, должны быть
защищены\
с помощью сертифицированных средств криптографической защиты информации,
удовлетворяющих установленным требованиям к средствам криптографической
защиты информации класса не ниже КСЗ и находящихся в пределах
контролируемых зон участников взаимодействия. Допускается применение
криптографических средств защиты канала связи класса KC1 на участке
взаимодействия «ЕСИА-ВИС», выходящем за пределы контролируемых зон
участников взаимодействия, в случае отсутствия передачи каких-либо
персональных данных для информационной системы, использующей данный
канал связи, из Цифрового Профиля ЕСИА, за исключением идентификатора
пользователя ЕСИА, проходящего аутентификацию, а также при подключении к
ЕСИА через API Gateway при условии использования на стороне ВИС ключей
электронной подписи со сроком действия, ограниченным 6 месяцами,
сертификата ключа проверки электронной подписи ‒ со сроком действия,
ограниченным 1 годом. Для защиты канала должны применяться СКЗИ,
обеспечивающие криптографическую аутентификацию канала связи ВИС.\
При взаимодействии с использованием протокола TLS, аутентификацию
взаимодействия ВИС с ЕСИА рекомендуется осуществлять с использованием
сертификата безопасности (двустороннего протокола TLS). Допускается
применение односторонней аутентификации с использованием протокола TLS
(аутентификации ЕСИА на стороне ВИС)\
при взаимодействии через API Gateway с использованием аутентификации ВИС
в рамках выполнения протокола аутентификации в соответствии с настоящими
методическими рекомендациями (с использованием электронной подписи ВИС).
Для взаимодействия ИС клиента с ЕСИА в части автоматического создания и
(или) автоматической проверки электронных подписей, предусмотренных п.5
ч.1 ст. 17.2,\
п.3 ч.2 ст. 17.2 и ст.17.4 Федерального закона от 06.04.2011 № 63-ФЗ «Об
электронной подписи», заявитель должен иметь квалифицированный
сертификат ключа проверки электронной подписи, содержащий указание
только на юридическое лицо в качестве владельца данного сертификата.
Физическое лицо, действующее от имени юридического лица, не должно
указываться качестве владельца сертификата ключа проверки электронной
подписи. Данное ограничение вводится с 01.07.2025.

3.  Участки взаимодействия ИС-пользователь и ЕСИА-пользователь.

    1.  При осуществлении криптографических операций в рамках реализации
        взаимодействия пользователей с ВИС, используемые на стороне ВИС
        решения (СКЗИ и сертификаты аутентификации), должны поддерживать
        криптографические алгоритмы ГОСТ 28147-89, ГОСТ Р 34.10-2012,
        ГОСТ Р 34.11-2012.

    2.  Серверная часть ВИС должна поддерживать возможность
        взаимодействия\
        с пользователями по протоколу TLS, реализованному с
        использованием СКЗИ, сертифицированных ФСБ России по классу не
        ниже КС3 на стороне ВИС (сервера) и КС1 на стороне пользователя
        (клиента). Допускается применение СКЗИ класса KC1 в ВИС в случае
        отсутствия передачи каких-либо персональных данных из Цифрового
        Профиля ЕСИА, за исключением идентификатора пользователя ЕСИА,
        проходящего аутентификацию.

В случае реализации взаимодействия пользователя с ИС с использованием
мобильного приложения, разрабатываемого владельцем (оператором) ВИС,
рекомендуется реализовать защиту канала при подключении к ВИС и ЕСИА
посредством односторонней аутентификации с использованием протокола TLS
СКЗИ, сертифицированного ФСБ России по классу не ниже КС1.

Для защиты каналов связи при подключении к ЕСИА может использоваться
ЗСПД СМЭВ или иное решение криптографической защиты канала связи,
применение которого официально согласовано с ФСБ России и Минцифры
России.

[^1]: Соответствующий термин на английском языке -- Single Sign On.

[^2]: Соответствующий термин на английском языке -- Identity Management.

[^3]: Раздел 6 Регламента.

[^4]: Раздел 9 Регламента.

[^5]: Раздел 10 Регламента.

[^6]: В соответствии с Методическими рекомендациями по проектированию
    интерфейсов государственной услуги или государственной функции на
    едином портале государственных услуг (утверждены протоколом
    Президиума Правительственной комиссии от 17.08.2022 № 31), а также
    правилами использования элементов фирменного стиля Госуслуг
    (https://guides.gosuslugi.ru/).

[^7]: Раздел 10 Регламента.

[^8]: Для подтверждения личности ЦО могут использовать соответствующий
    программный интерфейс ЕСИА\
    (см. п. В.3, Приложение В).

[^9]: Инициирование приглашения на присоединение пользователя к ЮЛ или
    ОГВ возможно с помощью программного интерфейса ЕСИА. Детальная
    информация -- в п. Б.7, Приложение Б.

[^10]: Инициирование приглашения на присоединение пользователя к
    юридическому лицу возможно с помощью программного интерфейса ЕСИА.
    Детальная информация -- в Приложении Б.7.

[^11]: Инициирование приглашения на присоединение пользователя к ОГВ
    возможно с помощью программного интерфейса ЕСИА. Детальная
    информация -- в Приложении Б.7.

[^12]: Раздел 6 Регламента.

[^13]: Также возможно управление данными организации с помощью
    программного интерфейса на основе REST (см. Приложение А).

[^14]: Бывший сотрудник ЮЛ может продолжать использовать свою УЗ ЕСИА,
    например, для получения государственных услуг в электронном виде.

[^15]: Если соответствующими ИС предусмотрены группы доступа (системные
    группы), см. п. 4.1.5.

[^16]: За исключением получения данных об ИС (см. п. Б.7, Приложения
    Приложение Б и п. В.3, Приложения Приложение В).

[^17]: Порядок подключения к ЕСИА с целью использования программных
    интерфейсов описан в п. 9, 10 Регламента.

[^18]: См. раздел 6 Регламента.

[^19]: В тестовой среде сервис доступен по URL:
    https://esia-portal1.test.gosuslugi.ru.

[^20]: Например, fullname, contacts, email (см. Приложение В.4).
    Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^21]: Для просмотра полных данных о ребенке с его документами, адресами
    и контактами можно использовать режим встраивания (embed). В этих
    целях необходимо сделать запрос методом GET по следующему адресу:
    /prns/{oid}/kids/{kid_id}?embed=(documents.elements,addresses.elements,contacts.elements).

[^22]: В соответствии с Таблицей 2 «Коды типа документа, удостоверяющего
    личность» в РУКОВОДСТВЕ ПОЛЬЗОВАТЕЛЯ ВИДА СВЕДЕНИЙ В ЕДИНОЙ СИСТЕМЕ
    МЕЖВЕДОМСТВЕННОГО ЭЛЕКТРОННОГО ВЗАИМОДЕЙСТВИЯ, Сведение
    «Предоставление данных лицевого счета по СНИЛС»

[^23]: В тестовой среде сервис доступен по URL:
    https://esia-portal1.test.gosuslugi.ru/rs/orgs.

[^24]: В настоящее время используются следующие коды:

    10.FED -- Федеральный орган исполнительной власти;

    11.REG -- Орган исполнительной власти субъекта РФ;

    12.LCL -- Орган местного самоуправления;

    13.PVD -- Подведомственная организация федерального органа
    исполнительной власти;

    20.GOV -- Государственное учреждение;

    21.MCL -- Муниципальное учреждение;

    30.FND -- Государственный внебюджетный фонд;

    31.PFN -- Подведомственная организация государственного
    внебюджетного фонда;

    40.MFC -- Многофункциональный центр;

    41.LEG -- Законодательный (представительный) орган государственной
    власти субъекта Российской Федерации.

[^25]: Запрос ресурса: /orgs/100000/addrs?embed=(elements).

[^26]: Запрошенный ресурс: /orgs/1000000000/vhls?embed=(vehicles) или
    /orgs/1000000000/vhls?embed=(elements-1).

[^27]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs.

[^28]: Запрос ресурса: /orgs/100000/emps?embed=(elements.person).

[^29]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs.

[^30]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/ctts.

[^31]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/ctts/{ctt_id}.

[^32]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/ctts/{ctt_id}.

[^33]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/addrs.

[^34]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/addrs/{addr_id}.

[^35]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/vhls.

[^36]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/vhls/{vhl_id}.

[^37]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/vhls/{vhl_id}.

[^38]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/invts.

[^39]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/invts.

[^40]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/invts/{invt_id}.

[^41]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/emps/{emp_id}.

[^42]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/emps/{emp_id}.

[^43]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/grps/{grp_id}/perms.

[^44]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/grps/{grp_id}/perms.

[^45]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/brhs.

[^46]: Сервис доступен по URL:
    https://esia-portal1.test.gosulsugi.ru/rs/orgs/{org_oid}/brhs/{brh_id}.

[^47]: Список доверенных систем конфигурируется настройкой на стороне
    ЕСИА для конкретных ИС\
    по решению Минцифры России, согласованному с ЦБ России. Если ИС в
    настройке отсутствует,\
    то при запросе на импорт УЗ без адреса электронной почты будут
    возвращаться коды ошибок ESIA-032110.

[^48]: Порядок управления сертификатами для системы-клиента приведен в
    Руководстве пользователя Технологического портала ЕСИА, размещаемого
    по адресу https://digital.gov.ru/ru/documents/6190/.

[^49]: Данные коды завершения операции включаются настройкой на стороне
    ЕСИА для конкретных ИС\
    по решению Минцифры России, согласованному с ЦБ РФ. Если настройка
    для ИС не включена,\
    то при запросе паспортного досье будут возвращаться коды ошибок
    ESIA-039604 и ESIA-039606.

[^50]: В среде разработки сервис доступен по URL
    https://esia-portal1.test.gosuslugi.ru/rs/reqs/{requestId},\
    ыгде requestId -- уникальный идентификатор заявки на проверку данных
    пользователя.

[^51]: Сервис доступен по URL:
    https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/pso/{prn_oid}/avt/circle.

[^52]: Сервис доступен по URL:
    https://esia-portal1.test.gosuslugi.ru/esia-rs/api/public/v1/pso/{prn_oid}/avt/square.

[^53]: Строка может содержать через запятую коды
    [qc](https://dadata.ru/api/clean/address/#qc),
    [qc_complete](https://dadata.ru/api/clean/address/#qc_complete),
    [qc_house](https://dadata.ru/api/clean/address/#qc_house) на основе
    ответа от [API стандартизации адресов
    DaData](https://dadata.ru/api/clean/address/), либо значение по
    умолчанию.

[^54]: Строка может содержать через запятую коды
    [qc](https://dadata.ru/api/clean/address/#qc),
    [qc_complete](https://dadata.ru/api/clean/address/#qc_complete),
    [qc_house](https://dadata.ru/api/clean/address/#qc_house) на основе
    ответа от [API стандартизации адресов
    DaData](https://dadata.ru/api/clean/address/), либо значение по
    умолчанию.

[^55]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^56]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^57]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^58]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/ac.

[^59]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^60]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^61]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/v2/ac.

[^62]: Некоторые алгоритмы требуют развернуть зеркально, побайтово,
    полученную подпись.

[^63]: Порядок управления сертификатами для системы-клиента приведен в
    Руководстве пользователя Технологического портала ЕСИА, размещаемого
    по адресу https://digital.gov.ru/ru/documents/6190/.

[^64]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^65]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^66]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/te.

[^67]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^68]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^69]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/v3/te.

[^70]: Порядок байтов получаемой подписи важен. Если в соответствии с
    документацией на используемое средство криптографической защиты
    информации порядок байтов получаемой подписи обратный, может
    потребоваться его изменение.

[^71]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^72]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^73]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА.

[^74]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^75]: Использование scope, предоставляющих доступ к персональным данным
    физических лиц, может быть ограничено. Необходимо вместо scope
    указывать согласия. Методические рекомендации по интеграции с REST
    API Цифрового профиля опубликованы по ссылке
    https://digital.gov.ru/ru/documents/7166/.

[^76]: Подробнее см. в:
    <http://tools.ietf.org/html/draft-ietf-jose-json-web-signature-02#appendix-B>.

[^77]: Подробнее см. Руководство пользователя Технологического портала
    ЕСИА, п. 3.1.1 и п. 3.1.2:
    <https://digital.gov.ru/ru/documents/6190/>.

[^78]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/ac.

[^79]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^80]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/v2/ac.

[^81]: Порядок байтов получаемой подписи важен. Если в соответствии с
    документацией на используемое средство криптографической защиты
    информации порядок байтов получаемой подписи обратный, может
    потребоваться его изменение.

[^82]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^83]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/te.

[^84]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^85]: Выдача маркера обновления доступна только для информационных
    систем, которые получили разрешение в соответствии с пунктами 9, 10
    или 11 Регламента ЕСИА

[^86]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/v3/te.

[^87]: Использование областей доступа (scope), предоставляющих доступ к
    персональным данным физических лиц, может быть ограничено.
    Необходимо вместо области доступа (scope) указывать согласия.
    Методические рекомендации по интеграции с REST API Цифрового профиля
    опубликованы по ссылке: https://digital.gov.ru/ru/documents/7166/.

[^88]: Адрес в тестовой среде:
    https://esia-portal1.test.gosuslugi.ru/aas/oauth2/te.

[^89]: Набор данных, доступный ИС по данному scope, описан в п.Б.4,
    Приложение Б.

[^90]: Работа через шлюзовой модуль (API Gateway) будет возможна после 1
    января 2025 года (после завершения сертификационных процедур на
    соответствие требованиям по безопасности информации в отношении
    шлюзового модуля).

[^91]: Модель доступа описана в п. Б.2.

[^92]: Модель доступа описана в п. Б.3.

[^93]: Для получения доступа к механизму требуется направить заявку в
    электронной форме на адрес единой точки входа Минцифры России:
    <sd@sc.digital.gov.ru>.

[^94]: Детальная информация по описанию работы ВС доступна по ссылкам:
    [Register](https://smev3.gosuslugi.ru/portal/inquirytype_one.jsp?id=102402&zone=fed&page=1&dTest=false),
    [RegisterBySimplified](https://smev3.gosuslugi.ru/portal/inquirytype_one.jsp?id=102418&zone=fed&page=1&dTest=false),
    [Confirm](https://smev3.gosuslugi.ru/portal/inquirytype_one.jsp?id=102406&zone=fed&page=1&dTest=false),
    [Recover](https://smev3.gosuslugi.ru/portal/inquirytype_one.jsp?id=102408&zone=fed&page=1&dTest=false),
    [DeleteAccount](https://smev3.gosuslugi.ru/portal/inquirytype_one.jsp?id=102398&zone=fed&page=1&dTest=false),
    [FindAccount](https://smev3.gosuslugi.ru/portal/inquirytype_one.jsp?id=102404&zone=fed&page=1&dTest=false).

[^95]: В среде разработки сервис доступен по URL:
    https://esia-portal1.test.gosuslugi.ru/rs/reqs/{requestId},\
    где requestId -- уникальный идентификатор заявки на проверку данных
    пользователя.

[^96]: Доверенная загрузка собственного или типового технического
    решения обеспечивается средствами, указанными в эксплуатационной
    документации на СЭП и техническое решение и в соответствии\
    с требованиями указанной документации.
