Полный процесс работы в тестовом контуре с услугой "Предоставление информации о наличии исполнительного производства онлайн"

Общая информация

Тестовая среда

Адрес

ЕСИА

esia-portal1.test.gosuslugi.ru

ЕПГУ

svcdev-beta.test.gosuslugi.ru

Технологический портал ЕПГУ

svcdev-partners.test.gosuslugi.ru

Технологический портал ЕСИА

esia-portal1.test.gosuslugi.ru/console/tech/

1. Регистрация физических лиц и организаций в ЕСИА

Создание учетной записи физического лица

Регистрация в тестовой среде ЕСИА.

Ввод личных данных - ФИО, паспорт, СНИЛС (должен быть реальным для корректной работы некоторых сервисов), email (реальный, потребуется для получения сертификатов и общения с Оператором), номер телефона (можно реальный и провести подтверждение через смс).

Подтверждение учетной записи через центр госуслуг или почту.

Дождаться валидации данных в тестовой среде.

Мониторинг кода подтверждения.

Регистрация организации в ЕСИА

Вход в тестовую среду ЕСИА.

Использование КЭП генерального директора. (Можно реальный, но не рекомендую, лучше использовать способ описсанный ниже)

Заполнение заявки - указать ОГРН, ИНН, наименование организации. Отправка в ЕСИА. 

Подключение учетных записей сотрудников и выдача доверенностей на формирование API-ключей.

2. Получение тестового сертификата

Запрос сертификата

Отправка заявки на sd@sc.digital.gov.ru с заполненной формой.

Ответ сервиса

Получение PIN-кода.

Получение архива с сертификатом и закрытым ключом.

Инструкция по установке.

3. Регистрация информационной системы (ИС)

Создание ИС

Создание информационной системы в Технологическом портале ЕСИА.

Указание мнемоники тестовой ИС.

Загрузка сертификата.

Создание заявки с указанием описание системы, функциональные возможности и область применения.

Необходимо предоставить информацию о технических контактах для взаимодействия с операторами ЕСИА.

Отправка заявки на sd@sc.digital.gov.ru.

4. Получение тестового API-ключа

Запрос API-ключа

Добавление сотрудника с полномочиями:

Определение сотрудников, которым потребуется доступ к тестовой среде.

Создание учетных записей для каждого сотрудника через систему ЕСИА.

Сотрудники сначала создают подтверждённую учетную запись физического лица.

Генеральный директор добавляет сотрудников и назначает им полномочия.

Выдается доверенность на ответственного работника для формирования идентификационных ключей.

Назначение ролей и привилегий в рамках тестовой среды.

Подача заявки в разделе Мои системы.

Скачивание ключа в формате CSV.

5. Настройка взаимодействия с API Госуслуг

Получение токена доступа

Запрос access_token через OAuth 2.0.

Проверка валидности токена тестовым запросом.

Настройка сертификатов для подписания

Установка КриптоПро и подключение КЭП.

Настройка сервиса штампов времени (TSA).

Валидация подписей в тестовой среде.

6. Работа с заявками на предоставление услуги

Формирование XML-запроса

Создание XML-документа и его валидация.

Проверка соответствия XSD-схемам API.

Подписание запроса

Использование КриптоПро для подписания XML-документа.

Проверка подписи и добавление штампа времени.

Отправка запроса через API

POST /api/gusmev/push/chunked для загрузки заявления.

Получение номера заявки (orderId).

7. Обработка ответов

Получение статуса заявления

Запрос POST /api/gusmev/order/{orderId}.

Загрузка ответа ведомства

Запрос GET /download_file/{objectId}/{objectType}.

Обработка ошибок

Логирование запросов и обработка ошибок API.

8. Интеграция с фронтендом

Разработка интерфейса

Форма подачи заявлений с загрузкой файлов.

Отображение статуса запроса в реальном времени.

Интеграция с бэкендом

Взаимодействие с FastAPI, работа с JWT-токенами.

Подписание документов

Интеграция с КриптоПро для подписания XML-запросов.

Автоматизация отправки подписанных заявлений.

9. Выход в продуктивную среду

Тестирование API

Интеграционные тесты, проверка стабильности работы.

Совместное тестирование с Оператором.

Анализ логов и устранение ошибок.

Настройка продуктивной среды

Оформление заявки на подключение.

Получение API-ключей и настройка OAuth 2.0.

Проверка работы цифровой подписи.

Запуск в эксплуатацию

Мониторинг API-запросов.

Подключение пользователей и распределение ролей.

Настройка системы логирования и обработки инцидентов.

Эти шаги обеспечивают полное подключение и интеграцию с API Госуслуг в тестовом и продуктивном контурах.

