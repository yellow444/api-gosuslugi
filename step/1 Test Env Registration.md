### Подробная инструкция по регистрации в тестовой среде

#### 1. **Регистрация организации**

1.  **Создание учетной записи физического лица**

    - Регистрация в [тестовой среде ЕСИА](https://esia-portal1.test.gosuslugi.ru/registration/).
    - Ввести личные данные:
    - ФИО
    - Паспорт
    - СНИЛС (должен быть реальным для корректной работы некоторых сервисов)
    - Email (реальный, потребуется для получения сертификатов и общения с Оператором)
    - Номер телефона (реальный)

2.  **Подтверждение учетной записи**

    - Подтверждение учетной записи можно выполнить через центр госуслуг или почту.
    - Дождаться валидации данных в тестовой среде.
    - Мониторинг [кода подтверждения](https://esia-portal1.test.gosuslugi.ru/logs/postcodes/).

3.  **Подача заявки на регистрацию организации**

    - Вход в [тестовую среду ЕСИА](https://esia-portal1.test.gosuslugi.ru/).
    - Использовать сертификат электронной подписи (КЭП) генерального директора.
    - Указать ОГРН, ИНН, наименование организации.
    - Заполнить заявку и направить её в ЕСИА.

4.  **Подключение учетных записей сотрудников**

    - Определение сотрудников, которым потребуется доступ к тестовой среде.
    - Создание учетных записей для каждого сотрудника через систему ЕСИА.
    - Сотрудники сначала создают подтверждённую учетную запись физического лица.
    - Генеральный директор добавляет сотрудников и назначает им полномочия.
    - Выдается доверенность на ответственного работника для формирования идентификационных ключей.
    - Назначение ролей и привилегий в рамках тестовой среды.

5.  **Запрос сертификата**

    - Отправка заявки на [sd@sc.digital.gov.ru](mailto:sd@sc.digital.gov.ru) с заполненной формой.
    - Проверка соответствия сертификатов требованиям API.

6.  **Ответ сервиса**

    - Получение PIN-кода `1234567890`.
    - Получение архива с сертификатом и контейнером закрытого ключа.
    - Инструкция по установке.

7.  **Получение тестового сертификата для работы в тестовой среде**

    - После одобрения заявки организация получает тестовый сертификат электронной подписи.
    - Сертификат может быть загружен через официальный сервис удостоверяющего центра.
    - Устанавливается в систему для последующего использования при подписании запросов.

#### 2. **Регистрация информационной системы (ИС)**

1.  **Подача заявки на регистрацию ИС в тестовой среде**

    - Создание информационной системы в [Технологическом портале ЕСИА](https://esia-portal1.test.gosuslugi.ru/console/tech).
    - Указание мнемоники тестовой ИС.
    - Загрузка сертификата.
    - Организация отправляет заявку на регистрацию своей информационной системы.
    - В заявке указывается описание системы, функциональные возможности и область применения.
    - Необходимо предоставить информацию о технических контактах для взаимодействия с операторами ЕСИА.
    - Отправка заявки на [sd@sc.digital.gov.ru](mailto:sd@sc.digital.gov.ru) с заполненной формой.

2.  **Настройка параметров ИС в тестовой среде**
    - После подтверждения регистрации выполняется настройка параметров информационной системы.
    - Определяются точки входа, протоколы взаимодействия, а также настройки безопасности.
    - Проверяется совместимость системы с API тестовой среды.

#### 3. **Получение тестового API-ключа**

1.  **Оформление запроса на генерацию API-ключа**

    - Организация направляет запрос на выдачу API-ключа через административный портал тестовой среды.
    - Запрос включает сведения о зарегистрированной информационной системе.

2.  **Генерация API=ключа через платформу ЕСИА**

    - После одобрения запроса платформа ЕСИА автоматически генерирует API-ключ.
    - Для этого необходимо добавить сотрудника с полномочиями путем подачи заявки в разделе [Мои системы](https://svcdev-partners.test.gosuslugi.ru/systems).
    - Скачиваем csv с ключем.

#### 4. **Проверка авторизации и доступов**

1.  **Аутентификация через OAuth 2.0 в ЕСИА**

    - Для получения доступа к API необходимо выполнить аутентификацию через OAuth 2.0.
    - Клиентское приложение запрашивает access_token, подписываем API-ключ в base64.
    - ЕСИА проверяет запрос и выдает временный токен для работы с сервисами.

2.  **Подключение и тестирование API ЕПГУ**
    - Выполняется тестовое подключение к API Единого портала государственных услуг.
    - Проверяется корректность передачи данных и авторизации системы.
    - В случае ошибок анализируются логи и корректируются параметры запроса.

Эти шаги обеспечивают корректную регистрацию и настройку системы в тестовом контуре перед началом полноценного взаимодействия с сервисами ЕСИА и ЕПГУ.
